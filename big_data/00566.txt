6
1
0
2

 
r
a

M
2

 

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
6
6
5
0
0

.

3
0
6
1
:
v
i
X
r
a

Point Counting on Non-Hyperelliptic Genus 3 Curves with

Automorphism Group Z/2Z using Monsky-Washnitzer

Cohomology

Yih-Dar SHIEH

Abstract. We describe an algorithm to compute the zeta function of any non-
hyperelliptic genus 3 plane curve C over a ï¬nite ï¬eld with automorphism group
G = Z/2Z. This algorithm computes in the Monsky-Washnitzer cohomology
of the curve. Using the relation between the Monsky-Washnitzer cohomology
of C and its quotient E := C/G, the computation splits into 2 parts: one in a
subspace of the Monsky-Washnitzer cohomology and a second which reduces
to the point counting on an elliptic curve E. The former corresponds to the
dimension 2 abelian surface ker(Jac(C) â†’ E), on which we can compute with
lower precision and with matrices of smaller dimension. Hence we obtain a
faster algorithm than working directly on the curve C.

1. Introduction

Henn gave the table of the possible non-trivial groups which appear as auto-
morphism groups of a non-hyperelliptic genus 3 curves, which can be found in Ver-
meulenâ€™s thesis [11]. The dimension of the set of moduli points of non-hyperelliptic
genus 3 curves whose automorphism group contain Z/2Z is 4 inside the moduli of
genus 3 curves M3 of dimension 6. We thus obtain an algorithm to compute the
zeta function of a large family of genus 3 curves.
In [5], Kedlaya used Monsky-Washnitzer cohomology to compute the zeta func-
tions of hyperelliptic curves over ï¬nite ï¬elds. This method could be applied to
general varieties, and there are already generalizations to superelliptic curves, Ca,b
curves and non-degenerate curves, see [1], [2] and [4]. This work also uses Monsky-
Washnitzer cohomology but focuses on a smaller dimensional space associated to
an abelian surface in the jacobian of C.

The remainder of this paper is organized as follows: Section 2 recalls the deï¬-
nition of Monsky-Washnitzer cohomology and results in this theory. In Section 3,
we compute a basis of the cohomology and describe a way to do the reduction of
a diï¬€erential form. Reduction means to write a diï¬€erential form as a linear com-
bination of the basis. In particular, we give an upper bound of the denominator
after a diï¬€erential form is reduced. This bound makes the algorithm practical since
it establishes a ï¬nite precision bound for the computation. Section 4 describes a

This work was supported by a project of the Agence Nationale de la Recherche, reference

ANR-12-BS01-0010-01.

1

2

YIH-DAR SHIEH

way to compute a lift of Frobenius and Section 5 explains why the computation
splits into 2 eigenspaces. Finally, Section 6 gives the algorithm and an analysis of
its complexity.

2. Monsky-Washnitzer Cohomology

In this section, we recall the deï¬nition of Monsky-Washnitzer cohomology which

is introduced by Monsky and Washnitzer in [7][8][9].

Monsky-Washnitzer cohomology is a p-adic cohomology theory deï¬ned for smooth

aï¬ƒne varieties over ï¬nite ï¬elds. Let X be a smooth aï¬ƒne variety deï¬ned over a
ï¬nite ï¬eld k := Fq of characteristic p with coordinate ring A which is a ï¬nitely gen-
erated k-algebra. In [3], Elkik showed that there exists a ï¬nitely generated smooth
Zq-algebra A such that A/pA âˆ¼= A, here Zq is the valuation ring of Qq, the degree
n := logpq unramiï¬ed extension of Qp.

In general, A does not admit a lift of the Frobenius endomorphism F on A , but
its p-adic completion Aâˆ does. However, the dimension of the de Rham cohomology
n=0 pnxpnâˆ’1dx is not an
is not in Aâˆ, but each term of this sum is
exact. The problem is that this diï¬€erential form does not converge fast enough for
its integral to converge as well.

of Aâˆ may be too big. For example, if A = Zp[x], then Pâˆ
exact diï¬€erential form since Pâˆ

n=0 xpn

Monsky and Washnitzer work with a subalgebra Aâ€  of Aâˆ consisting of series

which converge fast enough to solve the above problem. For
A = Zq[x1, x2,Â·Â·Â· , xd]/(f1, f2,Â·Â·Â· , fr),

the weak completion or dagger ring of A is

Aâ€  := Zqhx1, x2,Â·Â·Â· , xdi/(f1, f2,Â·Â·Â· , fr)

where Zqhx1, x2,Â·Â·Â· , xdi is the subring of Aâˆ which consists of overconvergent
power series

(XÎ±

with Î± := (Î±1,Â·Â·Â· , Î±d), xÎ± := xÎ±1
valuation on Zq.

aÎ±xÎ± âˆˆ Zq[[x1, x2,Â·Â·Â· , xd]] (cid:12)(cid:12)(cid:12)
d , |Î±| =Pd

1 Â·Â·Â· xÎ±d

lim inf
|Î±|â†’âˆ

vp(aÎ±)
|Î±|

> 0)

i=1 Î±i and vp is the usual p-adic

Definition 2.1. The Monsky-Washnitizer cohomology of X/Fq is the de Rham
cohomology of Aâ€ âŠ—Zq Qq. More precisely, let D0(Aâ€ ) := Aâ€ , D1(Aâ€ ) be its universal
module of diï¬€erentials
dxd(cid:19)ï£¶
ï£¸

D1(Aâ€ ) :=(cid:0)Aâ€  dx1 + Â·Â·Â· + Aâ€  dxd(cid:1) /ï£«
Xj=1
ï£­

and Di(Aâ€ ) be the i-th exterior product of D1(Aâ€ ). Let H i(A, Zq) be the i-th
cohomology group of the complex

Aâ€ (cid:18) âˆ‚fi

dx1 + Â·Â·Â· +

âˆ‚fi
âˆ‚xd

âˆ‚x1

r

0 âˆ’â†’ D0(Aâ€ )

d3âˆ’â†’ Â·Â·Â·
where di is the usual diï¬€erentiation. Then the i-th Monsky-Washnitzer cohomology
group of X (or of A) is H i(A, Zq) âŠ—Zq Qq, which is denoted by H i
MW (X/Fq) (or
H i(A, Qq)).

d0âˆ’â†’ D1(Aâ€ )

d1âˆ’â†’ D2(Aâ€ )

d2âˆ’â†’ D3(Aâ€ )

The Monsky-Washnitzer cohomology has the following properties, see [10].

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

3

Theorem 2.2. For a smooth ï¬nitely generated Fq-algebra A, we have
(a) The map A 7â†’ H i(A, Qq) is well deï¬ned and functorial.
(b) There exists a Zq-algebra homomorphism Fq : Aâ€  â†’ Aâ€  which lifts the
Frobenius endomorphism of A. Furthermore, any two lifts induce homo-
topic maps on the complex Di(Aâ€ ). Hence they induce the same map
Fq,âˆ— : H i(A, Qq) â†’ H i(A, Qq) on the Monsky-Washnitzer cohomology.

The following Lefschetz ï¬xed point formula allows us to compute the zeta

function of X = Spec(A) using Monsky-Washnitzer cohomology.

Theorem 2.3 (Lefschetz ï¬xed point formula). Let X/Fq be a smooth aï¬ƒne

variety of dimension d. Then we have

X(Fq) =

d

Xi=0

q,âˆ—(cid:12)(cid:12)(cid:12)
(âˆ’1)iTr(cid:16)qdF âˆ’1

H i

MW (X/Fq)(cid:17) .

3. Cohomology of Non-Hyperelliptic Genus 3 Plane Curves with

Automorphism Group Z/2Z

In this article, we consider non-hyperelliptic smooth projective plane curves
C of genus 3 whose automorphism group contains Z/2Z over a ï¬nite ï¬eld Fq of
characteristic p 6= 2. Such curves can be written (up to isomorphism) as

C : F := Y 4 + G(X, Z)X 2 + H(X, Z) = 0,

with G(X, Z) and H(X, Z) âˆˆ Fq[X, Z] which are homogeneous of degree 2 and 4
respectly. We assume that C is smooth. Since the Monsky-Washnitzer cohomology
is deï¬ned for smooth aï¬ƒne varieties, we also consider the aï¬ƒne part of C

Caï¬€ : f := y4 + g(x)y2 + h(x) = 0,

where g(x) = G(x, 1) and h(x) = H(x, 1) are the dehomogenizations of G(X, Z) and
H(X, Z) with respect to Z. In this section, we compute the Monsky-Washnitzer
cohomology H i
MW (Caï¬€ /Fq) of Caï¬€ and relate the zeta function of C/Fq to the
characteristic polynomial of the Frobenius action Fq,âˆ— on H i

MW (Caï¬€ /Fq).

Choose arbitrary lifts G(X, Z) and H(X, Z) âˆˆ Zq[X, Z] of G(X, Z) and H(X, Z)
such that degX G = degX G and degX H = degX H. Let g(x) := G(x, 1) and
h(x) := H(X, 1) be the dehomogenizations. Consider the following two curves

ËœC : F := Y 4 + G(X, Z)Y 2 + H(X, Z) = 0,

and

(3.1)

ËœCaï¬€ : f := y4 + g(x)y2 + h(x) = 0

Since the reduction of F modulo the maximal ideal (p) of Zq is F which deï¬nes a
smooth projective curve C, the generic ï¬ber ËœCÎ¾ := ËœC Ã—Zq Qq of ËœC is also smooth.
Using the three facts that the reduction of f modulo the maximal ideal (p) of Zq
equals to f which is not zero in Fq[x, y], that A := Fq[x, y]/(f (x, y)) is an integral
domain and that p is a prime element in the unique factorization domain Zq[x, y],
one sees that A is an integral domain and hence it is ï¬‚at over Zq. This shows that
A is a ï¬nitely generated smooth Zq-algebra, so we can work with A to apply the
theory of Monsky-Washnitzer cohomology. The above arguments also show that
the generic ï¬ber ËœCÎ¾ of ËœC is a geometrically integral smooth projective curve over
Qq.

4

YIH-DAR SHIEH

Although we can compute the Monsky-Washnitzer cohomology of the aï¬ƒne
curve Caï¬€ /Fq by explicit reduction algorithms and the control of denominators,
we use the following theorem instead, see [6], and compute the algebraic de Rham
dR( ËœCÎ¾,aï¬€ /Qq) of the curve ËœCÎ¾,aï¬€ /Qq, the aï¬ƒne part of the generical
cohomology H i
ï¬ber ËœCÎ¾. Note that we are concerned with curves, hence the divisors are always
normal crossings.

Theorem 3.1. Let Y /Zq be a smooth proper scheme, Z be a relative normal
crossings divisor and X := Y \Z is aï¬ƒne. Then there is a canonical isomorphism

H i
dR(XÎ¾/Qq) â†’ H i

MW (Xp/Fq),

where XÎ¾ is the generic ï¬ber and Xp is the special ï¬ber of X/Zq, namely, the ï¬bers
of X at the closed point (p) of Spec(Zq).

3.1. Geometry. Before we compute the algebraic de Rham cohomology of the
aï¬ƒne curve ËœCÎ¾,aï¬€ , we need to study its geometry. The coordinate ring of ËœCÎ¾,aï¬€ is
A := Qq[x, y]/(f (x, y)), here f (x, y) = y4 + g(x)y2 + h(x) âˆˆ Zq[x, y] with deg(g) â‰¤ 2
and deg(h) â‰¤ 4. We write g(x) and h(x) as following

(3.2)

g(x) = a2x2 + a1x + a0, ai âˆˆ Zq
h(x) = b4x4 + b3x3 + b2x2 + b1x + b0, bi âˆˆ Zq

There are four cases to consider:
Case 1. b4 = 0 and a2 = 0
There is only one point at inï¬nity which is Pâˆ := (1 : 0 : 0). Using the fact that
ËœCÎ¾ is smooth at Pâˆ, one shows that b3 6= 0. The dimension of the ï¬rst algebraic
de Rham cohomology of ËœCÎ¾,aï¬€ /Qq is 2g + Nâˆ âˆ’ 1 = 2 Â· 3 + 1 âˆ’ 1 = 6, here g is the
genus of ËœCÎ¾, which equals to the genus of C, and Nâˆ is the number of points at
inï¬nity. We have Ï…Pâˆ (x) = âˆ’4 and Ï…Pâˆ (y) = âˆ’3. The local parameter at Pâˆ is
t := b3x2/y3. The expansions of x and y as Laurent series of the local parameter t
are x = âˆ’b3/t4 + Â·Â·Â· and y = b3/t3 + Â·Â·Â· .
Case 2. b4 = 0 and a2 6= 0
There are 3 points at inï¬nity: Pâˆ := (1 : 0 : 0) and Pâˆ,Â± := (1 : Â±Î± : 0) with
Î±2 = âˆ’a2. Using the fact that ËœCÎ¾ is smooth at Pâˆ, one shows that b3 6= 0.
(The condition a2 6= 0 implies the smoothness at Pâˆ,+ and Pâˆ,âˆ’.) We have
dR( ËœCÎ¾,aï¬€ /Qq) = 2 Â· 3 + 3 âˆ’ 1 = 8, Ï…Pâˆ,Â±(x) = Ï…Pâˆ,Â±(y) = âˆ’1, Ï…Pâˆ (x) = âˆ’2
dimQq H 1
and Ï…Pâˆ (y) = âˆ’1. The local parameters at Pâˆ and Pâˆ,Â± are t := 1/y and
tÂ± := 1/x. The expansions of x and y at Pâˆ and Pâˆ,Â± as Laurent series of the
local parameters are x = Î²/t2 + Î³ + Î´t2 + Â·Â·Â· with Î² = âˆ’a2/b3, y = 1/t, and
x = 1/tÂ±, y = Â±Î±/t + Â·Â·Â· .
Case 3. b4 6= 0 and a2
There are 2 points at inï¬nity: Pâˆ,Â± := (1 : Â±Î± : 0) with Î± = (âˆ’a2/2)1/2. Using
the fact that ËœCÎ¾ is smooth at Pâˆ,+, one shows that a1a2 âˆ’ 2b3 6= 0. We have
dR( ËœCÎ¾,aï¬€ /Qq) = 2Â· 3 + 2âˆ’ 1 = 7 and Ï…Pâˆ,Â±(x) = Ï…Pâˆ,Â±(y) = âˆ’2. The local
dimQq H 1
parameters are tÂ± := y/x âˆ“ Î±. The expansions of x and y as Laurent series of the
local parameters are x = Î²/t2
Â± + (Î² Â± Î±Î³)/tÂ± + Â·Â·Â·
with Î² = âˆ’(a1a2 âˆ’ 2b3)/4a2 and Î³ = Î±(a1a2 + 2b3)/2a2
2.
Case 4. b4 6= 0 and a2
There are 4 points at inï¬nity which are Pâˆ,i,Â± := (1 : Â±Î±i : 0) with Â±Î±1 and

Â± + Î³/tÂ± + Â·Â·Â· and y = Â±Î±Î²/t2

2 âˆ’ 4b4 6= 0

2 âˆ’ 4b4 = 0

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

5

dR( ËœCÎ¾,aï¬€ /Qq) =
Â±Î±2 are the four roots of y4 + a2y2 + b4 = 0. We have dimQq H 1
2Â·3+4âˆ’1 = 9 and Ï…Pâˆ,i,Â±(x) = Ï…Pâˆ,i,Â±(y) = âˆ’1. The local parameters are t := 1/x.
The expansions of x and y as Laurent series of t are x = 1/t and y = Â±Î±i/t + Â·Â·Â· .
In order to analyze the control of denominators later, we need to impose further

assumptions on the choice of the lift F (X, Y, Z).

Assumption 3.2. The coeï¬ƒcients ai and bj of g(x) and h(x) in (3.2) are either

0 or units in Zq. Furthermore, a2

2 âˆ’ 4b4 is either 0 or a unit in Zq.

Remark 3.3. A lift which satisï¬es the above assumptions could be constructed
by using TeichmÂ¨uller lift. The choice of such a lift is to preserve the geometric
structure. Under these assumptions, we introduce some facts which will be used
later. The expansions of x and y as Laurent series of the local parameters have
integral coeï¬ƒcients.1 This means that x and y are in O((t)), here O is the integral
closure of Zq in a ï¬nite extension Qq(Î±) (Qq(Î±1, Î±2) in Case 4) of Qq and Î± is the
Y -coordinate of the points at inï¬nity discussed above. Furthermore, the coeï¬ƒcients
of the lowest terms 2 in these Laurent series are units in O. (In Case 3, one shows
that a1a2 âˆ’ 2b3 is a unit in Zq by using C is smooth.) ËœCÎ¾ and C have the same
geometry. In Case 4, pa2
3.2. The Reduction Algorithm and Algebraic de Rham Cohomol-
ogy. In this subsection, we present the reduction algorithm and use it to compute
dR( ËœCÎ¾,aï¬€ /Qq). First of all, since (i + 1)xjyidy = d(xj yi+1) âˆ’ jxjâˆ’1yi+1dx for
H 1
all i â‰¥ 0, the universal module of diï¬€erential â„¦1 of ËœCÎ¾,aï¬€ /Qq is generated by
{xjyidx | i â‰¥ 0, j â‰¥ 0}. From the deï¬ning equation (3.1), â„¦1 is generated by
{xjyidx | 1 â‰¤ i â‰¤ 3, j â‰¥ 0}. Since
0 = df = d(cid:0)y4 + g(x)y2 + h(x)(cid:1) =(cid:0)gâ€²(x)y2 + hâ€²(x)(cid:1) dx +(cid:0)4y3 + 2g(x)y(cid:1) dy,

2 âˆ’ 4b4 is a unit in O.

we have

Combine with the following equation

2

2

l + 4

l + 2

yl+4 +

kxkâˆ’1yl+4 +

g(x)yl+2(cid:19)(cid:19) âˆ’ xk(cid:0)4y3 + 2g(x)y(cid:1) yldy

xk(cid:0)gâ€²(x)y2 + hâ€²(x)(cid:1) yldx + xk(cid:0)4y3 + 2g(x)y(cid:1) yldy = 0.
d(cid:18)xk(cid:18) 4
=(cid:18) 4
xk(cid:18) l
= d(Sl,k), where Sl,k := âˆ’xk(cid:18) 4

l + 2(cid:0)kxkâˆ’1g(x) + xkgâ€²(x)(cid:1) yl+2(cid:19) dx,

gâ€²(x)y2 + hâ€²(x)(cid:19) yldx âˆ’ kxkâˆ’1(cid:18) 4

g(x)yl+2(cid:19)

l + 4
2

y4 +

yl+4 +

l + 4

l + 2

l + 4

l + 2

2

l + 2

g(x)y2(cid:19) yldx

one gets

Using y4 = âˆ’(g(x)y2 + h(x)) and the explicit description of g(x) and h(x) in (3.2),
the above equation becomes

(3.3)

Î“k,l,0,j xk+j yl +

3

Xj=âˆ’1

1

Xj=âˆ’1

ï£«
ï£­

Î“k,l,2,j xk+j yl+2ï£¶

ï£¸ dx = d(Sl,k),

1Use Henselâ€™s lemma. For Case 1, one needs a 2-variable version of Henselâ€™s lemma.
2 In particular, Î±, Î² âˆˆ Oâˆ— if we use the notations in the above classiï¬cation.

0
Â·
Â·
0

0
Â·
Â·
0

0
Â·
Â·
0
0 Î“l,k,0,âˆ’1 Î“l,k,0,0 Î“l,k,0,1 Î“l,k,0,2 Î“l,k,0,3
0
0 Î“l,k,2,âˆ’1 Î“l,k,2,0 Î“l,k,2,1

0
Â·
Â·
0

0
Â·
Â·
0

0
Â·
Â·
0

0
0

0
0

0

0

0

ï£«

ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£­

ï£¶

ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£¸

6

YIH-DAR SHIEH

here the coeï¬ƒcients Î“k,l,0,j and Î“k,l,2,j are deï¬ned as following

Î“k,l,0,j := (j + 1 +

4k
l + 4

) bj+1, Î“k,l,2,j :=

l

l + 2

(j + 1 +

2k
l + 4

)aj+1.

In order to make things more clear, we use the following notation:

Definition 3.4. A family of matrices Mk of size mÃ— n with entries (Mk)i,j =

mk,i,j âˆˆ Qq is called a family of reduction matrices if

mk,i,j xk+jâˆ’3yiâˆ’1ï£¶

m

n

Xi=1

Xj=1

ï£«
ï£­

ï£¸ dx â‰¡ 0 in â„¦1, for all k.

For reduction matrices Mk, we deï¬ne Mk dx to be

m

n

Xi=1

Xj=1

ï£«
ï£­

mk,i,j xk+jâˆ’3yiâˆ’1ï£¶
ï£¸ dx.

For example, from (3.3), we have reduction matrices of size (l + 3) Ã— 6 which

has non-zero entries only at the (l + 1)-th and (l + 3)-th rows

M 0

l,k :=

l,kdx = d(Sl,k). The superscript 0 that appears in M 0

and M 0
obtained from (3.3), without further reduction.

l,k means that it is

We have to consider l = 1, 2 and 3, which give the reductions of xk+3y2dx or

xk+2y2dx:
l = 1.
As mentioned above, we have reduction matrices of size 4 Ã— 6

0

0

0

0

0

0

0

0

1

2ka0

M1,k =

(2k + 5)a1

(12k + 60)b4

(12k + 45)b3

(12k + 30)b2

(12k + 15)b1

0
0 12kb0
0
0

15 Â·ï£«
ï£¬ï£¬ï£­

ï£¶
ï£·ï£·ï£¸
From 3.1, we know that one of b4 and b3 is non-zero. Hence xk+3ydx or xk+2ydx
can be reduced to a linear combination of {xjyidx} with i = 1 or 3 and j â‰¤ k + 2
(if b4 6= 0) or j â‰¤ k + 1 (if b4 = 0), which have smaller degree in x.
l = 2.
From (3.2), we have reduction matrices of size 5 Ã— 6, so y4 is involved. Using the
deï¬ning equation (3.1) to reduce the degree in y, one gets a reduction matrix M2,k
whose transpose is

(2k + 10)a2

0
0

0
0

M t

2,k = âˆ’

1
6 Â·

0 0
0 0
0 0
0 0
0 0
0 0

ï£«

ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£­

(k + 3)(a2

k(a2

0
0
0 âˆ’ 4b0)
0
0
1 + 2a0a2 âˆ’ 4b2) 0
0
0

(2k + 3)(a0a1 âˆ’ 2b1)
(2k + 9)(a1a2 âˆ’ 2b3)
(k + 6)(a2
2 âˆ’ 4b4)

ï£¶

ï£·ï£·ï£·ï£·ï£·ï£·ï£¸

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

7

This gives us the reductions of xk+3y2dx or xk+2y2dx depending on the nullity of
a2
2 âˆ’ 4b4.
l = 3.
As at the start of l = 2 (dealing with y5), one gets M 1

3,k whose transpose is

1
35 Â·

âˆ’

ï£«

ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£¬ï£­

0

6ka0b0

6k(a1b0 + a0b1) + 21a1b0

0
0
0
0 6k(a2b0 + a1b1 + a0b2) + 21a1b1 + 42a2b0
0 6k(a2b1 + a1b2 + a0b3) + 21a1b2 + 42a2b1
0 6k(a2b2 + a1b3 + a0b4) + 21a1b3 + 42a2b2
0
0

(6k + 21)(a2b3 + a1b4) + 21a2b3

(6k + 42)a2b4

0
0
0
0
0
0
0
0

(2k + 7)(3a2

k(6a2

0
0 âˆ’ 20b0)
1 + 6a0a2 âˆ’ 10b2)

(4k + 7)(3a0a1 âˆ’ 5b1)
(4k + 21)(3a1a2 âˆ’ 5b3)
(2k + 14)(3a2
2 âˆ’ 10b4)

0
0

ï£¶

ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£·ï£¸

Since we want to reduce xj y3dx to those with smaller degree in x, M 1
3,k is not
suitable since it has (possible) non-zero entries which correspond to xk+5y1, xk+4y1
and xk+3y1. We use l = 1 to reduce xk+3ydx to {xj1 ydx, xj2 y3dx| j1 â‰¤ k + 2, j2 â‰¤
k + 1} if b4 6= 0, or reduce xk+2ydx to {xj1 ydx, xj2 y3dx| j1 â‰¤ k + 1, j2 â‰¤ k + 1} ) if
b4 = 0. Then use this result to reduce xk+3ydx (if b4 = 0), xk+4ydx and xk+5ydx
(if b4 6= 0) iteratively to {xj1 ydx, xj2 y3dx| j1 â‰¤ k + 2, j2 â‰¤ k + 3}, depending the
nullity of b4. Finally, use these reductions in M 1
Case 3 and Case 4: b4 6= 0

3,k, we get reduction matrices in

â€²

M

0
0
0
0

0 0
âˆ— âˆ—
0 0
âˆ— âˆ—

0
0
âˆ— âˆ—2,5
0
0
âˆ— âˆ—4,5

3,k = c Â·ï£«
ï£¬ï£¬ï£­
4(k + 4)(k + 5)(k + 6)(cid:0)(8k + 44)a1a2b4 âˆ’ a2

with c = âˆ’1/(cid:0)2688(k + 4)(k + 5)(k + 6)b3

âˆ—4,5 = 96b2

which equals to 384b3

4(cid:1) and

2 âˆ’ 4b4)

ï£¶
ï£·ï£·ï£¸
2b3 âˆ’ (16k + 84)b3b4(cid:1)

4(k + 4)(k + 5)(k + 6)(2k + 11)(a1a2 âˆ’ 2b3) if a2

384(k + 4)(k + 5)(k + 6)(k + 7)b3

4(a2

0
0
0

2 âˆ’ 4b4 = 0, and

âˆ—2,5 = 36(k + 4)b4 (cid:18)(6k2 + 136k + 285)a2b3

3 âˆ’ 8(6k2 + 56k + 125)a2b2b3

+ 48(k2 + 11k + 30)a2b1b2

4 + 16(k2 + 6k)a0b3b2
4

âˆ’ 2(8k2 + 58k + 105)a1b2

4(cid:19)
Notice that âˆ—2,5 may be non-zero, but it corresponds to xk+2y and since b4 6= 0,
one can use M1,kâˆ’1 in the case l = 1 to reduce xk+2ydx and get a new reduction
matrices

3b4 + 16(2k2 + 17k + 35)a1b2b2

M3,k = c Â·ï£«
ï£¬ï£¬ï£­

0
âˆ—
0
âˆ—

0 0
âˆ— âˆ—
0 0
âˆ— âˆ—

0
0
âˆ—
0
0
0
âˆ— âˆ—4,5

0
0
0

384(k + 4)(k + 5)(k + 6)(k + 7)b3

4(a2

2 âˆ’ 4b4)

ï£¶
ï£·ï£·ï£¸

Notice that the reduction of xk+2ydx using M1,kâˆ’1 only involve xjydx with kâˆ’ 2 â‰¤
j â‰¤ k+1 and xj y3 with kâˆ’2 â‰¤ j â‰¤ k, the last two columns of M3,k and M 2
3,k are the
same except the (2, 5)-entry, and M3,k satisï¬es the condition in Deï¬nition 3.4, so
they are indeed reduction matrices. The reduction involves division by 12(k + 4)b4,
hence câˆ’1M3,k has integral coeï¬ƒcients.

8

YIH-DAR SHIEH

Case 1 and Case 2: b4 = 0

M3,k = c Â·ï£«
ï£¬ï£¬ï£­

0
0
0
0

0
âˆ—
0
âˆ—

0 0
âˆ— âˆ—
0 0
âˆ— âˆ—

0
0
0
âˆ—4,5

0
0
0

2(k + 7)(2k + 11)(4k + 15)(4k + 19)b2

3a2
2

ï£¶
ï£·ï£·ï£¸

with c = âˆ’1/(cid:0)7(4k + 15)(4k + 19)(4k + 23)b2
âˆ—4,5 = (4k + 15)b3 (cid:18)(32k3 + 504k2 + 2648k + 4641)a1a2b3 âˆ’ (4k2 + 52k + 168)a2

3(cid:1) and

2b2

3(cid:19)
âˆ’ (64k3 + 1008k2 + 5276k + 9177)b2
which equals to âˆ’(4k + 15)(4k + 19)(4k + 21)(4k + 23)b3
ËœCÎ¾,aï¬€ /Qq.

3 if a2 = 0.
Now we can compute the algebraic de Rham cohomology H 1

dR( ËœCÎ¾,aï¬€ /Qq) of

Proposition 3.5. The algebraic de Rham cohomology H 1

dR( ËœCÎ¾,aï¬€ /Qq) has a

basis

(1) {ydx, y2dx, y3dx, xydx, xy2dx, xy3dx}, if b4 = 0 and a2 = 0.
(2) {ydx, y2dx, y3dx, xydx, xy2dx, xy3dx, x2y2dx, x2y3dx}, if b4 = 0 and
(3) {ydx, y2dx, y3dx, xydx, xy2dx, xy3dx, x2ydx}, if b4 6= 0 and a2
2 âˆ’ 4b4 = 0.
(4) {ydx, y2dx, y3dx, xydx, xy2dx, xy3dx, x2ydx, x2y2dx, x2y3dx}, if b4 6= 0 and

a2 6= 0.

a2
2 âˆ’ 4b4 6= 0.

Proof. We give the proof for (c). For other parts, the proofs are all similar.
Suppose b4 6= 0 and a2
2âˆ’ 4b4 = 0. The reduction matrices M1,k shows that xk+3ydx
is a linear combination of {xj1 ydx, xj2 y3dx | k âˆ’ 1 â‰¤ j1 â‰¤ k + 2, k âˆ’ 1 â‰¤ j2 â‰¤
k + 1}, since b4 6= 0. So each xj ydx with j â‰¥ 3 can be reduced. The (3, 6)-
entry of the reduction matrix M2,k is (k + 6)(a2
2 âˆ’ 4b4) = 0, but its (3, 5)-entry is
(2k + 9)(a1a2 âˆ’ 2b3) which is non-zero by Case 3 in Section 3.1. So xk+2y2dx is a
linear combination of {xjy2 | k âˆ’ 1 â‰¤ j â‰¤ k + 1} and hence each xjy2dx with j â‰¥ 2
can be reduced. The reduction matrix M3,k in Case 3 has (k + 7)(a2
2 âˆ’ 4b4) = 0 at
the (4, 6)-entry, but its (4, 5)-entry is âˆ—4,5 = (2k + 11)(a1a2âˆ’ 2b3) 6= 0. So xk+2y3dx
is a linear combination of {xj1 ydx, xj2 y3dx | k âˆ’ 2 â‰¤ j1 â‰¤ k + 1, kâˆ’ 2 â‰¤ j2 â‰¤ k + 1}
and hence each xjy3 with j â‰¥ 2 can be reduced. This completes the proof for
(c).

(cid:3)

The following table give a more clear description of these basis.

y

y2

dx 1 x x2
â€¢ Ã—
â€¢ Ã—
â€¢ Ã—
(1.a) Case 1

â€¢
â€¢
â€¢

y3

y

y3

y2

dx 1 x x2
â€¢ Ã—
â€¢
â€¢
â€¢
â€¢
(1.b) Case 2

â€¢
â€¢
â€¢

y

y2

dx 1 x x2
â€¢
â€¢
â€¢ Ã—
â€¢ Ã—
(1.c) Case 3

â€¢
â€¢
â€¢

y3

y

y2

dx 1 x x2
â€¢
â€¢
â€¢
(1.d) Case 4

â€¢
â€¢
â€¢

â€¢
â€¢
â€¢

y3

Table 1. basis of H 1

dR( ËœCÎ¾,aï¬€ /Qq)

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

9

3.3. Control of the denominators in the reduction algorithm and
Monsky-Washnitzer cohomology. The reduction algorithm in subsection 3.2
dR( ËœCÎ¾,aï¬€ /Qq). By Theorem 3.1, this basis also
allows us to obtain a basis of H 1
forms a basis of the Monsky-Washnitzer cohomology H 1
MW (Caï¬€ /Fq). One can also
prove this by the following upper bound on the denominators that appear during the
reduction process. This bound provides the precision necessary for our algorithm.
Before stating the main result of this subsection, we ï¬x some notations. For a
local parameter t at a point at inï¬nity Pâˆ, we write the Laurent series expansion
of x, y and xj yi with respect to t as following:

(3.4)

x =

âˆ

Xs=Ï…p(x)

Î´0,1
s

ts, y =

âˆ

Xs=Ï…p(y)

Î´1,0
s

ts and xjyi =

âˆ

Xs=Ï…p(xj yi)

Î´i,j
s

ts.

If a subscript is used to denote a local parameter at some point, we use this subscript
in the coeï¬ƒcients of the above expansion. For example, in Case 3, we write xjyi =
âˆ’ at Pâˆ,âˆ’. Recall that all the coeï¬ƒcents

s,âˆ’ ts

s,+ ts

Pâˆ
s Î´i,j
Î´i,j
s are in O in all cases that we are concerned, see Remark 3.3.

+ at Pâˆ,+ and xjyi =Pâˆ

s Î´i,j

Proposition 3.6. Write

(3.5)

xkyldx =

3

2

Xi=1

Xj=0

ai,jxjyidx + dS, where S =

3

Xi=0Xjâ‰¥0

bi,jxjyi

with ai,j and bi,j âˆˆ Qq, ai,j = 0 if xjyi is not in the basis in Proposition 3.5,
1 â‰¤ l â‰¤ 3 and k âˆˆ N. Then

(a) One can choose S with the property that bi,j = 0 if i âˆ’ l 6= 0 (mod 2).
(b) For any S in (3.5) which satisï¬es the property in (a), we have bi,jâˆ’i = 0
for all 0 â‰¤ i â‰¤ 3 and j â‰¥ k +5. Furthermore pmbi,jâˆ’i âˆˆ O for all 0 â‰¤ i â‰¤ 3
and j â‰¥ 7, where m = âŒŠlogp(4k + 8)âŒ‹.
(c) pm+âˆ†+1ai,j âˆˆ Zq, where âˆ† := 11(cid:0)âŒŠlogp(63)âŒ‹ + Ï„ (p)(cid:1) with Ï„ (3) = 5, Ï„ (5) =
3, Ï„ (p) = 1 for p = 7, 11, 13 and Ï„ (p) = 0 if p > 13.
Proof. (a) Using the automorphism y â†’ âˆ’y, or by a direct analysis on the
reduction process discussed in the previous subsection. (b) We prove this for Case 4,
proofs for other cases are all similar. From the expansions in Case 4, one obtains

(3.6)

xj yi =

âˆ

Xs=âˆ’(i+j)

Î´i,j
s,Âµ,Â±ts

Âµ,Â±

with Î´i,j
bi,j = 0 for all j > M . Hence

âˆ’(i+j),Âµ,Â± = (Â±Î±Âµ)i and Âµ = 1, 2. There is an integer M > 0 such that

bi,jxjyi =

3

M

Xi=0

Xjâ‰¥0

bi,jâˆ’iÎ´i,jâˆ’i

âˆ’j,Âµ,Â± +

S =

=

3

M

M+3

Xjâ‰¥0
Xi=0
ï£«
Xi=0
Xj=0
ï£­

3

âˆ

bi,j

Xs=âˆ’(i+j)
Xjâ€²>j   3
Xi=0

M+3

Î´i,j
s,Âµ,Â±ts

Âµ,Â±

bi,jâ€²âˆ’iÎ´i,jâ€²âˆ’i

âˆ’j,Âµ,Â±!ï£¶
ï£¸ tâˆ’j

Âµ,Â±

10

YIH-DAR SHIEH

Since Ï…pâˆ,Âµ,Â±(ai,j xjyidx) â‰¥ 7 and Ï…pâˆ,Âµ,Â±(xkyldx) â‰¥ âˆ’(k + 5) and the expansions
of xkyldx have integral coeï¬ƒcients, we have

(3.7)

3

j Â·ï£«
Xi=0
ï£­

bi,jâˆ’iÎ´i,jâˆ’i

âˆ’j,Âµ,Â± +

M+3

Xjâ€²>j   3
Xi=0

bi,jâ€²âˆ’iÎ´i,jâ€²âˆ’i

âˆ’j,Âµ,Â±!ï£¶

ï£¸ âˆˆ O

for all j â‰¥ 7 and it is zero if j â‰¥ k + 5. Combine (3.7) with the property in (a) and
the fact that Î±1 and Î±2 are units in O (Fact 3.3), we get
Xi=0

âˆ—ï£¶
ï£¸ âˆˆ O
for i = 0, 1, j â‰¥ 7 and Âµ = 1, 2, and it is zero if j â‰¥ k + 5. Since Î±2
here D = a2

j Â·ï£«
ï£­1 Â· bi,jâˆ’i + Î±2

Âµ Â· bi+2,jâˆ’iâˆ’2 +

2 = âˆšD,

1 âˆ’ Î±2

Xjâ€²>j

M+3

3

2 âˆ’ 4b4 6= 0, one obtains

(3.8)

j Â·ï£«
ï£­1 Â· bi,jâˆ’i + âˆšD Â· bi+2,jâˆ’iâˆ’2 +

M+3

3

Xjâ€²>j

Xi=0

âˆ—ï£¶
ï£¸ âˆˆ O

for i = 0, 1, j â‰¥ 7, and it is zero if j â‰¥ k + 5, here âˆ— involves only bi,jâ€²âˆ’i with jâ€² > j
and elements in O. Remember that âˆšD âˆˆ Oâˆ—. Apply j = M + 3 to (3.8), we
know that bi,M+3âˆ’i = 0 for all 0 â‰¤ i â‰¤ 3. Repeat the same argument, one shows
that bi,jâˆ’i = 0 for all 0 â‰¤ i â‰¤ 3 and j â‰¥ k + 5. Now apply j = k + 4 to (3.8),
we get pmbi,k+4âˆ’i âˆˆ O for all 0 â‰¤ i â‰¤ 3. Repeat the same argument and notice
that the terms âˆ— in (3.8) are in O in each step (since all the Î´â€¢,â€¢
and bi,jâ€²âˆ’i âˆˆ O if
jâ€² > j in each step),one proves that pmbi,jâˆ’i âˆˆ O for all 0 â‰¤ i â‰¤ 3 and j â‰¥ 7. So
pmbi,jâˆ’i âˆˆ O âˆ© Qq = Zq for all 0 â‰¤ i â‰¤ 3 and j â‰¥ 7.
(c) Consider

s

(3.9a)

(3.9b)

3

k+5

Ï‰ := pmï£«
ï£­xkyldx âˆ’ dï£«
Xi=0
ï£­
= pmï£«
Xi=1
ï£­

Xjâ‰¥7âˆ’i
ai,jxjyidx + dï£«
Xi=0
ï£­

bi,jxjyiï£¶
ï£¶
ï£¸
ï£¸
bi,jxjyiï£¶
Xj=0
ï£¸

Xj=0

6âˆ’i

3

2

3

ï£¶
ï£¸

From (b) and (3.9a), one knows that Ï‰ has integral coeï¬ƒcients, so we can choose
Ï•1(x, y) and Ïˆ1(x, y) in Zq[x, y] such that Ï‰ = Ïˆ1 dx + Ï•1 dy. On the other hand,
from (3.9b), one know that Ï‰ = Ïˆ2 dx + Ï•2 dy for some Ï•2 and Ïˆ2 in Qq[x, y] with
deg(Ï•2) â‰¤ 5, deg(Ïˆ2) â‰¤ 5. Consider
(3.10)

fy Ï‰ = fy (Ïˆi dx + Ï•i dy) = (Ïˆify âˆ’ Ï•ifx) dx
fx Ï‰ = fx (Ïˆi dx + Ï•i dy) = (Ï•ifx âˆ’ Ïˆify) dy
(using fx dx + fy dy = df = 0). Let Î»i(x, y) := Ïˆify âˆ’ Ï•ifx.
It is clear that
Î»1 âˆˆ Zq[x, y] and Î»2 âˆˆ Qq[x, y] with deg(Î»2) â‰¤ 8. Using the deï¬ning equation
f to reduce the degree of y in Î»i, we get fy Ï‰ = ËœÎ»i dx and fx Ï‰ = âˆ’ËœÎ»i dy with
ËœÎ»1 âˆˆ Zq[x, y], degy( ËœÎ»1) â‰¤ 3, ËœÎ»2 âˆˆ Qq[x, y], deg( ËœÎ»2) â‰¤ 8 and degy( ËœÎ»2) â‰¤ 3. Since
( ËœÎ»1 âˆ’ ËœÎ»2)dx = fy Ï‰ âˆ’ fy Ï‰ = 0 and degy( ËœÎ»1 âˆ’ ËœÎ»2) â‰¤ 3, we have ËœÎ»1 = ËœÎ»2. This
means that fy Ï‰ = ËœÎ» dx and fx Ï‰ = âˆ’ËœÎ» dy with ËœÎ» := ËœÎ»1 = ËœÎ»2 which is in Zq[x, y] of
deg(ËœÎ») â‰¤ 8. By Corollary 3.9, there exist Î± and Î² in Zq[x, y] with deg(Î±) â‰¤ 5 and

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

11

i=1P2

deg(Î²) â‰¤ 5 such that Î±fy + Î²fx = 1 in A. So Ï‰ = (Î±fy + Î²fx) Ï‰ = (Î±ËœÎ»)dxâˆ’ (Î²ËœÎ»)dy.
Notice that Ï‰ â‰¡ P3
j=0 pmai,j xjyidx, we can use the reduction of (Î±ËœÎ»)dx âˆ’
(Î²ËœÎ»)dy to get the denominators of pmai,j. Since deg(Î±ËœÎ») â‰¤ 13 and deg(Î²ËœÎ») â‰¤ 13,
we need only to know the denominators of the ï¬nal reductions of xjyidx and xjyidy
with 0 â‰¤ i + j â‰¤ 13. Using xjyidy â‰¡ âˆ’j/(i + 1)xjâˆ’1yi+1dx, the deï¬ning equation
f , and xjdx â‰¡ 0, we only need to consider the reductions of xj yidx with 1 â‰¤ i â‰¤ 3
and i + j â‰¤ 13, but if p = 3, the extra denominator 3 should be counted.
The reduction of xkyldx (1 â‰¤ l â‰¤ 3) using the reduction matrices Mi,j in
subsection 3.2 involve divisions by some of the following: 12(k + 2)b4, (12k + 21)b3,
(k + 3)(a2
2 âˆ’ 4b4),
384(k + 2)(k + 3)(k + 4)(2k + 7)b3
3a2
2,
âˆ’(4k + 7)(4k + 11)(4k + 13)(4k + 15)b3
3, depending on each case, and the numbers
2, a2, b4, b3, a2
2 âˆ’ 4b4 and a1a2 âˆ’ 2b3 that we need to consider (depending on each
case) are units of Zq. So in each step, we get extra denominators which are at most

2 âˆ’ 4b4), (2k + 5)(a1a2 âˆ’ 2b3), 384(k + 1)(k + 2)(k + 3)(k + 4)b3

4(a1a2 âˆ’ 2b3), 2(k + 4)(2k + 5)(4k + 3)(4k + 7)b2

4(a2

pâŒŠlogp(4j+15)âŒ‹+Ï„ (p),

here Ï„ (3) = 5, Ï„ (5) = 3, Ï„ (p) = 1 for p = 7, 1, 13 and Ï„ (p) = 0 if p > 13. Since
we are concerned with 2 â‰¤ j â‰¤ 12, we need at most 11 reduction steps, so the
denominators of the reductions of xjyidx with 1 â‰¤ i â‰¤ 3 and i + j â‰¤ 13 are at most

p11Â·(âŒŠlogp(63)âŒ‹+Ï„ (p)).

Hence pm+âˆ†+1ai,j âˆˆ Zq.

(cid:3)

Remark 3.7. Proposition 3.6 gives an upper bound for the denominators after
a diï¬€erential form (with integral coeï¬ƒcients) is reduced to the linear combination
of the basis we found in Propsition 3.5. Along with the rate of convergence of
the Frobenius Fp (see Corollary 4.3), one can determine how much p-adic precision
we need to work with (and determine an integer N3 such that one can work with
modulo xN3), see Section 6. But one needs an upper bound for all the denominators
that will appear during the computation (in the reduction step) in order to know
how much precision of the reduction matrices Mi,j are required and to have an
analysis of the bit complexity.
It turns out that one has a similar bound as in
Proposition 3.6. The proof is completely similar.

Theorem 3.8. Let R be a ï¬eld or a discrete valuation ring and m be the

maximal ideal of R. Let f0, . . . , fn âˆˆ R[x1, . . . , xn] with degfi = di and deï¬ne

Ï = d0 + . . . + dn âˆ’ n âˆ’ 1.

Denote the homogenization of fi by f h
i
point in Pn(R/m) satisï¬es f h
g0, . . . , gn âˆˆ R[x1, . . . , xn] with deg gi â‰¤ Ï + 1 âˆ’ di for i = 0, . . . , n such that

for i = 0, . . . , n. Assume that there is no
n = 0. Then there exist polynomials

1 = . . . = f h

0 = f h

n

gifi = 1.

Xi=0

Proof. This appears as Theorem 2 in Denef-Vercauteren [2].

(cid:3)

Corollary 3.9. There exist Î± and Î² in Zq[x, y] with deg(Î±) â‰¤ 5 and deg(Î²) â‰¤
5 such that Î±fy + Î²fx = 1 in A. Furthermore, one can ï¬nd such Î± and Î² such that
Î± has only odd degrees in y and Î² has only even degrees in y.

12

YIH-DAR SHIEH

Proof. Apply 3.8 to R = Zq, f0 = f , f1 = fy and f2 = fx.
Apply 3.8 to R = Zq, f0 = f , f1 = fy and f2 = fx. If Î± and Î² donâ€™t satisfy
the last property, consider the equality Î±(x,âˆ’y)fy(x,âˆ’y) + Î²(x,âˆ’y)fx(x,âˆ’y) = 1
in A. From (3.1), it is clear that fy(x,âˆ’y) = âˆ’fy(x, y) and fx(x,âˆ’y) = fx(x, y).
We thus have

(cid:18) Î±(x, y) âˆ’ Î±(x,âˆ’y)

2

(cid:19) fy +(cid:18) Î²(x, y) + Î²(x,âˆ’y)

2

(cid:19) fx = 1,

which completes the proof.

(cid:3)

4. Lift of Frobenius

In this section, we describe a lift Fp of the absolute Frobeninus endomorphism
F p : a â†’ ap on the coordinate ring A of C aï¬€ to Aâ€ . This means that Fp is a Zp-
algebra endomorphism on Aâ€  such that Ï€ â—¦ Fp = F p â—¦ Ï€, where Ï€ is the reduction
modulo p. The lift Fq of the q-th Frobenius endomorphism of A is F n
p , hence one
can work with Fp for the purpose of computation.

Denote by Ïƒ the p-th power Frobenius endomorphism on Fp and also its lift on

Zp. Any lift Fp satisï¬es

Fp(x) â‰¡ xp mod p, Fp(y) â‰¡ yp mod p, Fp(f (x, y)) = 0.

From Corollary 3.9, we know that there exist Î± and Î² in Zq[x, y] such that Î±fy+ Î²fx =
1. Deï¬ne Î´y := Î±p, Î´x := Î²p and consider the equation

G(Z) := Fp(f (x, y)) = f Ïƒ(xp + Î´xZ, yp + Î´yZ) = 0

(4.1)
in Aâ€ [Z]. Then G(0) = f Ïƒ(xp, yp) â‰¡ f Ïƒ(xÏƒ, yÏƒ) = 0 mod p. Also Gâ€²(0) =
f Ïƒ
y (xp, yp)Î´y + f Ïƒ
y Î±p +
x Î²p = (fyÎ± + fxÎ²)p = 1 mod p. Hence by Henselâ€™s lemma, there is a unique so-
f p
lution of (4.1) in Aâˆ. Use the following proposition and its corollary, this solution
is in fact in Aâ€ . In fact, Corollary 4.3 below gives an explicit lower bound on the
rate of convergence, which allows us (together with Proposition 3.5) to work with
a ï¬nite and explicit p-adic precision.

x (xÏƒ, yÏƒ)Î´x â‰¡ f p

y Î´y + f p

x Î´x = f p

x (xp, yp)Î´x â‰¡ f Ïƒ

y (xÏƒ, yÏƒ)Î´y + f Ïƒ

Lemma 4.1. Let H(Z) = P hk(x)Z k âˆˆ Zq[x][Z] and âˆ†1,k = dk := deg(hk).
Assume h0(x) â‰¡ 0 mod p and h1(x) â‰¡ 1 mod p. Let 0 â‰¤ âˆ†n,0 â‰¤ âˆ†n,1 â‰¤ Â·Â·Â· â‰¤
âˆ†n,j â‰¤ Â·Â·Â· (n â‰¥ 1, j â‰¥ 0) with Î´j = âˆ†1,j be integers stastiï¬es the following
conditions:

1. âˆ†n+1,j â‰¥ max{âˆ†n,jâˆ’l + Î´l | 0 â‰¤ l â‰¤ j} for all n â‰¥ 0, j â‰¥ 0.
2. Î´0 â‰¥ d0.
3. Î´j âˆ’ Î´jâˆ’1 â‰¥ d1 for all j â‰¥ 1.
4. Î´kâˆ’1+j â‰¥ âˆ†k,j + dk for all k â‰¥ 2, j â‰¥ 0.
Then the unique solution Î± = Pâˆ
2 if i â‰¥ Î´j + 1. One can always ï¬nd such âˆ†n,j.
Proof. Let T := {Pâˆ
i=0 aixi âˆˆ Zqhxi | vp(ai) â‰¥ j + 2 if i â‰¥ Î´j + 1} be a subset
of Zqhxi, here âˆ’1 = Î´âˆ’1 < 0 â‰¤ Î´0 â‰¤ Î´1 â‰¤ Â·Â·Â· â‰¤ Î´j â‰¤ Â·Â·Â· are integers which we will
determine for which T satisï¬es some properties that are used in the proof. For each
n, one can write T n = {Pâˆ
i=0 aixi âˆˆ Zqhxi | vp(ai) â‰¥ n + j + 1 if i â‰¥ âˆ†n,j + 1} for
some âˆ’1 = âˆ†n,âˆ’1 < 0 â‰¤ âˆ†n,0 â‰¤ âˆ†n,1 â‰¤ Â·Â·Â· â‰¤ âˆ†n,j â‰¤ Â·Â·Â· . A suï¬ƒcient condition

i=0 aixi âˆˆ Zqhxi has the property: vp(ai) â‰¥ j +

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

13

for T n âŠ‚ T is âˆ†n+1,j â‰¥ max{âˆ†n,jâˆ’l + Î´l | 0 â‰¤ l â‰¤ j} for all n. Notice that T is
closed under addition. In Zqhxi, we can use Newton method:

Î±i+1 = Î±i âˆ’

H(Î±i)
H â€²(Î±i)

= Î±i âˆ’ H(Î±i) 1 +

(1 âˆ’ H â€²(Î±i))k! .

âˆ

Xk=1

k=2 hk(x)Î±k

Our goal is to determine a condition on Î´j for which the result in each iteration
above is in T . We use induction: assume Î±i âˆˆ T and to prove Î±i+1 âˆˆ T . It is
suï¬ƒcient to show: H(Î±i) âˆˆ T and (1 âˆ’ H â€²(Î±i)) T âŠ‚ T . H(Î±i) = h0(x) + h1(x)Î±i +
Pâˆ
i . Since vp(h0(x)) â‰¥ 1, h0(x) âˆˆ T if d0 â‰¤ Î´0. Since h1(x)Î±i =
Î±iâˆ’ (1 âˆ’ h1(x)) Î±i, Î±i âˆˆ T and vp (1 âˆ’ h1(x)) â‰¥ 1, h1(x)Î±i âˆˆ T if Î´j âˆ’ Î´jâˆ’1 â‰¥ d1 for
all j â‰¥ 1. Similarly for k â‰¥ 2, since Î±k
i âˆˆ T k, hk(x)Î±k
i âˆˆ T if âˆ†k,j + dk â‰¤ Î´kâˆ’1+j.
In fact, the above conditions imply (1 âˆ’ h1(x)) T âŠ‚ T and hk(x)T k âŠ‚ T . Using
this fact with (1 âˆ’ H â€²(Î±i)) T = (cid:0)(1 âˆ’ h1(x)) +Pâˆ
(cid:1) T and Î±kâˆ’1
âˆˆ
T kâˆ’1, we know (1 âˆ’ H â€²(Î±i)) T âŠ‚ T . Hence Î±i+1 âˆˆ T and this implies the solution
Î± âˆˆ T .
For the existence âˆ†n,j, notice that the conditions 2, 3 and 4 are equivalent
to: âˆ†1,n+1 â‰¥ max{âˆ†1,n + d1, âˆ†k,n+2âˆ’k + dk | 2 â‰¤ k â‰¤ n + 2} for all n â‰¥ 0.
Suppose one has determined âˆ†nâ€²,jâ€² for all nâ€² + jâ€² â‰¤ n + 1. Use condition 1, one can
determine âˆ†k,n+2âˆ’k for all 2 â‰¤ k â‰¤ n + 2 (i.e for âˆ†nâ€²,jâ€² with nâ€² + jâ€² â‰¤ n + 2 and
nâ€² â‰¥ 2). Finally, one determines âˆ†1,n+1. Therefore, one determines all the âˆ†nâ€²,jâ€²
with nâ€² + jâ€² â‰¤ n + 2. This shows that one can ï¬nd âˆ†n,j recursively.

k=2 âˆ’khk(x)Î±kâˆ’1

(cid:3)

i

i

Lemma 4.2. Suppose deg(hk(x)) â‰¤ (k + 1) d in Lemma 4.1. Then âˆ†i,j :=
(i + 4j) d satisfy the conditions in Lemma 4.1 and all the inequalities are equalities.
In particular, Î´j = (4j + 1) d.

Proof. This follows by induction in i and j.

(cid:3)

Corollary 4.3. There exists a lift Fp of the absolute Frobeninus endomor-
phism a â†’ ap on the coordinate ring A of Caï¬€ to Aâ€  such that Fp(x) = xp + Î´xZ0
and Fp(y) = yp + Î´yZ0 with Z0 = Pi,j ai,jxjyi, ai,j âˆˆ Zq and ordp(ai,j) > i+j
16p .
Also the coeï¬ƒcient of xjyi in Fp(y) and Fp(x) has p-adic order > i+j
16p if i + j 6= p.
Finally, Fp(xkyldx) =P3
16p âˆ’ 4.

i=1Pj bi,jxj yidx with ordp(bi,j) > i+j

Proof. Using Corollary 3.9 and equation (4.1), one can apply d = 4p to
(cid:3)

Lemma 4.2.

Theorem 4.4. There exists a lift of Frobenius Fp on Aâ€  which commutes with

the involution Ï„ : y â†’ âˆ’y and has the rate of convergence in Corollary 4.3.

Proof. We choose Î± and Î² such that Î± has only odd degrees in y and Î² has
only even degrees in y as in Corollary 3.9. Since Î´y = Î±p and Î´x = Î²p, they have
the same property as Î± and Î². For solving G(Z) = 0 by Newtonâ€™s method, we use
Lemma 4.1 with H = G = f Ïƒ(xp + Î´xZ, yp + Î´yZ). It is clear that G has only even
degrees in y, hence so does the solution Z0. From this, it is clear that the lift of
Frobenius Fp : Aâ€  â†’ Aâ€  commutes with the involution Ï„ .
(cid:3)

5. Quotient by Automorphism

We have study H 1

MW (Caï¬€ /Fq). In this section, we consider the quotient of C
by the automorphism Ï„ : Y â†’ âˆ’Y . We denote the quotient map by Ï€ : C â†’ E :=

14

YIH-DAR SHIEH

ËœÏ€

C/hÏ„i. One can show that C/hÏ„i has genus 1 either by Riemann-Hurwitz genus
formula or from the aï¬ƒne equation directly, using the fact that Caï¬€ is stable under
Ï„ and Caï¬€ /hÏ„i is smooth, hence the notation E is justiï¬ed. The aï¬ƒne part Eaï¬€ of
E is Caï¬€ /hÏ„i, which has the deï¬ning equation: v2 + g(u)v + h(u) = 0. We have
Ï€âˆ’â†’ Eaï¬€ , (x, y) â†’ (x, y2), and the corresponding map on the coordinate ring is
Caï¬€
Ï€âˆ— : u â†’ x, v â†’ y2.
MW (Eaï¬€ /Fq), the induced map Ï€âˆ— :
Our goal is to study the followings: H 1
H i
MW (Eaï¬€ /Fq) â†’ H i
MW (Caï¬€ /Fq) and its interplay with Frobenius endomorphism.
âˆ’â†’ ËœEaï¬€ , (x, y) â†’ (x, y2) lifts Ï€, here ËœEaï¬€ is the lift of Eaï¬€ , whose deï¬ning
Since ËœCaï¬€
equation is v2 + g(u)v + h(u) = 0, we can study H i
MW (Caï¬€ /Fq)
dR( ËœCaï¬€,Î¾/Qq). For i 6= 1, these are isomorphisms. For
by H i
i = 1, since {ËœÏ€âˆ—(ujvdu) = xj y2dx} | 0 â‰¤ j â‰¤ 1 (resp. 0 â‰¤ j â‰¤ 2)} are linear
in Case 2 and Case 4), one sees that
independent in Case 1 and Case 3 (resp.
{ujvdu | 0 â‰¤ j â‰¤ 1 (resp. 0 â‰¤ j â‰¤ 2)} are linear independent. Let Î´E be the
number of points at inï¬nity of E. We have Î´E = 1, 2, 1, 2 in each case, hence
dR( ËœEaï¬€,Î¾/Qq) = 2Â·gE âˆ’ 1 + Î´E = 2, 3, 2, 3. This shows that {ujvdu | 0 â‰¤ j â‰¤
dimZq H 1
dR( ËœEaï¬€,Î¾/Qq) which is isomorphic via ËœÏ€âˆ— to the
1 (resp. 0 â‰¤ j â‰¤ 2)} is the basis of H 1
dR( ËœCaï¬€,Î¾/Qq) generated by {xjy2dx | 0 â‰¤ j â‰¤ 1 (resp. 0 â‰¤ j â‰¤ 2)}.
subsapce V of H 1
E of the Frobenius endomorphism
F q,E on the coordinate ring AE of E. The left diagram below is not necessary
commutative, but its reduction mod p is commutative

As in Section 4, there is a lift Fq,E : Aâ€ 

dR( ËœEaï¬€,Î¾/Qq) ËœÏ€âˆ—

MW (Eaï¬€ /Fq) Ï€âˆ—

E â†’ Aâ€ 

âˆ’â†’ H i

âˆ’â†’ H i

ËœÏ€âˆ—

Aâ€ 

Aâ€ 
E

A

Ï€âˆ—

AE

Fq

Fq,E

F q

F q,E

Aâ€ 

Aâ€ 
E

ËœÏ€âˆ—

A

AE

Ï€âˆ—

ËœÏ€âˆ—

E is the natural lift of homomorphism A ËœÏ€âˆ—

Here Aâ€ 
â†âˆ’âˆ’ AE on the coordinate
rings which corresponds to the morphism ËœÏ€ : ËœCaï¬€,Î¾/Qq â†’ ËœEaï¬€,Î¾/Qq, so the reduc-
tion of Aâ€ 
E modulo p is just the natural homomorphism on the coordinate
rings of Caï¬€

â†âˆ’âˆ’ Aâ€ 
â†âˆ’âˆ’ Aâ€ 
Ï€âˆ’â†’ Eaï¬€ . Since F q â—¦ Ï€âˆ— = Ï€âˆ— â—¦ F q,E, we know that
MW (Eaï¬€ /Fq)

MW (Caï¬€ /Fq)

H i

H i

ËœÏ€âˆ—

Ï€âˆ—

Fq,âˆ—

Fq,E,âˆ—

H i

MW (Caï¬€ /Fq)

Ï€âˆ—

H i

MW (Eaï¬€ /Fq)

So the point counting on Eaï¬€ is the same as computing on the subsapce of H 1
generated by {xjy2dx | 0 â‰¤ j â‰¤ 1 (resp. 0 â‰¤ j â‰¤ 2)}.

From Lefschetz ï¬xed point formula (Theorem 2.3), we have
q,âˆ— )r|H 1
q,âˆ— )r|H 1

#Caï¬€ (Fqr ) = Tr(cid:0)(qF âˆ’1
#Eaï¬€ (Fqr ) = Tr(cid:0)(qF âˆ’1

MW (Caï¬€ )(cid:1) âˆ’ Tr(cid:0)(qF âˆ’1
MW (Eaï¬€ )(cid:1) âˆ’ Tr(cid:0)(qF âˆ’1

q,âˆ— )r|H 0
q,âˆ— )r|H 0

MW (Caï¬€ )(cid:1)
MW (Eaï¬€ )(cid:1)

MW (Caï¬€ /Fq)





o
o
o
o




o
o
o
o




o
o
o
o
POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

15

1 + Î²r
Let PE(X) = (X âˆ’ Î²1)(X âˆ’ Î²2) be the Weil polynomial of E and Sr(E) := Î²r
2.
Then #Eaï¬€ (Fqr ) = qr + 1âˆ’ Sr(E)âˆ’ Î´E, here Î´E is the number of points at inï¬nity
of E. Use #Caï¬€ (Fqr ) = #C(Fqr ) âˆ’ Î´C , we get

#C(Fqr ) = qr + 1 âˆ’ Sr(E) âˆ’ Tr(cid:0)(qF âˆ’1

q,âˆ— )r|V(cid:1) + (Î´C âˆ’ Î´E),

MW (Caï¬€ /Fq) generated by {xjy2dx | 0 â‰¤ j â‰¤ 1 (resp. 0 â‰¤
here V is the subsapce of H 1
j â‰¤ 2)}, whose dimension is 4+Î´Câˆ’Î´E. This implies that the Weil polynomial P (X)
of C/Fq equals to PE(X)QV (X)(X âˆ’ 1)âˆ’(Î´C âˆ’Î´E ), here QV (X) is the characteristic
polynomial of qF âˆ’1
q,âˆ— acts on V . The characteristic polynomial PV (X) of Fq,âˆ— =
q Â· (qF âˆ’1

q,âˆ— )âˆ’1 is QV (X)(X âˆ’ q)Î´C âˆ’Î´E (X âˆ’ 1)âˆ’(Î´C âˆ’Î´E ), so

P (X) = PE(X)PV (X)(X âˆ’ q)âˆ’(Î´C âˆ’Î´E ).

Summary 5.1. The Weil polynomial P (X) of C/Fq is equal to

PE(X)PV (X)(X âˆ’ q)âˆ’(Î´C âˆ’Î´E ),

where PE(X) is the Weil polynomial of E/Fq and PV (X) is the characteristic
polynomial of Fq,âˆ— on V .

6. The Algorithm

In order to compute PV (X), one needs to compute PV (X) with a precision
N1 = âŒŠlogp30+2nâŒ‹+1 with n = logpq, which is determined by the Weil bound. Due
to the fact that the matrix Mp of the Frobenius action Fp,âˆ— may have denominators,
we need Mp with a precision N2 := N1 + (6n âˆ’ 1)c with c = âŒŠc1 + logp(c1 +
logp(2c1))âŒ‹ + 1 and c1 = 6 + logp80 + âˆ†. From this, we only need to compute (for
1 â‰¤ l â‰¤ 3 and 0 â‰¤ k â‰¤ 2) Z0, Fp(x), Fp(y) and Fp(ylxkdx) modulo (xN3 , pN4)
with N3 = âŒŠ16p(c2 + logp(2c2))âŒ‹ + 1, N4 = âŒŠN2 + c1 + logp(c2 + logp(2c2))âŒ‹ + 1
and c2 = 6 + logp80 + âˆ† + N2. Finally, the above discussion is based on the
reduction matrices Mi,k (1 â‰¤ i â‰¤ 3) introduced in 3.2. But since one can only
work with an approximation of Mi,k, one need Mi,k modulo pN5 with a slightly
higher precision N5 = N4 + 8âŒŠlogpN3âŒ‹ + 14 . We have N3 = O(pn), N4 = O(n) and
N5 = O(n). We work in Zq/pN5 3, whose elements can be stored in O(n2logp) space
and the arithmetic on it could be done in ËœO(n2logp) bit operations. This gives the
algorithm:

Algorithm

Step 1. Compute Î± and Î² in Corollary 3.9 modulo p.4
Step 2. Compute Z0 in Corollary 4.3 using Newtonâ€™s method, then Fp(xkyldx)

for l = 1, 3 and 0 â‰¤ k â‰¤ 2, all of them are modulo (xN3 , pN4).5
Step 3. Use reduction matrices Mi,j (1 â‰¤ i â‰¤ 3, 2 â‰¤ j â‰¤ N3) to reduce
Fp(xkyldx) and get Mp.
Step 4. Compute Mq = MpM Ïƒ
Step 5. Finally, compute the characteristic polynomial PV (X) modulo P N1.

p Â·Â·Â· M Ïƒnâˆ’1

by repeated squaring.

p

3More precisely, with p-adic precsion N4 but with denominators at most p(N5âˆ’N4).
4In Corollary 3.9, we only need Î±fy + Î²fx â‰¡ 1 modulo p in order to compute the lift of

Frobenius.

5In the proof of Lemma 4.1, we showed that the results during the Newtonâ€™s iteration all
have the same rate of convergence as in Corollary 4.3, so we can work modulo xN3 during the
Newtonâ€™s iteration.

16

YIH-DAR SHIEH

Theorem 6.1. The above algorithm requires ËœO(n3p) bit operations.

Proof. Step 1 consists of solving a system of linear equations over Fq of size
at most 16. Hence it requires ËœO(n2 log p) bit operations. Step 2 requires O(log N4)
Newtonâ€™s iterations, and each iteration requires ËœO(N3n2log p) bit operations. Hence
this step requires ËœO(pn3) bit operations. Step 3 requires O(N3) operations in
Zq/pN5, hence ËœO(pn3) bit operations. Step 4 requires O(log n) squarings and the
application of the lift of the p-th power Frobenius Ïƒ : Zq â†’ Zq modulo pN4 on
matrices of size 6 Ã— 6. Squaring requires ËœO(n2log p) bit operations. For Ïƒ, we use
Newtonâ€™s method which needs to evaluate a polynomial of degree n with coeï¬ƒ-
cients in Zq/pN4, which requires O(n) ËœO(n2 log p) bit operations. Hence we need
ËœO(n3 log p) bit operations in this step. Step 5 requires ËœO(n2 log p) bit operations.
Hence the algorithm requires ËœO(n3p) bit operations.
(cid:3)

If one works directly on H 1

MW (Caï¬€ ) and denote the precision needed by N â€²

3 N â€²

5 . (It is 4

5 instead of 2

i . Also the matrix Mp is of size 6Ã—6 and M â€²

i , then
Ni â‰ˆ 2
p is of size 9Ã—9. From these, we
give a comparison of speed. Step 2 is reduced by a factor of ( 2
3 )2 â‰ˆ 0.45. In Step 3,
we have 6 diï¬€erential forms Fp(xkyldx), l = 1, 3 and 0 â‰¤ k â‰¤ 2, to reduce. This
contributes a factor of 4
3 because the reductions of Fp(xky2dx)
involve fewer operations than the reductions of Fp(xky1dx) and Fp(xky3dx). See
the reduction matrices in 3.2.) Since each of these Fp(xkyldx) is computed modulo
(xN3, pN4) in Step 2, we work with smaller powers on x and fewer p-adic precision
in Step 3. This means that we have fewer reduction steps and the basic arithmetic
operations are faster, which contribute a factor of ( 2
3 )2. So Step 3 is reduced by a
factor of 4
3 )3 â‰ˆ 0.3, due
to the smaller size of Mp and fewer precision.

3 )2 â‰ˆ 0.36. Step 4 is reduced by a factor at least of ( 2

5 Â· ( 2

References

[1] Castryck, W., Point counting on nondegenerate curves. Katholieke Universiteit Leuven, The-

sis, 135 pp. (2006). Avaiable at: http://wis.kuleuven.be/algebra/castryck/thesis.pdf

[2] Denef, J.; Vercauteren, F., Counting Points on Cab Curves using Monsky-Washnitzer Coho-

mology. Finite Fields and Their Applications, Volume 12, Issue 1, pp. 78-102 (2006)

[3] Elkik, R., Solutions dâ€™Â´equations `a coeï¬ƒcients dans un anneau hensÂ´elien. Ann. Sci. Â´Ecole

Norm. Sup. (4), 6:553-603 (1973)

[4] Gaudry, P.; GÂ¨urel, N., An extension of Kedlayaâ€™s algorithm to superelliptic curves. Proc.

Asiacrypt 2001, Springer, Berlin, Lecture Notes in Comput. Sic., 2248: 480-494 (2001)

[5] Kedlaya, K., Counting Points on Hyperelliptic Curves using Monsky-Washnitzer Cohomol-

ogy. J. Ramanujan Math. Soc. (4), 16: 323-338 (2001)

[6] Kedlaya, K., Computing zeta functions via p-adic cohomology. Proc. ANTS-VI, Springer

LNCS, 3076: 1-17 (2004)

[7] Monsky, P.; Washnitzer, G., Formal cohomology I. Ann. Math. (2), 88: 181-217 (1968)
[8] Monsky, P., Formal cohomology II: The cohomology sequence of a pair. Ann. Math. (2), 88:

218-238 (1968)

[9] Monsky, P., Formal cohomology III: Fixed point theorems. Ann. Math. (2), 93: 315-343 (1971)
[10] van Der Put, M., The cohomology of Monsky and Washnitzer. MÂ´em. Soc. Math. France

(N.S.) (4): 23:33-59 (1986)

[11] Vermeulen, A.M., Weierstrass pointss of weight two on curves of genus three. Amsterdam

University Thesis, 1983.

POINT COUNTING ON GENUS 3 CURVES WITH AUTOMORPHISM GROUP Z/2Z

17

Aix Marseille UniversitÂ´e, CNRS, Centrale Marseille, I2M, UMR 7373, 13453 Mar-

seille, France

Current address:

Institut de MathÂ´ematiques de Marseille (I2M)
163 avenue de Luminy, Case 907
13288 Marseille, cedex 9
France

E-mail address: chiapas@gmail.com

