6
1
0
2

 
r
a

 

M
4
1

 
 
]

.

G
A
h
t
a
m

[
 
 

1
v
1
1
4
4
0

.

3
0
6
1
:
v
i
X
r
a

Generalized automorphic sheaves and the proportionality principle

of Hirzebruch-Mumford

Mathematisches Institut, Albert-Ludwigs-UniversitÂ¨at Freiburg

Fritz HÂ¨ormann

March 2016

2010 Mathematics Subject Classiï¬cation: 14J15, 11F55, 14G35

Keywords: Automorphic vector bundles, modular forms, generalized automorphic sheaves, cusp forms, Jacobi forms,

Fourier-Jacobi categories, toroidal compactiï¬cations of mixed Shimura varieties, Chern classes, Hirzebruch-Mumford

proportionality

Abstract

We axiomatize the algebraic structure of toroidal compactiï¬cations of Shimura varieties and their
automorphic vector bundles. We propose a notion of generalized automorphic sheaf which includes
the sheaves of sections of automorphic vector bundles with all kinds of prescribed vanishing orders
along strata in the compactiï¬cation, their quotients, as well as e.g. Jacobi forms, and almost
holomorphic modular forms. Using this machinery we give a short and purely algebraic proof of
the proportionality theorem of Hirzebruch and Mumford. The main motivation was however to
create a theory which can be applied to other compactiï¬ed moduli spaces to be able to investigate
â€œmodular formsâ€ on them and their â€œFourier-Jacobi expansionsâ€ purely algebraically.

Notation
We write [n] for the unordered set {1, . . . , n} and âˆ†n for the poset {1â‰¤ 2 â‹… â‹… â‹… â‰¤ n} also regarded as a
category. For a scheme, formal scheme, or stack X we write [ X-Coh ] (or sometimes [ OX-Coh ])
for the category of coherent sheaves on X and [ X-Qcoh ] for the category of quasi-coherent

sheaves. For an algebraic group G we denote by g its Lie algebra.

Contents

1 Introduction

2

2 Toroidal compactiï¬cations

5
5
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1 Formally toroidal schemes
2.2 Modules and diï¬€erentials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7
2.3 Abstract toroidal compactiï¬cations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.4 Toroidal compactiï¬cations of (mixed) Shimura varieties . . . . . . . . . . . . . . . . . . 12

1

3 Automorphic data

12
3.1 Automorphic data on an abstract toroidal compactiï¬cation . . . . . . . . . . . . . . . 12
3.2 Generalized ï¬‚ag varieties and representations of quasi-parabolic subgroups . . . . . . 15
3.3
Jet bundles on generalized ï¬‚ag varieties . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
3.4 Fourier-Jacobi categories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
3.5
Jet bundles in the Fourier-Jacobi categories . . . . . . . . . . . . . . . . . . . . . . . . . 23
. . . . 25
3.6 Automorphic data on toroidal compactiï¬cations of (mixed) Shimura varieties

4 Hirzebruch-Mumford proportionality

27
4.1 Chern classes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
4.2 Proportionality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

1

Introduction

This article was motivated by the search for an axiomatization of the algebraic structure of toroidal
compactiï¬cations of Shimura varieties and their automorphic vector bundles, which might also be
applied to other moduli spaces (which, for instance, carry certain families of Calabi-Yau threefolds)
to study â€œmodular formsâ€ on them and their â€œFourier expansionsâ€ and â€œFourier-Jacobi expansionsâ€
purely algebraically. While this is the content of work in progress, this article focuses on the axiom-
atization, and explains that the axioms ï¬t the situation for toroidal compactiï¬cations of Shimura
varieties. To show that the language is suï¬ƒciently powerful we distill a few simple axioms that
imply the famous proportionality theorem of of Hirzebruch [6] and Mumford [12], thus providing a
purely algebraic proof thereof.
We now describe the axiomatization more in detail. All varieties and formal schemes are understood
over a ï¬eld k of characteristic zero. We deï¬ne a formally toroidal scheme (Deï¬nition 2.1.3) to be
a formal scheme together with an action of Mn
m, where Mm is the multiplicative monoid on the
aï¬ƒne line, which looks like the completion of a (partially) compactiï¬ed Gn
m-torsor on a variety
along a boundary stratum. An abstract toroidal compactiï¬cation (Deï¬nition 2.3.2) is deï¬ned as a
smooth variety M with a divisor of strict normal crossings D such that the completions along all
strata (of the stratiï¬cation deï¬ned by D) carry the structure of a formally toroidal scheme in a
compatible way w.r.t. the partial ordering of the strata. In Section 2.4 we explain that toroidal
compactiï¬cations of mixed Shimura varieties in the sense of Pink [13] indeed give rise to such
objects.
Moreover, we introduce the notion of automorphic data (Deï¬nition 3.1.1) on an abstract toroidal
compactiï¬cation. If D = âˆ… this is just the datum of a â€œcompact dualâ€ M âˆ¨ and a â€œperiod torsorâ€
B equipped with morphisms

Ï€o

M

B

p

/ M âˆ¨

where Ï€ âˆ¶ B â†’ M is a right-torsor under a reductive group PM and M âˆ¨ a component of the moduli
space of parabolics of PM (a ï¬‚ag variety). The morphism p is PM -equivariant.
This situation is well-known in the theory of Shimura varieties. In this case B is called the standard
principal bundle and is (philosophically) the bundle of trivializations of the de Rham realization
of the universal motive (associated with a representation Ï of the deï¬ning group PM ) together
with its natural PM -structure. The morphism p in this case is induced by the Hodge ï¬ltration.
If M âˆ¨

The diagram can also be seen as a morphism Î âˆ¶ M â†’ [M âˆ¨~PM] to the quotient stack.
contains a k-rational point then the quotient stack is isomorphic to the classifying stack [â‹…~QM] of

a parabolic QM âŠ‚ PM . Therefore the datum is essentially the same as a QM -torsor over M . This

2

o
/
allows to deï¬ne a vector bundle Îâˆ—E on M associated with any representation E of QM (or with a

PM -equivariant vector bundle on M âˆ¨). These are called automorphic vector bundles.
This situation generalizes to the case in which D is non-trivial.
consist of the following: for any stratum Y a diagram

In this case automorphic data

CY(M)

Ï€o

BY

p

/ M âˆ¨
Y

where CY means formal completion along Y , and Ï€ âˆ¶ BY â†’ CY(M) is again a right-torsor under

a â€” now arbitrary â€” linear algebraic group PM and M âˆ¨ is a component of the moduli space of
quasi-parabolics of PM . The morphism p is again PM -equivariant. Furthermore the action of MnY
m
lifts to BY (the lifted action is part of the datum) such that p becomes invariant. For any two
strata Z â‰¤ Y we suppose given an open embedding M âˆ¨
Y and a morphism BZ â†’ BY both
equivariant for a given homomorphism PZ â†’ PY .
Such a datum is present on toroidal compactiï¬cations of Shimura varieties. This is probably
less well-known, and was ï¬rst described in this form in [7] (cf. [8, 2.5]). It exists (philosophically)
because the PM -structure of the de Rham realization of the universal motive becomes a PY -structure
near the boundary stratum Y (in the formal sense) because of a natural weight ï¬ltration on the
realization there, leading to a family of mixed Hodge structures.
The more general situation of an (abstract) toroidal compactiï¬cation equipped with automorphic
data allows one to deï¬ne generalized automorphic sheaves (Deï¬nition 3.4.3) on M . In the situation
of toroidal compactiï¬cations of (mixed) Shimura varieties these include for instance:

Z â†ª M âˆ¨

â€¢ sheaves of sections of automorphic vector bundles with certain vanishing conditions along the

boundary (e.g. bundles of cusp forms, subcanonical extensions, etc.),

â€¢ the structure sheaf OD of the boundary or the structure sheaf OY of a closed stratum thereof,

â€¢ bundles of Jacobi-forms,

â€¢ bundles â„¦i(M) and jet bundles of automorphic vector bundles,

â€¢ bundles of â€œalmost holomorphicâ€ modular forms.

To deï¬ne generalized automorphic sheaves, the category of PM -equivariant vector bundles on M âˆ¨ is
not suï¬ƒcient as input category. For this purpose, we deï¬ne an Abelian category, the Fourier-Jacobi
category (Deï¬nition 3.4.1). The objects are speciï¬ed by a collection of functors

FY âˆ¶ ZnY â†’[ [M âˆ¨

Y~PY]-Coh ]

namely they should be left Kan extensions of functors deï¬ned on some bounded subregion of ZnY .

for each stratum Y , where nY = codim(Y). These are supposed to fulï¬ll a ï¬niteness condition,
In particular, the sheaves FY(v + Î»ei) become constant for suï¬ƒciently large Î» and we require that
they are isomorphic to FW(pr(v)) restricted to M âˆ¨
3.4.3 that such a datum {FY} deï¬nes a sheaf Îâˆ—({FY}) on M . The essential tool to deï¬ne those
to glue Îâˆ—({FY}) from sheaves on the various completions. The latter are, by deï¬nition, formally
toroidal, and the functor FY describes the parts of CY(Îâˆ—({FY})) of varying weight under GnY

sheaves is the theory of descent on formal/open coverings developed in [9]. This theory enables

Y where W is a larger stratum. It is explained in

m .

Example 1. Let M be the compactiï¬cation of a (ï¬ne) moduli space of elliptic curves. There are
only two types of strata: Y = M is the open stratum or Y is a point (a cusp). In the ï¬rst case

3

o
/
PM = GL2 and M âˆ¨ = P1 = PM~QM while in the second case PY = âˆ— âˆ—

1 and M âˆ¨ = A1 = PY~Gm.

The bundle of modular forms of weight k (with â€œvanishingâ€ order Î½Y âˆˆ Z at the cusp Y ) is given
by the following input datum:

for the open stratum, where L is the standard one-dimensional representation of weight k of QM ,

and

FM âˆ¶=LâŠ—k

FY âˆ¶ v â†¦â§âªâªâ¨âªâªâ©

LâŠ—k A1

0

if v â‰¥ Î½Y ,
otherwise,

for the cusps.

Example 2. Let M â€² be the universal elliptic curve over a (ï¬ne) moduli space of elliptic curves.
Let M the PoincarÂ´e line bundle over M â€² associated with the standard polarization. It is the partial
compactiï¬cation of a Gm-torsor M over M â€². The variety M is a mixed Shimura variety associated
with the group PM = GL2 â‹‰W , where W is a Heissenberg group, a central extension of G2
a:

0

/ U â‰… Ga

/ W

/ V â‰… G2
a

/ 0.

(Here GL2 acts on V via the natural 2-dimensional representation and on U via the determinant.)
In this case there is only one boundary stratum Y â‰… M â€² apart from M . Consider the following
input datum:

FM âˆ¶= 0

and

FY âˆ¶ v â†¦â§âªâªâ¨âªâªâ©
LâŠ—k

0

if v = i,
otherwise.

for L as before, extended (considered as a representation) to the present QM in the only possible

way. The associated generalized automorphic sheaf is then the bundle of Jacobi forms of weight
k and index i (it has support on Y â‰… M â€²). Here we completely ignored the behaviour along the
boundary of M â€² for simplicity, which can be achieved by considering a full compactiï¬cation of M
instead.

We ï¬nally consider the notion of (logarithmic) connection on automorphic data, and certain (purely
algebraic) axioms regarding it:

(F) ï¬‚atness of the logarithmic connection (3.1.2),

(T) inï¬nitesimal Torelli (3.1.3),

(M) unipotent monodromy condition (3.1.4),

(B) boundary vanishing condition (3.1.6).

(These axioms are of course not all expected to hold in this form for generalizations of the theory to
other moduli spaces.) For example (F) and (T) imply that â€” on the open stratum â€” the formation
of automorphic vector bundles commutes with the formation of sheaves of diï¬€erential forms and
jet bundles (Section 3.3). If (M) holds, even the sheaves of diï¬€erential forms and the jet bundles
â€” on the compactiï¬cation â€” can be deï¬ned as generalized automorphic sheaves (Section 3.5), as
opposed to their logarithmic variants which are always usual automorphic vector bundles. Finally,

4

/
/
/
/
if in addition (B) holds, Hirzebruch-Mumford proportionality holds for the compactiï¬cation (Sec-
tion 4.2). In the compact case (M) and (B) are vacuous, and this becomes much easier. The validity
of the axioms for automorphic data on toroidal compactiï¬cations of (mixed) Shimura varieties is
explained in section 3.6.
We prove the proportionality theorem of Hirzebruch and Mumford in Section 4 in the following
form:

Theorem 4.2.1. Let M be a toroidal compactiï¬cation of dimension n equipped with automorphic
data with logarithmic connection which satisï¬es the axioms (F, T, M, B) and such that PM is
reductive. There is c âˆˆ Q such that for all polynomials p of degree n in the graded polynomial ring

Q[c1, c2, . . . , cn] and all PM -equivariant vector bundles E in [ [M âˆ¨~PM]-Coh ] the proportionality

p(c1(E), . . . , cn(E)) = c â‹… p(c1(Îâˆ—E), . . . , cn(Îâˆ—E))

holds true.

The idea of the proof is as follows. Following Atiyah [2] the polynomials in the Chern classes of

vector bundles can be computed as an element in H n(M , Ï‰) â‰… k, resp. H n(M âˆ¨, Ï‰) â‰… k by a purely

homological algebra construction starting from the extensions

0

/ 0.

(1)

for E and similar extensions for Îâˆ—E. This construction works in every Abelian tensor category. It
suï¬ƒces therefore to ï¬nd an Abelian tensor category A which maps via an exact tensor functor to

/ â„¦1 âŠ—E

/ J 1E

/ E

[ M -Coh ], and [ M âˆ¨-Coh ],

0.

Extn

A(O, Ï‰â€²) is one-dimensional where Ï‰â€² is the pre-image of both Ï‰M and Ï‰M âˆ¨.

respectively, such that an extension like (1) exists in A and maps to the extensions J 1E, and
J 1(Îâˆ—E), respectively. Furthermore, this Abelian tensor category has to satisfy the property that
In the compact case the category[ [M âˆ¨~PM]-Coh ] of PM -equivariant vector bundles on M âˆ¨ can be
taken as A. This does not work in general because Îâˆ—Ï‰M âˆ¨ = Ï‰M(log) and mostly H n(M , Ï‰(log)) =
In the non-compact case, the Fourier-Jacobi categories can be taken as A. Here the boundary
A(O, Ï‰â€²) is indeed one-dimensional. (Strictly speaking we only construct the tensor product on

vanishing condition comes into play which, by an easy homological algebra argument, implies that
Extn
a subcategory of â€œtorsion-freeâ€ objects in the Fourier-Jacobi-categories and show that Îâˆ— respects
it. For the reasoning above this is however suï¬ƒcient.)
This article would never have been realized without many interesting discussions with Emanuel
Scheidegger, whom I would like to thank very much. Special thanks also to Wolfgang Soergel to
whom I am indebted for his aid.

2 Toroidal compactiï¬cations

2.1 Formally toroidal schemes

Let k be a ï¬eld of characteristic 0, ï¬xed for the whole article. Let Mm be A1 with its
2.1.1.
unital multiplicative monoid structure over k and, as usual, Gm â†ª Mm the open subscheme of the
multiplicative group. Denote by Îµ the unit of Mm or Gm and by Âµ the multiplication.

5

/
/
/
/
Let n be a positive integer and let X be a formal scheme over k with an action of Mn
given morphism

m, i.e. with a

such that

Mn
m

Ã— X

Ï

/ X

Mn
m

Ã— Mn
m

Ã— X

ÂµÃ—id

Mn
m

Ã— X

id Ã—Ï

Ï

Mn
m

Ã— X

Ï

/ X

is commutative and such that the composition

X

ÎµÃ—id /

/ Mn
m

Ã— X

Ï

/ X

is the identity.

Lemma 2.1.2. Let X = spf R be an aï¬ƒne formal scheme over k. It is equivalent to give an action
of Mn
â‰¥0-grading on R, i.e. collection of subrings Rv âŠ† R for each
v âˆˆ Zn

m on X or a (topological) Zn
â‰¥0 such that

1. For all v, w âˆˆ Zn

â‰¥0, we have

Rv â‹… Rw âŠ† Rv+w.

2. Each x âˆˆ R has a unique expression as an inï¬nite converging sum

x = QvâˆˆZn

â‰¥0

xv

with xv âˆˆ Rv.

We denote by e1, . . . , en the standard basis of Zn.

Deï¬nition 2.1.3. A formal scheme X with an action of Mn
is an aï¬ƒne covering by spf Râ€™s such that the action restricts to Mm
n

m is called formally toroidal if there
Ã— spf R â†’ spf R and such that

1. All Rv have the discrete topology.

2. The induced map

has dense image and induces an isomorphism between the completion of R0[Re1 , . . . , Ren] at
the ideal (Re1 , . . . , Ren) and R.

R0[Re1 , . . . , Ren] â†’ R

3. The Rei (and hence by 2. all Rv) are locally free R0-modules of rank 1.

It follows that, up to restricting to a smaller open cover, we have

R â‰… R0Jx1, . . . , xnK

with its natural topological Zn

â‰¥0-grading. The xi however are only determined up to RÃ—
0 .

6

/
/
/




/
/
2.1.4. On a formally toroidal scheme X we also have a ring-sheaf OX0 which locally gives the
R0â€™s and the OX,v which are coherent OX0-submodules of OX . The topological space X together
with OX,0 is a scheme and it is isomorphic to the categorical quotient (in the category of formal

It is denoted by X0. Furthermore there is an obvious

schemes) of X w.r.t. the action of Mn
m.
section (a closed embedding) X0 â†ª X.

Example 2.1.5. The standard example starts from a Gn
compactiï¬ed by glueing in the partial compactiï¬cation Gn
given by the origin of Mn
m.

m-bundle on a variety X which gets partially
m â†ª Mn
m and then completed at the section

2.2 Modules and diï¬€erentials

In the following we consider the integers Z as a category via the natural inclusion of posets into
categories. In other words, there is a morphism (and a unique one) n â†’ nâ€² if and only if n â‰¤ nâ€².

Proposition 2.2.1. Let X with action of Mn
equivalent to give

m be a noetherian formally toroidal scheme.

It is

1. a coherent OX -Module M with an extension of the Gn
2. a collection of coherent OX0-modules Mw for w âˆˆ Zn together with an associative multiplication

m-action (not necessarily the Mn

m-action);

morphism for v âˆˆ Zn

â‰¥0:

OX,v âŠ—OX0

Mw â†’ Mv+w

giving for v = 0 just the module-structure, such that there are N â€², N âˆˆ Z with the property that
for all w such that wi â‰¥ N , all i, and v = ei the morphism is an isomorphism and for all w
such that some wi < N â€² the module Mw is zero;

3. a functor with values in OX0-coherent sheaves

M âˆ¶ Zn â†’ [ OX0-Coh ]

v â†¦ M(v)

a functor âˆ†n

such that there are N, N â€² âˆˆ Z with the property that for all i and for all w with wi â‰¥ N the

N âˆ’N â€² â†’[ OX0-Coh ] where âˆ†N âˆ’N â€² is considered as an interval [N â€², N] âŠ‚ Z.

morphism M(w â†’ w + ei) is an isomorphism and for all w such that wi < N â€² for some i the
module M(w) is zero. In other words the functor is isomorphic to the left Kan extension of
Proof (sketch). 1 â†” 2: Given a module M the associated Mv is just the OX0-submodule of elements
2 â†” 3: A collection Mv is associated with the functor v â†¦ M(v) âˆ¶= Mv âŠ—OX,âˆ’v. Here OX,v for
arbitrary v âˆˆ Zn is deï¬ned by à£¹iOâŠ—Î±i

transforming with weight v under Gn
modules Mv.

m. Conversely, the module M is given as the product of the

for v =âˆ‘ Î±iei.

And a morphism v â†’ w in Zn is mapped to the morphism

X,ei

induced by

Mv âŠ—OX,0 OX,âˆ’v â†’ Mw âŠ—OX,0 OX,âˆ’w

OX,wâˆ’v âŠ—OX,0 Mv â†’ Mw.

The functoriality of the functor M is equivalent to the associativity of the multiplication on the
module M .

7

Deï¬nition 2.2.2. Let X with an action of Mn

m be a noetherian formally toroidal scheme. Coherent
m-action as in Proposition 2.2.1 form an Abelian category which we

OX -modules with compatible Gn
denote by [ OX-TCoh ].
Lemma 2.2.3. Under the correspondence above, we have M(v) are torsion-free OX,0-modules and
M(v â†’ w) are monomorphisms for all v â‰¤ w, if and only if M is torsion-free.
Remark 2.2.4. We deï¬ne the full subcategory Fun(Zn,[ OX0-Coh ])f.g. of Fun(Zn,[ OX0-Coh ])

as those functors M which are bounded below and have the property stated in Proposition 2.2.1, 3.
Hence we have an equivalence

[ OX -TCoh ] â‰… Fun(Zn,[ OX0-Coh ])f.g..

2.2.5. Let M be a coherent sheaf on X with a compatible action of Gn

functor M âˆ¶ Zn â†’ [ OX0-Coh ]. As said, there is an N such that M(âˆ‘ Î±iei) is (essentially)
constant in Î±i if Î±i > N . We denote this sheaf by limÎ±â†’âˆ M(v + Î±ei). Note that also expressions
like limÎ±1â†’âˆ,...,Î±j â†’âˆ M(v +Î±1ei1
+â‹¯ +Î±jeij) do make sense (up to isomorphism). Given an injection
Î² âˆ¶ [j] â†ª [n] we will regard this construction w.r.t to the missing indices in the image of Î² as a

m. We have its associated

functor

âˆ¶ Fun(Zn,[ OX0 -Coh ])f.g. â†’ Fun(Zj ,[ OX0-Coh ])f.g..

lim
Î²

We just write â€œlimâ€ for this construction w.r.t. all indices.

For coherent, torsion-free sheaves M and N we can describe the tensor product M âŠ— N

2.2.6.
with its natural Mn

m action by the functor

M âŠ— N(v) = Qv1+v2 =v

M(v1) âŠ— N(v2)

where the sum is formed in (lim M) âŠ—(lim N).
2.2.7. For any injection Î² âˆ¶[j] â†ª[n] deï¬ne a sheaf OX[Î²âˆ’1] as the sheaï¬ï¬cation of the pre-sheaf,

deï¬ned (for small enough U ) by

U â†¦OX(U)[xâˆ’1

Î²(j)]
Î²(1), . . . , xâˆ’1

m-action we may still associate (in the same way as in Proposition 2.2.1)

where the xi are generators of OX,ei. To a coherent (in the sense of modules on ringed spaces)
OX[Î²âˆ’1]-module with Gn
a functor in Fun(Zn,[ OX0-Coh ]). This yields a fully-faithful functor
[ OX[Î²âˆ’1]-TCoh ] â†’ Fun(Zn,[ OX0-Coh ]
Let Î²âŠ¥ âˆ¶[n âˆ’ j] â†ª[n] be a (to Î²) complementary injection. The diagram

which has the property that the functors in the image are constant in the direction of the eÎ²(i).

[ OX -TCoh ]

[ OX0[Î²âˆ’1]-TCoh ]

Fun(Zn,[ OX0-Coh ])f.g.

limÎ²âŠ¥

/ Fun(Znâˆ’j,[ OX0-Coh ])f.g.

pâˆ—
Î²âŠ¥

/ Fun(Zn,[ OX0-Coh ])

is commutative. Here pâˆ—

Î²âŠ¥ is the pullback induced by the projection pÎ²âŠ¥ âˆ¶ Zn â†’ Znâˆ’j induced by
Î²âŠ¥. The sheaf OX[Î²âˆ’1] can be completed afterwards w.r.t. any of the ideals generated by OX,ei for

8

/
/




/
/
i~âˆˆ im(Î²). This process might be repeated. Any sheaf R of OX-algebras so obtained (which carries

still an action of Gn

m) still yields a fully-faithful functor

[ R-TCoh ] â†’ Fun(Zn,[ OX0-Coh ])

whose image in contained in those functors which are constant in the direction of the eÎ²(i) for those
i such that (locally) a generator Xi has been inverted. An inverse functor on the essential image
might be quite complicated to describe. It is given as a subset of the inï¬nite product that was
considered in Proposition 2.2.1 but the sequences might be e.g. bounded below in some direction,
point-wise w.r.t. another direction. Since we will not need it we will not elaborate on this.
A Gn

[n]]-Module M is equivalent to just an OX0-module via M â†¦
M(0). Each OX0-module M0 in turn has a canonical extension to an OX -Module with Mn

m-equivariant coherent OX[idâˆ’1

m-

action, given by means of the functor

M0(v) =

M0
0

if v âˆˆ Zn
â‰¥0,
otherwise,

â§âªâªâ¨âªâªâ©

or equivalently by M âˆ¶= M0 âŠ—OX,0 OX with its natural Mn
of [ OX -TCoh ] consisting of canonical extensions by [ OX -TCoh-can ].

We have a morphism â€˜constant termâ€™ of functors:

m-action. We denote the full subcategory

c.t. âˆ¶ M âŠ—OX OX[Î²âˆ’1] â†’ lim

Î²

M.

2.2.8.
sheaves on X:

There is the following exact sequence (equivariant w.r.t. the action of Mn

m) of coherent

0

/ â„¦X0

/ â„¦X

âŠ—OX0 OX

/ âˆ‘iOX,ei

âŠ—OX0 OX

/ 0

âŠ—OX0OX is isomorphic to the bundle â„¦X X0. â„¦X is not a canonical extension. There
where âˆ‘iOX,ei
is the larger bundle â„¦X(log) which is locally generated by â„¦X and by the rational diï¬€erentials d xi
Consider the Atiyah extensions on X0 associated with the line bundles OX,ei

.
m. We proceed to describe the associated functors

m-equivariant vector bundles â„¦X and â„¦X(log).

The latter are invariant under the action of Mn
of the Mn

xi

and their amalgamed sum

0

/ â„¦X0

pi

/ Ei

0

/ â„¦X0

à£· pi /

/ E

/ OX0

/ à£·iOX0

/ 0

/ 0

(2)

Then â„¦X(log) is just the canonical extension of E, i.e. it is given by the functor

â„¦X(log)(v) =

E if v â‰¥ 0,
0

otherwise.

â§âªâªâ¨âªâªâ©

Proposition 2.2.9. The functor associated with â„¦X is given by

â„¦X(v) =
as a subfunctor of â„¦X(log).

â§âªâªâ¨âªâªâ©

{e âˆˆ E   pi(e) = 0 âˆ€i âˆ¶ Î±i = 0}

0

if v =âˆ‘ Î±iei â‰¥ 0,

otherwise,

9

/
/
/
/
/
/
/
/
/
/
/
2.3 Abstract toroidal compactiï¬cations

Let M be a smooth k-variety. Consider an open embedding M â†ª M into a smooth
2.3.1.
k-variety (which will mostly assumed to be proper), such that D âˆ¶= M âˆ– M is a divisor with strict

that all components of D are closures of a stratum in the ï¬nite set S. M itself will be the unique
open stratum. Let nY be the codimension of Y . Consider furthermore a formally toroidal action ÏY
of MnY
subscheme X0. For a pair of strata Y, Z we write Z â‰¤ Y if Z âŠ‚ Y .

normal crossings. Consider the coarsest statiï¬cation M = â‹ƒY âˆˆS Y into locally closed subsets such
m on the formal completion X = CY(M) of M along Y which establishes Y as the invariant
Deï¬nition 2.3.2. The embedding M â†ª M together with the collection {ÏY}Y is called a (partial,
map Î²ZY âˆ¶[nY] â†ª[nZ] such that the natural morphism of formal schemes

if M is not proper) toroidal compactiï¬cation if for each pair Z â‰¤ Y of strata we have an injective

is equivariant w.r.t. the action of MnY

CZ(M)
m , where MnY

/ CY(M)
m acts via Î²ZY and ÏZ on CZ(M).

Remark 2.3.3. The map Î²ZY is uniquely determined by the condition in the deï¬nition and hence
for strata W â‰¤ Z â‰¤ Y we have Î²W Z Î²ZY = Î²W Y .

canonical extensions, however.

m -action whose completions are all canonical extensions (2.2.7).

patible GnY
those sheaves with compatible GnY

We will regard objects on M such as coherent sheaves etc. always with a compatible action of the
GnY

m -actions on the various completions. It has a full subcategory [ O

m (not necessarily MnY
Deï¬nition 2.3.4. In particular, we have a category [ O

m ) on their completion on CY(M) for all strata Y in a compatible way.
M -TCoh ] of coherent sheaves with com-
M -TCoh-can ] of
For example â„¦i(M), T(M) and O
M -TCoh ]. The former two are no
2.3.5. Each closed stratum Y is itself a (partial) toroidal compactiï¬cation. The completion CZ(Y)
is the following formal subscheme of CZ(M). It is in local coordinates given by R0JRei, . . . , RenZ
K
modulo the ideal generated by ReÎ²(1), . . . , ReÎ²(nY ) (where Î² = Î²ZY ). It carries an action of GnZâˆ’nY
.
Here the missing indices not in the image of Î² can be numbered in any way. We denote the corre-
âˆ¶[nZ âˆ’nY] â†ª[nW âˆ’nY]
sponding injective map by Î²âŠ¥
ZY
of the transition maps Î²W Z for W â‰¤ Z â‰¤ Y the scheme Y becomes a toroidal compactiï¬cation. The
following commutative diagram shows the compatibility of the chosen numberings:

âˆ¶[nZ âˆ’nY] â†ª[nZ]. With the restriction Î²â€²

M and are sheaves in [ O

m

W Z

[nZ âˆ’ nY] 
[nZ] 

Î²âŠ¥

ZY

 Î²â€²

W Z /

Î²W Z

[nW âˆ’ nY]
/ [nW]

Î²âŠ¥

W Y

Lemma 2.3.6. Let E be a coherent sheaf on M with compatible GnY

completion EY on CY(M). Then for any stratum Z â‰¤ Y and v âˆˆ ZnY we have that

m -action on the respective

EY(v)

is the coherent sheaf on Y which (w.r.t. to the restricted structure of toroidal compactiï¬cation of
2.3.5) corresponds to the functor w.r.t. Z:

z â†¦ EZ(Î²ZY(v) + Î²âŠ¥

ZY(z)).

10

/
/

_



_



/
Lemma 2.3.7 (Glueing lemma). Consider for each stratum Y be a functor

FY âˆ¶ ZnY â†’[ Y -TCoh-can ]

which satisï¬es the conditions of Proposition 2.2.1, 3., where [ Y -TCoh-can ] is the category of

toroidal coherent sheaves on Y which are canonical extensions (see 2.3.4). Consider for all Z â‰¤ Y
an isomorphism of functors

ÎºZY âˆ¶ Î¹âˆ—

ZY FY

âˆ¼

Ãâ†’ lim
Î²ZY

FZ

(3)

which are compatible w.r.t. Y â‰¤ Z â‰¤ W in the obvious way. Here Î¹ZY âˆ¶ CZ(M) â†’ CY(M) is the
m on CY(E) for all Y ,

natural morphism of formal schemes.
Then there exists a coherent sheaf E on M with compatible actions of GnY
such that there are isomorphisms of functors

which are compatible with the functors ÎºZY in the sense that for all v âˆˆ Z nY the diagram

Î»Y âˆ¶ CY(E)(v) Y â‰… FY(v) Y
FY(v)

CY(E) Y(v)

Î»Y

CZ(E)[Î²âˆ’1

ZY](v)

Î»Z

(limÎ²ZY FZ)(v)

ÎºZY

(4)

is commutative.
determined (up to unique isomorphism) by this property and the isomorphisms Îº.

In particular E is isomorphic to FM on the open stratum M . E is uniquely

M -algebras RY of [loc. cit.] are isomorphic

Proof. We apply [9, Main theorem 7.6]. The sheaves of O

to the restriction of the sheaf CY(OX) to any open subset U âŠ‚ M such that U âˆ© Y = Y . We write as
usual CY(OX) Y for this sheaf. All ring sheaves are considered on the topological space underlying

M . Note that they are not quasi-coherent as OX -modules, except for the open stratum M itself.
For any pair of strata Z â‰¤ Y the sheaf of O

product is formed in the category of ring sheaves. The sheaf of O

to CY(RZ âŠ—OM
also isomorphic to a completion of the localization CZ(OX)[Î²âˆ’1
coordinates in CZ(OX) by the zero locus of xÎ²(1), . . . , xÎ²(nY ) for Î² = Î²ZY .

OU) where U is any open subset such that U âˆ© Y = Y and where the tensor
OU) is
Y Z] since Y is given in formal local

M -algebras CY(RZ âŠ—OM

M -algebras RY,Z of [loc. cit.]

is, by deï¬nition, equal

By the nature of toroidal compactiï¬cation of M we have an action of GnY
GnZ

m on RY,Z which are compatible (via Î²ZY ) with the inclusion

m on RY and an action of

RY â†ª RY,Z.

The category of RY -coherent sheaves with GnY

m -action is equivalent to the category

Hence the given collection of functors {FY}Y gives such objects by restricting FY to Y .

From the category of RY,Z-coherent sheaves with GnZ
into the sub-category of

m -action we have still a fully-faithful embedding

consisting of functors which are constant in the directions ei for i ~âˆˆ im(Î²ZY). For each Z â‰¤ Y
M -modules which is by construction an object in [ O

we get such an object taking limÎ²ZY FZ . The glueing datum required by [loc. cit.] can therefore
be given by diagram (4). Hence, by the main theorem of [loc. cit.], we get the requested sheaf of
O

M -TCoh ].

Fun(ZnY ,[ OY -TCoh ])f.g..

Fun(ZnZ ,[ OZ -TCoh ])

11







_
?
o
o
o
o
2.4 Toroidal compactiï¬cations of (mixed) Shimura varieties

2.4.1. The standard examples of abstract toroidal compactiï¬cations in the sense of Deï¬nition 2.3.2
are toroidal compactiï¬cations of Shimura varieties [1]. Since we are interested only in the situation
over a ï¬eld, we can use the theory of canonical models of toroidal compactiï¬cations of mixed
Shimura varieties due to Pink [13, 2.1] which has been extended in [7] (cf. also [8, 2.5]) to the
integral (good reduction) case. For the automorphic data referred to in the next section we rely on
[8, 2.5] also for the rational case. In that case the ideas for the proofs of the theorems in [8, 2.5.]
(which are given in [7]) are essentially due to Harris [3â€“5].

2.4.2.

Furthermore for each smooth K-admissible rational polyhedral cone decomposition âˆ† for X (cf. [8,

For each pure (or mixed) rational Shimura datum X = (PX, DX, hX) in the sense of [8,
2.2.3]1 or [13, 2.1], and for each suï¬ƒciently small compact open subgroup K âŠ‚ PX(A(âˆ)) there is
an associated Shimura variety M(K X) which is a smooth quasi-projective variety deï¬ned over the
reï¬‚ex ï¬eld E(X).
âˆ† X) which contains M(K X) as an open
2.2.23]) there is a (partial) toroidal compactiï¬cation M(K
âˆ† X) is a smooth projective variety deï¬ned over the reï¬‚ex ï¬eld
projective and complete then M(K
âˆ† X) as considered in 2.3.1. Each
E(X). This situation thus gives rise to a stratiï¬cation of M(K
this stratiï¬cation there is a mixed Shimura datum BY = (PBY , DBY , hBY) such that PBY is a

subvariety whose complement is a divisor with strict normal crossings. This and the following
is a summary of [8, Main Theorem 2.5.9]).
If âˆ† is chosen (and this is always possible) to be

stratum corresponds furthermore to a rational polyhedral cone in âˆ†. For each stratum Y in

subgroup of PX (actually this is a certain normal subgroup of the Q-parabolic of PX describing the
corresponding boundary component in the Baily-Borel compactiï¬cation). BY is determined only
up to conjugation. Furthermore, âˆ† restricts to a rational polyhedral cone decomposition âˆ†Y for

BY . The partial toroidal compactiï¬cation of the mixed Shimura variety M(KY
stratum ÌƒY and there is an isomorphism of formal schemes (assuming that K is small enough)

BY) has a matching

âˆ†Y

CY M(K

âˆ† X) â‰… CÌƒY

M(KY

âˆ†Y

BY).

Furthermore the mixed Shimura variety M(KY BY) is a torus torsor over another mixed Shimura
variety M(K â€²
Y BY~U) where U is a subgroup of UBY (the center of the unipotent radical of PBY )
BY) (cf. [8, 2.5.8]). The acting torus gets identiï¬ed
and the action of the torus extends to M(KY
BY) becomes a formally toroidal scheme in the sense of 2.1.3. The functoriality of the
âˆ† X) is

with GnY
By construction of the toroidal compactiï¬cation this action extends to MnY
CÌƒY
theory implies that the actions of the tori match for pairs of strata Z â‰¤ Y . Thus M âˆ¶= M(K

m by means of the basis of the nY -dimensional rational polyhedral cone describing Y .
m in such a way that

an abstract toroidal compactiï¬cation in the sense of Deï¬nition 2.3.2.

M(KY

âˆ†Y

âˆ†Y

3 Automorphic data

3.1 Automorphic data on an abstract toroidal compactiï¬cation

Let M be an abstract toroidal compactiï¬cation (Deï¬nition 2.3.2).

Deï¬nition 3.1.1. Automorphic data on the toroidal compactiï¬cation M consists of a collection

{PY , M âˆ¨

Y , BY , . . .}Y indexed by the strata Y of M where

1where the integrality property has to be ignored.

12

1. PY is a linear algebraic group (not necessarily reductive).

2. M âˆ¨

Y is an open and closed subscheme of the moduli space of quasi-parabolic subschemes of
PY . We will call these spaces generalized ï¬‚ag varieties. If PY is reductive then they are
projective. We consider the action of PY on M âˆ¨

Y as a right-action.

3. We are given a diagram

CY(M)

Ï€o

BY

p

/ M âˆ¨
Y

in which Ï€ is a right PY -torsor and p is a PY -equivariant map.

4. We are given a lift of the MnY

m -action to BY in a PY -equivariant way, and p is MnY

m -invariant.
We assume that BY is a canonical extension, i.e. isomorphic to Î âˆ’1BY for some bundle on
Y with its induced MnY
m -action, where Î  âˆ¶ CY M â†’ Y is the projection. (Such a datum is
basically equivalent to a QY -principal bundle on Y where QY corresponds to a k-rational
point of M âˆ¨ if it exists.)

For strata Z â‰¤ Y we suppose given closed embeddings of algebraic groups Î±ZY âˆ¶ PZ â†ª PY which
Z â†ª M âˆ¨
induce open embeddings M âˆ¨
m -equivariant morphisms BZ â†’ BY such
that the diagram of formal schemes

Y and given PZ - and MnY

CZ(M)

CY(M)

Ï€o

BZ

Ï€o

BY

p

p

/ M âˆ¨
Z

/ M âˆ¨
Y

commutes. The morphisms have to be functorial w.r.t. three strata W â‰¤ Z â‰¤ Y .
In other words, if M âˆ¨ contains a k-rational point QM , automorphic data is roughly given by a QM -
principal bundle BM on M such that the structure group restricts to QY on the formal completion
along Y in an MnY
3.1.2. Consider the following sequence of vector bundles on BY (which are all MnY
n -equivariant
and canonical extensions). We assume given a logarithmic Ehresmann connection on BY , i.e. a
section sY which is PY -invariant and MnY

m -equivariant way. Here QY is any parabolic in M âˆ¨

Y(k).

n -equivariant:

0

/ OBY

âŠ— gY = T Ï€âˆ’vert

BY

/ TB(log)

sY

/ Ï€âˆ—TCY (M)(log)

/ 0.

Since everything is MnY
of the sequence

n -equivariant and a canonical extension, this is equivalent to give a section

0

/ OBY  Y

âŠ— gY = T Ï€âˆ’vert

BY  Y

sâ€²
Y

/ TB(log) Y

/ Ï€âˆ—TCY (M)(log) Y

/ 0.

Furthermore these sections are supposed to be compatible w.r.t. the relation Z â‰¤ Y on strata.
Such a datum will be called automorphic data with logarithmic connection on the toroidal
compactiï¬cation M .
We deï¬ne the PY -sub vector bundle T horz
sition:

as the image of sY , and get a PY -equivariant decompo-

BY

We say that the connection is ï¬‚at, if

TBY(log) = T Ï€âˆ’vert

BY

âŠ• T horz

BY

.

13

o
/


o


/
_


o
/
/
/
/
s
s
/
/
/
/
r
r
/
(F) T horz

BY

is closed under the Lie bracket.

We call P vert
morphism of ring-sheaves

and P horz

Ï€

Ï€

the corresponding projection operators. If sY is ï¬‚at, it induces a homo-

Î½ âˆ¶ Ï€âˆ’1DMY(log) â†’ DBY(log).

(5)

(6)

3.1.3. We say that the automorphic data satisï¬es Torelli2, if we have in addition

(T) a direct sum decomposition

TBY(log) = T pâˆ’vert
(log) is the intersection of T pâˆ’vert

(log) âŠ• T horz
with TBY(log) in TBY .

BY

BY

BY

where T pâˆ’vert

BY

and P horz
We then denote by P vert
Torelli (T) induces an isomorphism

p

p

the corresponding projection operators.

pâˆ—TM âˆ¨ â‰… Ï€âˆ—TM(log).

In the same way, if sY is ï¬‚at and Torelli holds, we also get a homomorphism of ring-sheaves

Âµ âˆ¶ pâˆ’1DM âˆ¨

Y

â†’ DBY(log).

3.1.4.
sequence (2)

Note that, by the structure of toroidal compactiï¬cation, we have a sequence dual to

0

/ à£·nY

i=1

O

CY (M)

â‹… cani,M

/ TCY (M)(log)

/ Î âˆ—TY

/ 0

where cani,M are the fundamental vector ï¬elds for the GnY
to Y .
We also consider the following compatibility axiom (called the unipotent monodromy condi-
tion)

m -action on M , and Î  is the projection

(M) We have P vert

Ï€

dimensional normal unipotent subgroup Ga â‰… U (i) âŠ‚ PY .

(cani,BY) âˆˆ u

(i)
Y

(i)
âŠ— OBY , where u
Y

is a sub-Lie-algebra of pY given by a 1-

Axiom (M) has the following immediate consequence:

Lemma 3.1.5. We have p(P vert
where T (i)
normal unipotent subgroup Ga â‰… U (i) âŠ‚ PY .

(cani,BY)) âˆˆ pâˆ—T

M âˆ¨ is the subbundle of TM âˆ¨ induced by a subalgebra u

M âˆ¨ (or equivalently p(P horz

(i)
M âˆ¨),
(i)
Y of pY given by a 1-dimensional

(cani,BY)) âˆˆ pâˆ—T

(i)

Ï€

Ï€

3.1.6. We also consider the following axiom (called the boundary vanishing condition):

(B) For all strata Y ~= M we have: H i([M âˆ¨

Y~PY] , Ï‰M âˆ¨

Y) = 0 for i â‰¥ dim(Y).

(cf. Section 3.2 for the notation). Here Ï‰M âˆ¨
of diï¬€erential forms on M âˆ¨
Y .

Y

= â„¦n

M âˆ¨
Y

is the highest power of the PY -equivariant sheaf

2this rather corresponds to classical inï¬nitesimal Torelli theorems

14

/
/
/
/
3.2 Generalized ï¬‚ag varieties and representations of quasi-parabolic subgroups

3.2.1. For a linear algebraic group P and a quasi-parabolic subgroup Q we have several functors
between Q-representations, P -representations and (equivariant) coherent sheaves on the quasi-

projective variety M âˆ¨ = QÆ’P (generalized ï¬‚ag variety)3. These functors are best understood in

the language of Artin stacks. We will not use this theory explicitly but mention it as a guiding
principle because it so much clariï¬es the relations. All representations are, of course, understood
to be algebraic. We have the following diagram of morphisms of Artin stacks where all stacks are
quotient stacks (even schemes in the right-most column):

[â‹…~Q]

a
âˆ¼

/ [M âˆ¨~P]
[â‹…~P]

b

c

M âˆ¨

d

f

e

. spec(k)

(7)

We denote the categories of (quasi-)coherent sheaves on a stack X by [ X-(Q)Coh ] or sometimes
by [ OX -(Q)Coh ]. For the particular stacks above, we get

[ [â‹…~Q]-Coh ]
[ [â‹…~P]-Coh ]
[ [M âˆ¨~P]-Coh ]
[ M âˆ¨-Coh ]
[ spec(k)-Coh ]

category of ï¬nite-dimensional algebraic Q-representations in k-vector spaces;
category of ï¬nite-dimensional algebraic P -representations in k-vector spaces;
category P -equivariant ï¬nite dimensional vector bundles on M âˆ¨;
category of coherent sheaves on M âˆ¨;
category of ï¬nite-dimensional k-vector spaces,

and similarly for the categories of quasi-coherent sheaves.
The corresponding pull-back and (derived) push-forward functors between the categories of (quasi-)coherent
sheaves are given as follows.

aâˆ— associates with a Q-representation V a locally free P -equivariant sheaf on M âˆ¨. The total

space can be described as (V Ã— P)~Q where Q acts on V and P . It deï¬nes an equivalence of

the category of ï¬nite-dimensional Q-representations and coherent P -equivariant sheaves on
M âˆ¨.

aâˆ— is the inverse of aâˆ—, evaluation at the choosen base point of M âˆ¨.

bâˆ— global sections on M âˆ¨, remembering the induced P -action. The right derived functors are

cohomology on M âˆ¨ equipped with the induced P -action.

bâˆ— associates with a P -representation V the coherent sheaf V âŠ— OM âˆ¨ with the natural P -action.

câˆ— forgets the P -action.

dâˆ— global sections on M âˆ¨. The right derived functors are the cohomology on M âˆ¨.

dâˆ— associates with a vector space V the coherent sheaf V âŠ— OM âˆ¨.

eâˆ— induction IndP

e (âˆ’), associates with a vector space V the P -representation V âŠ— O(P).

eâˆ— forgets the P -action.

3Hence, in contrast to the last section, we explicitly assume for simplicity that M âˆ¨ has a k-rational point with

corresponding quasi-parabolic Q.

15

/




o
o
.
n
n
fâˆ— associates with a P -representation the vector space of P -invariants. This functor is exact if
P is reductive. Otherwise the right derived functors are the (Hochschild) group cohomology
of P with values in the respective representation.

f âˆ— equips a vector space V with the trivial P -representation.

The composed functor aâˆ—bâˆ— is the forgetful functor considering a P -representation as a Q-representation.
Q(âˆ’) but it is not exact in
Its right adjoint, the composed functor bâˆ—aâˆ—, is therefore also called IndP
general.
For a stack X, we denote by H i(X, E) the higher derived functors of Ï€âˆ— evaluated at E, where Ï€
is the structural morphism. For example H i([â‹…~P] , E) denotes the (Hochschild) cohomology of P

with values in the representation E.
We will use the following Lemma and its obvious consequences when one of the functors is exact
without further mentioning.

Lemma 3.2.2. For all compositions of push-forward functors along morphisms of Artin stacks we
have corresponding Grothendieck spectral sequences of composed functors.

Proof. See e.g. [10] for elementary statements regarding the stacks appearing in this section.

3.3 Jet bundles on generalized ï¬‚ag varieties

3.3.1. We start with a general discussion of jet bundles and diï¬€erential operators. Let X be a
smooth k-variety and X(n) the n-th diagonal, i.e.

where J is the ideal sheaf of the diagonal. Let E be a vector bundle on X.
We have the two projections:

X(n) âˆ¶= OXÃ—X~J n

X
One deï¬nes the n-th jet bundle J nE by

pr1

|â‘¢â‘¢â‘¢â‘¢â‘¢â‘¢â‘¢â‘¢â‘¢

X(n)

pr2

"â‰â‰â‰â‰â‰â‰â‰â‰â‰

X

which is always equipped with a surjective map

J nE â†’ E,

J nE = pr1,âˆ— prâˆ—

2 E

induced by the unit E â†’ âˆ†âˆ—âˆ†âˆ—E. Since OX (n) = prâˆ—
map in the case E = O:

1 OX = prâˆ—

2 OX there is also a splitting of this

O â†’ J nO.

3.3.2. For two vector bundles E and F the sheaf of diï¬€erential operators (of degree â‰¤ n) is deï¬ned
as

Dâ‰¤n(E, F) âˆ¶= HOMOX(J nE, F).

The bundle J nE has also a diï¬€erent OX -module structure coming from pr2, which we denote as an
action on the right. We have

where the tensor-product is formed w.r.t. this second OX-module structure.

J nOX âŠ— E â‰… J nE

16

"
|
into the sheaf of k-linear morphisms of sheaves (but not OX -linear). For an open subset U âŠ‚ X, a

3.3.3. There is an inclusion

Dâ‰¤n(E, F) â†ª HOMk(E, F)

section s âˆˆ H 0(U, E) here is considered to be a morphism

and the composition

OU â†’ EU

OU â†’ pr1,âˆ— prâˆ—

1 OU = pr1,âˆ— prâˆ—

2 OU â†’ pr1,âˆ— prâˆ—

2 E = J nE

yields a section in H 0(U, J nE) and then, via application of an element of H 0(U, HOM(J nE, F))
a section in H 0(U, F). The second OX-module structure on J nE here dualizes to pre-composition

with a section of OX . We write Dâ‰¤n
X is generated
X
by OX and TX with the only relations coming from the Lie bracket of vector ï¬elds and diï¬€erentiation
of functions.
Similarly to the case of jet bundles, we have

âˆ¶= Dâ‰¤n(OX , OX). The ring sheaf DX âˆ¶= colimn Dâ‰¤n

Dâ‰¤n(E, O) = Dâ‰¤n

X

âŠ— E âˆ—

where the tensor product is formed w.r.t. the right-OX -module structure.

3.3.4.
(compatible with the ï¬ltration by degree):

In the special case X = G, where G is an algebraic group, we have a natural isomorphism

DG = colimn Dâ‰¤n
G

= OG âŠ— U(g).

Elements of g are considered to be vector ï¬elds using the action by left-translation. They are
invariant under the action of G on G by right-translation. The isomorphism is hence G-equivariant
under right-translation, where G acts on the right hand side only on OG. It is G-equivariant under
left-translation if G on the right hand side acts on OG by left translation and via Ad on g.

3.3.5. We now consider the special case X = QÆ’P , where Q is a quasi-parabolic subgroup of P .
Y in the last section. Hence we assume that M âˆ¨

These are the generalized ï¬‚ag varieties, denoted M âˆ¨
has a k-rational point Q in the sequel.

Proposition 3.3.6. Let E be a P -representation and

the corresponding P -equivariant vector bundle on QÆ’P . Then we have

D(E âˆ—, O) = QÆ’(P Ã— U(p) âŠ—U(q) E)

where Q acts on U(p) via Ad and on E via the given representation.
Proof. A section on U âŠ‚ QÆ’P of the bundle QÆ’(P Ã— U(p) âŠ—U(q) E) can be considered as a Q-
invariant section s on Ï€âˆ’1U of the constant bundle U(p) âŠ—U(q) E. Such sections act on the space
H 0(U, E âˆ—) = H 0(Ï€âˆ’1U, Eâˆ—)Q as follows: Let f âˆˆ H 0(Ï€âˆ’1U, Eâˆ—)Q. A tensor s = g(X âŠ— v) acts as

E = QÆ’(P Ã— E)

f â†¦ g(Xv(f)).

In local coordinates one checks that this induces an isomorphism with the appropriate sheaf of
diï¬€erential operators.

17

Deï¬nition 3.3.7. We deï¬ne

J nE âˆ¶=((U(p) âŠ—U(q) Eâˆ—)â‰¤n)âˆ—.

Corollary 3.3.8 (to Proposition 3.3.6). The PY -equivariant sheaf on M âˆ¨
representation J nE is J nE.

Y associated with the

3.3.9. There is a logarithmic version of the sheaves of diï¬€erential operators deï¬ned in the last
section. Let X = M be a smooth k-variety equipped with a divisor with normal crossings. We
deï¬ne

as the subsheaf of diï¬€erential operators generated by vector ï¬elds in TX(log). Wet set

Dâ‰¤n(E, F)(log) âŠ‚ Dâ‰¤n(E, F)
logE âˆ¶= Dâ‰¤n(E, OX)(log)âˆ¨.

J n

The following theorem was shown in [4] for the case of Shimura varieties.

vector bundle on M . Then the automorphic vector bundle associated with J nV is precisely J n
log

Theorem 3.3.10. Let V be a representation of QM , and V âˆ¶= Îâˆ—ÌƒV the corresponding automorphic
Proof. Let ÌƒV denote the bundle QÆ’(V Ã— P) on QÆ’P . It suï¬ƒces to show, dually, that the auto-
morphic vector bundle associated with the P -equivariant vector bundle Dâ‰¤n(ÌƒV âˆ—, O) on QÆ’P is
Dâ‰¤n(log)(V âˆ—, O).

Let Y be a stratum. For the proof it suï¬ƒces to take Y = M , however, we will need the more
reï¬ned discussion later. There are PY -equivariant homomorphisms of ring sheaves (which respect
the ï¬ltrations by degree), cf. (3.1.2â€“3.1.3):

V.

Âµ âˆ¶ Ï€âˆ’1DMY(log) â†’ DBY(log)
â†’ DBY(log)

Î½ âˆ¶ pâˆ’1DM âˆ¨

Y

given by the ï¬‚at connection sY (and the Torelli axiom). They are compatible with the left- and
right-module structure under pâˆ’1OM âˆ¨
â‹… Î½(Dâ‰¤n

, resp. Ï€âˆ’1OMY . Furthermore, we have
Y) = Dhorz

MY(log)),
is the sub-ring sheaf of DBY generated by OBY and T horz

â‹… Âµ(Dâ‰¤n

= OBY

OBY

where Dhorz
BY

M âˆ¨

BY

BY

.

Y

The bundle Dâ‰¤n(ÌƒV , O) on M âˆ¨

Y is isomorphic to

Dâ‰¤n
M âˆ¨
Y

âŠ—OM âˆ¨

Y ÌƒV âˆ—

where the tensor product has been formed w.r.t. the OM âˆ¨
Furthermore, we have a PY -equivariant isomorphism:

Y

-right-module structure on Dâ‰¤n
M âˆ¨
Y

.

(Lemma 3.3.11 below). Now, PY acts on OBY

pâˆ—(Dâ‰¤n

M âˆ¨
Y

âŠ—OM âˆ¨

Y ÌƒV) â‰… OBY

â‹… Âµ(Dâ‰¤n
MY(log)) âŠ—OBY
MY(log)) exclusively on the ï¬rst factor, i.e.
â‹… Âµ(Dâ‰¤n

pâˆ—ÌƒV

(OBY

â‹… Âµ(Dâ‰¤n

MY(log)))PY â‰… Dâ‰¤n

MY(log)

using the identiï¬cation of PY -invariant sections of a PY -bundle on BY with the sections of a vector
bundle on MY . Conclusion:

(pâˆ—(Dâ‰¤n

M âˆ¨
Y

âŠ—OM âˆ¨

Y ÌƒV))PY â‰… Dâ‰¤n

MY(log) âŠ—OMY (pâˆ—ÌƒV)PY .

18

Lemma 3.3.11. The submodule OBY
we have:

M âˆ¨

â‹… Î½(Dâ‰¤n
Y ÌƒV) â‰…(OBY

pâˆ—(Dâ‰¤n

M âˆ¨
Y

âŠ—OM âˆ¨

Y) of DBY(log) is also a right-OBY -submodule, and

â‹… Î½(Dâ‰¤n

Y)) âŠ—OBY

M âˆ¨

pâˆ—ÌƒV

where the tensor product in both cases is formed w.r.t. the right-module structure.

Proof. This follows by induction on the degree from the fact that Î½ is compatible with the right-
pâˆ’1OM âˆ¨

-module structure.

Y

3.4 Fourier-Jacobi categories

Deï¬nition 3.4.1. Let M be a toroidal compactiï¬cation equipped with automorphic data. We deï¬ne

the Fourier-Jacobi category [ M -FJ ] of M . The objects are collections of functors

FY âˆ¶ ZnY â†’[ [M âˆ¨

Y~PY]-Qcoh ]

for each stratum Y , satisfying the following conditions:

1. For each j there is an N âˆˆ Z such that for all v with vj â‰¥ N the objects

do not depend on vj and for all v â‰¤ vâ€² with vj, vâ€²
j

â‰¥ N the morphisms

FY(v)

FY(v â†’ vâ€²)

do not depend on vj and are identities if vi = vâ€²
isomorphic to a left Kan extension of a functor ZnY
â‰¤N

i for all i ~= j. In other words, the FY are
We denote the respective constant value by limÎ»â†’âˆ FY(v + Î»ej). Note that also expressions
like limÎ»1,Î»2â†’âˆ FY(v + Î»1ej + Î»2ek) etc. make sense.
2. For all Z â‰¤ Y with corresponding map Î²ZY âˆ¶[nY] â†ª[nZ] and morphism Î±ZY âˆ¶ PZ â†’ PY there

Y~PY]-Qcoh ]4.

â†’[ [M âˆ¨

is an isomorphism:

ÂµZY(v) âˆ¶ Î±âˆ—

ZY FY(v) âˆ¼

Ãâ†’

lim
Î»k1 ,...,Î»kl

â†’âˆ

FZ(Î²ZY(v) + Î»k1 ek1

+ â‹¯ + Î»klekl)

for all v âˆˆ ZnY . Here {k1, . . . , kl} is the complement of im(Î²ZY). These isomorphisms are

supposed to be natural transformations of functors in v and to be functorial w.r.t. three strata
W â‰¤ Y â‰¤ Z.

The morphisms in the category [ M -FJ ] are collections of morphisms of functors {FY â†’ F â€²
Y}Y
for all strata which are compatible with the isomorphisms ÂµZY(v).
In the same way, we deï¬ne categories [ Y -FJ ], where the objects only consist of functors FZ for
Z â‰¤ Y . We also deï¬ne [ Y -FJ ], whose objects are just functors FY satisfying property 1. All

Fourier-Jacobi categories are Abelian categories.

4This would rather only say that the FY become constant up to isomorphism, but there is no harm in requiring

that they are actually constant.

19

Deï¬nition 3.4.2. We deï¬ne the following full subcategories of the Fourier-Jacobi categories:

1. [ M -FJ-â‰¥ ]: We ask in addition that for each stratum Y there is an N âˆˆ Z such that

FY(v) = 0
n â†’[ [M âˆ¨

for all Y and v. Such elements shall be called coherent.

considered as an interval [N, N + n] âŠ‚ Z.

if some vj < N . Such elements shall be called bounded below. It means that FY is actually
a left Kan extension from a functor âˆ†nY

Y~PY]-Qcoh ] for some n âˆˆ N, where âˆ†n is
2. [ M -FJ-coh ]: As before but with the additional condition that FY(v) is ï¬nite dimensional
3. [ M -FJ-â‰¥ N ], [ M -FJ-â‰¥ N -coh ]: As before but with ï¬xed N .
4. [ M -FJ-tf ]: All bounded-below objects, such that in addition for all v â‰¤ w, the morphism
5. [ M -FJ-lf ]: All torsions-free objects, such that for a diagram

FY(v) â†’ FY(w) is a monomorphism. Such elements shall be called torsion-free.

the corresponding diagrams

v

v + ei

v + ej

/ v + ei + ej

FY(v)
FY(v + ej)

FY(v + ei)
/ FY(v + ei + ej)

are Cartesian. Such elements shall be called locally free.

6. [ M -FJ-lf-coh ]: All locally free and coherent objects.

3.4.3. Obviously the deï¬nition of Fourier-Jacobi category mimics the situation for vector bundles
on toroidal compactiï¬cations and we now proceed to deï¬ne an exact functor

Îâˆ— âˆ¶[ M -FJ-coh ] â†’[ M -TCoh ]

as follows: For each FY(v) âˆˆ[ PY -Vect on M âˆ¨

on Y . It carries an action of MnZ âˆ’nY

on

m

Y ] we form pâˆ—(FY(v))PY Y which is a vector bundle

CZ(pâˆ—

Y(FY(v))PY Y) â‰…(pâˆ—

Z(Î±âˆ—

ZY FY(v))PZ) Y

which is a canonical extension (cf. 2.2.7).
The functors

F â€²
Y

âˆ¶ ZnY â†’[ Y -TCoh-can ]

(where Y is equipped with its structure as restricted toroidal compactiï¬cation) together with the
maps induced by the ÂµZY satisfy the requirements of Lemma 2.3.7. Hence we get a coherent sheaf

Îâˆ—({FY}) on M which carries a GnY

m action on CY(Îâˆ—({FY})).

We call the sheaves in the image of Îâˆ— generalized automorphic sheaves.

20

/
/




/
/
/




/
Example 3.4.4. The easiest case is just

where V is a bundle on [ M -FJ-coh ] = [ [M âˆ¨~PM]-Coh ].

canonical extension itself and can be described by the collection of functors

It is a vector bundle which is a

Îâˆ—V âˆ¶=(pâˆ—

M V)PM

FY âˆ¶ v â†¦â§âªâªâ¨âªâªâ©

Y M V

Î±âˆ—
0

v âˆˆ ZnY
â‰¥0
otherwise.

Sheaves of this form are locally free and called automorphic vector bundles.

Remark 3.4.5. The Fourier-Jacobi categories are related to the classical Fourier-Jacobi expansions

as follows. For each F âˆˆ[ M -FJ ] and stratum Y there is a morphism Fourier-Jacobi expansion:

H 0(M , Îâˆ—F) â†’ MvâˆˆZnY

H 0(M , Îâˆ—Fv),

where Fv is the following element of F âˆˆ[ Y -FJ ]. On Y it is deï¬ned by

Fv,Y(w) =

â§âªâªâ¨âªâªâ©
FY(v)

0

for w = v,
otherwise.

and is a similar restriction of F on strata Z â‰¤ Y and 0 on all other. Note that Îâˆ—Fv has support
on Y .

Deï¬nition 3.4.6. For the category [ M -FJ-tf-coh ] we deï¬ne a tensor product mimimicing the
tensor product of 2.2.6. Let F and G be objects of [ M -FJ-tf-coh ]. We deï¬ne

(F âŠ— G)Y âˆ¶ v â†¦ Qv1+v2 =v

FY(v1) âŠ— GY(v2)

where the sum is formed in (limvâ†’âˆ FY(v)) âŠ—(limvâ†’âˆ GY(v)).

Lemma 3.4.7. The exact functor (cf. 3.4.3)

Îâˆ— âˆ¶[ M -FJ-coh ] â†’[ M -TCoh ]
preserves the tensor product when restricted to [ M -FJ-tf-coh ].
3.4.8. For each pair (Y, v) where Y is a stratum and v âˆˆ ZnY there exist restriction functors:

Y

(v)âˆ—
(v)âˆ—
(v)âˆ—

Y

Y

âˆ¶

âˆ¶

âˆ¶

[ M -FJ-â‰¥ N -coh ] â†’ [ [M âˆ¨
[ M -FJ ] â†’ [ [M âˆ¨
[ M -FJ-â‰¥ N ] â†’ [ [M âˆ¨

Y~PY]-Coh ]
Y~PY]-Qcoh ]
Y~PY]-Qcoh ]

given by F â†¦ FY(v). Those are exact and have each an exact right-adjoint (v)Y,âˆ— which is given as
follows. ((v)Y,âˆ—V)Y is given by the right Kan-extension vâˆ—, where v âˆ¶{â‹…} â†ª ZnY , resp. v âˆ¶{â‹…} â†ª ZnY

also denotes the inclusion of v. In other words we have

â‰¥N

((v)Y,âˆ—V)Y(w) =

â§âªâªâ¨âªâªâ©

V

0

if w â‰¤ v (and p.r.n. wi â‰¥ N for all i)
otherwise.

21

Note that v â‰¤ w means that vi â‰¤ wi for all i. For any stratum Z â‰¤ Y we deï¬ne

((v)Y,âˆ—V)Z(v) âˆ¶= Î±âˆ—

ZY((v)Y,âˆ—V)Y(pr(v))

where pr âˆ¶ ZnZ â†’ ZnY is the projection induced by Î²ZY . In the bounded case it is set identically

zero if vi < N for any i. For all other strata Z the functor ((v)Y,âˆ—V)Z is set identically zero. The so
deï¬ned object (v)Y,âˆ—V satisï¬es conditions 1. and 2. of the deï¬nition of the Fourier-Jacobi category

3.4.1.

3.4.9. For each stratum Y and each N âˆˆ Z, there are exact restriction functors

Î¹âˆ—
N

âˆ¶[ Y -FJ-coh ] â†’[ Y -FJ-â‰¥ N -coh ]

which have an exact left-adjoint

Î¹N,! âˆ¶[ Y -FJ-â‰¥ N -coh ] â†ª[ Y -FJ-coh ]

which is given by the natural inclusion (or, in other words, by extension by zero or left Kan extension
for the individual FZ ).

Corollary 3.4.10. For Y and v âˆˆ ZnY appropriate, there are fully-faithful functors of categories

(v)Y,âˆ— âˆ¶ D([ [M âˆ¨

Y~PY]-Coh ]) â†ª D([ M -FJ-â‰¥ N -coh ])

Î¹N,! âˆ¶ D([ M -FJ-â‰¥ N -coh ]) â†ª D([ M -FJ-coh ])

and

for  âˆˆ{b, +, âˆ’, âˆ…}.

Proof. We have in each case a pair of adjoint functors in which the unit, resp. the counit, is an
isomorphism. Since all four functors are exact, they induce functors on the derived categories
without modiï¬cation, and form again pairs of adjoint functors (because the counit/unit-equations
still hold). Since also the unit, resp. the counit, is still an isomorphism we get the requested
fully-faithfulness of the left- (resp. right-) adjoint.

In particular, for Y = M and N = 0 we get that the canonical extension functor (cf. Example 3.4.4)
is fully-faithful on the level of derived categories.

Remark 3.4.11. The statement of Corollary 3.4.10 is also true for the functors

and

(v)Y,âˆ— âˆ¶ D([ [M âˆ¨

Y~PY]-Qcoh ]) â†ª D([ M -FJ-â‰¥ N ])

Î¹N,! âˆ¶ D([ M -FJ-â‰¥ N ]) â†ª D([ M -FJ ]).

We also have the following two lemmas, which however will not be needed in the sequel.

Lemma 3.4.12. The categories [ M -FJ-â‰¥ N ] and [ M -FJ ] do have enough injectives (while
[ M -FJ-â‰¥ ] does not).

22

Proof. For any object {FY} we deï¬ne an injective resolution by
Y F)

M(Y,v),vi â‰¤NY
Y F) is an injective resolution of (v)âˆ—

where I((v)âˆ—
to general products in [ M -FJ-â‰¥ N ] and [ M -FJ ]).

(v)Y,âˆ—I((v)âˆ—
Y F in the category [ [M âˆ¨

right-adjoints of exact functors and âˆ preserve injective objects. Here NY is some appropriate
upper bound for the stratum Y . Note that because of the bound, the product exists (as opposed

Y~PY]-Qcoh ]. Note that

Lemma 3.4.13. The functors

D([ M -FJ-â‰¥ N -coh ]) â†ª D([ M -FJ-â‰¥ N ])

D([ M -FJ-coh ]) â†ª D([ M -FJ-â‰¥ ])

Proof. Follows from (the dual of) [11, Theorem 13.2.8].

are fully-faithful for  âˆˆ{b, âˆ’}.
These two lemmas imply, in particular, that Db([ M -FJ-â‰¥ N -coh ]) and Db([ M -FJ-coh ]) are

locally small.

3.5 Jet bundles in the Fourier-Jacobi categories

3.5.1. We write MY âˆ¶= CY(M) and MY Y for the formal open subscheme on Y . Recall the
deï¬nition of the vector bundle â„¦M(log) on a variety with divisor of normal crossings. Locally the
bundle CY(â„¦M(log)) Y is the bundle â„¦MY  Y(log) (deï¬ned in 2.2.8) on the formally toroidal formal
scheme MY Y , but not on MY ! Recall the description of the associated functor of â„¦MY  Y(log) on
MY Y from 2.2.8.
By Theorem 3.3.10 the vector bundle â„¦M(log) on M can therefore be obtained by glueing and is
associated with the following element in [ M -FJ-lf-coh ]:

FY âˆ¶ v â†¦â§âªâªâ¨âªâªâ©

â„¦M âˆ¨
0

Y

if v â‰¥ 0,

otherwise.

Note that for Z â‰¤ Y the restriction Î±âˆ—
supposed to be an open embedding by deï¬nition.
If the given automorphic data with ï¬‚at logarithmic connection satisï¬es the unipotent monodromy
axiom (M) then the subbundle â„¦M can be described by the following functor

is canonically isomorphic to â„¦M âˆ¨

because Î±ZY is

ZY â„¦M âˆ¨

Z

Y

{Î¾ âˆˆ â„¦M âˆ¨

Y   pi(Î¾) = 0 âˆ€i âˆ¶ vi = 0}

0

if v â‰¥ 0,

otherwise.

(8)

FY âˆ¶ v â†¦â§âªâªâ¨âªâªâ©

Y

âŠ‚ TM âˆ¨

Here pi is given as follows: We have by the unipotent monodromy axiom that there are subbundles
T (i)
given by the Lie algebras ui of 1-dimensional normal unipotent subgroups Ui âŠ‚ GY . (In
M âˆ¨
Y
other words, choosing a base point QY âˆˆ M âˆ¨
is normal, the associated PY -equivariant bundles do not depend on the choice of base point.) pi is
then deï¬ned as the projection dual to this inclusion. By the unipotent monodromy axiom (M) we
have OBY

Y , this is induced by the inclusion ui â†’ pY~qY . Since ui

Y) under the natural PY -equivariant isomorphism

â‹… Ï€âˆ’1(cani,MY) â‰… pâˆ—(T (i)

M âˆ¨

Ï€âˆ—TMY(log) â‰… pâˆ—TM âˆ¨

Y

.

It follows therefore from the proof of Theorem 3.3.10 that â„¦M is associated with this subfunctor.

23

3.5.2. Assume for the rest of the section that there exists a k-valued point in M âˆ¨ and let QM
be the corresponding quasi-parabolic subgroup of PM . The discussion in the preceeding paragraph
enables us to reï¬ne Theorem 3.3.10. Given a QM -representation V or equivalently a PM -equivariant

vector bundle ÌƒV on M âˆ¨ we deï¬ne the object (J nÌƒV)â€² in [ M -FJ-lf-coh ] by

(J nÌƒV)â€²

Y

âˆ¶ v â†¦ J n(ÌƒV)v

where we deï¬ne a ZnY -indexed ï¬ltration on J n(ÌƒV) induced by the dual of the ï¬ltration on
(U(pY) âŠ—U(qY ) V âˆ—)â‰¤n given by the trivial ï¬ltration on V âˆ— and the ï¬ltration on U(pY) which is
the quotient of the induced ï¬ltration on T(pY) (tensor algebra) of the following ï¬ltration on pY :

pY(v) =

(This is essentially the dual of (8).)

â§âªâªâªâªâ¨âªâªâªâªâ©

pY

ui
0

v â‰¥ 0

vi = âˆ’1 and vj â‰¥ 0 âˆ€j ~= i

otherwise.

âŠ‚

morphic vector bundle on M . Then the generalized automorphic sheaf associated with the element

Theorem 3.5.3. Let V be a representation of QM , and let V âˆ¶= Îâˆ—ÌƒV be the corresponding auto-
(J nÌƒV)â€² in [ M -FJ-lf-coh ] is precisely J nV.
3.5.4. Deï¬ne Ï‰M(log) âˆ¶= Î›n(â„¦M(log)), where n = dim(M). By Proposition 3.3.10, this is an
Ï‰M(log) is a generalized automorphic sheaf on M given by the functors

automorphic line bundle associated with Ï‰M âˆ¨ and by the above discussion the subbundle Ï‰M

if vi â‰¥ 1 âˆ€i,
otherwise.

We also deï¬ne the following generalized automorphic sheaves Ï‰Y associated with the functor in

Ï‰Y âˆ¶ v â†¦â§âªâªâ¨âªâªâ©
In other words it is given by Î¹1,! (0)M,âˆ— Ï‰M âˆ¨, where (0)Y,âˆ— is considered as a functor with val-
is associated with the QY -representation Î›n(pY~qY).
ues in [ M -FJ-â‰¥ 1-coh ]. Note that Ï‰M âˆ¨
[ Y -FJ-coh ]:
(Ï‰Y)Y âˆ¶ v â†¦â§âªâªâ¨âªâªâ©
It extends (as canonical extension along smaller strata) to an element Ï‰Y in [ Y -FJ-coh ] (cf.
3.4.8). In other words Ï‰Y is given by Î¹0,! (0)Y,âˆ— Ï‰M âˆ¨
, where (0)Y,âˆ— is considered as a functor with
values in [ M -FJ-â‰¥ 0-coh ].
Lemma 3.5.5. There is an exact sequence in [ M -FJ-coh ]

Ï‰M âˆ¨
0

Ï‰M âˆ¨
0

Y

otherwise.

if v = 0,

Y

Y

Y

0

/ Ï‰

/ Ï‰M âˆ¨

/ à£·Y codim 1 strata Ï‰Y

/ à£·Y codim 2 strata Ï‰Y

/ â‹¯

where the sums go over certain multi-sets of strata which we will not specify because we do not need
them explicitly.

24

/
/
/
/
/
3.6 Automorphic data on toroidal compactiï¬cations of (mixed) Shimura vari-

eties

3.6.1. The toroidal compactiï¬cations of (mixed) Shimura varieties are naturally equipped with
automorphic data with logarithmic connection in the sense of Deï¬nition 3.1.1. We only sketch the
relation with the theory of mixed Shimura varieties and their toroidal compactiï¬cations in this
section, hinting at the reasons for the axioms to be satisï¬ed. The only exception is the boundary
vanishing axiom which will be investigated more in detail.
Firstly we may ï¬x the particular boundary component BY in its conjugacy class such that for Z â‰¤ Y
we get a boundary map BZ â†’ BY , i.e. a closed embedding PBZ
â†ª PBY together with a compatible
open embedding DBY into DBZ . By [8, Main Theorem 2.5.12] to each of these boundary components

BY there exists a â€œcompactâ€ dual Mâˆ¨(BY) (which is only proper for BY = X, i.e. Y = M , if X

is itself pure). It is of the form M âˆ¨
Y as required in the deï¬nition of automorphic data, i.e. a PB-
equivariant component in the classifying space of quasi-parabolics for PB. Except possibly in the
case Y = M if M is already proper (i.e. where there is nothing to compactify) M âˆ¨ is even deï¬ned

over Q and there is a Q-rational point in M âˆ¨(BY), i.e. a quasi-parabolic QY âŠ‚ PBY such that
= PBY~QY . For the deï¬nition of automorphic data, we will, however, consider all varieties and
groups as schemes over the reï¬‚ex ï¬eld E(X).
is a PBY -principal bundle B(KY
M(KY

B) over the mixed Shimura variety M(KY
BY)

The following is a summary of [8, Main Theorem 2.5.14]. For each stratum Y there

BY) together with an

equivariant map to the â€œcompactâ€ dual:

/ Mâˆ¨(BY)

BY)

B(KY

âˆ†Y

3.6.2.

p

Ï€

âˆ†Y

âˆ†Y

M âˆ¨
Y

âˆ†Y

Because of the functoriality (the torus action comes from a morphism of mixed Shimura data) the
morphism p is MnY
m -invariant. These data are compatible
in the sense that if we have strata Z â‰¤ Y then there is a commutative diagram

m -equivariant and the morphism Ï€ is MnY

CZ M(K

âˆ† X)

âˆ¼ /

/ C ÌƒZ

M(KZ

âˆ†Z

BZ)

CY M(K

âˆ† X)

âˆ¼ /

/ CÌƒY

M(KY

âˆ†Y

BY)

p

p

C

pâˆ’1 ÌƒZ

B(KZ

âˆ†Z

BZ)

/ Mâˆ¨(BZ)

C

pâˆ’1 ÌƒY

B(KY

âˆ†Y

BY)

/ Mâˆ¨(BY)

where the maps are functorial w.r.t. relations W â‰¤ Z â‰¤ Y of strata.
The ï¬‚at logarithmic connection can be deï¬ned analytically by means of the ï¬‚at section Î¾ on the
universal cover given as follows:

DBY

Ã— PBY(A(âˆ))~KY

Î¾âˆ¶[Ï„,g]â†¦[Ï„,1,g]

,â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³â³
PBY(Q)Æ’DBY

Ã— PBY(A(âˆ))~KY

PBY(Q)Æ’DBY
That the corresponding connection is deï¬ned over E(G, X) can be deduced from [3, 3.4].

In
purely algebraic constructions of Shimura varieties as moduli spaces it comes from the Gauss-
Manin connection on the cohomology bundle.

Ã— PBY(C) Ã— PBY(A(âˆ))~KY

PBY(C)~QY(C)

25

o
o
/




o
o


/


o
o
/


,
/
/
o
o
3.6.3. The Torelli axiom (T) is immediately clear analytically from the picture above since the
composition

DBY

Ã— PBY(A(âˆ))~KY â†’ PBY(C)~QY(C)

is the Borel open embedding (after projection to the ï¬rst factor). In purely algebraic constructions
of Shimura varieties it corresponds to inï¬nitesimal Torelli theorems of the parametrized objects
which can be proven purely algebraically.

3.6.4. The unipotent monodromy axiom (M) is satisï¬ed because the cone Ïƒ describing a boundary
a is a normal subgroup of PBY . By

â‰… Gu

component sits per deï¬nition in UBY ,R(âˆ’1) and UBY
universal cover correspond to the basis-vectors of (UBY

construction the fundamental vector ï¬elds cani of the action of GnY

BY) lifted to the
âˆ© KY)(âˆ’1) spanning Ïƒ. In cases, in which

m on M(KY

the mixed Shimura variety is constructed using a moduli problem of 1-motives as in [8, 2.7], the
unipotent monodromy axiom can be read oï¬€ from the construction.

âˆ†Y

Proposition 3.6.5 (Boundary vanishing condition (B)). Let Y be a mixed Shimura datum (e.g.

one of the boundary components BY ), let n be the dimension of Mâˆ¨(Y), let Q be one of the
quasi-parabolics parametrized by Mâˆ¨(Y), let Ï‰ be the Q-representation corresponding to the PX-

Mâˆ¨(Y) on Mâˆ¨(Y), and let u be the dimension of UY. Then we have:

equivariant bundle â„¦n

H i([â‹…~Q] , Ï‰) = 0

for all i â‰¥ n âˆ’ u provided u ~= 0.
satisfy dim(Y) â‰¥ n âˆ’ u.

Note that all boundary strata Y which come from rational polyhedral cones in the unipotent cone

Proof. W.l.o.g. we may assume that the base ï¬eld of the category of Q-representations is C and
that all algebraic groups involved are deï¬ned over C. We have the following zoo of connected linear
algebraic groups (cf. [8, 2.2] or [13]):

S = G2
m

P = PY = G â‹… V â‹… U
G = GY
V = VY â‰… G2v
a
U = UY â‰… Gu
a

is a maximal reductive subgroup

h âˆ¶ S â†’ G

any homomorphism in hY(DY)

R = K â‹… R+ = G âˆ© Q

is a parabolic in G (with its Levi decomposition)

R+, Râˆ’ â‰… Gn0
a

V = V + â‹… V âˆ’
V + = Q âˆ© V

Q = R â‹… V + is the quasi-parabolic deï¬ning M âˆ¨(Y)

By deï¬nition of a mixed Shimura datum the Lie algebras of these groups have the following weights
under S:

Lie(U)

(âˆ’1, âˆ’1)

Lie(V +)
Lie(V âˆ’)

(âˆ’1, 0)
(0, âˆ’1)

26

Lie(R+)
Lie(K)
Lie(Râˆ’)

(âˆ’1, 1)
(0, 0)
(1, âˆ’1)

We have the following sequence of aï¬ƒne morphisms

M âˆ¨(Y) = P~(R â‹… V +) â†’ G â‹… V~(R â‹… V +) â†’ G~R

of relative dimensions u = dim(U), and v = dim(V âˆ’), respectively. G~R is a projective ï¬‚ag variety
of dimension n0 = dim(R+).

STEP 1: We have

H i([â‹…~P] , Ï‰) = H i([â‹…~V + â‹… R+] , Ï‰)K

because K is reductive. Furthermore since Ï‰ is 1-dimensional and hence trivial as a V + and R+
representation, we have as K-representations

H i([â‹…~V + â‹… R+] , Ï‰) = H i([â‹…~V + â‹… R+] , C) âŠ— Ï‰.

STEP 2: V + and R+ commute (because there is no part of the Lie algebra of weight (âˆ’2, 1)).
Hence H i([â‹…~V + â‹… R+] , C) is just the cohomology of Gn0+v
H i([â‹…~V + â‹… R+] , C) = Î›i(Lie(V +)âˆ— âŠ• Lie(R+)âˆ—) as natural Aut(V + â‹… R+)-modules [10, p.64, Remark
2)]. Therefore H i([â‹…~V + â‹… R+] , C) = 0 for i > n0 + v and

w.r.t. the trivial representation. Hence

a

H n0+v([â‹…~V + â‹… R+] , C) = Î›n0+v(Lie(V +)âˆ— âŠ• Lie(R+)âˆ—) â‰… C.

STEP 3: Since the last isomorphism is compatible w.r.t. the natural Aut(V + â‹… R+)-actions, we see
that H n0+v([â‹…~V + â‹… R+] , C) is one-dimensional of weight
(v + n0, âˆ’n0)

under S. Also Ï‰ is one-dimensional of weight

(âˆ’u âˆ’ v âˆ’ n0, n0 âˆ’ u).

Therefore

H n0+v([â‹…~V + â‹… R+] , C) âŠ— Ï‰

has weight

(âˆ’u, âˆ’u)

and therefore cannot have any K-invariants as long as u ~= 0.
4 Hirzebruch-Mumford proportionality

4.1 Chern classes

4.1.1.
Let X be a smooth projective complex variety of dimension n. There are several ways
of constructing the Chern classes of vector bundles on X. We will use the following, cf. [2]. Let
E be a vector bundle on X. It deï¬nes an Atiyah extension (where J 1 is the ï¬rst jet bundle (cf.
Section 3.3))

Tensoring with E âˆ— and pulling back along the unit OX â†’ E âˆ— âŠ— E we get an extension

0

/ â„¦1
X

âŠ— E

/ J 1E

/ E

/ 0.

0

/ â„¦1
X

âŠ— End(E)

/ A

/ OX

/ 0.

This might be seen as a morphism

OX â†’ â„¦1
X

âŠ— End(E)[1]

27

/
/
/
/
/
/
/
/
in Db([ OX -Coh ]). The coeï¬ƒcients of the characteristic polynomial of this â€œendomorphismâ€ give

morphisms

ci(E) âˆ¶ OX â†’ â„¦i

X[i].

Furthermore, any polynomial p in the graded polynomial ring Q[c1, c2, . . . , cn] (where deg(ci) = i)

of degree n gives a morphism

p(c1(E), . . . , cn(E)) âˆ¶ OX â†’ â„¦n

X[n] =âˆ¶ Ï‰X[n].

The corresponding extension p(c1(E), . . . , cn(E)) âˆˆ Extn(OX , Ï‰X) can be constructed explicitly
using only locally free sheaves. Using the trace map tr âˆ¶ Extn(OX , Ï‰X) â†’ k of Serre duality, we get
elements tr(p(c1(E), . . . , cn(E))) âˆˆ k. The compatibility with other constructions of Chern classes
using algebraic cycles shows that even tr(p(c1(E), . . . , cn(E))) âˆˆ Q.

4.2 Proportionality

Theorem 4.2.1 (Hirzebruch-Mumford proportionality). Let M be a toroidal compactiï¬cation of
dimension n equipped with automorphic data with logarithmic connection which satisï¬es the axioms
(F, T, M, B) and such that PM is reductive. There is c âˆˆ Q such that for all polynomials p of

degree n in the graded polynomial ring Q[c1, c2, . . . , cn] and all PM -equivariant vector bundles E in
[ [M âˆ¨~PM]-Coh ] the proportionality

p(c1(E), . . . , cn(E)) = c â‹… p(c1(Îâˆ—E), . . . , cn(Îâˆ—E))

holds true.

Proof. Starting from the sequence in [ M -FJ-coh ] (cf. 3.5.2 for the deï¬nition of J 1(E)â€²):

0

/ (â„¦1)â€² âŠ— E

/ J 1(E)â€²

/ E

/ 0

by the procedure described in the last section we can construct an element

Ìƒp(E) âˆˆ Extn

[ M -FJ-coh ](O, Ï‰).

Note that in the construction only the tensor product of locally free objects is involved and the
exactness of âŠ— on sequences involving those.
Consider the following two compositions of functors

Db([ M -FJ-coh ])

Db(Îâˆ—)

/ Db([ O

M -Coh ])

Db([ M -FJ-coh ])
The images of the morphism Ìƒp(E) âˆ¶ O â†’ Ï‰[n] give

/ Db([ M -FJ-coh ])

p(c1(E), . . . , cn(E))

and

Db([ [M âˆ¨~PM]-Coh ])

/ Db([ OM âˆ¨-Coh ]).

p(c1(Îâˆ—E), . . . , cn(Îâˆ—E))

respectively. Here it is used that Îâˆ— is an exact functor that is compatible with the tensor product
when restricted to locally free (or even torsion-free) objects, that by Theorem 3.5.3 the image of

J 1(E)â€² under Îâˆ— is precisely J 1(Îâˆ—E), and that the image under the second functor is J 1(E) where
the PM -action on E is forgotten (by deï¬nition of J 1(E)â€²).

The theorem therefore follows from Proposition 4.2.2 below. In the compact case, i.e. if M = M ,
and PM is reductive, this is easier and Lemma 4.2.3 can be applied.

28

/
/
/
/
/
/
/
Proposition 4.2.2. If PM is reductive, we have

dim(Extn

[ M -FJ-coh ](O, Ï‰)) â‰¤ 1.

Proof. By Proposition 3.5.5 we have an exact sequence

0

/ Ï‰

/ Ï‰M âˆ¨

/ D

/ 0

and a ï¬nite resolution

0

/ D

/ à£·Y codim 1 strata Ï‰Y

/ à£·Y codim 2 strata Ï‰Y

/ â‹¯

(9)

We get the long exact sequence

Extnâˆ’1(O, D)

/ Extn(O, Ï‰)

/ Extn(O, Ï‰M âˆ¨)

/ Extn(O, D)

(all Ext-groups are computed in the category [ M -FJ-coh ]). By Lemma 4.2.3 below the dimension
of Extn(O, Ï‰M âˆ¨) is at most one. Hence it suï¬ƒces to show that Extnâˆ’1(O, D) = 0. Splitting up the
exact sequence (9) into short exact sequences one sees that it suï¬ƒces to show that Exti(O, Ï‰Y) = 0
for i â‰¤ dim(Y) and for Y ~= M . We have fully-faithful embeddings (cf. Corollary 3.4.10)

Db([ [â‹…~PY]-Coh ]) â†ª Db([ M -FJ-â‰¥ 0-coh ])) â†ª Db([ M -FJ-coh ])

such that the image of Ï‰M âˆ¨
Furthermore we have

Y

= Î›n

pY~qY under the composition is Ï‰Y .

Hence

HomDb([ M -FJ-coh ])(Î¹0,! Î¹âˆ—
= HomDb([ M -FJ-â‰¥ 0-coh ])(Î¹âˆ—
= HomDb([ M âˆ¨

Y ~PY (cid:6)-Coh ])(OM âˆ¨
Y~PY] , Ï‰M âˆ¨
H i([M âˆ¨

Y

0 O.

O = Î¹0,! Î¹âˆ—
0 O, Î¹0,!(0)âˆ— Ï‰M âˆ¨
0 O,(0)âˆ— Ï‰M âˆ¨
Y[i])
Y[i])

, Ï‰M âˆ¨

Y[i])

Y) = 0 for i â‰¥ dim(Y).

Therefore the Proposition follows from boundary vanishing condition (axiom B):

(fully-faithfulness)
(adjunction)

Lemma 4.2.3. If PM is reductive, we have

dim(Extn

[ M -FJ-coh ](O, Ï‰M âˆ¨)) â‰¤ 1.

Proof. We have a fully-faithful embedding (cf. Corollary 3.4.10)

Db([ [M âˆ¨~PM]-Coh ]) â†ª Db([ M -FJ-coh ]).

The functor R Hom(O, âˆ’) is the same as the composion

Db([ [M âˆ¨~PM]-Coh ]) â†’ Db([ [â‹…~PM]-Coh ]) â†’ Db([ spec(k)-Coh ])

where the ï¬rst functor is the right derived functor of taking global sections and the second is the
functor of PM -invariants. However, the last functor is exact (because PM is reductive) and therefore
we have

Since H n(M âˆ¨, Ï‰M âˆ¨) is one-dimensional by Serre duality, the Lemma follows.

Extn

[ M -FJ-coh ](O, Ï‰M âˆ¨) = H n(M âˆ¨, Ï‰M âˆ¨)PM .

Remark 4.2.4. For the compact dual associated with a pure Shimura datum this can also be seen
from the explicit calculation in the proof of Proposition 3.6.5, which shows that the dimension is in
fact one.

29

/
/
/
/
/
/
/
/
/
/
/
References

[1] A. Ash, D. Mumford, M. Rapoport, and Y.-S. Tai. Smooth compactiï¬cations of locally sym-
metric varieties. Cambridge Mathematical Library. Cambridge University Press, Cambridge,
second edition, 2010. With the collaboration of Peter Scholze.

[2] M. F. Atiyah. Complex analytic connections in ï¬bre bundles. Trans. Amer. Math. Soc., 85:

181â€“207, 1957.

[3] M. Harris. Arithmetic vector bundles and automorphic forms on Shimura varieties. I. Invent.

Math., 82(1):151â€“189, 1985.

[4] M. Harris. Arithmetic vector bundles and automorphic forms on Shimura varieties. II. Com-

positio Math., 60(3):323â€“378, 1986.

[5] M. Harris and S. Zucker. Boundary cohomology of Shimura varieties. I. Coherent cohomology

on toroidal compactiï¬cations. Ann. Sci. Â´Ecole Norm. Sup. (4), 27(3):249â€“344, 1994.

[6] F. Hirzebruch. Automorphe Formen und der Satz von Riemann-Roch. In Symposium interna-
cional de topologÂ´Ä±a algebraica International symposium on algebraic topology, pages 129â€“144.
Universidad Nacional AutÂ´onoma de MÂ´exico and UNESCO, Mexico City, 1958.

[7] F. HÂ¨ormann. The arithmetic volume of Shimura varieties of orthogonal type. PhD thesis,

Humboldt-UniversitÂ¨at zu Berlin, 2010.

[8] F. HÂ¨ormann. The geometric and arithmetic volume of Shimura varieties of orthogonal type,
volume 35 of CRM Monograph Series. American Mathematical Society, Providence, RI, 2014.

[9] F. HÂ¨ormann. Descent for coherent sheaves along formal/open coverings. arXiv: 1603.02150,

2015.

[10] J. C. Jantzen. Representations of algebraic groups, volume 107 of Mathematical Surveys and
ISBN

Monographs. American Mathematical Society, Providence, RI, second edition, 2003.
0-8218-3527-0.

[11] M. Kashiwara and P. Schapira. Categories and sheaves, volume 332 of Grundlehren der
Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences]. Springer-
Verlag, Berlin, 2006.

[12] D. Mumford. Hirzebruchâ€™s proportionality theorem in the noncompact case. Invent. Math.,

42:239â€“272, 1977.

[13] R. Pink. Arithmetical compactiï¬cation of mixed Shimura varieties. Bonner Mathematische
Schriften [Bonn Mathematical Publications], 209. UniversitÂ¨at Bonn, Mathematisches Institut,
Bonn, 1990. Dissertation, Rheinische Friedrich-Wilhelms-UniversitÂ¨at Bonn, Bonn, 1989.

30

