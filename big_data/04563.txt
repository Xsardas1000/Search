6
1
0
2

 
r
a

 

M
5
1

 
 
]
T
N
h
t
a
m

.

[
 
 

1
v
3
6
5
4
0

.

3
0
6
1
:
v
i
X
r
a

Non-emptiness of Newton strata of Shimura varieties of Hodge type

Dong Uk Lee

Abstract

For a Shimura variety of Hodge type with hyperspecial level at a prime p, the Newton
stratiï¬cation on its special ï¬ber at p is a stratiï¬cation deï¬ned in terms of the isomorphism class
of the Dieudonne module of parameterized abelian varieties endowed with a certain ï¬xed set
of Frobenius-invariant crystalline cycles (â€œF -isocrystal with GQp -structureâ€). There has been a
conjectural group-theoretic description of the F-isocrystals that are expected to show up in the
special ï¬ber. We conï¬rm this conjecture by two diï¬€erent methods. More precisely, for any F -
isocrystal with GQp -structure that is expected to appear (in a precise sense), ï¬rst we construct
a special point which has good reduction and whose reduction has associated F -isocrystal equal
to given one. Secondly, we produce a Kottwtiz triple (with trivial Kottwitz invariant) with
the F -isocrystal component being the given one. According to a recent result of Kisin which
establishes the Langlands-Rapoport conjecture, such Kottwitz triple arises from a point in the
reduction.

Contents

1 Introduction

2 F -isocrystals and Newton maps for reductive groups over p-adic ï¬elds

2.1 Preliminaries
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Newton maps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

6
6
7

3 Newton stratiï¬cation on good reduction of Shimura variety

9
9
3.1
3.2 Newton stratiï¬cation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

Integral canonical model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Construction of special Shimura datum with prescribed F -isocrystal

18

4.1 Construction of special Shimura datum with prescribed F -isocrystal satisfying con-

dition (â€ )

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
4.2 Aï¬ƒne Deligne-Lusztig varieties and veriï¬cation of the assumption (â€ )
. . . . . . . . 21
4.3 First proof of non-emptiness of Newton strata . . . . . . . . . . . . . . . . . . . . . . 27

5 Construction of Kottwitz triple with prescribed F -isocrystal

29
5.1 Kottwitz triples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
5.2 Kottwitz invariant
5.3 Second proof of non-emptiness of Newton strata
. . . . . . . . . . . . . . . . . . . . 32

A A lemma on algebraic groups over p-adic ï¬elds

36

1

1

Introduction

Fix a prime p > 0, and for g â‰¥ 1, let Ag be the moduli space of principally polarized abelian
varieties of dimension g in characteristic p. Then, the Newton stratiï¬cation on Ag is the stratiï¬-
cation such that each stratum consists of points x = (Ax, Î»x) whose associated p-divisible group
(Ax[pâˆ], Î»x[pâˆ]) with quasi-polarization is quasi-isogenous to a ï¬xed one. The DieudonnÂ´e module
D(X) of a p-divisible group X over a perfect ï¬eld k of characteristic p > 0 provides an equiv-
alence of categories between the isogeny category of (quasi-polarized) p-divisible groups and the
category of (quasi-polarized) F -isocrystals. An F -isocrystal (or simply isocrystal) over a perfect
ï¬eld k of chark = p is a ï¬nite-dimensional L(k)-vector space M with a Ïƒ-linear bijective operator
Î¦ : M â†’ M , where L(k) := Frac(W (k)) and Ïƒ is its Frobenius automophism. According to the
DieudonnÂ´e-Manin classiï¬cation, an isocrystal over an algebraically closed ï¬eld is determined by the
slope sequence of Î¦. The latter combinatorial datum in turn can be faithfullly represented by a
lower-convex (piecewise-linear) polygon with integral break points lying in the ï¬rst quadrant of Z2,
which will be called Newton polygon hereafter. In other words, the Newton polygon of D(Ax[pâˆ])
determines the quasi-isogeny class of Ax[pâˆ]. The existence of a quasi-polarization forces the New-
ton polygon of D(Ax[pâˆ]) to be â€œsymmetricâ€. Then, a natural question arises which symmetric
Newton polygon can be the Newton polygon of a point of Ag. In fact, the Newton polygons arising
from points of Ag in the just described way meet two more restrictions. First, when the initial
point is located at the origin, the end point is always (2g, g) âˆˆ Z2. Secondly, it â€œlies aboveâ€ the
ordinary Newton polygon, which by deï¬nition is the Newton polygon having two slopes (0, 1) with
same multiplicities g. And, it has long been known (after it was conjectured by Manin) that any
Newton polygon subject to these two restraints is the Newton polygon of a point on Ag; a proof can
be found e.g. in [Oor13, Cor.7.8], which uses the Honda-Tate theory, thus gives examples deï¬ned
over ï¬nite ï¬elds.

The main result of this article is a generalization of this fact to more general moduli spaces of

abelian varieties, namely to Shimura varieties of Hodge type.

Let (G, X) be a Shimura datum of Hodge type. This means that there exists an embedding of
Shimura data (G, X) Ö’â†’ (GSp(W, Ïˆ), HÂ±
g ) into a Siegel Shimura datum, in the sense that there exists
an embedding ÏW : G Ö’â†’ GSp(W, Ïˆ) of Q-groups which sends each morphism in X to a member
of HÂ±
g ; we ï¬x such an embedding. For a compact open subgroup K âŠ‚ G(Af ) (which will be tacitly
assumed suï¬ƒciently small), the associated (canonical model over the reï¬‚ex ï¬eld E(G, X) of the)
Shimura variety ShK(G, X) parameterizes polarized abelian varieties endowed with a ï¬xed set of
(absolute) Hodge cycles and a K-level structure, and carries a universal family of abelian varieties
A â†’ SK := ShK(G, X) equipped with a similar set of (absolute Hodge) tensors on H 1
dR(A/SK ).
To study its reduction modulo p, we ï¬x a prime â„˜ of E := E(G, X) and let O := O(â„˜) be the
localization at â„˜ of the ring of integers of E with residue ï¬eld Îº(â„˜). To obtain an integral model
over O with good reduction, we assume that G âŠ—Q Qp is unramiï¬ed, which is the same as that there
exists a reductive group scheme GZp over Zp with generic ï¬bre G âŠ— Qp. We choose one such model
GZp and set Kp := GZp(Zp) (such compact open subgroups of G(Qp) are called hyperspecial).
For K, we take K = Kp Ã— K p for a (suï¬ƒciently small) compact open subgroup K p âŠ‚ G(Ap
f ).
Then, by Vasiu ([Vas99]) and Kisin ([Kis10]), it is known that there exists a smooth integral model
SK := SK(G, X) over O with generic ï¬bre SK, which is furthermore uniquely characterized by
a â€œNeron-extension propertyâ€, and has a universal abelian scheme A over it by construction (see
Â§3.1 for details). To deï¬ne the F -isocrystal attached to a point of the reduction SK âŠ—O Îº(â„˜), we

2

ï¬x (for simplicity) an algebraically closed ï¬eld k of ï¬nite transcendence degree over Â¯Fp. Let z be a
point of SK âŠ—O Îº(â„˜) deï¬ned over k. By smoothness of SK and the moduli interpretation of SK,
the Dieudonne module D(Az) is supplied with a set of Frobnius-invariant tensors {tÎ±,z}Î±âˆˆJ , and
there exists an L(k)-isomorphism between the dual space W âˆ¨ âŠ— L(k) and the Dieudonne module
D(Az) which matches the G-invariant tensors on W âˆ¨ and the tensors {tÎ±,z}Î±âˆˆJ on D(Az), which
is thus canonically determined up to the action of GL(k) on W âˆ¨
L(k) (cf. Â§3.2). Choosing such an
isomorphism, we transport the Frobenius operator Î¦ to W âˆ¨
L(k) and get an element b âˆˆ G(L(k)) by
Î¦ = ÏW âˆ¨(b)(idW âˆ¨ âŠ— Ïƒ), where ÏW âˆ¨ : G Ö’â†’ GL(W âˆ¨) is the contragredient representation of the
symplectic representation ÏW ï¬xed above. Recall that two elements g1, g2 of G(L(k)) are called
Ïƒ-conjugate if there exists h âˆˆ G(L(k)) with g2 = hg1Ïƒ(h)âˆ’1. Then, the Ïƒ-conjugacy class b of b is
independent of the choice of an isomorsphim W âˆ¨
L(k) â†’ D(Ax) just explained, and the isomorphism
class of the F -isocrystal (D(Az), Î¦) equipped with the Frobenius-invariant tensors {tÎ±,z}Î±âˆˆJ , called
F -isocrystal with GQp-structure, corresponds to a unique Ïƒ-conjugacy class of elements of G(L(k)).
If B(GQp) denotes the set of the Ïƒ-conjugacy classes of elements of G(L(k)), there exists a subset
B(GQp, X) of B(GQp) which is expected to be the set of isocrystals with GQp-structure coming
from points on SK âŠ—O Îº(â„˜). We remark that this is a subset of B(GQp) deï¬ned by certain two
conditions that are analogues of those discussed above in the Siegel case, and it is easy to see that
for any point of SK âŠ—O Îº(â„˜), its associated F -isocrystal with GQp-structure belongs to this subset
B(GQp, X). A detailed presentation of the discussion in this paragraph is given in Section 3.

For b âˆˆ B(GQp, X), let S

b be the subset of points of SK âŠ—O Îº(â„˜) whose associated F -isocrystal
with GQp-structure is b. The main result of this paper is then that for every b âˆˆ B(GQp, X),
b is non-empty. We present two proofs. The main idea of the ï¬rst proof is to ï¬nd a special
S
point with required reduction property. We recall that a point [h, gf Â· K] âˆˆ ShK(G, X)(C) =
G(Q)\X Ã— G(Af )/K is called special if h âˆˆ X factors through TR for some maximal Q-torus T
of G. Special points are known to be deï¬ned over Q âŠ‚ C and correspond to abelian varieties
with complex multiplication. More precisely, in the ï¬rst proof, we construct a special point which
extends to a point SK(OÎ¹p), where OÎ¹p is the valuation ring of Q deï¬ned by chosen embedding
Î¹p : Q Ö’â†’ Qp (in which case, we will say that it has good reduction at Î¹p) and such that the isocrystal
of its reduction in SK(Â¯Fp) is the given isocrystal.

Theorem 1.0.1 (Thm. 4.3.1). Let (G, X) be a Shimura datum and p a rational prime. Assume
that GQp is unramiï¬ed. Fix a hyperspecial subgroup Kp of G(Qp) and a suï¬ƒciently small compact
open subgroup K p âŠ‚ G(Ap
f ); put K = Kp Ã— K p. Choose a prime â„˜ of E(G, X) above p, and an
embedding Î¹p : Q Ö’â†’ Qp inducing â„˜.

Then, for every b âˆˆ B(GQp, X), there exists a special sub-Shimura datum (T, h âˆˆ Hom(S, TR) âˆ©
X) such that TQp is unramiï¬ed and the (unique) hyperspecial subgroup of T (Qp) is contained in
Kp, and that the Ïƒ-conjugacy class of Âµâˆ’1

p ) equals b.

h (p) âˆˆ G(Qur

In particular, if (G, X) is of Hodge type, for every gf âˆˆ G(Af ), the special point [h, gf ]K âˆˆ

ShK(G, X)(Q) has good reduction at Î¹p and the F -isocrystal of its reduction in SK (Â¯Fp) is b.

The non-emptiness of Newton strata has been conjectured by Fargues [Far04, Conjecture 3.1.1]
and Rapoport [Rap05, Conjecture 7.1]. And, some partial cases conï¬rming this conjecture were
known.
In this introduction, we only mention previous works in two directions. For PEL-type
Shimura varieties (which form a subclass of Hodge-type Shimura varieties), this conjecture (i.e.
non-emptiness of all Newton strata in B(GQp, X)) was proved by C.-F. Yu [Yu05] in the Lie-type

3

C cases, then by Viehmann-Wedhorn [VW13, Thm.1.6] in general cases, and by Kret [Kre13] for
some simple groups of Lie type A or C. For a general Hodge-type Shimura variety, to the best of the
authorâ€™s knowledge, there are two partial results. First, Wortmann [Wor13] showed non-emptiness
of Âµ-ordinary locus; the Âµ-ordinary locus is a generalization of the (usual) ordinary locus in Ag.
And, for projective Shimura varieties of Hodge type, Koskivirta [Kos14] proved the conjecture
(non-emptiness of all Newton strata).

While all these previous results on the non-emptiness of Newton strata, except for that of Kret,
are obtained by characteristic-p geometric methods, which are often of limited applicability for
Hodge-type Shimura varieties, we draw readerâ€™s attention to that the ï¬rst claim of our theorem
above is a purely group-theoretic statement on Shimura data without any reference to geometry of
Shimura variety. When the Shimura datum is of Hodge type, this group-theoretic statement carries
a geometric meaning of the second claim (by Lemma 3.2.4). In this geometric interpretation of
the group-theoretic statement of the ï¬rst claim, the only geometric property that we use about the
canonical integral model SK is the Neron-extension property, which is in the end a consequence of
smoothness of SK .

We also point out that our method of proof of the theorem, more precisely that of constructing
a special point with certain prescribed properties, allows us to obtain some ï¬ner results. First,
as already apparent, we prove more than just non-emptiness of Newton strata, namely we show
existence of a special point whose reduction lying in any given Newton stratum. As another
example, we also prove a generalization of a result of Wedhorn [Wed99, (1.6.3)] (the next result in
the PEL-type cases of Lie type A or C) (by argument diï¬€erent from the original one of Wedhorn,
cf. Remark 4.3.3).

Corollary 1.0.2. (Cor. 4.3.2) Let (G, X) be a Shimura datum of Hodge type. Suppose that GQp is
unramiï¬ed and choose a hyperspecial subgroup Kp of G(Qp). Let â„˜ be a prime of E(G, X) above p.
Then the reduction SKp(G, X) Ã— Îº(â„˜) has non-empty ordinary locus if and only if â„˜ has absolute
height one (i.e. E(G, X)â„˜ = Qp).

Our second proof of the non-emptiness of Newton strata is by construction of a Kottwtiz triple.

A Kottwitz triple is a triple of elements in the product

(Î³0; Î³ = (Î³l)l6=p, Î´) âˆˆ G(Q) Ã— G(Ap

f ) Ã— G(Qur
p ),

satisfying certain compatibility conditions among themselves and some other conditions.
It has
been expected that one can attach such triple to every point of SK over a ï¬nite ï¬eld, such that
Î³l(l 6= p) is the (relative) Frobenius acting on the l-adic etale cohomology and Î´ is the (absolute)
Frobenius on the crystalline cohomology of the abelian variety corresponding to the point. This
was established by Kisin in the course of his proof of the Langlands-Rapoport conjecture ([Kis13]).
In fact, this Langlands-Rapoport conjecture implies that every Kottwitz triple meeting suitable
conditions (especially, vanishing of the Kottwitz invariant) also comes from a point over a ï¬nite
ï¬eld. Therefore, in view of this, our second proof is deduced from the following result:

Theorem 1.0.3 (Thm. 5.3.1, Cor. 5.3.3). Keep the assumptions and notations from the above
theorem, and assume further that the derived group Gder of G is simply connected.

Then, for every b âˆˆ B(GQp, X), there exists a Kottwitz triple (Î³0; Î³, Î´) âˆˆ G(Q Ã— Ap

p ) with
Î´ âˆˆ b and having trivial Kottwitz invariant. In particular, there exists a point x âˆˆ ShKp(G, X)(Â¯Fp)
whose associated F -isocrystal is b, where Â¯Fp is an algebraic closure of Îº(â„˜).

f Ã— Qur

4

We refer readers to Â§6 for the deï¬nitions of Kottwitz triple and Kottwitz invariant, and also to

Theorem 5.3.1 for a more precise statement of the result in this theorem.

Our two proofs of the non-emptiness of Newton strata are not unrelated. Both are based on
the fact that for every b âˆˆ B(GQp, X), the condition (â€ ) in Theorem 4.1.1 holds. We verify this
in Proposition 4.2.4 in two ways. In fact, this was proved in [LR87], Lemma 5.11. However, we
also present our own proof which was found before the proof of Langalnds-Rapoport came to our
attention. Our proof is similar to theirs, but also diï¬€ers in details.

Finally, we remark that since our methods of proof of the above results are purely group-
theoretic (making heavy use of Galois cohomology of algebraic groups), they are very likely to
apply to more general Shimura varieties, particularly to Shimura varieties of abelian-type and/or
with non-hyperspecial level. We did not pursue such ideas in this article, though.

This article is organized as follows. In Section 2, we give a brief account of the theory of Newton
map for reductive groups over p-adic ï¬elds and provide a collection of some basic facts. In Section
3, we review the construction of the canonical integral model SKp(G, X) of a Hodge-type Shimura
variety ShKp(G, X) with hyperspecial level, due to Vasiu and Kisin, and the Newton stratiï¬cation
on its (good) reduction SKp(G, X) âŠ— Îº(â„˜). Here, we give a criterion when a special point on
ShK(G, X) has good reduction at given embedding Î¹p : Q Ö’â†’ Qp, and identiï¬es the F -isocrystal of
its reduction in terms of the deï¬ning special Shimura datum. Section 4 is devoted to the ï¬rst proof
of the non-emptiness of Newton strata, by constructing a special point with good reduction at Î¹p
and with prescribed F -isocrystal. Our construction is carried out, assuming that given isocrystal
b âˆˆ B(GQp) satisï¬es the condition (â€ ) in Theorem 4.1.1. Then, we verify that the condition (â€ )
holds for every isocrystal b âˆˆ B(GQp). We ï¬rst present the proof of Langlands-Rapoport [LR87,
Lemma5.11] of this, and then our own argument. Combining these results, we get our ï¬rst proof
of non-emptiness of Newton strata. As a corollary, we also obtain a criterion of when the good
reduction of a Shimura variety with hyperspecial level has an ordinary point. In the ï¬nal section,
Section 5, we give our second proof of the non-emptiness of Newton strata, by constructing a
Kottwtiz triple with prescribed isocrystal component. We begin by a review of the deï¬nitions
of Kottwitz triple and Kottwitz invariant. Our construction of such Kottwitz triple (with trivial
Kottwitz invariant) also uses the aforementioned fact that every isocrystal b âˆˆ B(GQp, X) satisï¬es
the condition (â€ ).

Acknowledgements This work was supported by IBS-R003-D1. Also, parts of this research
were conducted during the authorâ€™s stay at PMI (Pohang Mathematics Institute), Postech, and
ASARC (Algebraic Structures and Applications Research Center), Kaist, with support from the
National Research Foundation of Korea (NRF) funded by the Korea government (MSIP) (No.
2011-0030749 and No. 2012-0000798).

Notations
Throughout this paper, Q denotes the algebraic closure of Q inside C (so Q has a previliged

embedding into C).

For a (connected) reductive group G over a ï¬eld, we let Gsc be the universal covering of its
derived group Gder, and for a (general linear algebraic) group G, Z(G) and Gad denote its center
and the adjoint group G/Z(G), respectively.

5

2 F -isocrystals and Newton maps for reductive groups over p-adic

ï¬elds

In this section, we give a brief review of the Newton map which is deï¬ned for connected reductive
groups over p-adic ï¬elds. For more details on the material discussed in this section, see, e.g. [Kot85],
[RR96], [Rap05] and references therein.

2.1 Preliminaries Let G be a connected reductive group over an arbitrary ï¬eld F of charac-
teristic zero.

2.1.1 Any Borel pair (T, B) of GF (i.e. T is a maximal torus of GF and B is a Borel subgroup of
GF containing T ) determines a based root datum

BR(G, T, B) = (X âˆ—(T ), Râˆ—(T ), Xâˆ—(T ), Râˆ—(T ), âˆ†(T, B)),

where R(G, T ) = (X âˆ—(T ), Râˆ—(T ), Xâˆ—(T ), Râˆ—(T )) is the root datum of (G, T ) (the usual notation)
and âˆ†(T, B) is the root base of Râˆ—(T ) determined by B. A based root datum of G has a canonical
Galois action Ï„ : Gal(F /F ) â†’ Aut(BR(G, T, B)) [Spr98, 15.5] such that for x âˆˆ X âˆ—(T ), Ïƒ âˆˆ
Gal(F /F ),

Ï„ (Ïƒ)x = gÏƒ(x)gâˆ’1,

where g âˆˆ G(F ) satisï¬es gÏƒ(T, B)gâˆ’1 = (T, B); this action can be also understood as a natural
action of Gal(F /F ) on the orbit space Xâˆ—(T )/â„¦(G, T ), where â„¦(G, T ) = NG(T )/ZG(T ) is the Weyl
group of G, i.e. NG(T ) (resp. ZG(T )) is the normalizer (resp. centralizer) of T in G.

2.1.2 Let C(T, B) âŠ‚ Xâˆ—(T )Q be the closed Weyl chamber corresponding to a root base âˆ†(T, B)
of Râˆ—(T ):

C(T, B) = {x âˆˆ Xâˆ—(T )Q | hÎ±, xi â‰¥ 0, âˆ€Î± âˆˆ âˆ†(T, B)}.

This is a fundamental domain for the action of the Weyl group on Xâˆ—(T )Q and is stable under
the action of Gal(F /F ) just deï¬ned. Note that when T is deï¬ned over F , we also have a â€œnaiveâ€
Galois action on Xâˆ—(T ) deï¬ned in terms of the F -structure of T only.
In this article, we call
the former action on C(T, B) canonical action, to distinguish it from the naive action on Xâˆ—(T ).
When G is quasi-split, i.e. when there is a Borel subgroup B of G deï¬ned over F , the naive action
on Xâˆ—(T ) restricts to the canonical action on C(T, B). For any other Borel pair (T â€², Bâ€²), there
is g âˆˆ G(F ) such that (T â€², Bâ€²) = g(T, B)gâˆ’1 and the resulting isomorphism of based root data
âˆ¼â†’ BR(G, T â€², Bâ€²) is independent of the choice of g and is Gal(F /F )-equivariant. The
BR(G, T, B)
based root datum BR(G) = (X âˆ—, Râˆ—, Xâˆ—, Râˆ—, âˆ†) of G is the projective limit of all such based root
data BR(G, T, B) (where (T, B) runs through the set of Borel pairs of GF ). This is equipped with
a canonical Galois action Gal(F /F ) â†’ Aut(BR(G)).

2.1.3 For an algebraically closed extension K of F , let CG(K) denote the set of G(K)-conjugacy
classes of (algebraic group) homomorphisms Gm,K â†’ GK . Then, for any maximal torus T of GF ,
we have a canonical identiï¬cation

CG(K) âˆ¼= Xâˆ—(T )/â„¦.

In particular, we have CG(K) = CG(F ) for any algebraically closed extension K of F .

6

2.2 Newton maps Next, we review the deï¬nition of Newton map. Let k be an algebraically
closed ï¬eld of characteristic p, and let W (k) (resp. K0 = L(k)) be its Witt vector ring (resp. the
fraction ï¬eld of W (k)). Fix an algebraic closure K0 of K0. In this subsection, let F be a ï¬nite
extension of Qp in K0, and let L be the composite of K0 and F in K0; for our application to
Shimura varieties, the most interesting case is when k = Â¯Fp, F = Qp so that L = L(Â¯Fp). Denote
by Ïƒ the Frobenius automorphism on K0 (and its extension to an element of Aut(L/F )). Let G be
a connected reductive group G over F . Let GalF := Gal(F /F ).

2.2.1 Let B(G) be the set of Ïƒ-conjugacy classes in G(L):

B(G) = G(L)/ âˆ¼,

where two elements x, y of G(L) are Ïƒ-conjugated, denoted by x âˆ¼ y, if x = gyÏƒ(g)âˆ’1 for some
g âˆˆ G(L). An element of B(G) is called (F -)isocrystal with G-structure.

2.2.2 Let D be the pro-algebraic torus with character group Q. We deï¬ne N (G) to be the set of
Ïƒ-invariants in the set of conjugacy classes of homomorphisms DL â†’ GL:

N (G) = (Int G(L) \ HomL(D, G))hÏƒi,

where hÏƒi denotes the inï¬nite cyclic group generated by Ïƒ (and is endowed with the discrete
topology). For example, when G = T is a torus, we have N (T ) = Xâˆ—(T )GalF âŠ— Q.

If T âŠ‚ G is a maximal F -torus with (absolute) Weyl group â„¦, there is a natural identiï¬cation

N (G) = (Xâˆ—(T )Q/â„¦)GalF .

In particular, if G is quasi-split and T is a maximal F -torus contained in a Borel subgroup B
deï¬ned over F , N (G) can be identiï¬ed with the subset of GalF -invariants in C(T, B).

Theorem 2.2.3. [RR96, Theorem 1.8] For b âˆˆ G(L), there exists a unique element Î½ = Î½b âˆˆ
HomL(D, G) for which there are an integer s > 0, an element c âˆˆ G(L) and a uniformizing element
Ï€ of F such that:

(i) sÎ½ âˆˆ HomL(Gm, G).
(ii) Int(c) â—¦ sÎ½ is deï¬ned over the ï¬xed ï¬eld of Ïƒs in L.
(iii) c Â· b Â· Ïƒ(b) Â· Â· Â· Ïƒsâˆ’1(b) Â· Ïƒs(c)âˆ’1 = c Â· (sÎ½)(Ï€) Â· câˆ’1.

The map b 7â†’ Î½b has the following properties.

(a) Î½Ïƒ(b) = Ïƒ(Î½b).
(b) gbÏƒ(g)âˆ’1 7â†’ Int(g) â—¦ Î½, g âˆˆ G(L).
(c) Î½b = Int(b) â—¦ Ïƒ(Î½b).

By the properties (b) and (c), we obtain a well-deï¬ned map Î½G : B(G) â†’ N (G). The induced
functorial map Î½, deï¬ned on the category of connected reductive groups, is called the Newton map:

Î½ : B(Â·) â†’ N (Â·) ; Î½G(b) = Î½b,

b âˆˆ b.

Here, b (resp. Î½b) is the Ïƒ-conjugacy class of b (resp. the conjugacy class of Î½b). When G = GLh,
B(G) classiï¬es the isomorphism classes of Ïƒ âˆ’ L-spaces of height h, and the Newton map sends a
Ïƒ âˆ’ L-space of height h to its Newton polygon which is represented in N (G) by the corresponding
slope homomorphism (cf. Example 1.10 of [RR96]).

7

2.2.4 Recall the canonical action of GalF on a based root datum BR(G, T, B) (cf. Subsection
2.1). The induced action of GalF on

Ï€1(G, T ) := Xâˆ—(T )/Î£Î±âˆˆâˆ†(G,T )ZÎ±âˆ¨

is independent of the choice of B, where Î¦(G, T ) denotes the set of roots of T and for Î± âˆˆ Î¦(G, T ),
Î±âˆ¨ is the coroot of Î±. Moreover, for another maximal torus T â€² of G, we have a canonical isomorphism
Ï€1(G, T ) = Ï€1(G, T â€²) of GalF -modules. The algebraic fundamental group Ï€1(G) of G is deï¬ned
to be this common GalF -module; The functor is an exact functor from the category of connected
reductive groups over F to the category of ï¬nitely generated discrete Î“F -modules, cf. [RR96, 1.13].
For a torus T = G, we have

Ï€1(T ) = Xâˆ—(T ).

The functor Ï€1(Â·)GalF âŠ— Q deï¬nes an exact functor from the category of connected reductive groups
over F to the category of ï¬nite-dimensional Q-vector spaces. There is a canonical isomorphism

X âˆ—(Z(bG)GalF ) = Ï€1(G)GalF ,

where Z(bG) denotes the center of the Langlands dual group of G and

Ï€1(G)GalF = Ï€1(G)/hÏ„ x âˆ’ x | Ï„ âˆˆ GalF , x âˆˆ Ï€1(G)i

is the group of coinvariants of Ï€1(G) for the canonical action of GalF .

Theorem 2.2.5 ([RR96], Theorem 1.15). (i) There exists a unique natural transformation1

Îº : B(Â·) â†’ Ï€1(Â·)GalF

of set-valued functors on the category of connected reductive groups over F such that on Gm we
have

ÎºGm(b) = ordL(b) (b âˆˆ LÃ—),

where the valuation on L is normalized by ordL(Ï€L) = 1 for a uniformizer Ï€L, and for tori it is an
isomorphism.

(ii) There is a unique natural transformation of functors on the category of connected reductive

groups

such that for a torus this is the natural identiï¬cation

Î´ : N (Â·) â†’ Ï€1(Â·)GalF âŠ— Q

N (T ) = Xâˆ—(T )GalF âŠ— Q = Ï€1(T )GalF âŠ— Q.

(iii) The following diagram is functorial (in the sense of pointed sets)

Î½G

B(G)

ÎºG

N (G)

Î´G

Ï€1(G)GalF

Î±G/

/ Ï€1(G)GalF âŠ— Q.

1In [RR96], Theorem 1.15, this map is denoted Î³, but here we changed it to Îº, a notation which seems to be more

popular in recent literatures.

8

/
/




Here, the map Î±G in the bottom is given by

Âµ 7â†’ |GalF Â· Âµ|âˆ’1 X

Âµâ€².

Âµâ€²âˆˆGalF Â·Âµ

For a detailed discussion of this theorem, we refer to [Kot85].

3 Newton stratiï¬cation on good reduction of Shimura variety

In this section, we give an account of the construction of the Newton stratiï¬cation on the reduction
of the integral canonical model of a Hodge-type Shimura variety. For the theory of the integral
canonical model of Shimura variety of Hodge type, we follow [Vas99], [Kis10] (see also [Vas08],
[Kis09] for a survey of the main results).

3.0.6 Let (G, X) be a Shimura datum. For a morphism h : S â†’ GR in X, the associated Hodge
cocharacter

Âµh : GmC â†’ GC

is the composite of hC : SC â†’ GC and the cocharacter of SC âˆ¼= QCÖ’â†’C GmC corresponding to the

identity embedding C Ö’â†’ C. Let c(G, X) denote the G(C)-conjugacy class of cocharacters of GC
containing Âµâˆ’1
(not Âµh), for an arbitrary h âˆˆ X. For a maximal torus T of GQ, we can consider
h
c(G, X) as an element of Xâˆ—(T )/â„¦. Alternatively, when we ï¬x a based root datum BR(G, T, B),
c(G, X) has a unique representative in the associated closed Weyl chamber C(T, B). We will also
identify the conjugacy class c(G, X) with this representative:

c(G, X) âˆˆ C(T, B).

The reï¬‚ex ï¬eld E(G, X) of a Shimura datum (G, X) is the ï¬eld of deï¬nition of c(G, X) âˆˆ CG(Q),
the ï¬xed ï¬eld of the stabilizer of c(G, X) in Gal(Q/Q); so a reï¬‚ex ï¬eld, which is a ï¬nite
i.e.
extension of Q, is always a subï¬eld of C, cf.
[Del77, Lemme1.2.4]. When T is a torus, the reï¬‚ex
ï¬eld E(T, {h}) is just the smallest subï¬eld of Q âŠ‚ C over which the single morphism Âµh is deï¬ned.

3.1
Integral canonical model Let (G, X) be a Shimura datum of Hodge type provided with
an embedding Ï : (G, X) â†’ (GSp(W, Ïˆ), HÂ±). Consider a compact open subgroup K of G(Af ) of
the form K = KpK p, where Kp (resp.K p) is a compact open subgroup of G(Qp) (resp. of G(Ap
f )).
Lemma 3.1.1. Suppose p > 2.
If Kp is a hyperspecial subgroup (i.e. Kp = GZp(Zp) inside
G(Qp) for a reductive group scheme GZp over Zp with generic ï¬ber GQp := G âŠ—Q Qp), for every
suï¬ƒciently small K p, there exist a lattice WZ of W , compact open subgroups Hp âŠ‚ GSp(W, Ïˆ)(Qp),
H p âŠ‚ GSp(W, Ïˆ)(Ap
embedding (of weakly canonical models of Shimura varieties)

f ), such that H := HpH p leaves WbZ := WZ âŠ— bZ stable and that Ï induces an

ShK (G, X) Ö’â†’ ShH(GSp(WZ, Ïˆ), HÂ±) âŠ—Q E(G, X).

Proof. This is shown in [Kis10, (2.3)]. We give a brief summary of it (also see the introduction
of [Vas08]). According to [Kis10, Lem.(2.3.1)], there exists a lattice WZ of W such that ÏQp : GQp Ö’â†’
GL(WQp) is induced by a closed embedding ÏZp : GZp Ö’â†’ GL(WZp), where WZp := WZ âŠ—Z Zp. Fix

such a WZ. Then, for K p small enough, K p leaves WZ âŠ—Z bZ(p) as well. Finally, when we take

Hp âŠ‚ GSp(W, Ïˆ)(Qp) to be the stabilizer of WZp, the existence of H p with the required property
is established in (2.1.2) of [Kis10] (cf. [Noo96, Lem. 3.3]).

9

3.1.2 For suï¬ƒciently small compact open subgroup H of GSp(Af ), let Ag,d,H denote the ï¬ne
moduli scheme over Z(p) representing the functor which, with any Z(p)-scheme T , associates the
isomorphism classes of an abelian scheme equipped with a polarization of degree d and a level
H-structure (cf. [Kot85]). Choose a prime â„˜ of E(G, X) above p and let O(â„˜) be the localization
at â„˜ of the ring of integers OE(G,X) of E(G, X). After modifying WZ by a scalar multiple, we may
assume that Ïˆ is Z-valued on WZ. Let W âˆ¨
Z be the dual lattice of WZ (with respect to Ïˆ). If we
take a compact open subgroup H of GSp(Af ) as in Lemma 3.1.1 and d := [W âˆ¨
Z : WZ], there is a
natural embedding of O(â„˜)-schemes

We denote by SK(G, X) the normalization of the closure of ShK (G, X) in Ag,d,H âŠ—Z(p) O(â„˜). Set

ShK(G, X) Ö’â†’ Ag,d,H âŠ—Z(p) O(â„˜).

SKp(G, X) = limâ†âˆ’
K p

SKpK p(G, X),

where K p runs over suï¬ƒciently small compact open subgroups of G(Ap

f ).

The following theorem was conjectured by Langlands, Milne (cf. [Mil92], Conjecture 4.25), and

was established by Vasiu ([Vas99], [Vas07], [Vas08]) and Kisin ([Kis09], [Kis10]).

Theorem 3.1.3. Retain previous assumptions (particularly, p > 2 and Kp is hyperspecial).

(1) The scheme SKp(G, X) is an inverse limit of smooth O(â„˜)-schemes with ï¬nite Â´etale transi-

tion maps, whose restriction to E(G, X) can be G(Ap

f )-equivariantly identiï¬ed with ShKp(G, X).

(2) The scheme SKp(G, X) has the following extension property:

for any regular, formally
smooth O(â„˜)-scheme S, every E(G, X)-morphism SE(G,X) â†’ ShKp(G, X) extends uniquely over
O(â„˜).

In particular, SKp(G, X) itself is regular and formally smooth over O(â„˜). We call the O(â„˜)-
(pro)schemes SK (G, X) and SKp(G, X) integral canonical model of ShK (G, X) and ShKp(G, X),
respectively.
Remark 3.1.4. This deï¬nition of the extension property is due to Kisin ([Kis10], Thm. (2.3.8)). It
diï¬€ers slightly from that of Vasiu, who uses, as test schemes, healthy regular schemes over O(â„˜)
([Vas99, 3.2]) instead of regular, formally smooth O(â„˜)-schemes. But, when GQp is unramiï¬ed,
every regular, formally smooth scheme over O(â„˜) is also healthy regular over O(â„˜), because O(â„˜)
is unramiï¬ed over Z(p) ([Mil94], Cor. 4.7 (a)) and over any d.v.r unramiï¬ed over Z(p), every
regular, formally smooth scheme is healthy regular (if p > 2), according to a lemma of Faltings
([Moo98, 3.6]). Consequently, this diï¬€erence (and related other minor diï¬€erences) will not aï¬€ect our
arguments involving the integral canonical models, since our use of the integral canonical models
will be only restricted to its extension property for discrete valuation rings unramiï¬ed over O(â„˜).

3.2 Newton stratiï¬cation We keep the notations and assumptions from the previous subsec-
tion. In particular, we are given a hyperspecial subgroup Kp of G(Qp), and accordingly a reductive
group scheme GZp over Zp with generic ï¬bre GQp and such that GZp(Zp) = Kp. Also, choose a
lattice WZ of W and a closed embedding

ShK(G, X) Ö’â†’ ShH(GSp(WZ, Ïˆ), HÂ±) âŠ—Q E(G, X)

as in Lemma 3.1.1. Further, we ï¬x an embedding Î¹p : E(G, X) Ö’â†’ Qp inducing â„˜ on E(G, X). Let
SK âŠ— Îº(â„˜) and SKp âŠ— Îº(â„˜) be the reductions of SK and SKp at â„˜, respectively. In this subsection,
we deï¬ne the Newton stratiï¬cation on these schemes, following [Rap05], [Vas08], [Wor13].

10

3.2.1 For a vector space or a free module over a d.v.r V , let T (V ) be the tensor space attached
to V , i.e. T (V ) = âŠ•s,tâˆˆZâ‰¥0V âŠ—s âŠ— (V âˆ¨)âŠ—t. Let {sÎ±}Î±âˆˆJ be the set of tensors on WQ ï¬xed under the
extended action of GQ Ö’â†’ GL(W ) on T (W ).

Let (Ï€ : A â†’ ShK , Î»A) be the pull back to ShK = ShK(G, X) of the universal abelian scheme
with a polarization of degree d over Ag,d,H, where as usual we assume K p to be suï¬ƒciently small for
this to make sense. We have the local system W := R1(Ï€an)âˆ—Q of Q-vector spaces and the (analytic)
vector bundle Wan
with Gauss-Manin connection (which is an integrable
connection with regular singularities); by Deligneâ€™s theorem, the latter is the analytiï¬cation of
a unique algebraic vector bundle W := R1Ï€âˆ—â„¦â€¢
with integrable connection over ShK. Each
tensor sÎ± deï¬nes a global section sÎ±,B of the local system T (W) and also a global section sÎ±,dR of
the vector bundle T (W) ([Kis10, (2.2)]).

C := R1(Ï€an)âˆ—â„¦â€¢

AC/ShK

A/ShK

dR(Ax/F ) and H m

Now, let F âŠƒ E(G, X) be an extension which can be embedded in C; we ï¬x an embedding
Ïƒâˆ : F Ö’â†’ C which extends the given embedding E(G, X) Ö’â†’ C. For x âˆˆ ShK(G, X)(F ), let Ax
be the corresponding abelian variety over F , and let H m
Â´et (Ax âŠ—F F , Qp) denote
respectively the de Rham cohomology of Ax/F and the Â´etale cohomology of AxâŠ—F F . For each tensor
sÎ± âˆˆ T (W ), let sÎ±,B,Ïƒâˆ(x) âˆˆ T (H 1
B(Ïƒâˆ(Ax), Q)) denote the ï¬bre of sÎ±,B at Ïƒâˆ(x) âˆˆ ShK(G, X)(C);
by the moduli interpretation of the complex points of ShK (G, X) ([Mil94, Prop.3.9]), there is an
isomorphism W âˆ¨ âˆ¼â†’ H 1
B(AÏƒâˆ(x), Q), uniquely determined up to action of G(Q), where G acts on
W âˆ¨ by the contragredient representation, and sÎ±,B,Ïƒâˆ(x) is the image of sÎ± by any such isomorphism
(so, does not depend on the choice of such isomorphism). For each prime l, let sÎ±,l,Ïƒâˆ(x) be the
tensor in T (H 1
Â´et(Ax âŠ—F F , Ql)) which is the preimage of sÎ±,B,Ïƒâˆ(x) under the canonical isomorphism
Â´et (Ax âŠ—F F , Ql) âˆ¼â†’ H m

Â´et (Ïƒâˆ(Ax âŠ—F F ), Ql) = H m

B (Ïƒâˆ(Ax), Q) âŠ— Ql,

(3.2.1.1)

H m

where the ï¬rst isomorphism Ïƒâˆ is the proper base change isomorphism in Â´etale cohomology. Also,
it is known ([DMOS82, Cor.2.8]) that the image of sÎ±,B,Ïƒâˆ(x) under the comparison isomorphism

H m

B (Ïƒâˆ(Ax), Q) âŠ— C = H m

dR(Ax âŠ—F,Ïƒâˆ C)

dR(Ax)) âŠ—F,Ïƒâˆ Ïƒâˆ(F ), i.e. equals Ïƒâˆ(sÎ±,dR,Ïƒâˆ(x)), for some sÎ±,dR,Ïƒâˆ(x) âˆˆ T (H 1

lies in T (H 1
dR(Ax âŠ—F
F )). The element (sÎ±,dR,Ïƒâˆ(x), sÎ±,Â´et,Ïƒâˆ(x) := (sÎ±,l,Ïƒâˆ(x))l) of the tensor space T (H 1
A(Ax), Q(1)) is
an absolute Hodge cycle on Ax, where H 1
[DMOS82]),
Â´et(Ax, Ql) (cf.
from which it follows ([Kis10, (2.2.1)]) that sÎ±,Â´et,Ïƒâˆ(x) is ï¬xed under the canonical Galois action of
Gal(F /F ), hence in fact, sÎ±,dR,Ïƒâˆ(x) belongs to the subspace T (H 1

dR(Ax) Ã— Q H 1

A(Ax) := H 1

dR(Ax/F )).

3.2.2 We show how every geometric point z âˆˆ SK âŠ— Â¯Fp(k) (k = k, chark = p) gives rise to an
F -isocrystal over k with GQp-structure; here, we assume that L(k) can embed in C, for example,
it suï¬ƒces if k has ï¬nite transcendence degree over Â¯Fp. The p-divisible group (Az[pâˆ], Î»Az [pâˆ])
with quasi-polarization gives rise to an F -isocrystal over k equipped with a non-degenerate al-
ternating pairing. More precisely, the crystalline cohomology M = H 1
cris(Az/W (k)) of Az with
quasi-polarization Î»z is a quasi-polarized F -crystal (M, Ï†, h , i): M is a free W (k)-module of
rank equal to 2 dim Az, Ï† âˆˆ EndZp(M ) is a Ïƒ-linear endomorphism such that pM âŠ‚ Ï†(M ), and
h , i : M Ã— M â†’ W (k) is an alternating form with the property that hÏ†(v1), Ï†(v2)i = phv1, v2iÏƒ for
v1, v2 âˆˆ M .

To show that the F -isocrystal (M âŠ— L(k), Ï†, Ïˆ) has GQp-structure, let x : Spec(W (k)) â†’ SK be
a lift of z, which exists since SK(G, X) is smooth over O(â„˜) and O(â„˜) is unramiï¬ed over Z(p) ([Mil94,

11

Cor.4.7]), and set (Ax, Î»x) := xâˆ—(A, Î»A); here we identiï¬ed Eâ„˜ = L(Fq) for the residue ï¬eld Fq of
O(â„˜). Let {tÎ²,dR,x, tÎ²,Â´et,x}Î²âˆˆJx âˆˆ T (H 1
A(Ax), Q(1)) be the set of absolute Hodge cycles on Ax (see
[DMOS82] for the notations appearing here), and for each Î² âˆˆ Jx, let tÎ²,z âˆˆ T (M âŠ—W (k)L(k)) denote
the image of tÎ²,dR,x under the canonical isomorphism H 1
cris(Az/W (k)) âŠ— L(k).
Then, one can identify J as a subset of Jx (see below for a proof) and the triple

dR(Ax/L(k)) = H 1

(M âŠ— F, Ï†, (tÎ²,z)Î²âˆˆJ )

dR(Ax/L(k)) = H 1

cris(Az/W (k)) âŠ— L(k) = H 1

depends only on z, not on the lift x: this is basically because for any two lifts x, xâ€² of z, the composite
map H 1
dR(Axâ€²/L(k)) is given by parallel transport with
respect to the Gauss-Manin connection ([BO83, (2.9)]). Also, the cycle tÎ²,z is crystalline, namely
tÎ²,z belongs to the F 0-ï¬ltration of T (M âŠ— L(k)) and is ï¬xed under the Frobenius Ï† (originally,
this was proved when x is deï¬ned over a number ï¬eld, by Wintenberger and Blasius [Bla94, Â§5], as
a consequence of the fact that the Hodge cycles on an abelian variety over a number ï¬eld are de
Rham and the compatibility of the crystalline and the de Rham comparison isomorphisms [Bla94,
5.1(5)]. Then, Vasiu [Vas08, Sec.8] generalized it to arbitrary ï¬elds). Moreover, there exists an
L(k)-isomorphism

W âˆ¨ âŠ—Q L(k) âˆ¼â†’ M âŠ—W (k) L(k)

(3.2.2.1)

which maps sÎ±, for every Î± âˆˆ J , to tÎ²,z for some Î² = Î²(Î±) âˆˆ Jx. Indeed, as before we choose
an embedding Ïƒâˆ : L(k) Ö’â†’ C which extends the given embedding E(G, X) Ö’â†’ C. Then, for each
Î² âˆˆ Jx, as tÎ²,dR,x is the de Rham component of an absolute Hodge cycle on Ax, there exists a
tensor vÎ² âˆˆ T (W ) such that Ïƒâˆ(tÎ²,dR,x) is the image of vÎ² under the comparison isomorphism

W âˆ¨ âŠ— C

âˆ¼â†’ H 1

B(Ïƒâˆ(Ax), Q) âŠ— C

âˆ¼â†’ H 1

dR(Ax/L(k)) âŠ—L(k),Ïƒâˆ C,

(3.2.2.2)

where as noted above the ï¬rst isomorphism exists and is unique up to the action of G(Q) on W âˆ¨.
Because for each Î± âˆˆ J , Ïƒâˆ(sÎ±,dR,Ïƒâˆ(x)) is the image of sÎ± of the same isomorphism and also is
the de Rham component of an absolute Hodge cycle on Ax, for every Î± âˆˆ J , sÎ± equals vÎ² for some
Î² = Î²(Î±) âˆˆ Jx (which gives an injection J Ö’â†’ Jx mentioned above), i.e. the set {vÎ²}Î²âˆˆJx contains
the set {sÎ±}Î±âˆˆJ . Then, the functor deï¬ned on L(k)-schemes

R 7â†’ HomR((W âˆ¨

L(k) âŠ— R, {vÎ² âŠ— 1}), (H 1

dR(Ax/L(k)) âŠ— R, {tÎ²,dR,x âŠ— 1}))

of isomorphisms between W âˆ¨âŠ—QL(k) and H 1
dR(Ax/L(k)) taking vÎ² to tÎ²,dR,x for every Î² âˆˆ J (âŠ‚ Jx)
is represented by a scheme which is non-empty as it has a C-valued point, and thus is a torsor over
L(k) under GL(k). Since H 1(L(k), GL(k)) = {0} (Steinbergâ€™s theorem), this torsor is trivial, namely
has an L(k)-valued point.

Therefore, when one chooses an isomorphism as in (3.2.2.1) to transport the Ïƒ-linear map Ï† to

W âˆ¨, there exists an element b âˆˆ G(L(k)) with

Ï† = ÏW âˆ¨(b)(idW âˆ¨ âŠ— Ïƒ),

where ÏW âˆ¨ : G Ö’â†’ GL(W âˆ¨) denotes the contragredient representation: indeed, ÏW âˆ¨(b)(idW âˆ¨ âŠ— Ïƒ)
ï¬xes each vÎ² âŠ—1 âˆˆ T (W âˆ¨ âŠ—L(k)). Although b depends on the choice of an isomorphism (3.2.2.1), its
Ïƒ-conjugacy class b âˆˆ B(GQp) is independent of such choice. This shows that the F -isocrystal over
k attached to z is an F -isocrystal with GQp-structure. For arbitrary point z of SK(G, X)âŠ—Îº(â„˜), we

12

deï¬ne the F -isocrystal attached to z to be the F -isocrystal of the geometric point in SK(G, X)(k)
induced from z for any algebraically closed ï¬eld k containing the residue ï¬eld Îº(z) of z: the
resulting F -isocrystal does not depend on the choice of kâ€² (cf. [VW13, Â§8]). Therefore, we obtain
a (set-theoretic) map

Î˜ : SK(G, X) âŠ— Îº(â„˜) â†’ B(G).

We note that the same argument also establishes that if x âˆˆ ShK(G, X)(F ) is a special point
corresponding to a special Shimura datum (T, h âˆˆ Hom(S, TR) âˆ© X), the associated isocrystal has a
representative in T (L). Indeed, by the moduli interpretation, there is an isomorphism of polarized
Q-Hodge structures W âˆ¨ âˆ¼â†’ H1(Ïƒâˆ(Ax), Q), where on the left side the Hodge structure is given by
h, so T âŠ‚ GL(W ) is the stabilizer of the Hodge tensors {vÎ²}Î²âˆˆJx âŠ‚ T (W ), and according to the
above discussion, the associated element b âˆˆ G(L(k)) ï¬xes all of the tensors {vÎ²}Î²âˆˆJx.

Finally, we remark that although our deï¬nition of the F -isocrystal attached to a point of
SK(G, X)(k) uses cohomology spaces, one can equally work with homology spaces, as adopted by
other people (such as [VW13]). This does not alter the deï¬nition of the map Î˜.

3.2.3 We recall that for a torus T over a non-archimedean local ï¬eld F , there exists a unique
maximal compact subgroup of T (F ) (which is also open). In fact, T has a canonical integral form
T over OF such that for every ï¬nite extension F â€² of F , the maximal compact subgroup of T (F â€²)
is T (OF â€²). If E is a ï¬nite Galois extension of F splitting T , the maximal compact subgroup of
T (E) = Hom(X âˆ—(T ), F Ã—)(â‰ƒ (EÃ—)dim T ) is T (OE ) = Hom(X âˆ—(T ), OÃ—
E )dim T ); furthermore
we have T (OF ) = HomGal(E/F )(X âˆ—(T ), OÃ—
If T is unramiï¬ed over F , T (OF ) is the unique
hyperspecial subgroup of T (F ) (cf. Thm. 1 and the discussion after Prop. 2 in Â§10.3 of [Vos98],
[Tit79]). We will also write simply T (OF ) for T (OF ).

E )(â‰ƒ (OÃ—

E ).

Lemma 3.2.4. Choose an embedding Î¹p : Q Ö’â†’ Qp inducing given prime â„˜ of E âŠ‚ Q. Let Kp be
a hyperspecial subgroup of G(Qp) and K p a compact open subgroup of G(Ap
f ). Let x = [h, kf ] âˆˆ
ShK(G, X)(Q) be a special point, where h âˆˆ Hom(S, TR) âˆ© X for a maximal Q-torus T of G and
kf âˆˆ G(Af ). Suppose that T is unramiï¬ed over Qp and the (unique) hyperspecial subgroup T (Zp)
of T (Qp) is contained in Kp. Then,

(1) x âˆˆ ShK (G, X)(Qp) is deï¬ned over an unramiï¬ed extension F of E(G, X)â„˜, thus extends

over OF , and

(2) the F -isocrystal with GQp-structure of its reduction z âˆˆ ShK (G, X)(Â¯Fp) is represented by
is

p ). In particular, the associated Newton point Î½TQp (Âµh(p)) âˆˆ N (TQp) = Xâˆ—(T )Î“(p)

Âµâˆ’1
h (p) âˆˆ T (Qur

Q

âˆ’

1
r

NmL(Fq)/Qp(Âµh),

where L(Fq) = Frac(W (Fq)) is any splitting ï¬eld of TQp (q = pr).

A special point of ShK will be said to have good reduction at Î¹p if it extends to an OÎ¹p-valued

point of SK for the valuation ring OÎ¹p of Q deï¬ned by Î¹p.

Proof. (1) The statement on the ï¬eld of deï¬nition is an easy consequence of the reciprocity
law chararcterizing the canonical model of Shimura varieties ([Del71, Â§3]) and the local class ï¬eld
theory. For any compact open subgroup K â€² contained in T (Af ) âˆ© K, there is a natural map
ShK â€²(T, {h}) â†’ ShK(G, X) âŠ—E(G,X) E(T, {h}) of weakly canonical models of Shimura varieties
([Del71, (3.13)]). Hence, it suï¬ƒces to show that for the compact open subgroup K â€² = T (Zp) Ã— K â€²p

13

for any K â€²p âŠ‚ T (Ap) âˆ© K p, the connected components of the ï¬nite scheme ShK â€²(T, {h}) over
E(T, {h}) are deï¬ned over an (abelian) extension Eâ€² of E := E(T, {h}) such that the prime pâ€² of Eâ€²
induced by Î¹p is unramiï¬ed over â„˜ ([Del71, 3.15]). The action of Gal(Q/E) (which factors through
the abelianization Gal(Eab/E)) on the group ShK â€²(T, {h})(Q) = T (Q)\T (Af )/K â€² is given by (the
adelic points of) the reciprocity map ([Del71, 3.9])

rT,Âµh : ResE/Q(GmE)

ResE/Q(Âµh)

âˆ’â†’ ResE/Q(TE)

NE/Qâˆ’â†’ T

(3.2.4.1)

via class ï¬eld theory: for Ï âˆˆ Gal(Eab
one has

â„˜ /Eâ„˜) = EÃ—

â„˜ and [t]K â€² âˆˆ ShK â€²(T, {h})(Eâ„˜) = T (Q)\T (Af )/K â€²,

Ï[t] = [t Â· rT,Âµ(Ï)âˆ’1],

â„˜ /Eur

where one uses the convention on the class ï¬eld theory that under the identiï¬cation Gal(Eab
â„˜ /Eâ„˜) =
EÃ—
â„˜ , the geometric Frobenius corresponds to a uniformizer of Eâ„˜. But, the image in T (Qp) of the
unit group (OE âŠ— Zp)Ã— is obviously contained in the maximal compact open subgroup T (Zp). Since
Gal(Eab
â„˜ âŠ‚ (OE âŠ— Zp)Ã—, this proves the claim. Then, by the Neron extension
property (Thm. 3.1.3, (2) and Remark 3.1.4) of the integral canonical model, x extends to an
OF -valued point of SK.

â„˜ ) = (OE)Ã—

(2) Set L := L(Â¯Fp); by (1), we may regard L as an extension of F . The statement on the
Newton point follows from the ï¬rst statement and Theorem 2.2.5. The claim that the F -isocrystal
of z is represented by Âµâˆ’1
h (p) âˆˆ T (L) is Lemma 13.1 of [Kot92]; as was observed above, we already
know that it is represented by an element of T (L). More precisely, this lemma is a corollary of
Lemma 12.1 of loc.cit., which is a statement purely for a torus over a non-archimedean local ï¬eld
and a cocharacter of it (in particular, in Lemma 12.1 it is not required that the torus is deï¬ned
by a PEL-datum), and the argument in [Kot92] of deducing Lemma 13.1 from Lemma 12.1 still
works in our situation of a general Hodge-type. To see that in detail, we reproduce the Kottwitzâ€™s
argument here, pointing out necessary modiï¬cations explicitly along the way.

We ï¬x an embedding Ïƒâˆ : L Ö’â†’ C which extends the given embedding E(G, X) Ö’â†’ C. The mod-
B(Ïƒâˆ(Ax), Q), determined
, Qp)
the con-
, Qp). Then, the Galois representation Gal(Qp/F ) â†’
p ) = Gal(Qp/F ur) of the

uli interpretation of ShK(G, X)(C) provides an isomorphism W âˆ¨ âˆ¼â†’ H 1
uniquely up to action of G; we ï¬x one. Accordingly, we get an isomorphism W âˆ¨
Qp
by the isomorphism (3.2.1.1), via which we transport the action of TQp on W âˆ¨
tragredient representation) to H 1
GL(H1((Ax)Qp
resulting representation equals the homomorphism

, Qp)) factors through TQp and the restriction to Gal(Qp/Qur

âˆ¼â†’ H 1
Qp (i.e.

Â´et((Ax)Qp

Â´et((Ax)Qp

ÏTQp ,Âµh : Gal(Qp/Qur

p ) â†’ TQp

(3.2.4.2)

attached to (TQp, Âµh) by the procedure of Â§12 of [Kot92] (just as in the PEL-type case); in particular,
it is a crystalline representation. Indeed, as we have seen from [Kis10, (2.2.1)], the absolute Hodge
cycles on Ax are invariant under Gal(F /F ), which proves the ï¬rst claim. The second claim holds
because we can reduce our case to the Siegel case by means of the symplectic embedding G Ö’â†’
GSp(W, Ïˆ).

Next, we need three Qp-linear Tannakian categories: RE P(TQp) is the neutral Qp-linear Tan-
nakian category of ï¬nite-dimensional representations of the torus TQp, C R(F ) is the neutral Qp-
linear Tannakian category of ï¬nite-dimensional crystalline representations of Gal(Qp/F ur), and

14

C RY S denotes the Qp-linear Tannakian category of F -isocrystals (U, Î¦), where U is a ï¬nite di-
mensional vector space over L and Î¦ is a Ïƒ-linear bijection Î¦ : U â†’ U . Then, to any cocharacter
Âµ âˆˆ Xâˆ—(TQp), there is attached a (composite) tensor functor

ÎÂµ : RE P(TQp)

Ïâˆ—
Âµhâ†’ C R(F )

Dâ†’ C RY S .

(3.2.4.3)

Here, the ï¬rst functor Ïâˆ—
p ) â†’ TQp
(3.2.4.2) and the second functor D is the DieudonnÂ´e functor in the Fontaine-Messing theory: for a
ï¬nite unramiï¬ed extension E(âŠ‚ Qur

Âµh is dual to the homomorphism ÏÂµh := ÏTQp ,Âµh : Gal(Qp/Qur

p ) of F and a crystalline representation V of Gal(Qp/E),

D(V ) = (Bcris âŠ—Qp V )Gal(Qp/E),

where Bcris is the crystalline period ring of Fontaine-Messing ([FM87]). On the other hand, if for a
ï¬eld K, V E C K denotes the category of ï¬nite-dimensional K-vector spaces, from the ï¬bre functor
C RY S â†’ V E C L : (U, Î¦) 7â†’ U , we get a non-standard ï¬bre functor Ï‰1 : RE P(TQp) â†’ V E C L.
By Steinbergâ€™s theorem (H 1(L, TL) = {0}), this ï¬bre functor is isomorphic to the standard ï¬bre
âˆ¼â†’ Ï‰0 of ï¬bre
functor Ï‰0 : RE P(TQp) â†’ V E C L : (Ï, V ) 7â†’ V âŠ—Qp L. We ï¬x an isormophsm f : Ï‰1
functors.

Now, it follows from the above discussion (on the homomorphism ÏTQp ,Âµh) that for the natural
representation WQp of TQp, the associated crystalline representation Ïâˆ—
uh(WQp) is the natural repre-
sentation of Gal(Qp/Qur
, Qp), hence ÎÂµh(WQp) is canonically isomorphic to the dual
cris(Az/W (Â¯Fp)) âŠ— L (cf. proof of [Kot92, Lemma13.1]); here, by
of the F -isocrystal H 1
deï¬nition, the F -isocrystal dual to H 1
cris(Az/L), L)
equipped with the Frobenius operator Î¦1(f )(v) := pâˆ’1 Â· Ïƒf (V v) for f âˆˆ H cris
cris(Az/L)
(V being the Verschiebung). Then, Lemma 12.1 of [Kot92] says that if one transports the Frobenius
operator Î¦1 on ÎÂµh(WQp) = H cris

p ) on H1((Ax)Qp
cris(Az/L) = H 1

cris(Az/L) is the linear dual H cris

to W âŠ— L via the isomorphism

:= HomL(H 1

1

and v âˆˆ H 1

1

1

f (WQp) : Ï‰1(WQp) = H cris

1

âˆ¼â†’ Ï‰0(WQp) = WQp âŠ— L,

and writes (H cris

1

, Î¦1) â‰ƒ (W âŠ— L, ÏW (b)(idW âŠ— Ïƒ)), then one has an equality

in B(TQp). It also holds that

b = Âµâˆ’1

h (p)

H 1

cris(Ax/L) â‰ƒ (W âˆ¨ âŠ— L, ÏW âˆ¨(b)(idW âˆ¨ âŠ— Ïƒ)).

âˆ¼â†’ H 1

âˆ¼â†’ Ï‰0
Therefore, to prove the statement (2), we only need to show that for any identiï¬cation f : Ï‰1
âˆ¼â†’ WL induces an isomorphism as in (3.2.2.1), namely f (WQp)âˆ¨ :
of ï¬bre functors, f (WQp) : H cris
W âˆ¨
cris(Az/L) sends sÎ±, for every Î± âˆˆ J , to tÎ²,z for some Î² = Î²(Î±) âˆˆ Jx. We remark that in
L
the PEL-type setting, the tensors involved are morphisms in tensor categories, so this was obvious.
In a general Hodge-type case, the proof of this fact requires more sophisticated argument and also
a non-trivial fact ([Bla94]) that the Hodge cycles on abelian varieties over number ï¬elds are de
Rham.

1

In more detail, we consider each tensor sÎ± as a morphism sÎ± : 1 â†’ W âŠ—
Qp

in RE P(TQp), where
1 is the trivial representation Qp (which is an identity object of the tensor category RE P(TQp))

15

and W âŠ—
Qp
Î± : ÎÂµ(1) â†’ ÎÂµ(W âŠ—
tâ€²
Qp
equivalently regarded as a crystalline tensor on ÎÂµ(WQp) = H cris
isomorphism of ï¬bre functors, we have a commutative diagram of L-vector spaces

denotes some speciï¬c object of RE P(TQp). Apply the functor ÎÂµ, we get a morphism
) in C RY S . But, as ÎÂµ(1) is the trivial F -isocrystal (L, Ïƒ), again this is
. Moreover, as f : Ï‰1 â†’ Ï‰0 is an

1

Ï‰1(1)

f (1) â‰ƒ

tâ€²
Î± /

Ï‰1(W âŠ—
Qp

)

â‰ƒ f (W âŠ—
Qp

)

Ï‰0(1)

sÎ± /

/ Ï‰0(W âŠ—
Qp

).

under Ïâˆ—

Î± on H cris

Âµh is just the image of it under our chosen identiï¬cation W âˆ¨
Qp

As the isomorphism f (1) is the multiplication by an element of L, by modifying f , we may assume
that f (1) is the identity on 1 = Qp. This implies that under f (WQp)âˆ’1, the tensor sÎ± on WQp =
Ï‰0(WQp) maps to a crystalline tensor tâ€²
1 = Ï‰1(WQp). So, it remains to check that the tensor
tâ€²
Î± is the de Rham component of an absolute Hodge cycle on Ax. But, the image of the tensor sÎ± :
1 â†’ W âŠ—
, Qp),
Qp
hence equals the Â´etale component sÎ±,p,Ïƒâˆ(x) : 1 â†’ HÂ´et
, Qp)âŠ— of a Hodge cycle sÎ±,B,Ïƒâˆ(x)
on Ïƒâˆ(Ax) by the moduli interpretation of ShK (G, X)(C). In turn, the image of sÎ±,p,Ïƒâˆ(x) under
dR(Ax/L), L)âŠ—, because the
the second functor D is sÎ±,dR,Ïƒâˆ(x) : 1 â†’ H dR
etale and the de Rham component of an absolute Hodge cycle on an abelian variety over a number
ï¬eld match under the p-adic comparison isomorphism from which the functor D is induced ([Bla94,
Thm.0.3]). So, we have just proved that tâ€²
Î± = ÎÂµh(sÎ±) = sÎ±,dR,Ïƒâˆ(x), and consequenty the statement
(2).

1 (Ax/L)âŠ— := HomL(H 1

âˆ¼â†’ H 1

Â´et((Ax)Qp

1 ((Ax)Qp

3.2.5 We ï¬x an embedding Î¹p : Q Ö’â†’ Qp for an algebraic closure Qp of Qp, thereby an inclusion

Î“(p) := Gal(Qp/Qp) Ö’â†’ Î“ := Gal(Q/Q).

This allows us to consider c(G, X) as an element of CG(Qp). As such, the ï¬eld of deï¬nition of
c(G, X) is equal to the â„˜-adic completion E(G, X)â„˜ of E(G, X), where â„˜ is the prime of E(G, X)
induced by Î¹p.

Let BR(GQp) = (X âˆ—, Râˆ—, Xâˆ—, Râˆ—, âˆ†) be the based root datum of GQp and C âŠ‚ (Xâˆ—)Q the closed
Weyl chamber associated with the root base âˆ†. Denoting also by c(G, X) its (unique) representative
in C, we set

Âµ(G, X) := |Î“(p) Â· c(G, X)|âˆ’1 X

Âµâ€²

âˆˆ C

Âµâ€²âˆˆÎ“(p)Â·c(G,X)

= [Î“(p) : Î“(p)c]âˆ’1 X

Î³âˆˆÎ“(p)/Î“(p)c

Î³(c(G, X)),

Here, the action of Î“(p) on C is the canonical action and Î“(p)c := Gal(Qp/E(G, X)â„˜), i.e. the
stabilizer of c(G, X) in Î“(p).

16

/




3.2.6 As Xâˆ—(T ) = X âˆ—(bT ) for the dual torus bT of T , regarded as a character on bT , we can restrict
c(G, X) âˆˆ C(T, B) to the subgroup Z(bG)Î“(p) of bT , obtaining an element

Âµâ™® âˆˆ X âˆ—(Z(bG)Î“(p)).

This depends only on the pair (G, X) (more precisely, on the pair (GQp, c(G, X) âˆˆ CG(Qp))).

Alternatively, under the identiï¬cation X âˆ—(Z(bG)Î“(p)) = Ï€1(G)Î“(p), the element Âµâ™® equals the image
of Âµ âˆˆ Xâˆ—(T ) under the canonical map Xâˆ—(T ) â†’ Ï€1(G)Î“(p) = (Xâˆ—(T )/Î£Î±âˆˆÎ¦(G,T )ZÎ±âˆ¨)Î“(p), where Âµ
is any cocharacter of TQp

that lies in the conjugacy class c(G, X) of cocharacters of GQp

.

3.2.7 We deï¬ne a ï¬nite subset B(GQp, X) of B(GQp) (following Kottwitz [Kot97, Sec.6] and
Rapoport [Rap05, Sec.4]):

B(GQp, X) := n b âˆˆ B(GQp) | ÎºGQp (b) = Âµâ™®,

Î½GQp (b) (cid:22) Âµ(G, X) o ,

where ÎºGQp is as deï¬ned in Theorem 2.2.5 and (cid:22) is the natural partial order on the closed Weyl
chamber C(T, B) deï¬ned by that Î½ (cid:22) Î½â€² if Î½â€² âˆ’ Î½ is a nonnegative linear combination with real
coeï¬ƒcients of simple coroots in Râˆ—(T ) ([RR96], Lemma 2.2).

One knows ([Kot97, 4.13]) that the map (Î½, Îº) : B(GQp) â†’ N (GQp) Ã— X âˆ—(bZ(G)Î“(p)) is injective,

hence B(GQp, X) can be identiï¬ed with a subset of N (GQp).

Proposition 3.2.8. Suppose G is unramiï¬ed over Qp and K = KpK p is hyperspecial at p.

(1) The image of Î˜ : SK(G, X)(Îº(â„˜)) â†’ B(G) is contained in B(GQp, X).
(2) For b âˆˆ B(GQp), the subset

is locally closed inside SK(G, X) âŠ— Â¯Fp.

Sb := Î˜âˆ’1(b)

For (1), see e.g. [RR96]. The second statement (2) is due to [Vas11, 5.3.1].
Endowed with reduced induced subscheme structure, the subvarieties Sb of SK (G, X) âŠ— Â¯Fp are

called the Newton strata of SK(G, X).

In [Rap05], Conjecture 7.1, Rapoport conjectures

Conjecture 3.2.9.

Im(Î˜) = B(GQp, X).

Remark 3.2.10. (1) As mentioned brieï¬‚y in the introduction, this non-emptiness conjecture of New-
ton strata was proved for PEL-type Shimura varieties by C.-F. Yu [Yu05] in Lie-type C cases and
by Viehmann-Wedhorn [VW13] in general cases. Their methods of proof are both characteristic-p
geometric, which are not applicable for Hodge-type Shimura varieties.

(2) It is known (cf.

[RR96], [Cha00]) that with respect to the partial order (cid:22) on B(GQp, X),
there exist a unique maximal element, called Âµ-ordinary element, and a unique minimal element,
called basic element. The Âµ-ordinary element is nothing other than (the Ïƒ-conjugacy class in
it is clear from deï¬nition that Âµ(G, X) âˆˆ B(GQp, X).
B(GQp, X) with Newton point) Âµ(G, X):
Previously, non-emptiness of these two special strata have been known. For the Âµ-ordinary locus,
this was ï¬rst proved by Wedhorn ([Wed99]) in the PEL-type cases, using an equi-characteristic
deformation argument (which is thus yet unavailable for Hodge type Shimura varieties) and by

17

Wortmann [Wor13] for general Hodge-type cases, along the line of Viehmann-Wedhorn [VW13]
comparing the Newton stratiï¬cation with the Ekedahl-Oort stratiï¬cation. As such, Wortmannâ€™s
work makes an essential use of the Kisinâ€™s results on the integral p-adic comparison between the etale
cohomology with Zp-coeï¬ƒcients and the crystalline cohomology with integral coeï¬ƒcients, endowed
with tensors (which is also established by [Vas12]). There was also a group-theoretic approach of
Bultel [Bul01]. The Âµ-ordinary locus is also known to be dense and open. In the PEL-type cases,
non-emptiness of the basic locus was shown by Fargues [Far04].

(3) There is a conjectural formula for the (co)dimension of each Newton stratum, given by Chai
[Cha00]. The result of Kret [Kre13], alluded in the introduction, in fact proves this formula in the
simple PEL-type cases of Lie type A or C. His result depends on the resolution of Kisin [Kis13]
of the Langlands-Rapoport conjecture and the stabilization of the twisted trace formula. We also
mention the work of Scholze-Shin [SS13, Cor.8.4] of similar ï¬‚avor.

(4) Originally, Conjecture 3.2.9 was formulated for general parahoric subgroup Kp. But, if Kp
is not hyperspecial, the Âµ-ordinary locus may not be dense, as the example of Stamm [Sta97] shows
(the Hilbert-Blumenthal surfaces with Iwahoric level structure at p). Still, our result (the ï¬rst
method of proof) proves that if there exists an integral model for which a suitable Neron-extension
property similar to Theorem 3.1.3 holds, then the Newton strata (parametrized by the same set
B(GQp, X)) on the reduction of such model are all non-empty.

(5) We do not know yet that our deï¬nition of the isocrystal with GQp-structure is an isocrystal
with GQp-structure on SK âŠ—Îº(â„˜) in the sense of [RR96, Â§3]. Due to this ï¬‚aw, some basic properties
on Newton stratiï¬cation that are known for PEL-type Shimura varieties, such as the Grothendieck
specialization theorem, are not yet established for Hodge type Shimura varieties. For some known
properties, we refer to [Rap03], [Vas08].

4 Construction of special Shimura datum with prescribed F -isocrystal

Suppose given a Shimura datum (G, X) of Hodge type such that GQp is unramiï¬ed. Fix a hyper-
special subgroup Kp of G(Qp) and a prime â„˜ of E(G, X). We choose embeddings Î¹âˆ : Q Ö’â†’ C and
Î¹p : Q Ö’â†’ Qp inducing â„˜ on E(G, X). Let SKp(G, X) be the canonical integral model of the Shimura
variety ShKp(G, X). The goal of this section is to prove the fact that for any F -isocrystal with GQp-
structure b lying in B(GQp, X), there exists a special Shimura sub-datum (T, h âˆˆ Hom(S, TR) âˆ© X)
such that TQp is unramiï¬ed and the unique hyperspecial subgroup is contained in a G(Qp)-conjugate
of Kp, and that the Ïƒ-conjugacy class of Âµâˆ’1

p ) equals b.

h (p) âˆˆ G(Qur

Later, from such special Shimura datum, we will ï¬nd a special Shimura sub-datum (T â€², hâ€²)
Qp and T â€²(Zp) âŠ‚ Kp, and further such that for any gf âˆˆ G(Af ), the special
with unramiï¬ed T â€²
point x = [hâ€², gf ] âˆˆ SKp(G, X)(Q) has good reduction at Î¹p and the associated F -isocrystal with
GQp-structure of its reduction is b.

4.1 Construction of special Shimura datum with prescribed F -isocrystal satis-
fying condition (â€ ) We will use the following notation in the remaining of this section. Let M
be a reductive group over a ï¬eld F (of characteristic zero) and T a maximal F -torus of M . For
any Âµ âˆˆ Xâˆ—(T ), we let [Âµ]M denote its image under the natural map

Xâˆ—(T ) â†’ Ï€1(M )Gal(F /F ) = (Xâˆ—(T )/ X

ZÎ±âˆ¨)Gal(F /F ).

Î±âˆˆâˆ†(T,M )

18

(Although the ï¬eld F does not enter the notation, in most cases, this will not cause confusion; F
will be the natural ï¬eld over which M is to be considered.)

Remember that we had ï¬xed two embeddings Q Ö’â†’ C, Q Ö’â†’ Qp, and using these we will
regard every conjugacy class of cocharacters of GC (for example, c(G, X)) as a conjugacy class of
cocharacters of GQp

. Suppose that

Theorem 4.1.1. Let (G, X) be a Shimura datum. Let p be a rational prime such that GQp is
unramiï¬ed, and bâ€² âˆˆ B(GQp). Suppose that

(â€ ) there exists a pair (T â€², Âµâ€²), where T â€² is an unramiï¬ed maximal Qp-torus of GQp, and Âµâ€² âˆˆ

Xâˆ—(T â€²) âˆ© c(G, X) such that the Newton point Î½GQp (bâ€²) of bâ€² âˆˆ B(GQp) equals the image of

1
r

NmLr/Qp(Âµâ€²) âˆˆ N (T â€²) = Xâˆ—(T â€²)Î“(p)

Q

under the canonical map N (T â€²) â†’ N (GQp), where T â€² splits over Lr := L(Fpr ).

Then, there exists a special Shimura datum (T, h âˆˆ X âˆ© Hom(S, TR)) such that (TQp, Âµh) =
p ). Moreover,

Intgp(T â€², Âµâ€²) for some gp âˆˆ G(Qp) and that bâ€² is Ïƒ-conjugate in G(L) to Âµâˆ’1
for any ï¬nite prime l 6= p of Q, we can choose such (T, h) with TQl being elliptic in GQl

h (p) âˆˆ G(Qur

We note that when bâ€² âˆˆ B(GQp, X), the equality Î½GQp (bâ€²) = 1

r NmLr/Qp(Âµâ€²) of elements in

N (GQp) (i.e. the condition in (â€ )) is equivalent to the equality

bâ€² = Âµâ€²(p)

of elements in B(GQp), because of Lemma 3.2.4 and the fact that the map

(Î½, Îº) : B(GQp) â†’ N (GQp) Ã— Ï€1(G)Î“(p)

is injective ([Kot97, 4.13]).

Proof. Our proof consists of two steps. Fix a rational prime l diï¬€erent from p.
Step 1. First, we claim that if the assumption (â€ ) holds, then it holds with T â€² = (T0)Qp for
some maximal Q-torus T0 of G which is elliptic at both R and l. More precisely, we ï¬nd a maximal
Q-torus T0 of G such that (T0)Qv is elliptic in GQv for v = âˆ, l and that (T0)Qp = Int(gp)(T â€²) for
some gp âˆˆ G(Qp). To that end, we consider the following three sets:

Xv = {x âˆˆ Gsc(Qv) | x is regular semisimple and

Xp = {x âˆˆ Gsc(Qp) | x is regular semisimple and

CentG(x) is elliptic in GQv } (v = âˆ, l);

CentG(x) = Int(gp)(T â€²) for some gp âˆˆ G(Qp) },

for v = âˆ, this follows from the Deligneâ€™s condition on Shimura
These sets are all non-empty:
data ([Del77, (2.1.1.2)]), and for v = l, from [PR94, Thm. 6.21]. They are also open in the real,
l-adic, and p-adic topology, respectively: â€œfor suï¬ƒciently close two regular semisimple elements,
their centralizers are conjugatedâ€ (cf.
[Bul01], proof of Lemma 3.1). So, by weak approximation
theorem, there exists an element x âˆˆ Gsc(Q) which lies in all of them. Its centralizer T0 := CentG(x)
is then the desired maximal torus.

19

Clearly, for any g âˆˆ G(Qp) (especially, g âˆˆ G(Qp) with (T0)Qp = gT â€²gâˆ’1), the new pair (T1, Âµ1) =
(gT â€²gâˆ’1, gÂµâ€²gâˆ’1) still satisï¬es the condition (â€ ). Hence, in the rest of our proof, we may and do
assume that the condition (â€ ) holds for a pair (Âµâ€², T â€²) such that T â€² = (T0)Qp for some maximal
Q-torus T0 of G which is elliptic at R and at our chosen prime l 6= p.

Step 2. Next, for any maximal Q-torus T0 of G, elliptic at R, and each cocharacter Âµâ€² âˆˆ Xâˆ—(T0),

we claim that there exists u âˆˆ G(Q) such that

(i) Intu : (T0)Q Ö’â†’ GQ is deï¬ned over Q and the Q-torus T := Intu(T0) is elliptic in G over R,

(ii) Intu(Âµâ€²) equals Âµâˆ’1
h

for some h âˆˆ Hom(S, TR) âˆ© X.

Moreover, if (T0)Ql is elliptic in GQl for some l 6= p, there exist such u âˆˆ G(Q), h âˆˆ X satisfying,
in addition to these properties, that

(iii) there exists y âˆˆ G(Qp) such that (TQp, Âµâˆ’1

h ) = Inty((T0)Qp, Âµâ€²).

Our proof is an adaptation of the argument of [LR87], Lemma 5.12. Let T sc

0 be the inverse
image of (T0 âˆ© Gder)0 under the canonical isogeny Gsc â†’ Gder, and pick any morphism h0 âˆˆ X
factoring through (T0)R, which exists since (T0)R is elliptic in GR. Choose w âˆˆ NG(T0)(C) such
that Âµâ€² = w(Âµâˆ’1
h0

),2 and consider the cocycle Î±âˆ âˆˆ Z 1(Gal(C/R), Gsc(C)) deï¬ned by

Î±âˆ
Î¹ = w Â· Î¹(wâˆ’1).

As a mater of fact, this has values in T sc
Int(wâˆ’1) of (T sc
t âˆˆ T sc
Lemma 7.16 of [Lan83], there exists a global cocycle

0 (C). Indeed, by [Sh79, Prop. 2.2], the automorphism
0 )C is deï¬ned over R, so Int(wâˆ’1)(Î¹(t)) = Î¹(Int(wâˆ’1)t) = Int(Î¹(wâˆ’1))(Î¹(t)) for all
0 (C), and so is wÎ¹(wâˆ’1) = Î¹(Î¹(w)wâˆ’1). Then, by

0 (C), i.e. Î¹(w)wâˆ’1 âˆˆ CentGsc(T sc

0 )(C) = T sc

Î± âˆˆ Z 1(Q, T sc
0 )

mapping to Î±âˆ âˆˆ H 1(Qâˆ, T sc
lemma ensures the existence of a cocycle Î± âˆˆ Z 1(Q, T sc
to zero in H 1(Qp, T sc
torsion elements.

0 ). When (T0)Ql is elliptic in GQl for some l 6= p, then the following
0 ) and further
0 ). For a ï¬nitely generated abelian group A, let Ators be the subgroup of its

0 ) mapping to Î±âˆ âˆˆ H 1(Qâˆ, T sc

Lemma 4.1.2. (1) For a maximal Q-torus T of G which is elliptic at l 6= p, the natural map
(Ï€1(T sc)Î“(l))tors â†’ (Ï€1(T sc)Î“)tors is surjective.

(2) There exists Î± âˆˆ Z 1(Q, T sc

0 ) mapping to Î±âˆ âˆˆ H 1(Qâˆ, T sc

0 ) and to zero in H 1(Qp, T sc

0 ).

Proof of lemma. (1) This is equal to the composite:

(Ï€1(T sc)Î“(l))tors Ö’â†’ Ï€1(T sc)Î“(l) Ö‰ Ï€1(T sc)Î“ Ö‰ (Ï€1(T sc)Î“)tors,

where the last two maps are clearly surjective. Hence, it suï¬ƒces to prove that Ï€1(T sc)Î“(l) is a
torsion group. But, since T sc
Ql

is a ï¬nite group, and so is

Î“(l)

2Recall our convention that c(G, X) is the conjugacy class of cocharcters into GC containing Âµâˆ’1

h for some h âˆˆ X.

is anisotropic, cT sc
Ï€1(T sc)Î“(l) = X âˆ—(cT sc

Î“(l)

) = Hom(cT sc

Î“(l)

, CÃ—).

20

(2) For any place v of Q, there exists a canonical isomorphism ([Kot84a, (3.3.1)], [RR96, 1.14])

H 1(F, T sc)

Î“(v)

)D)tors âˆ¼= (Ï€1(T sc)Î“(v))tors,

Î“(v)

âˆ¼â†’ Hom(Ï€0(cT sc

), CÃ—) = ((cT sc

and a short exact sequence ([Kot86, Prop.2.6])

Î“

Î“

H 1(Q, T sc) â†’ H 1(Q, T sc(A)) := âŠ•vH 1(Qv, T sc) Î¸â†’ Ï€0(cT sc
)D â†’ Ï€0(cT sc

Here, Î¸ is the composite âŠ•vH 1(Qv, T sc) âˆ¼â†’ âŠ•vÏ€0(cT sc

)D, of which the second map
is the one considered in (1) for T = T0. Hence, by (1), there exists a class Î±l âˆˆ H 1(Ql, T sc) such
that Î¸(Î±l) = âˆ’Î¸(Î±âˆ), and thus the element (Î²v)v âˆˆ H 1(Q, T sc(A)) deï¬ned by that Î²v = Î±v for
)D. By exactness of the sequence, we

v = âˆ, l and Î²v = 0 for v 6= l, âˆ maps to zero in Ï€0(cT sc

conclude existence of Î± âˆˆ Z 1(Q, T sc) whose cohomology class maps to (Î²v)v.

)D = (Ï€1(T sc)Î“)tors,

Î“(v)

Î“

Now, by changing Î±âˆ and w further, we may assume that Î±âˆ is the restriction of Î± to Gal(C/R).
Then, since the restriction map H 1(Q, Gsc) â†’ H 1(Qâˆ, Gsc) is injective (the Hasse principle), we
see that Î± becomes trivial as a cocycle with values in Gsc(Q). We summarize this discussion in the
diagram:

H 1(Qâˆ, T sc
0 )

/ H 1(Qâˆ, Gsc)

Î±âˆ
Î¹ = wÎ¹(wâˆ’1) âœ¤

H 1(Q, T sc
0 )

H 1(Q, Gsc)

âˆƒ Î±â´

So there exists u âˆˆ Gsc(Q) such that for all Ï âˆˆ Gal(Q/Q),

Î±Ï = uâˆ’1Ï(u).

/ 0

/ Î±â€²â´

â‡’ Î±â€² = 0.

Then, the homomorphism Intu : (T0)Q â†’ GQ : t â†’ tâ€² = utuâˆ’1 is deï¬ned over Q; in particular,
T := uT0uâˆ’1 is a torus deï¬ned over Q, and as the restriction of Intu to Z(G) is the identity, TR is
also elliptic in GR. Moreover, since uâˆ’1Î¹(u) = wÎ¹(wâˆ’1) for Î¹ âˆˆ Gal(C/R), one has that uw âˆˆ Gsc(R)
and

Intu(Âµâ€²) = Int(uw)Âµâˆ’1
h0

= Âµâˆ’1
h

for h := Int(uw)(h0) âˆˆ X âˆ© Hom(S, T ). This establishes the claims (i), (ii). The proof of the
claim (iii) is similar. As the restriction of Î± to Gal(Qp/Qp) is trivial, there exists x âˆˆ T (Qp) such
that xÏ(xâˆ’1) = Î±Ï = uâˆ’1Ï(u) for all Ï âˆˆ Gal(Qp/Qp), i.e. ux âˆˆ G(Qp). But, the homomorphism
Intu : (T0)Qp

also equals Intu = Intux. This proves (iii).

â†’ GQp

To ï¬nish the proof, we observe that for the pair ((T0)Qp, Âµâ€²) produced at the end of Step 1,
if (T, h) is the special Shimura datum obtained from (T0, Âµâ€²) by the procedure of Step 2, by the
property (iii), bâ€² equals the Ïƒ-conjugacy class of Âµâˆ’1

h (p) âˆˆ T (Qur
p ).

4.2 Aï¬ƒne Deligne-Lusztig varieties and veriï¬cation of the assumption (â€ ) In
this subsection, we prove that in fact, the assumption (â€ ) of Theorem 4.1.1 always holds (i.e. holds
for every b âˆˆ B(GQp, X)). For that, we use the fact (due to Witenberger [Win05])) that for any
b âˆˆ B(G, {Âµ}), the aï¬ƒne Deligne-Lusztig variety XÂµ(b) is non-empty. From the latter fact, we give
two ways of verifying the assumption (â€ ).

21

/
/
/
/
O
O
?

O
O
O
O
âœ¤
/
O
O
4.2.1 Let L be the completion of the maximal unramiï¬ed extension of a non-archimedean local
ï¬eld F in an algebraic closure F of F and Ïƒ âˆˆ Aut(L/F ) the relative Frobenius. Let G be an
unramiï¬ed reductive group over F .For a conjugacy class {Âµ} of cocharacters of G deï¬ned over L,
we have the ï¬nite set B(G, {Âµ}) deï¬ned in (3.2.7). Let S be a maximal F -split torus of G and T its
centralizer (so T is a maximal torus of G, since G is quasi-split); corresponding to S, there exists
an apartment a in the Bruhat-Tits building B(G, L) of the reductive group GL over L (cf. [Tit79]).

Let eK = Stab(x) be the (hyper)special subgroup of G(L) corresponding to a (hyper)special vertex

x of a. Fix a uniformizer ÌŸ of F . The aï¬ƒne Deligne-Lusztig variety associated with Âµ âˆˆ Xâˆ—(T )/â„¦
and b âˆˆ G(L) is deï¬ned to be the set

When bâ€² âˆˆ G(L) is Ïƒ-conjugate to b, say bâ€² = hâˆ’1bÏƒ(h), the map g 7â†’ gâ€² = hâˆ’1g induces a bijection

XÂµ(b) = {g eK âˆˆ G(L)/eK | gâˆ’1bÏƒ(g) âˆˆ eKÂµ(ÌŸ)eK}.

XÂµ(b) âˆ¼â†’ XÂµ(bâ€²).

(4.2.1.1)

Recall that a cocharacter Âµâ€² âˆˆ Xâˆ—(T â€²) of a maximal torus T â€² of GF is said to be minuscule if
hÎ±, Âµâ€²i âˆˆ {âˆ’1, 0, 1} for all simple roots Î± âˆˆ âˆ†(G, T â€²). It is well-known ([Del77, 1.2.5]) that any
Hodge cocharacter Âµ = Âµâˆ’1
h

(h âˆˆ X) is minuscule.

Theorem 4.2.2. [Win05, Corollare 3] Suppose Âµ is minuscule. Then for any b âˆˆ B(G, {Âµ}), the
set XÂµ(b) is non-empty.

Lemma 4.2.3. For a connected reductive group G over a p-adic ï¬eld F and a G(F )-conjugacy
class C of cocharacters, the assumption (â€ ) of Theorem 4.1.1 holds if there exists a quadruple

(M â€², bâ€², T â€², Âµâ€²),

where M â€² is a Levi subgroup of GQp, bâ€² is a representative in M â€²(L) of bâ€² whose Ïƒ-conjugacy
class in B(M â€²) is basic (cf.
[Kot85]), T â€² is an unramiï¬ed elliptic maximal Qp-torus of M â€², and
Âµâ€² âˆˆ Xâˆ—(T â€²) âˆ© C such that

ÎºM â€²(bâ€²) = [Âµâ€²]M â€²
(here, bâ€² denoting the Ïƒ-conjugacy class of bâ€² in B(M â€²)).

Proof. It suï¬ƒces to show that bâ€² âˆˆ M â€²(L) is Ïƒ-conjugate (in M â€²(L)) to Âµâ€²(p) âˆˆ T â€²(L). Since
T â€² is an elliptic maximal torus of M â€², the image of B(T â€²) in B(M â€²) equals the subset B(M â€²)b of
basic elements ([Kot85], Prop. 5.3), and there is a commutative diagram of natural maps with
bijective vertical maps ([Kot85], Prop. 5.6)

B(T â€²)

ÎºT â€²

âˆ¼=

B(M â€²)basic

ÎºM â€²

âˆ¼=

Xâˆ—(T â€²)Î“(p)

/ Ï€1(M â€²)Î“(p).

(4.2.3.1)

Denoting again (by abuse of notation) by Âµâ€²(p) the class of Âµâ€²(p) in B(T â€²), we have

ÎºT â€²(Âµâ€²(p)) = [Âµâ€²]T â€²

22

/
/




/
([RR96], Thm. 1.15 (ii)). So, since the elements Âµâ€²(p), bâ€² of B(M â€²) are both basic, their equality
can be checked after applying ÎºM â€². Then, the equality ÎºM â€²(bâ€²) = ÎºM â€²(Âµâ€²(p)) is just the assumption
ÎºM â€²(bâ€²) = [Âµ]M â€².

Recall that for a Levi subgroup M of G, an element b of M (L) is said to be G-regular basic for
M if the Ïƒ-conjugacy class of b in B(M ) is basic (so that Î½b is deï¬ned over Qp, cf. [Kot85, (4.4.3)])
[Kot85, Â§6]). A Levi subgroup of G is said to be standard if
and CentGQp (Î½b) is equal to M (cf.
it contains the centralizer CentG(S) of a maximal Qp-split torus S of G (CentG(S) is a maximal
torus since G is quasi-split).

Proposition 4.2.4. Let G be an unramiï¬ed connected reductive group over Qp and C be a G(Qp)-
. Let GZp be a
conjugacy class of cocharacters, containing a minuscule one Âµ0 : GmQp
reductive Zp-group scheme with generic ï¬bre GZp âŠ—Zp Qp = G and put Kp := GZp(Zp). Let B(G, C)
be the subset of B(G) as deï¬ned in (3.2.7).

â†’ GQp

(1) For any b âˆˆ B(G, C), there exists a pair (T, Âµ) satisfying the assumption (â€ ) of Theorem

4.1.1 and furthermore such that the unique hyperspecial subgroup of T (Qp) is contained in Kp.

(2) Suppose that one of the following two conditions holds:
(i) Gder is simply connected;
(ii) there exists a representation Ï : GQp

every weight of Ï â—¦ Âµ0 is either 0 or 1;

â†’ GL(V ) over Qp with ï¬nite kernel and such that

Then, for every triple

(M, b, T ),

where M is a standard Levi Qp-subgroup of GQp splitting over L, b âˆˆ M (L) is a basic element (i.e.
b âˆˆ B(M )basic), and T is a maximal torus of M , there exists Âµ âˆˆ Xâˆ—(T ) âˆ© C such that

ÎºM (b) = [Âµ]M .

(3) Under the assumption of (2), for any b âˆˆ B(G, C), there exists a quadruple (M, b, T, Âµ) as in
(2), which further satisï¬es that b âˆˆ M (L) is GQp-regular basic, T is an unramiï¬ed elliptic maximal
torus of M , and that the unique hyperspecial subgroup of T (Qp) is contained in a G(Qp)-conjugate
of Kp.

Note that clearly the condition (ii) of (2) is satisï¬ed when (G, C) arises (via obvious base-change

from Q to Qp) from a Hodge-type Shimura datum.

Proof.

In the cases of the assumptions of (2), by Lemma 4.2.3, (2) and (3) together give another proof
of the fact that the condition (â€ ) as well as the claim on the hyperspecial subgroup hold for every
b âˆˆ B(G, C), with certain simpliï¬cation (i.e. simple proof of (4.2.4.3)) in the Hodge-type case (ii).
(1) This is what is established in the proof of Lemma 5.11 of [LR87]; a (slightly
diï¬€erent) account of this proof is also given in [Kis13, Lem. (2.2.2)]. From the start, Langlands-
Rapoport considers only isocrystals b âˆˆ B(GQp) with non-empty XÂµ(b). Also, in their argument,
T can be any (unramiï¬ed) maximal Qp-torus of GQp. So in our case, we can simply take T to be
an unramiï¬ed maximal Qp-torus of GQp such that the unique hyperspecial subgroup of T (Qp) is
contained in Kp (which exists by Lemma A.0.4). Here, for the convenience of readers, we give a
sketch of the argument of [LR87, Lem. 5.11]; we also use the notations of loc.cit.

Let M be the centralizer of a maximal Qp-split sub-torus of T .

It is a Levi subgroup of a
parabolic subgroup Q of G deï¬ned over Qp. Note that T is an elliptic maximal torus of M and
M is unramiï¬ed (since T is assumed to be unramiï¬ed). We may assume that M (L) âˆ© GZp(OL)

23

is a special subgroup of M (L) ([Tit79]). Then, choose an unramiï¬ed maximal Qp-torus T â€² of M
such that T â€² contains a maximal Qp-split torus whose corresponding apartment in the Bruhat-Tits
building contains the hyperspecial point corresponding to Kp = GZp(Zp) (so that the hyperspecial
subgroup of T â€²(Qp) is contained in Kp); from the beginning, one can assume that T is such a torus
and take T â€² = T (Lemma A.0.4). Choose representatives b âˆˆ M (L) of b and Âµâ€² âˆˆ Xâˆ—(T â€²) of C.
Then, the following facts are established step by step:

(i) There exist m âˆˆ M (L) and nâ€² âˆˆ N (L), where N is the unipotent radical of Q, such that

mâˆ’1bÏƒ(m)nâ€² âˆˆ KLÂµâ€²(p)KL

(KL := GZp(OL)).

(ii) Let Âµâ€²â€² âˆˆ Xâˆ—(T â€²) be deï¬ned, via the Cartan decomposition for M ([Tit79, 3.3.3]), by that

mâˆ’1bÏƒ(m) âˆˆ (KL âˆ© M (L))Âµâ€²â€²(p)(KL âˆ© M (L)).

(4.2.4.1)

Then, Âµâ€²â€² is conjugate to Âµâ€².

(iii) Let Î½b be a Qp-rational representative of Î½b âˆˆ N (G) = (IntG(L)\HomL(D, GL))hÏƒi that
factors through T (which exists by Prop. 6.2 of [Kot85]) and let Âµ be a cocharacter of T
that is conjugated to Âµâ€²â€² in M . Then for any Lr = L(Fpr ) splitting T , we have an equality in
Xâˆ—(T )

rÎ½b = NmLr/Qp(Âµ)

The statement (i) is a consequence of that XÂµâ€²(b) 6= âˆ….

The claim (ii) is the technical heart of the proof. It is proved using [Kot84b], Lemma 2.3.3 and
2.3.7: the latter lemma uses Satake transform, and the former lemma can be given a simple proof
in Hodge-type situation (the case (ii) of the statement (2) of this proposition, cf. proof of (4.2.4.3)
below). We note that the equation (4.2.4.1) implies

Î»M (mâˆ’1bÏƒ(m)) = [Âµâ€²â€²]M .

(4.2.4.2)

Here, Î»M : M (L) â†’ X âˆ—(Z(cM )) is the map deï¬ned in [Kot84b, Lem.3.3] (strictly speaking, the

is obtained from this map by taking Galois invariants, i.e. H 0(Qp, âˆ’)), and [âˆ’]M
map in loc.cit.
denotes (by abuse of notation) the natural map Xâˆ—(T â€²) â†’ Ï€1(M ). Also, Î»M induces the map ÎºM
of Theorem 2.2.3 by taking H 1(Qp, âˆ’).

The proof of (iii) goes as follows: clearly, the equality in (iii) is equivalent to the statement that

for each Qp-rational character Ï‡ of T , one has that

hÏ‡, Âµi = hÏ‡, Î½bi

(this is the same as (5.n) on p.178 of [LR87]: Î½p in (5.n) equals rÎ½b = [Lr : Qp]Î½b in our notation,
and the sign diï¬€erence is due to that our sign convention of c(GQp, X) is diï¬€erent from that of
Langlands-Rapoport). But because T is elliptic in M , each Qp-rational character of T can be also
regarded as a character of M (equivalently, of the maximal abelian quotient M ab of M ), and as
hÏ‡, Âµi = hÏ‡, Âµâ€²â€²i for any character Ï‡ of M , the claim (iii) is the same as that for every Qp-rational
character Ï‡ of M

hÏ‡, Âµâ€²â€²i = hÏ‡, Î½bi,

24

and this is a direct consequence of the equation (4.2.4.1), as shown in [LR87, p.178-179]. Alter-
natively, assuming that T is an unramiï¬ed and taking T â€² = T , Âµ = Âµâ€²â€², we can also proceed as
follows: as T is elliptic in M , Î½b is central in M (i.e. mâˆ’1bÏƒ(m) âˆˆ M (L) is basic), hence in view of
the equation (4.2.4.2), (M, mâˆ’1bÏƒ(m), T, Âµâ€²â€²) satisï¬es the conditions of Lemma 4.2.3, which gives
that the two Qp-rational cocharacters rÎ½b, NmLr/Qp(Âµâ€²â€²) of T are conjugated in M (L), so their
projections to M ab are equal. But, they factor through the maximal Qp-split sub-torus T1 of T ,
and as T is elliptic in M , the natural map T1 â†’ M ab induces an injection Xâˆ—(T1) Ö’â†’ Xâˆ—(M ab).
So, we must have that rÎ½b = NmLr/Qp(Âµâ€²â€²).

(3) Let us ï¬rst prove (3) assuming (2). Let S be any maximal Qp-split Qp-torus of G. According
to [Kot85, Prop.6.2], there exist a standard Levi subgroup M of G and b âˆˆ M (L) with b âˆˆ b such
that b is basic G-regular for M . In fact, M can be taken to be the centralizer of any Qp-rational
representative Î½p âˆˆ HomQp(D, G) of the Newton point Î½G(b) âˆˆ N (G) = (IntG(L)\HomL(D, GL))hÏƒi
(proof of Prop. 6.2 of [Kot85]). Furthermore, there exists an unramiï¬ed elliptic maximal Qp-torus
T of M (Lemma A.0.4). So far these discussions concern Qp-groups.

For Zp-groups, we can choose a maximal Qp-split Qp-torus S such that in the Bruhat-Tits
building B(G, Qp), the hyperspecial point x ï¬xed by Kp is contained in the apartment associated
with S. For such S, let SZp be the reductive Zp-group scheme with generic ï¬ber being S and
such that SZp(Zp) is the (unique) hyperspecial subgroup of S(Qp). We claim that SZp and T â€²
:=
Zp
CentGZp (SZp) are smooth, closed subschemes of GZp. To see that SZp is a closed subscheme of GZp,
we ï¬rst observe that SZp(OL) maps to GZp(OL) under the embedding S Ö’â†’ G, where OL is the ring
of integers of L. This follows from the two facts: ï¬rst, the hyperspecial point x of B(G, Qp) is also
a hyperspecial point of B(G, L) with the associated OL-group scheme being (GZp )OL ([Tit79, 3.4,
3.8]), and secondly, for a maximal L-split torus S1 of G containing S and deï¬ned over Qp (which
exists since G is quasi-split), x âˆˆ B(G, L) lies in the apartment corresponding to S1 ([Tit79, 1.10]).
So, x is ï¬xed under the maximal bounded subgroup S1(OL) of S1(L), and thus under SZp(OL)
as well. Then, according to [Vas99, 3.1.2.1], this implies that the Qp-embedding S Ö’â†’ G extends
to a Zp-embedding SZp Ö’â†’ GZp. The fact that T â€²
:= CentGZp (SZp) is a smooth closed group
Zp
Zp-subscheme of GZp is well-known ([SGA3, XI, 5.3], [Con11, 2.2]). Moreover, one knows that it
represents the functor on Zp-schemes:

Râ€² 7â†’ {g âˆˆ G(Râ€²) | g(SZp )Râ€²gâˆ’1 = (SZp)Râ€²},

and its generic ï¬bre T â€² := CentG(S) is a maximal torus of G which splits over L, since GQp is quasi-
split ([Tit79, 1.10]). Next, there exists a Qp-rational representative Î½p of Î½G(b) âˆˆ HomQp(D, G)hÏƒi
which factors through S ([Kot84b, (1.1.3)]). Suppose that N Î½p (N âˆˆ N) is a morphism from Gm
to S âŠ‚ T â€² (not just a quasi-cocharacter). Then, the image of N Î½p is a Qp-split subtorus of T â€²,
and since T â€² extends over Zp, this image extends uniquely to a Zp-subtorus U of T â€²
Zp (use the
equivalence between the category of Qp-tori and the category of free Z-modules with Î“(p)-action,
under which Zp-tori correspond to unramiï¬ed Î“(p)-modules). The morphism U â†’ T â€²
is a closed
Zp
embedding ([SGA3, IX.2.5]).

Now, as mentioned above, we may take CentG(N Î½) for M . It is the generic ï¬bre of MZp :=
CentGZp (U ), which is a reductive group scheme over Zp ([SGA3, XI, 5.3], [Con11, 2.2]). Therefore,
by Lemma A.0.4, there exists a maximal torus TZp deï¬ned over Zp of MZp whose generic ï¬bre
T = TZp âŠ— Qp is elliptic in M = MZp âŠ— Qp (and thus is unramiï¬ed over Qp). Finally, the claim
follows since the unique hyperspecial subgroup of T (Qp) is TZp(Zp) (which is also the unique
maximal compact subgroup of T (Qp)).

25

(2) Following [Kot03], Â§4.2, for arbitrary Âµ âˆˆ Xâˆ—(T ), we put

PÂµ := {Î½ âˆˆ Xâˆ—(T ) | [Î½]G = [Âµ]G, Î½ âˆˆ Conv(â„¦G Â· Âµ)},

where Conv(â„¦G Â· Âµ) denotes the convex hull in Xâˆ—(T )R of the orbit â„¦G Â· Âµ, â„¦G being the absolute
Weyl group of T in G. In the original deï¬nition of PÂµ, instead of our T , Kottwitz used a maximal
torus of M containing a maximal Qp-split torus of GQp, but there is an obvious bijection between
PÂµâ€™s obtained using two diï¬€erent maximal tori of M . We also remark that when Gder is simply-
connected, the ï¬rst condition [Î½]G = [Âµ]G in the deï¬nition of PÂµ is implied by the second one (under

this assumption, the second condition implies that Âµ âˆ’ Î½ lies in the coroot lattice PÎ±âˆˆâˆ† ZÎ±âˆ¨ =

Xâˆ—(T âˆ© Gder); see below for a proof).

Let PÂµ,M denote the subset of Ï€1(M )Î“(p) (which was denoted by YM in [Kot03]) obtained as
the image of PÂµ under the canonical surjection [ Â· ]M : Xâˆ—(T ) â†’ Ï€1(M )Î“(p). Then, Kottwitz
shows ([Kot03, Thm. 4.3]) that for every standard Levi subgroup M and any basic bâ€² âˆˆ M (L) and
Âµâ€² âˆˆ Xâˆ—(T ), we have that

ÎºM (bâ€²) âˆˆ PÂµâ€²,M if and only if XÂµâ€²(bâ€²) 6= âˆ….

On the other hand, the result of Wintenberger (Theorem 4.2.2) tells us that for any minuscule
cocharacter Âµâ€² and any bâ€² âˆˆ G(L),

XÂµâ€²(bâ€²) 6= âˆ…

if and only if

Î½(bâ€²) âˆˆ B(G, {Âµâ€²}).

Hence, it follows from these together that for any bâ€² âˆˆ B(G, {Âµâ€²}), ÎºM (bâ€²) lies in PÂµâ€²,M .

Finally, it remains to show that

In turn, since one has [Î½]G = [Âµâ€²]G for any Î½ âˆˆ â„¦G Â· Âµâ€², it suï¬ƒces to show that

PÂµâ€²,M (= [PÂµâ€² ]M ) = [â„¦G Â· Âµâ€²]M ,

Xâˆ—(T ) âˆ© Conv(â„¦G Â· Âµâ€²) = â„¦G Â· Âµâ€².

(4.2.4.3)

First, suppose that Gder is simply connected. Then, for any minuscule cocharacter Âµâ€² âˆˆ Xâˆ—(T ),
one has

Xâˆ—(T ) âˆ© Conv(â„¦G Â· Âµâ€²)

(a)
= (Âµâ€² + Qâˆ¨) âˆ© Conv(â„¦G Â· Âµâ€²)

(b)
= â„¦G Â· Âµâ€²,

2.2]) that when one ï¬xes a set âˆ† of simple roots and Âµâ€² lies in the associated closed Weyl chamber

where Qâˆ¨ = PÎ±âˆˆâˆ† ZÎ±âˆ¨ is the coroot lattice. The equality (a) is due to the fact ([RR96, Lemma
C âŠ‚ Xâˆ—(T )R, Âµ âˆˆ Conv(â„¦G Â· Âµâ€²) implies that Âµâ€² âˆ’ wÂµ âˆˆ C âˆ¨ := PÎ±âˆˆâˆ† Râ‰¥0Î±âˆ¨ âŠ‚ Xâˆ—(T der)R for every

w âˆˆ â„¦, and the fact that

Qâˆ¨ = Xâˆ—(T der) = Xâˆ—(T ) âˆ© Xâˆ—(T der)R

(âŠ‚ Xâˆ—(T )R)

for simply connected Gder. To see the second equality, we note that since Gder is simply connected,
(T âˆ© Gder)0 = T âˆ© Gder, thus the submodule Xâˆ—(T der) of Xâˆ—(T ) is a direct summand (as follows,
for example, by applying [Kot84b, Cor. 2.3] to the exact sequence of diagonalizable groups 1 â†’
T âˆ© Gder â†’ T â†’ Gab â†’ 1, to get an exact sequence of free Z-modules).3 The equality (b) is
[Kot84b, Lemma 2.3.3].

3We also note the fact that when Gder is simply connected, for x, xâ€² âˆˆ Xâˆ—(T ), if x âˆ’ xâ€² âˆˆ Xâˆ—(T der)R, one has that

xâ€² â‰¥ x (xâ€² (cid:23) x in our notation) if and only if xâ€² âˆ’ x âˆˆ PÎ±âˆˆâˆ† Zâ‰¥0Î±âˆ¨.

26

Next, suppose that we are in the situation of case (ii). Fix a maximal torus T â€² of GL(V )

containing Ï(T ). Since the induced map Ïâˆ— : Xâˆ—(T ) â†’ Xâˆ—(T â€²) is linear, we have the inclusion

Ïâˆ—(Xâˆ—(T ) âˆ© Conv(â„¦G Â· Âµâ€²)) âŠ‚ Xâˆ—(T â€²) âˆ© Conv(Ïâˆ—(â„¦G Â· Âµâ€²)).

Also, since Ï has ï¬nite kernel, Ïâˆ— is injective. Let {e1, Â· Â· Â· , en} be the weights of the representation
T â€² â†’ GL(V ); clearly, these form a basis X âˆ—(T ), giving an identiï¬cation X âˆ—(T â€²) = Zn, Xâˆ—(T â€²) = Zn.
Likewise, the set {e1 â—¦ Ï, Â· Â· Â· , en â—¦ Ï} consists of weights of (T, Ï|T ), and for any Âµ âˆˆ Xâˆ—(T ), each
ei â—¦ Ïâˆ—(Âµ) âˆˆ Z (i = 1, Â· Â· Â· , n) is also a weight of Ï â—¦ Âµ : Gm â†’ GL(V ). So, by assumption (which
also implies that for any Âµ âˆˆ â„¦G Â· Âµ, every weight of Ï â—¦ Âµ is either 0 or 1), the set Ïâˆ—(â„¦G Â· Âµâ€²) âŠ‚ Zn
is contained in the set of vertices of the hypercube Bn := {(xi) âˆˆ Rn | 0 â‰¤ xi â‰¤ 1}; in particular,
Conv(Ïâˆ—(â„¦G Â· Âµâ€²)) âŠ‚ Rn is contained in the hypercube Bn. Then, since Xâˆ—(T â€²) = Zn âŠ‚ Rn, the
intersection Xâˆ—(T â€²) âˆ© Conv(Ïâˆ—(â„¦G Â· Âµâ€²)) must be equal to the vertex set of Conv(Ïâˆ—(â„¦G Â· Âµâ€²)), and
thus a subset of Ïâˆ—(â„¦G Â· Âµâ€²). Since Ïâˆ— is injective, this proves (4.2.4.3).
Remark 4.2.5. (1) The main ideas of the two proofs of the condition (â€ ) are quite similar. But, the
details are still diï¬€erent. For example, the Levi subgroup M in the proof of (1) is in general diï¬€erent
(albeit related) from the Levi subgroup appearing in (2) and (3): the latter is the centralizer of a
Qp-rational representative of the conjugacy class Î½b, while the former is not necessarily so.

(2) In fact, the claim of (2) holds more generally for any Levi subgroup splitting over L (not

just for standard Levi subgroups). Indeed, we only need to check that for such Levi subgroup,

ÎºM (bâ€²) âˆˆ PÂµâ€²,M if XÂµâ€²(bâ€²) 6= âˆ….

Indeed, this direction of Theorem 4.3 of [Kot03] follows from Lemma 4.5, Lemma 4.6 there; this
part does not use Lemma 4.4 of loc. cit., whose proof seems to require the group to be unramiï¬ed,
and Lemma 4.6 is Lemma 4.5 of [KR03]. Both of these lemmas (and the mathematical facts used
for their proofs, such as the Iwasawa (resp. Cartan) decompositions for GL (resp.
for ML)) are
statements about either reductive groups deï¬ned over F and splitting over L (Lemma 4.5), or split
reductive groups over L (Lemma 4.6 of [Kot03], i.e. Lemma 4.5 of [KR03]); one also notes that
the same argument in fact establishes the stronger fact that if XÂµâ€² (bâ€²) 6= âˆ…, the subset Î»M (bâ€²) of

Ï€1(M ) = X âˆ—(Z(cM )) equals the image of PÂµâ€² under the canonical surjection Xâˆ—(T ) â†’ Ï€1(M ) (in

the introduction of [Kot03], Î»M was denoted by wM : G(L) â†’ Ï€1(M )).

4.3 First proof of non-emptiness of Newton strata We now give our ï¬rst proof of the
main theorem.

Theorem 4.3.1. Let (G, X) be a Shimura datum. Let p be a rational prime such that GQp is
unramiï¬ed, and ï¬x a hyperspecial subgroup Kp of G(Qp). Choose a prime â„˜ of E(G, X) above p
and an embedding Î¹p : Q Ö’â†’ Qp inducing â„˜.

Then, for every b âˆˆ B(GQp, X), there exists a special sub-Shimura datum (T, h : S â†’ TR) such
that TQp is unramiï¬ed and the unique hyperspecial subgroup of T (Qp) is contained in Kp, and that
the Ïƒ-conjugacy class of Âµâˆ’1

h (p) âˆˆ G(Qur

p ) equals b.

In particular, if (G, X) is of Hodge type, for every gf âˆˆ G(Af ), the special point [h, gf ]Kp âˆˆ

ShKp(G, X)(Q) has good reduction at Î¹p and the F -isocrystal of its reduction in SKp(Â¯Fp) is b.

27

Recall that a special point of ShK is said to have good reduction at Î¹p if it extends as a point in

SK(OÎ¹p) for the valuation ring OÎ¹p of Q deï¬ned by Î¹p.

Proof. We can apply Theorem 4.1.1 and Proposition 4.2.4, to obtain a special Shimura datum
(T1, h1 : S â†’ (T1)R) such that (T1)Qp is unramiï¬ed and the unique hyperspecial subgroup of T1(Qp)
is contained in Int(gp)(Kp) for some gp âˆˆ G(Qp) and that the Ïƒ-conjugacy class of Âµâˆ’1
(p) âˆˆ G(Qur
p )
h1
equals b. Since G(Q) is dense in G(Qp) ([Mil94, Lem. 4.10]), there exists g âˆˆ G(Q) âˆ© Kp Â· gâˆ’1
p .
Then, the new special Shimura datum (T, h) := Int(g)(T1, h1) still enjoys the same properties and
further satisï¬es that the unique hyperspecial subgroup of T (Qp) is contained in Kp. If moreover
(G, X) is of Hodge type, according to Lemma 3.2.4, for every gf âˆˆ G(Af ), the special point
[h, gf ]Kp âˆˆ ShKp(G, X)(Q) has good reduction at Î¹p : Q Ö’â†’ Qp and the F -isocrystal of its reduction
in SKp(G, X)(Â¯Fp) is b.

Corollary 4.3.2. Let (G, X) be a Shimura datum of Hodge type. Choose an embedding Î¹p : Q Ö’â†’ Qp
and let â„˜ be the prime of E(G, X) induced by Î¹p. Suppose that GQp is unramiï¬ed and choose a
hyperspecial subgroup Kp of G(Qp). Then the reduction SKp(G, X) Ã— Îº(â„˜) has non-empty ordinary
locus if and only if â„˜ has absolute height one (i.e. E(G, X)â„˜ = Qp).

Proof. The necessity of E(G, X)â„˜ = Qp was proved in [Bul01, Section3]. For suï¬ƒciency, we

note that it suï¬ƒces to ï¬nd a special Shimura sub-datum (T, {h}) with the following properties:

(i) TQp is unramiï¬ed and the unique hyperspecial subgroup of T (Qp) is contained in Kp;
(ii) there exists a Borel subgroup B over Qp of GQp containing TQp and such that Âµh âˆˆ Xâˆ—(T )

lies in the closed Weyl chamber determined by (TQp, B).

Indeed, then the canonical Galois action of Î“(p) on Xâˆ—(T ) coincides with the naive Galois action,
hence one has that E(G, X)â„˜ = E(T, h)p, where p is the prime of E(T, h) induced by Î¹p. Given
this, the corollary then follows from the fact ([Bul01, Lem.2.2]) that for a CM-abelian variety A
over Q(âŠ‚ C) with CM-type (F, Î¦), where F is a CM-algebra and Î¦ is a subset of Hom(F, C)) with
Î¦ âŠ” Î¹ â—¦ Î¦ = Hom(F, C), the reduction of A at Î¹p : Q Ö’â†’ Qp is an ordinary abelian variety if and
only if the prime of the reï¬‚ex ï¬eld E = E(F, Î¦) induced by Î¹p is of absolute height one; when A is
deï¬ned by a special Shimura datum (T, h), the reï¬‚ex ï¬eld E(F, Î¦) equals the reï¬‚ex ï¬eld E(T, h)
deï¬ned earlier.

:= CentGZp (SZp) are smooth, closed subschemes of GZp, and thus T â€² := T â€²
Zp

Now, to prove the claim, let Kp = GZp(Zp) for a reductive Zp-group scheme model GZp of
GQp and S a maximal Qp-split torus of GQp such that in the Bruhat-Tits building B(G, Qp),
the hyperspecial point x ï¬xed by Kp is contained in the apartment associated with S. For such
S, let SZp be the reductive Zp-group scheme with generic ï¬ber S and such that SZp(Zp) is the
(unique) hyperspecial subgroup of S(Qp). Then the proof of Prop. 4.2.4, (3) shows that SZp and
T â€²
âŠ— Qp is unramiï¬ed.
Zp
Moreover, since GQp is quasi-split, T â€² is a maximal torus of GQp, and by construction the unique
hyperspecial subgroup of T â€²(Qp), i.e. T â€²
Zp(Zp) is contained in Kp. Since GQp is quasi-split, there
exists a Borel subgroup Bâ€² deï¬ned over Qp which contains T â€². Let Âµâ€² be the cocharacter in c(G, X)
factoring through T â€² and lying in the closed Weyl chamber determined by (T â€², Bâ€²). Let (T, {h})
be a special Shimura sub-datum produced from (T â€², Âµâ€²) as in the proof of Theorem 4.3.1 using
Theorem 4.1.1 (so, in particular T (Zp) âŠ‚ Kp). Then, as (TQp, Âµh) is conjugate to (T â€², Âµâ€²) under
G(Qp), the claim is now clear.

Remark 4.3.3. (1) In fact, for any special Shimura sub-datum (T, h) with the properties (i), (ii) in
the proof, every special point of ShKp(G, X) deï¬ned by it has Âµ-ordinary reduction at Î¹p. So, we

28

get a more direct proof of non-emptiness of Âµ-ordinary locus (without invoking a Levi subgroup as
in Proposition 4.2.4, etc).

(2) This corollary was proved in the PEL-type cases of Lie type A or C by Wedhorn [Wed99].
His argument was to ï¬rst establish non-emptiness of the Âµ-ordinary locus, and then to check that
the Âµ-ordinary locus equals the (usual) ordinary locus when E(G, X)â„˜ = Qp (in the PEL-type
cases of Lie type A or C). But to check the second statement, he relied on a case-by-case analysis.
In contrast, we observe that in view of (1), the equality of the Âµ-ordinary Newton point and the
ordinary Newton point when E(G, X)â„˜ = Qp is a consequence of the existence of a special Shimura
sub-datum (T, h) with the properties (i), (ii) in the proof (since the reduction of such special point
attains simultaneously the two Newton points when E(G, X)â„˜ = Qp).

5 Construction of Kottwitz triple with prescribed F -isocrystal

In this section, assuming that Gder is simply-connected, we construct a Kottwitz triple (Î³0; (Î³)l6=p, Î´)
(see below for its deï¬nition) such that the F -isocrystal with GQp-structure attached to Î´ âˆˆ G(L)
equals the given one. According to the Langlands-Rapoport conjecture [LR87], which is now
conï¬rmed by Kisin [Kis13], such a triple corresponds to an Â¯Fp-valued point in the reduction
of SKp(G, X), if it satisï¬es certain additional condition, and under this correspondence the F -
isocrystal of the abelian variety corresponding to the point is identiï¬ed with the F -isocrystal de-
ï¬ned by the Ïƒ-conjugacy class of Î´ in the triple. The Kottwitz triple that we will construct in this
section will satisfy the additional condition just mentioned. Therefore, combined with the result of
Kisin, we will get another proof of the non-emptiness of Newton strata for Shimura varieties with
simply connected derived group.

5.1 Kottwitz triples Our two main references for the material covered here are [LR87], pp.
182-183 and [Kot88], Â§2. Let (G, X) be a Shimura datum. Throughout this section, we assume
that Gder is simply connected. Let p be a rational prime. We ï¬x a prime â„˜ of E(G, X) that is
unramiï¬ed above p. Recall that Q is given as the algebraic closure of Q in C and E(G, X) is by
deï¬nition a subï¬eld of Q âŠ‚ C (thus the embedding Q Ö’â†’ C determines an inï¬nite place E Ö’â†’ C) .
For every place v of Q, we ï¬x an embedding Q Ö’â†’ Qv, such that for v = p, âˆ this should induce
the above places of E(G, X). For each r âˆˆ N, let Lr denote the unramiï¬ed extension of degree r of
Qp in Qp (i.e. L(Fpr ) in our previous notation), and denote by L = L(Â¯Fp) the completion of Qur
p ,
the maximal unramiï¬ed extension of Qp in Qp. Let Ïƒ be the absolute Frobenius on L; so, Lr is the
subï¬eld of L of elements ï¬xed under Ïƒr.

5.1.1 We consider a triple (Î³0; Î³ = (Î³l)l6=p, Î´), where

(i) Î³0 is a semi-simple element of G(Q) that is elliptic in G(R), deï¬ned up to conjugacy in G(Q);

(ii) for l 6= p, Î³l is a semi-simple element in G(Ql), deï¬ned up to conjugacy in G(Ql), which is

conjugate to Î³0 in G(Ql);

(iii) Î´ is an element of G(Ln) (for some n), deï¬ned up to Ïƒ-conjugacy in G(L), such that the norm

NmnÎ´ of Î´ is conjugated to Î³0 under G(L), where NmnÎ´ := Î´ Â· Ïƒ(Î´) Â· Â· Â· Ïƒnâˆ’1(Î´) âˆˆ G(Qp).

29

There are some conditions to impose on such triple. Let I0 be the centralizer CentG(Î³0) of
Î³0 in G. For every place v of Q, we will deï¬ne an algebraic Qv-group I(v) and an inner twisting
Ïˆv : I0 â†’ I(v) over Qv. First, for each ï¬nite place v 6= p of Q, let I(v) be the centralizer of Î³v in
GQv . If one chooses gv âˆˆ G(Qv) such that gvÎ³0gâˆ’1
v = Î³v, then Int(gv), restricted to I0, gives an
inner twisting Ïˆv : I0 â†’ I(v), well deï¬ned up to inner automorphism of I0. Next, for v = p, deï¬ne
an algebraic Qp-group I(p) by

I(p) := {x âˆˆ ResLn/Qp(GLn) | xâˆ’1Î´Î¸(x) = Î´},

Here, Î¸ is the Qp-automorphism of ResLn/Qp(GLn ) induced by the restriction of Ïƒ to Ln; for more
details, we refer to [Kot82], where Î¸ and I(p) are denoted by s (on p. 801) and IsÎ´ (on p. 802),
respectively. Then, Lemma 5.8 of loc.cit. gives us an inner twisting Ïˆp : I0 â†’ I(p), canonical up to
inner automorphisms of I0; since Î³0 and NmLn/Qp(Î´) are G(Qp)-conjugated, Î³0 âˆˆ G(Qp) lies in the
stable conjugacy class of Î´ (cf. loc.cit. Â§5). Finally, at the inï¬nite place, choose an elliptic maximal
torus T of GR containing Î³0. When we pick h âˆˆ X such that h factors through TR, by deï¬nition of
Shimura datum, Int(h(i)) induces a Cartan involution on I0/Z(G), which we use to twist I0 over
R, obtaining an inner twisting Ïˆâˆ : I0 â†’ I(âˆ) with I(âˆ)/Z(G) being anisotropic over R.

Then we consider the following condition on the triple (Î³0; Î³ = (Î³l)l6=p, Î´) as above; let Ïˆv :

I0 â†’ I(v) be inner twistings as just described.

(iv) There exists a triple (I, Ïˆ, (jv )) consisting of a Q-group I, an inner twisting Ïˆ : I0 â†’ I and
for each place v of Q, an isomorphism jv : I â†’ I(v) over Qv, unramiï¬ed almost everywhere,
such that jv â—¦ Ïˆ and Ïˆv diï¬€er by an inner automorphism of I0 over Qv.

Deï¬nition 5.1.2. A Kottwitz triple is a triple (Î³0; (Î³l)l6=p, Î´) satisfying (i) - (iv), and the following
two conditions (âˆ—(Î´)), (âˆ—(Î³0)):

(âˆ—(Î´)) the image of (the Ïƒ-conjugacy class of) Î´ under the map ÎºGQp : B(GQp) â†’ Ï€1(GQp)Î“(p) =

X âˆ—(Z(bG)Î“(p)) (Thm. 2.2.5) is equal to Âµâ™® (where Âµâ™® was deï¬ned in (3.2.6)).

(âˆ—(Î³0)) Let H be the centralizer in GQp of the maximal Qp-split torus in the center of (ZG(Î³0))Qp.
Then, there exists Âµ âˆˆ Xâˆ—(H) which is deï¬ned over Ln and lies in c(G, X) (via the given
embeddings Q Ö’â†’ C, Q Ö’â†’ Qp), and such that

Î»H (Î³0) = NmLn/QpÂµ,

where Î»H is the homomorphism Î»H : H(Qp) â†’ Ï€1(H)Î“(p) = X âˆ—(Z(bH))Î“(p) deï¬ned (for

quasi-split Qp-groups) in [Kot84b], Â§3.

Remark 5.1.3. 1) Following Kisin [Kis13], we will say that a Kottwitz triple (Î³0; (Î³l)l6=p, Î´) is of
level n if Î´ âˆˆ G(Ln).

2) Two triples (Î³0; (Î³l)l6=p, Î´), (Î³â€²

l)l6=p, Î´â€²) as in (5.1.1) with Î´, Î´â€² âˆˆ G(Ln) for (iii) are said to
be equivalent, if Î³0 is stably conjugate to Î³â€²
l in G(Ql) for each l 6= p, âˆ, and
Î´ is Ïƒ-conjugate to Î´â€² in G(Ln). Then, for two such equivalent triples, one of them is a Kottwitz
triple of level n if and only if the other one is so (cf. see [LR87, Lemma 5.17] for the condition
(âˆ—(Î³0))).

0; (Î³â€²

0, Î³l is conjugate to Î³â€²

3) As noted in [Kot88], p.172, the condition (iv) holds if the Kottwitz invariant Î±(Î³0; Î³, Î´) (to

be recalled below) is trivial.

30

4) The two conditions (âˆ—(Î´)), (âˆ—(Î³0)) are from [LR87], p.182-183. Some authors do not include
these (especially, (âˆ—(Î³0))) in their deï¬nition of Kottwitz triple. This will be partly a matter of
taste. It is, however, necessary to point out [LR87] that a triple (Î³0; (Î³l)l6=p, Î´) satisfying (i)-(iv)
can correspond to an Â¯Fp-valued point of the Shimura variety only if it further satisï¬es these two
conditions, so from the viewpoint of the question of ï¬nding an Â¯Fp-valued point of given Shimura
variety using such triple (as in the current work), it is natural to include these conditions (âˆ—(Î´)),
(âˆ—(Î³0)) in the deï¬nition of Kottwitz triple.

5) In view of our sign convention of c(G, X) in (3.0.6), our formulation (especially the sign) of

the condition (âˆ—(Î´))) is the same as that of Kottwitz appearing in [Kot88, p.165].

[Kot88], Â§2.
5.2 Kottwitz invariant We recall the deï¬nition of the Kottwitz invariant, cf.
Note that the centralizer I0 of Î³0 in G is connected and reductive since Î³0 is semisimple and the

derived group of G is simply connected. There is a natural embedding Z(bG) â†’ Z(bI0), and the

exact sequence

induces a homomorphism ([Kot84a, Cor.2.3])

1 â†’ Z(bG) â†’ Z(bI0) â†’ Z(bI0)/Z(bG) â†’ 1

Ï€0((Z(bI0)/Z(bG))Î“) â†’ H 1(Q, Z(bG)),

where Î“ := Gal(Q/Q). Let ker1(Q, Z(bG)) be the kernel of the map H 1(Q, Z(bG)) â†’ Qv H 1(Qv, Z(bG)),
and let K(I0/Q) denote the subgroup of Ï€0((Z(bI0)/Z(bG))Î“) consisting of elements whose image in
H 1(Q, Z(bG)) lies in ker1(Q, Z(bG)). Since Î³0 is elliptic, we have an identiï¬cation

K(I0/Q) = (cid:16)âˆ©vZ(bI0)Î“(v)Z(bG)(cid:17) /Z(bG),

and this is known to be a ï¬nite group. The Kottwitz invariant Î±(Î³0; Î³, Î´) is then a character of
K(I0/Q) (i.e. an element of Hom(K(I0/Q), CÃ—)), deï¬ned as a product, over all places v of Q,

of local components, where the v-component is the restriction to âˆ©vZ(bI0)Î“(v)Z(bG) of a character
Î²v(Î³0; Î³, Î´) on Z(bI0)Î“(v)Z(bG):

Î±(Î³0; Î³, Î´) = Y

v

Î²v(Î³0; Î³, Î´)|âˆ©v Z( bI0)Î“(v)Z( bG).

This product is trivial on Z(bG). The character Î²v(Î³0; Î³, Î´) itself is the unique extension of another
character Î±v(Î³0; Î³, Î´) on Z(bI0)Î“(v) with the restriction of Î²v to Z(bG) being

Î²v|Z( bG) =

Âµ1
âˆ’Âµ1
trivial

if
if
if

v = âˆ
v = p
v 6= p, âˆ.

ï£±ï£´ï£²
ï£´ï£³

Here, Âµ1 is the negative of the restriction to Z(bI0) of the Weyl group orbit in X âˆ—(bT ) dual to the

Weyl group orbit Xâˆ—(T ) âˆ© c(G, X).4 For the deï¬nition of the character Î±v(Î³0; Î³, Î´), here we will be
just contented with directing readers to the reference [Kot88], Â§2.

4This Âµ1 is identical to the character denoted by the same symbol in [Kot88, p.165].

31

5.3 Second proof of non-emptiness of Newton strata

Theorem 5.3.1. Let (G, X) be a Shimura datum such that Gder is simply connected and GQp is
unramiï¬ed. Fix a hyperspecial subgroup Kp of G(Qp). Then, for any b âˆˆ B(GQp, C), there exist

â€¢ a maximal Q-torus T of G which is elliptic at R and unramiï¬ed over Qp, and such that the

unique hyperspecial subgroup of T (Qp) is contained in a G(Qp)-conjugate of Kp,

â€¢ a Kottwitz triple (Î³0; Î³, Î´) âˆˆ T (Q) Ã— G(Ap

f ) Ã— T (Qur

p ) with Î´ âˆˆ b and having trivial Kottwitz

invariant, and

â€¢ a cocharacter Âµ âˆˆ Xâˆ—(T ) âˆ© c(G, X) such that the condition (âˆ—(Î³0)) of Deï¬nition 5.1.2 holds

for (T, Âµ) and that Î´ is Ïƒ-conjugate to Âµ(p) in T (L).

The Newton point Î½T (Î´) âˆˆ N (TQp) = Xâˆ—(TQp)Î“(p)

Q

of Î´ âˆˆ B(TQp) equals

Î½ :=

1
r

NmLr/Qp(Âµ),

where Lr is a splitting ï¬eld of TQp, and TQp is an elliptic maximal torus of the centralizer J =
CentGQp (Î½). Moreover, for any rational prime l 6= p, we can ï¬nd such object (T, Âµ, (Î³0; Î³, Î´)) such
that TQl is elliptic in GQl.

Here, the statement that the condition (âˆ—(Î³0)) of Deï¬nition 5.1.2 holds for (T, Âµ) means that

Î»TQp (Î³0) = NmLr/QpÂµ âˆˆ Xâˆ—(T )Î“(p) (note that Âµ must be deï¬ned over Lr).

Proof. Our construction of T , Âµ, and (Î³0; Î´, (Î³v)v6=p) âˆˆ T (Q Ã— L) Ã— G(Af ) proceeds in three
f ) in these

steps: we will ï¬nd (T, Âµ), the pair (Î³0; Î´) âˆˆ T (Q Ã— L), and the elements (Î³v)v6=p âˆˆ G(Ap
orders.

Step 1. According to Proposition 4.2.4 and the ï¬rst step of the proof of Theorem 4.1.1, there
exists a maximal Q-torus T of G which is elliptic at R and at any given prime l 6= p and is unramiï¬ed
over Qp, and a triple (M, b âˆˆ M (L), Âµ âˆˆ Xâˆ—(TQp) âˆ© c(G, X)) satisfying the condition (â€ ) combined
with TQp (particularly, ÎºM (b) = [Âµ]M ).

Step 2. Choose r âˆˆ N such that TQp splits over Lr = L(Fpr ). Pick any Âµ âˆˆ Xâˆ—(T ) such that
ÎºM (b) = [Âµ]M . In this step, we construct (Î³0, Î´) âˆˆ T (Q Ã— L), but for this construction itself, we
will not need the condition Âµ âˆˆ c(G, X), yet; that property will be invoked later when we construct
the prime-to-p components (Î³v)v6=p (especially, the l-component) and verify that the associated
Kottwitz invariant is zero.

We claim that there exists v âˆˆ T (OLr ) (the unique maximal compact open subgroup of T (Lr))

such that the element

Î´ := Âµ(p)v âˆˆ T (Lr),

has the following three properties:

(a) its norm Nmr(Î´) âˆˆ T (Qp) belongs to T (Q);

(b) Î´ and Âµ(p) are Ïƒ-conjugate in T (L);

(c) Âµ(b) and b are Ïƒ-conjugate in M (L).

32

It follows from (b) that the Newton point Î½TQp (Î´) of Î´ âˆˆ B(TQp) equals 1

r NmLr/Qp(Âµ) âˆˆ

N (TQp) = Xâˆ—(T )Î“(p)
Q .

We will see that as long as v âˆˆ T (OLr ), the property (b) always holds and the property (c)
is equivalent to that ÎºM (b) = [Âµ]M . Then, it is the property (a) for which we have to make a
restricted choice of v; interestingly, Âµ does not play any signiï¬cant role in such choice of v.

Lemma 5.3.2. Let T be a torus over Qp.

(1) For every s âˆˆ N, the image of T (OLs) under the norm map Nms : T (Ls) â†’ T (Qp) : t 7â†’

t Â· Ïƒ(t) Â· Â· Â· Ïƒsâˆ’1(t) is open.

(2) If T is unramiï¬ed, the Ïƒ-conjugacy class of any u âˆˆ T (OL) is trivial.

Proof of lemma. (1) The composition of the natural maps of algebraic tori over Qp

TQp Ö’â†’ ResLs/Qp(TLs)

Nsâ†’ TQp

is an isogeny, so the image of the maximal compact subgroup of T (Qp) is open in T (Qp) ([PR94,
Ch.3, Cor.1]).

(2) We recall (Theorem 2.2.5 (i)) the natural transformation Îº : B(Â·) â†’ Xâˆ—(Â·)Î“(p) of set-
valued functors on the category of connected reductive groups over Qp which gives isomorphisms
for tori. For an unramiï¬ed Qp-torus T , this isomorphism ÎºT : B(T ) âˆ¼â†’ Xâˆ—(T )Î“(p) is obtained
as follows [Kot85, 2.9]: tensor the normalized valuation LÃ— â†’ Z with Xâˆ—(T ) to get a canonical
surjection T (L) â†’ Xâˆ—(T ). The isomorphism ÎºT is obtained by applying the functor H 1(hÏƒi, Â·)
to this surjection; on Gm, we have ÎºGm(b) = ordL(b) for b âˆˆ LÃ—. Now, it is obvious that any
u âˆˆ T (OL) = Hom(X âˆ—(T ), OÃ—
L is a linear combination of elements of Xâˆ—(T ) with
coeï¬ƒcients in OÃ—

L , hence maps to zero under the surjection T (L) â†’ Xâˆ—(T ).

L ) = Xâˆ—(T ) âŠ—Z OÃ—

We now prove the claims. Since TQp is unramiï¬ed over Qp, T (Q) is dense in T (Qp) ([Mil92,
Lemma 4.10] or [Vos98, Theorem in Â§11.5]). So, by Lemma 5.3.2 (1), there exists v âˆˆ T (OLr ) such
that

Namely, for such v, the element

Nmr(Âµ(p)) Â· Nmr(v) âˆˆ T (Q).

Î´ := Âµ(p) Â· v âˆˆ T (Lr)

satisï¬es the property (a). Also, by Lemma 5.3.2 (2), Î´ is Ïƒ-conjugated to Âµ(p) in T (L), which
proves (b).

Step 3. Finally, we assume that our Âµ âˆˆ Xâˆ—(T ) further satisï¬es that Âµ âˆˆ c(G, X). Fix h âˆˆ X
which factors through TR and let Âµh be the associated Hodge cocharacter. We will ï¬nd an element
Î³l âˆˆ T (Ql) which is conjugate to Î³0 in G(Ql), characterized by certain cohomological property. In
general, if an element Î³l âˆˆ G(Ql) is conjugate to Î³0 in G(Ql), say, Î³l = glÎ³0gâˆ’1
(gl âˆˆ G(Ql)), one
has that Ï„ (glÎ³0gâˆ’1
(Î³0)(Ql), for all Ï„ âˆˆ Gal(Ql/Ql). In this
way, one obtains a bijection between the set of Ql-rational conjugacy classes of elements Î³l âˆˆ G(Ql)
which are conjugate to Î³0 in G(Ql) and the set

l Ï„ (gl) âˆˆ CentGQl

) = glÎ³0gâˆ’1

l

, i.e. gâˆ’1

l

l

Ker[H 1(Ql, I0) â†’ H 1(Ql, G)].

33

On the other hand, we have a commutative diagram (for any ï¬nite place v) [Kot84a, Prop. 6.4]

H 1(Qv, T )

H 1(Qv, I0)

H 1(Qv, G)

(5.3.2.1)

âˆ¼=

âˆ¼=

âˆ¼=

Ï€0(Z(bT )Î“(v))D

/ Ï€0(Z(bI0)Î“(v))D

/ Ï€0(Z(bG)Î“(v))D,

and for any connected reductive Qv-group H, Ï€0(Z(bH)Î“(v))D is the subgroup of X âˆ—(Z(bH)Î“(v)) =
Hom(Z(bH)Î“(v), CÃ—) of torsion elements ([RR96, 1.14]). Hence, if the image Î±l of the cocharacter
âˆ’(Âµh + Âµ) âˆˆ Xâˆ—(T ) in X âˆ—(Z(bI0)Î“(l)) = Ï€1(I0)Î“(l) (via the map Xâˆ—(T ) â†’ Ï€1(I0)) is a torsion element
and furthermore maps to zero in X âˆ—(Z(bG)Î“(l)) = Ï€1(G)Î“(l), it will belong to Ker[H 1(Ql, I0) â†’
H 1(Ql, G)] and accordingly we will get an element Î³l âˆˆ G(Ql) that is Ql-conjugate to Î³0. But,
the cocharacter âˆ’(Âµh + Âµ) âˆˆ Xâˆ—(T ) in fact belongs to the subgroup Xâˆ—(T der), where T der :=
is an
h under the Weyl group

(T âˆ© Gder)0(= T âˆ© Gder), and Xâˆ—(T der)Î“(l) = X âˆ—(dT der
action, âˆ’(Âµh + Âµ) lies in the coroot lattice PÎ±âˆˆâˆ†(T,G) Î±âˆ¨, hence maps to zero in Ï€1(G).

anisotropic torus by our choice of T . Moreover, as Âµ is an image of Âµâˆ’1

) is a torsion group since T der
Ql

Î“(l)

Now, we claim that when we put

Î³0 := Nmr(Î´),

Î³v := Î³0 (v 6= p, l),

Î³l = Î±l

the triple (Î³0; (Î³v)v6=p, Î´) forms a Kottwitz triple.

First, we check the two conditions (âˆ—(Î´)), (âˆ—(Î³0)) of Deï¬nition 5.1.2. For the condition (âˆ—(Î´)),

we recall the identity (from (3.2.6))

Âµâ™® = [Âµ]GQp âˆˆ Ï€1(G)Î“(p),

as Âµ âˆˆ Xâˆ—(T )âˆ©c(G, X). As Î´ belongs to T (L) and TQp is also a maximal torus of M , the functoriality
of the natural transformation Îº : B(Â·) â†’ Ï€1(Â·)Î“(p) allows us to replace, in our veriï¬cation, GQp by
M , in which case the condition (âˆ—(Î´)) is our assumption ÎºM (Î´) = [Âµ]M .

For the condition (âˆ—(Î³0)), recall that we introduced the centralizer H of the maximal split Qp-
subtorus of the center of (ZG(Î³0))Qp; since Î³0 âˆˆ T (Q) and TQp is an unramiï¬ed maximal torus of
GQp, TQp is also an unramiï¬ed maximal torus of H. Hence, by the functoriality of the natural
transformation Î»H : H(Qp) â†’ Ï€1(H)Î“(p) ([Kot84b], Lemma 3.3), we may replace H by TQp, in

which case Î»T : T (Qp) â†’ Xâˆ—(T )Î“(p) = X âˆ—(bT )Î“(p) is obtained by tensoring the normalized valuation
p )Ã— â†’ Z with Xâˆ—(T ) and taking invariants under Î“(p), ([Kot84b, Â§3]).

It follows from this

(Qur
deï¬nition that Î»(T (Zp)) = 0 and thus

Î»TQp (Î³0) = Î»TQp (Nmr(Î´)) = Î»TQp (Nmr(Âµ)(p)) = Nmr(Âµ),

as required.

It remains to show the vanishing of the Kottwitz invariant Î±(Î³0; Î³, Î´); recall from Subsection

5.2 that it is a product, over all places v of Q, of the restriction to âˆ©vZ(bI0)Î“(v)Z(bG) of characters
Î²v(Î³0; Î³, Î´) on Z(bI0)Î“(v)Z(bG), which itself is a unique extension of another character Î±v(Î³0; Î³, Î´)
on Z(bI0)Î“(v). For v 6= l, p, since Î³0 = Î³v it is obvious from the deï¬nition (cf.

[Kot88, Â§2]) that
Î±v(Î³0; Î³, Î´) and thus Î²v(Î³0; Î³, Î´) as well are trivial. Also, by deï¬nition ([Kot88, Â§2]), Î±l(Î³0; Î³, Î´) is the

34

/
/


/
/




/
/
cohomology class [gâˆ’1

l Ï„ (gl)], regarded as an element of Ï€0(Z(bI0)Î“(v))D via the vertical isomorphism

H 1(Qv, I0) âˆ¼= Ï€0(Z(bI0)Î“(v))D of (5.3.2.1), where Î³l = glÎ³0gâˆ’1
l Ï„ (gl) âˆˆ I0(Ql),
hence is nothing but âˆ’[Âµh + Âµ]I0Ql
by the very deï¬nition of Î³l. Working out the deï¬nitions (ï¬rst
and second paragraphs on p.167 in Â§2 of [Kot88]) for v = p, âˆ in a similar way, we get that
Î±v(Î³0; Î³, Î´) âˆˆ X âˆ—(Z(bI0)Î“(v)) = Ï€1(I0)Î“(v) is given by
Îº(I0)Qp

for gl âˆˆ G(Ql) with gâˆ’1

if v = p

l

ï£±ï£´ï£²
ï£´ï£³

(Î´)
[Âµh]I0 R

âˆ’[Âµh + Âµ]I0Ql

Î±v(Î³0; Î³, Î´) =

if v = âˆ,
if v = l

See the remark at the end of Subsection 5.2 for our sign convention.

Recall that for v = p, we have (as a consequence of Î´ âˆˆ Âµ(p) Â· T (OLr )) that ÎºTQp (Î´) = [Âµ]TQp .

Hence, when we ï¬x embeddings bT Ö’â†’ bI0 Ö’â†’ bG, we see that Î²p(Î³0; Î³, Î´) is equal to the restriction of
the character Âµ âˆˆ Xâˆ—(T ) = X âˆ—(bT ) of bT to
and similarly Î²âˆ(Î³0; Î³, Î´) is the restriction of Âµâˆ’1

h âˆˆ Xâˆ—(T ) = X âˆ—(bT ) to Z(bI0)Î“(âˆ)Z(bG) Ö’â†’ bT . It
follows that the product of the restrictions of Î²âˆ(Î³0; Î³, Î´) and Î²p(Î³0; Î³, Î´) to Tv=âˆ,p Z(bT )Î“(v)Z(bG)
is the pull-back of the character Âµ + Âµh âˆˆ Xâˆ—(T ) = X âˆ—(bT ) to

Z(bI0)Î“(p)Z(bG) Ö’â†’ bT Î“(p)Z(bG) Ö’â†’ bT

\

v=âˆ,p

Z(bI0)Î“(v)Z(bG) Ö’â†’ \

v=âˆ,p bT Î“(v)Z(bG) Ö’â†’ bT .

As clearly Î²l(Î³0; Î³, Î´) is the restriction of âˆ’(Âµh + Âµ) âˆˆ Xâˆ—(T ) = X âˆ—(bT ) to Z(bI0)Î“(l)Z(bG) Ö’â†’ bT , we
see that the Kottwitz invariant Î±(Î³0; Î³, Î´) = Qv Î²v(Î³0; Î³, Î´)|âˆ©v Z( bI0)Î“(v)Z( bG) vanishes.

It remains to show that TQp is elliptic in J. According to Proposition 4.2.4, there exist a Levi
Qp-subgroup M of GQp and a representative b of b in M (L) with Î½b âˆˆ HomQp(D, GQp) such that
M = CentGQp (Î½b). Then, since b = Î´ in B(GQp), it follows that Î½b = gÎ½gâˆ’1 for some g âˆˆ G(L) so
that M is an inner form of J (indeed, M = Int(g)(J). On the other hand, since Î½, Î½b are deï¬ned
over Qp, gâˆ’1Ïƒ(g) âˆˆ CentG(L)(Î½) = J(L)).
In particular, Int(g) induces a Qp-isomorphism from
Z(J) to Z(M ). Now, let T be as in Theorem 4.1.1 where the Levi subgroup M â€² in the assumption
(â€ ) is M just chosen, so that a G(Qp)-conjugate of TQp is an elliptic maximal torus of M . But, as
TQp âŠ‚ J, Z(J) âŠ‚ TQp. Then, TQp contains a subtorus Z â€² â‰ˆ Z(M ) such that TQp/Z â€² is anisotropic.
But, since TQp âŠ‚ J, Z(J) âŠ‚ TQp. As Z â€² â‰ˆ Z(J), thus TQp/Z(J) is also anisotropic, i.e. TQp is
also an elliptic maximal torus of J (the maximal split subtorus S of TQp is contained in Z â€², so
Z(J) â‰ˆ Z â€² contains a split subtorus of TQp of same rank, which then must be S). This ï¬nishes our
proof of the theorem.

Now, we can give another proof of the non-emptiness of Newton strata of Shimura varieties of

Hodge type, using the resolution of the Langlands-Rapoport conjecture by Kisin [Kis13].
Corollary 5.3.3. Let (G, X) be a Shimura datum of Hodge type such that Gder is simply-connected.
Let p be a rational prime such that GQp is unramiï¬ed. Fix a prime â„˜ of E(G, X) unramiï¬ed over
p and a hyperspecial subgroup Kp of G(Qp). Let Â¯Fp be an algebraic closure of the residue ï¬eld Îº(â„˜)
of â„˜.

Then, for every b âˆˆ B(GQp, X), there exists a point x âˆˆ ShKp(G, X)(Â¯Fp) whose associated

F -isocrystal is b.

35

Proof. This follows from Theorem 5.3.1 and [Kis13], Theorem 0.3. The statement of this
theorem of Kisin is formulated in terms of the notion of Galois gerbs and admissible morphisms,
but it is known (cf. [Mil92, Â§5], [Mil09]) that this implies that for any Kottwitz triple with trivial
Kottwitz invariant, there exists a point in ShKp(G, X)(Â¯Fp) which has that Kottwitz triple as the
associated Kottwitz triple.

A A lemma on algebraic groups over p-adic ï¬elds

The goal of this appendix is to give a proof of the following fact, which is perhaps well-known (for
example, it is mentioned without proof in the last paragraph on p. 172 of [LR87]). But, since we
could not ï¬nd its proof in literatures, we present a proof here.

Lemma A.0.4. Let H be an unramiï¬ed semi-simple group deï¬ned over a p-adic ï¬eld F with ring
of integers OF . Then H admits a maximal F -torus which is anisotropic and unramiï¬ed. If K
is a hyperspecial subgroup of H(F ), there exists a such maximal F -torus T â€² (i.e. aniostropic and
unramiï¬ed) such that the (unique) hyperspecial subgroup of T â€²(F ) is contained in K.

Proof. We ï¬rst review some constructions in the general theory of reductive group schemes

over S = Spec(OF ).

Let us use H (by abuse of notation) again to denote the reductive group scheme over S which is
an integral model of the given F -group in question and such that H(OF ) = K. We ï¬x a maximal
S-torus T of H; by deï¬nition ([Con11, 3.2.1]), it is a S-torus T âŠ‚ H whose every geometric ï¬ber Ts
is a maximal torus of Gs in the usual sense. Let N = NH(T ) be the normalizer scheme of T in H
([Con11, 2.1.1]): it is a (ï¬nitely presented) closed subscheme of G, smooth over S ([Con11, 2.1.2]).
Also, let W := NH(T )/ZH (T ) be the Weyl group scheme of T , where ZH (T ) is the centralizer
scheme of T in H ([Con11, 2.2]). It is a ï¬nite Â´etale scheme over O [Con11, 3.2.8]). Let X be the
scheme of maximal tori of H: this is the scheme representing the functor on S-schemes

TorH/S : Sâ€² 7â†’ { maximal tori in HSâ€²}

(which is a sheaf of sets in the fppf topology, [Con11, 3.2.6]), and is a smooth aï¬ƒne scheme ([SGA3,
XII, 5.4]). Moreover, this also represents the quotient sheaf H/N ([Con11], Thm. 2.3.1 and proof
of Thm. 3.2.6). Now, to prove the lemma, it is enough to show the existence of an anisotropic
maximal torus of the special ï¬bre HÎº = H âŠ—OF Îº, where Îº is the residue ï¬eld of OF . Indeed, since
TorH/S is smooth over the henselian base OF , then there exists a maximal torus T â€² over OF whose
special ï¬bre is anisotropic. But, since T â€² is a torus over OF , the Ï€1(S, Î·)-module attached to the
Â´etale sheaf X âˆ—(T â€²) = HomSÂ´et(T â€², Gm) is unramiï¬ed (Î· is a geometric generic point of S), hence the
Îº. Also, since T â€² is a subscheme of H, the unique hyperspecial
F -rank of T â€²
subgroup T â€²(OF ) of T (F ) is contained in K = H(OF ).

F equals the Îº-rank of T â€²

For the closed point s of S and a (ï¬xed) algebraic closure Îº = Îº(s) of its residue ï¬eld Îº = Îº(s),

there exists a canonical diagram

X(Îº)

Î´ /

H 1(Îº, NÎº)

H 1(Îº, HÎº)

%â‘â‘â‘â‘â‘â‘â‘â‘â‘â‘

Ï•:=jâ—¦Î´

j

H 1(Îº, WÎº)

/ H 1(Îº, AutTÎº)

36

/
%
/
/


/
Here, the upper sequence of pointed sets is exact and Î´ is deï¬ned as follows: for a maximal Îº-torus
T â€² of HÎº, the image of T â€² âˆˆ X(Îº) under Î´ is the cohomology class of the cocycle

Ïƒ 7â†’ aÏƒ := gâˆ’1 Â· Ïƒ(g) âˆˆ N (Îº),

where g âˆˆ H(Îº) satisï¬es T â€² = gT gâˆ’1. The lower horizontal map is induced from the injection
W Ö’â†’ AutT . On the other hand, the pointed set H 1(Îº, AutT ) classiï¬es the Îº-isomorphism classes
of Îº-forms of TÎº, and for any T â€² âˆˆ X(Îº), its corresponding class in H 1(Îº, AutTÎº) is the image
of [Ï•(T â€²)] under the natural map H 1(Îº, WÎº) â†’ H 1(Îº, AutTÎº), namely, T â€² is the twist of T by
(a cocycle in W (Îº) representing) Ï•(T â€²). Therefore, to prove the lemma, it will suï¬ƒce to ï¬nd a
cohomology class Î¾ âˆˆ H 1(Îº, WÎº) which lies in the image of Ï• and such that the twist Î¾T of TÎº by
Î¾ is anisotropic. But, since H 1(Îº, HÎº) = H 2(Îº, TÎº) = {1} (Langâ€™s theorem), Ï• is always surjective,
hence we only need to ï¬nd a cohomology class Î¾ âˆˆ H 1(Îº, WÎº) such that the twist Î¾TÎº is anisotropic.
This is also well-known. More explicitly, recalling the fact that every reductive group over a
ï¬nite ï¬eld is quasi-split, choose a Borel pair (T1, B1) deï¬ned over Îº, and let âˆ† be the associated
set of simple roots of (HÎº, T1), and N (T1) the normalizer of T1; thus, the Frobenius automorphism
Ïƒ of Îº acts on X âˆ—(T1), leaving âˆ† stable. Then, what one needs is an element w âˆˆ N (T1) such
that wÏƒ âˆˆ H(Îº) â‹Š Gal(Îº/Îº) does not have a ï¬xed vector in Xâˆ—(T )R. In this case, it is shown in
[Spr74, Lemma 7.4] that if {Î±1, Â· Â· Â· , Î±m} is a set of representatives of the Gal(Îº/Îº)-orbits in âˆ†, the
product Ï‰ (in any order) of the corresponding simple reï¬‚ections ri (i = 1, Â· Â· Â· , m), called â€œtwisted
Coxeter elementâ€, has such property.

References

[BO83] P. Berthelot, A. Ogus, F-isocrystals and de Rham cohomology. I. Invent. Math. 72 (1983),

no. 2, 159-199.

[Bla94] D. Blasius, A p-adic property of Hodge classes on abelian varieties. Motives (Seattle, WA,
1991), 293-308, Proc. Sympos. Pure Math., 55, Part 2, Amer. Math. Soc., Providence, RI,
1994.

[BT84] F. Bruhat, J. Tits. Groupes rÂ´eductifs sur un corps local. II. SchÂ´emas en groupes. Existence
dâ€™une donnÂ´ee radicielle valuÂ´ee. Inst. Hautes Â´Etudes Sci. Publ. Math. No. 60 (1984), 197-376.

[Bou05] N. Bourbaki. Lie groups and Lie algebras. Chapters 4-6, Chapters 7-9. Elements of

Mathematics (Berlin). Springer-Verlag, Berlin, 2002, 2005.

[Bul01] O. BÂ¨ultel. Density of the ordinary locus. Bull. London Math. Soc. 33 (2001), no. 2, 149-156.

[Cha00] C.-L. Chai. Newton polygons as lattice points. Amer. J. Math. 122 (2000), no. 5, 967-990.

[Con11] B. Conrad. Reductive group schemes. Notes for â€œSGA3 summer schoolâ€, 2011, available

at http://math.stanford.edu/~conrad/papers/luminysga3smf.pdf

[Del71] P. Deligne. Travaux de Shimura. Seminaire Bourbaki, 23eme annee (1970/71), Exp. No.

389, 123-165. Lecture Notes in Math., Vol. 244, Springer, Berlin, 1971.

37

[Del77] P. Deligne. VariÂ´etÂ´es de Shimura: interprÂ´etation modulaire, et techniques de construction
de mod`eles canoniques. Automorphic forms, representations and L-functions (Proc. Sympos.
Pure Math., Oregon State Univ., Corvallis, Ore., 1977), Part 2, 247-289, Proc. Sympos. Pure
Math., XXXIII, Amer. Math. Soc., Providence, R.I., 1979.

[DMOS82] P. Deligne, J.S. Milne, A. Ogus, K-Y. Shih. Hodge cycles, motives, and Shimura vari-

eties. Lecture Notes in Math., 900. Springer-Verlag, Berlin-New York, 1982.

[SGA3] M. Demazure, A. Grothendieck. SchÂ´emas en groupes I, II, III. Lecture Notes in Math.,

151, 152, 153, Springer-Verlag, New York, 1970.

[Far04] L. Fargues. Cohomologie des espaces de modules de groupes p-divisibles et correspondances
de Langlands locales. VariÂ´etÂ´es de Shimura, espaces de Rapoport-Zink et correspondances de
Langlands locales. AstÂ´erisque No. 291 (2004), 1-199.

[FM87] J.-M. Fontaine, W. Messing. p-adic periods and p-adic Â´etale cohomology. Current trends
in arithmetical algebraic geometry (Arcata, Calif., 1985), 179-207, Contemp. Math., 67, Amer.
Math. Soc., Providence, RI, 1987.

[Kis09] M. Kisin. Integral canonical models of Shimura varieties. J. ThÂ´eor. Nombres Bordeaux 21

(2009), no. 2, 301-312.

[Kis10] M. Kisin. Integral models for Shimura varieties of abelian type. J. Amer. Math. Soc. 23

(2010), no. 4, 967-1012.

[Kis13] M. Kisin. Mod p-points on Shimura varieties of abelian type. preprint available on

http://www.math.harvard.edu/~kisin/

[Kos14] J.-S. Koskivirta Sections of the Hodge bundle over Ekedahl-Oort strata of Shimura varieties

of Hodge type. http://arxiv.org/abs/1410.1317.

[Kot82] R. Kottwitz. Rational conjugacy classes in reductive groups. Duke Math. J. 49 (1982), no.

4, 785-806.

[Kot84a] R. Kottwitz. Stable Trace Formula: Cuspidal Tempered Terms. Duke Math. J. 51 (1984),

611-650.

[Kot84b] R. Kottwitz. Shimura Varieties and Twisted Orbital Integrals. Math. Ann. 269 (1984),

287-300.

[Kot85] R. Kottwitz. Isocrystals with additional structure. Compositio Math. 56 (1985), no. 2,

201-220.

[Kot86] R. Kottwitz. Stable Trace Formula: Elliptic Singular Terms. Math. Ann. 275 (1986),

365-399.

[Kot88] R. Kottwitz. Shimura varieties and Î»-adic representations. Automorphic forms, Shimura
varieties, and L-functions, Vol. I (Ann Arbor, MI, 1988), 161-209, Perspect. Math., 10, Aca-
demic Press, Boston, MA, 1990.

38

[Kot92] R. Kottwitz. Points on some Shimura varieties over ï¬nite ï¬elds. J. Amer. Math. Soc. 5

(1992), no. 2, 373-444.

[Kot97] R. Kottwitz. Isocrystals with additional structure. II. Compositio Math. 109 (1997), no.

3, 255-339.

[KR03] R. Kottwitz, M. Rapoport. On the existence of F-crystals. Comment. Math. Helv. 78

(2003), no. 1, 153-184.

[Kot03] R. Kottwitz. On the Hodge-Newton decomposition for split groups. Int. Math. Res. Not.

2003, no. 26, 1433-1447.

[Kre13] A. Kret. The trace formula and the existence of PEL type Abelian varieties modulo p.

http://arxiv.org/abs/1209.0264.

[Lan83] R. P. Langlands. Les dÂ´ebuts dâ€™une formule des traces stable. Publ. Math. de lâ€™Univ. Paris

VII 13, Paris 1983.

[LR87] R. P. Langlands, M. Rapoport. ShimuravarietÂ¨aten und Gerben. J. Reine Angew. Math.

378 (1987), 113-220.

[Mil92] J.S. Milne. The points on a Shimura variety modulo a prime of good reduction. The zeta

functions of Picard modular surfaces, Univ. MontÂ´eal, MontrÂ´eal, QC, 1992.

[Mil94] J.S. Milne. Shimura varieties and motives. Motives (Seattle, WA, 1991), 447â€“523, Proc.

Sympos. Pure Math., 55, Part 2, Amer. Math. Soc., Providence, RI, 1994.

[Mil09] J.S. Milne. Points on Shimura varieties over ï¬nite ï¬elds: the conjecture of Langlands and

Rapoport. http://arxiv.org/abs/0707.3173.

[Moo98] B. Moonen. Models of Shimura varieties in mixed characteristics. Galois representations
in arithmetic algebraic geometry (Durham, 1996), 267-350, London Math. Soc. Lecture Note
Ser., 254, Cambridge Univ. Press, Cambridge, 1998.

[Noo96] R. Noot. Models of Shimura varieties in mixed characteristic. J. Algebraic Geom. 5 (1996),

no. 1, 187-207.

[Oor13] F. Oort. Moduli of abelian varieties in mixed and in positive characteristic. Handbook of

moduli. Vol. III, 75-134, Adv. Lect. Math. (ALM), 26, Int. Press, Somerville, MA, 2013.

[PR94] V. Platonov, A. Rapinchuk. Algebraic groups and number theory. Pure and Applied

Mathematics, 139, Academic Press, Inc., Boston, MA, 1994.

[RR96] M. Rapoport, M. Richartz. On the classiï¬cation and specialization of F -isocrystals with

additional structure. Compositio Math. 103 (1996), no. 2, 153-181.

[Rap03] M. Rapoport. On the Newton stratiï¬cation.

SÂ´eminaire Bourbaki. Vol. 2001/2002.

AstÂ´erisque No. 290 (2003), Exp. No. 903, viii, 207-224.

[Rap05] M. Rapoport. A guide to the reduction modulo p of Shimura varieties. Automorphic

forms. I. AstÂ´erisque No. 298 (2005), 271-318.

39

[SS13] P. Scholze, SW. Shin. On the cohomology of compact unitary group Shimura varieties at

ramiï¬ed split places. J. Amer. Math. Soc. 26 (2013), no. 1, 261-294.

[Sh79] D. Shelstad. Characters and inner forms of a quasisplit group over R. Comp. Math. 39

(1979), 11-45.

[Spr74] T.A. Springer. Regular elements of ï¬nite reï¬‚ection groups. Invent. Math. 25 (1974), 159-

198.

[Spr98] T.A. Springer. Linear algebraic groups. Progress in mathematics, vol. 9, BirkhÂ¨auser,

Boston, Mass., 1998.

[Sta97] H. Stamm. On the reduction of the Hilbert-Blumenthal-moduli scheme with Î“0(p)-level

structure. Forum Math. 9 (1997), no. 4, 405-455.

[Tit79] J. Tits. Reductive groups over local ï¬elds. Automorphic forms, representations and L-
functions (Proc. Sympos. Pure Math., Oregon State Univ., Corvallis, Ore., 1977), Part 1, pp.
29-69, Proc. Sympos. Pure Math., XXXIII, Amer. Math. Soc., Providence, R.I., 1979.

[Vas99] A. Vasiu. Integral canonical models of Shimura varieties of preabelian type. Asian J. Math.

3 (1999), no. 2, 401-518.

[Vas07] A. Vasiu. Good Reductions of Shimura Varieties of Hodge Type in Arbitrary Un-
http://arxiv.org/abs/0707.1668 and

ramiï¬ed Mixed Characteristic, Parts I and II.
http://arxiv.org/abs/0712.1572.

[Vas08] A. Vasiu. Geometry of Shimura varieties of Hodge type over ï¬nite ï¬elds. Proceedings
of the NATO Advanced Study Institute on â€œHigher dimensional geometry over ï¬nite ï¬eldsâ€,
GÂ¨ottingen, Germany (June 25 - July 06, 2007), 197-243, IOS Press, 2008.

[Vas11] A. Vasiu. Manin problems for Shimura varieties of Hodge type. J. Ramanujan Math. Soc.

26 (2011), no. 1, 31-84.

[Vas12] A. Vasiu. A motivic conjecture of Milne. J. Reine Angew. Math. 685 (2013), 181-247.

[VW13] E. Viehmann, T. Wedhorn. Ekedahl-Oort and Newton strata for Shimura varieties of

PEL-type. Math. Ann. 356 (2013), 1493-1550.

[Vos98] V. E. Voskresenskii. Algebraic groups and their birational invariants. Translations of Math-

ematical Monographs, 179. American Mathematical Society, Providence, RI, 1998. xiv+218.

[Wed99] T. Wedhorn. Ordinariness in good reductions of Shimura varieties of PEL-type. Ann. Sci.

Â´Ecole Norm. Sup. (4) 32 (1999), no. 5, 575-618.

[Win05] J.-P. Wintenberger. Existence de F-cristaux avec structures supplÂ´ementaires. Adv. Math.

190 (2005), no. 1, 196-224.

[Wor13] D. Wortmann.

The Âµ-ordinary locus

for Shimura varieties of Hodge

type.

http://arxiv.org/abs/1310.6444.

40

[Yu05] C.-F. Yu. On the slope stratiï¬cation of certain Shimura varieties. Math. Z. 251 (2005), no.

4, 859-873.

Center for Geometry and Physics, Institute for Basic Science (IBS),
Pohang 790-784, Republic of Korea
Email: dulee@ibs.re.kr

41

