6
1
0
2

 
r
a

 

M
1
1

 
 
]

.

M
Q
o
i
b
-
q
[
 
 

1
v
5
1
8
3
0

.

3
0
6
1
:
v
i
X
r
a

Ground truth validation for the estimation of
resting-state fMRI eï¬€ective connectivity by a
generalization of the correlation approach $

Nan Xua,âˆ—, R. Nathan Sprengb, Peter C. Doerschuka

aSchool of Electrical and Computer Engineering, Cornell University, Ithaca, NY, USA

bHuman Neuroscience Institute, Department of Human Development, Cornell University,

Ithaca, NY, USA

Abstract

Resting-state functional MRI (rs-fMRI) is widely used to noninvasively study

human brain networks. Network functional connectivity is often estimated

by calculating the timeseries correlation between blood-oxygen-level dependent

(BOLD) signals at diï¬€erent regions of interest. However, standard correlation

cannot characterize the causality and the direction of information ï¬‚ow between

regions.

In this paper, we introduce and test a new method, prediction cor-

relation, to estimate eï¬€ective connectivity from rs-fMRI. In this approach, the

correlation between two BOLD signals is replaced by a correlation between one

BOLD signal and a prediction of this signal via a causal linear model driven

by the other BOLD signal. Prediction correlation was applied to previously

published simulations of fMRI timeseries data, based on directed ground-truth

networks (Smith et al., (2011) NeuroImage, 54, 875-891). It was compared with

four standard algorithms, speciï¬cally, Granger, Gen Synch, LiNGAM and Pa-

telâ€™s Tau. Compared with the ground truth networks on which the simulations

are based, prediction correlation outperformed the other algorithms in networks

with sizes 5, 10, 15 and 50 regions of interest (ROIs). In addition, prediction

correlation is also able to analyze large-scale networks with more than hundreds

of ROIs. Testing the method on a â€œcommon driverâ€ situation shows that predic-

tion correlation does not introduce false connections between the noninteracting

âˆ—Corresponding author
Email address: nx25@cornell.edu (Nan Xu)

Preprint submitted to Journal of NeuroImage

March 15, 2016

driven ROIs. Extending the result of Xu et al., (2014 IEEE ICIP, 3508 - 3512),

we also demonstrate the robustness of prediction correlation on experimental

data and demonstrate the ability to recover previously identiï¬ed brain network

organizations from experimental data. These results provide an initial validation

that prediction correlation can capture causality information, the direction of

information ï¬‚ow, and the possibility of extended temporal delays of information

ï¬‚ow in BOLD signals. This approach not only maintains the high sensitivity to

network connectivity provided by the correlation analysis, but also achieves the

accurate estimation of connection directionality.

Keywords:

functional connectivity, functional connected network,

resting-state fMRI, correlation analysis

1. Introduction

Resting-state functional MRI (rs-fMRI) has been widely used to study the

intrinsic functional architecture of the human brain based on spontaneous os-

cillations of the blood oxygen level dependent (BOLD) signals (Smith et al.,

2011; Biswal et al., 1995; Yeo et al., 2011; Power et al., 2011). One fruitful

approach has been to examine the correlations between rs-fMRI timeseries at

pairs of regions of interest (ROIs) and use the correlations as a measure of

connectivity strength between each pair (Wig et al., 2011; Sporns, 2011). The

correlation method, though simple, plays a fundamental role in evaluating func-

tional connectivity in the human brain for both task-evoked networks (Sadaghi-

ani et al., 2015; Cole et al., 2014) and resting-state networks (Hipp and Siegel,

2015; Sadaghiani et al., 2015; Power et al., 2013). The relationships between

correlation and the topological properties, including small-world organization,

modular structure, and highly connected hubs, has been studied in Zalesky et al.

(2012). However, the direction of information ï¬‚ow between pairs of ROIs and

the causality of information ï¬‚ow cannot be derived from standard correlation

methods. Reliable insight into the direction and causality of functional connec-

tions in the brain from BOLD signals would provide substantial breakthroughs

2

in characterizing large-scale brain network dynamics.

The BOLD signal is an indirect and sluggish measure of neuronal activity.

Despite this, substantial insights have been gleaned by examining patterns of

BOLD signals as proxies for functional connectivity in the brain, and these are

consistent with more direct and invasive observations (Foster et al., 2015). At

every level of analysis, the brain demonstrates an organized network structure

(Bassett and Gazzaniga, 2011). So, even though neuronal activation occurs on

the millisecond time scale, organized and structured activation patterns are also

observed on the level of seconds, which is within the range of BOLD signals and

is important for understanding cognition. Causal information about the ï¬‚ow of

information in the brain may be detected and estimated from the BOLD signals.

It remains critical, however, to evaluate methods of investigation against ground

truth simulation in order to validate these methods.

Numerous methods for estimating functional or eï¬€ective connectivity (Van

Den Heuvel and Pol, 2010; Friston, 2011) have recently been evaluated against

ground truth networks using simulated rs-fMRI data (Smith et al., 2011). Func-

tional connectivity can be quantiï¬ed with a measure of statistical dependence

such as correlation, whereas eï¬€ective connectivity measures the directed causal

inï¬‚uence (Friston, 2011). In Smith et al. (2011), performance of both types of

methods across a range of measures was mixed. Standard and partial correlation

excelled at detecting the presence of a connection. Other methods for estimat-

ing the direction of a connection varied from chance (Granger) to greater than

50% accuracy (Patelâ€™s Tau and pairwise LiNGAM). These results suggest that

novel methods are needed to estimate directed connectivity from rs-fMRI data,

particularly with a large number of ROIs, which are necessary for full coverage

of cortical and subcortical areas in the human brain. In this paper, we intro-

duce a new method, prediction correlation, to the neuroimaging community and

provide an initial validation of the approach.

Methods for estimating functional connectivity can be oriented toward esti-

mating a real number describing strength of connectivity, which might be quite

small, versus estimating a binary connectivity, which is present or absent, with

3

possibly the addition of a strength of connectivity, in the form of a real number,

for the case where a connection is present. Correlation and prediction corre-

lation, which is a generalization of correlation that we propose in this paper,

are methods that estimate a real number that describe strength of connection.

Subsequent processing can then be applied to remove week connections and/or

organize the complete network into modular networks.

As is described in the following sections, testing on simulated rs-fMRI data

with known ground-truth networks (Smith et al., 2011) demonstrates that pre-

diction correlation is not only sensitive to detected network connections, as

identiï¬ed by standard correlation, but also achieves the highest accuracy on es-

timation of connection directionality among all approaches used in Smith et al.

(2011) (Section 3). In a â€œcommon driverâ€ phenomena, when ROI 1 drives ROIs 2

and 3 but ROIs 2 and 3 do not directly interact, prediction correlation correctly
detects strong 1â†’2 and 1â†’3 connections but not 2â†’3 or 3â†’2 connections (Sec-
tion 4). Finally, extending Xu et al. (2014), we demonstrate the robustness of

this method on experimental data and that prediction correlation recovers pre-

viously identiï¬ed brain network organization from experimental data (Section

5).

2. Prediction correlation

2.1. Fundamental method

In what follows, we describe a methodology for analyzing rs-fMRI data using

a generalization of the well-established correlation approach, which is to corre-

late the timeseries at two ROIs. The generalization, denoted by â€œp-correlationâ€

(â€œpâ€ for â€œpredictionâ€) is to replace correlation between the BOLD timeseries

at two ROIs by correlation between the BOLD timeseries at one ROI and a

prediction of this timeseries. The prediction is the output of a mathematical

dynamical system that is driven by the timeseries at the other ROI. More gen-

erally, the prediction could be based on several, spatially discrete, ROIs. In this

paper, we focus on the case where only one other ROI is used. We assume that

4

the dynamical system is linear and has ï¬nite memory and that the memory

duration and parameters may be estimated from the BOLD timeseries. If the

prediction of the timeseries is restricted to use only the current value of the

timeseries that drives the dynamical system, then p-correlation is the same as

standard correlation. Therefore p-correlation is a generalization of correlation.

Features of p-correlation include (1) the ability to indicate the directionality of

the interaction between two ROIs, (due to the fact that this prediction corre-

lation is asymmetrical between two signals), and (2) the ability to evaluate the

interaction based on casual information.

In the remainder of this section, we provide more detail on the p-correlation

approach. Consider the ordered pair of ROIs (i, j) and let xi (xj) denote the rs-
fMRI timeseries at the ith (jth) ROI. Both timeseries have duration Nx. The xj

signal is predicted from the xi signal by a linear time-invariant causal dynamical

model with xi as the input and the prediction Ë†xj|i as the output. This model
can be described by an impulse response, denoted hj|i, which is zero for negative

times. We assume that the impulse response is of ï¬nite duration, with duration

denoted by Nhj|i. In summary,

Ë†xj|i[n] =

Nhj|i(cid:88)

m=0

hj|i[m]xi[n âˆ’ m].

(1)

The basic approach to estimate the coeï¬ƒcients of hj|i is to minimize the least

squares cost

J (hj|i) =

Nxâˆ’1(cid:88)

(xj[n] âˆ’ Ë†xj|i[n])2.

(2)

n=0

We estimate the value of Nhj|i and the values of the impulse response at the same

time by restating the least squares problem as a Gaussian maximum likelihood

estimator (MLE) with a known variance for the measurement errors. The MLE

allows a trade oï¬€ of the accuracy of predicting the current data (i.e., minimizing
J ), which is best done by large values of Nhj|i, with the accuracy of predicting
when presented with new data, which is best done by smaller values of Nhj|i.

There are several approaches to quantifying this trade oï¬€ including Akaike in-

formation criteria (AIC) (Akaike, 1974, 1970; Sugiura, 1978; Hurvich and Tsai,

5

1989, 1993; Cavanaugh, 1997), Bayesian information criteria (BIC) (Schwarz,

1978), restricted maximum likelihood (REML) (Thompson Jr, 1962; Patterson

and Thompson, 1971), minimum description length (Rissanen, 1978) and min-

imum message length (Wallace and Boulton, 1968). We have focused on AIC

because it leads to easily computed problem formulations (Eq. 3). AIC realizes

this balancing goal by minimizing the sum of two terms, one term that char-

acterizes the prediction error of the dynamic system through the least squares
cost J (hj|i) and a second term that depends on the durations Nhj|i and Nx:
if Nx/Nhj|i â‰¥ 40

2Ï€

Nxâˆ’Nhj|i

2Ï€

Nxâˆ’Nhj|i

J (hj|i)) + Nx + Nhj|i
J (hj|i)) + N 2

x +

N 2

âˆ’Nx+Nhj|i
âˆ’1

hj|i
Nxâˆ’Nhj|i

ï£±ï£´ï£²ï£´ï£³Nx log(

Nx log(

AIC =

.

otherwise

(3)

Simultaneous minimization of Eq. 3 with respect to both hj|i, which occurs
only in the J (hj|i) term, and Nhj|i determines the duration and the value of
the impulse response. The integer minimization over Nhj|i
is computed by

testing each value in a predetermined range of values, i.e., 1,2, ..., D seconds.

Then, for each value of Nhj|i, the minimization with respect to hj|i involves only
minimizing J (hj|i). Since the dynamical system describing how xi inï¬‚uences
xj is separate from the dynamical system describing how xj inï¬‚uences xi, the

approach described here can lead to a directed rather than undirected graph of

interactions between ROIs.

Once hj|i and Nj|i are estimated, the output of the dynamical system, which
is the prediction Ë†xj|i, can be computed, and then the correlation of xj and Ë†xj|i,
which is the so-called p-correlation, denoted by Ïj|i, can be computed. We use

â€œcorrelationâ€ and Ïj,i for the standard approach (i.e., the standard correlation

between xj and xi).

Let the total number of ROIs be denoted by NROI. P-correlation is an
asymmetric NROI Ã— NROI matrix, where the asymmetry follows the Ïj|i (cid:54)= Ïi|j.
Furthermore, p-correlation includes lags of the xi signal since the dynamical

system output at time n, Ë†xj|i[n], depends on the input at its current and previous
times, i.e., xi[n], xi[n âˆ’ 1], . . . , xi[n âˆ’ Nhj|i + 1]. If Nhj|i = 1 (i.e., no lags)

6

and hj|i[0] â‰¥ 0 then Ïj|i is the correlation between xj and xi so that Ïj|i = Ïj,i
and the approach of this paper exactly reduces to the standard approach. In
Section 2.2.1, we describe a constraint such that hj|i[0] â‰¥ 0 is always achieved.
The entire algorithm is shown in Fig. 1. The Matlab software of implementing

p-correlation is available upon request.

7

(a) Flow chart describing the computational method.

(b) â€œLeast Squaresâ€ Sub-block.

(c) â€œCorrelationâ€ Sub-block.

(d) Operators used in the block diagrams of Panels (a)-(c). Lines that intersect in the form , do not connect

at the intersection while other intersections imply connections.

Figure 1: Block diagram and sub-block diagrams describing the computation

of p-correlation for one pair of ROIs.

8

 ğ’‰ğ’‹|ğ’Š[ğŸ]  ğ’™ğ’Š[ğ’]  ğ’™ğ’‹[ğ’] +DD ğ’™ğ’Š[ğ’âˆ’ğŸ]  ğ’™ğ’Š[ğ’âˆ’ğŸ] ++D     ğ’™ğ’Š[ğ’âˆ’ğ‘µğ’‰ğ’‹|ğ’Š]   ğ’‰ğ’‹|ğ’Š[ğŸ]  ğ’‰ğ’‹|ğ’Š[ğŸ]  ğ’‰ğ’‹|ğ’Š[ğ‘µğ’‰ğ’‹|ğ’Š] Least SquaresCorrelationMinimize Eq. 1 with respect to ğ’‰ğ’‹|ğ’Š and ğ‘µğ’‰ğ’‹|ğ’Š to determine optimal values  ğ’‰ğ’‹|ğ’Š âˆ— and  ğ‘µğ’‰ğ’‹|ğ’Š âˆ— ğ“˜(ğ’‰ğ’‹|ğ’Š) ğ†ğ’‹|ğ’Š  ğ’‰ğ’‹|ğ’Š âˆ—  ğ‘µğ’‰ğ’‹|ğ’Š âˆ—  ğ’™ ğ’‹|ğ’Š[ğ’] Ã—Ã—Ã—Ã—++++++ğ’™ğ’Š ğ†ğ’‹|ğ’Š outin1         2        â€¦       â€¦     1         2        â€¦       â€¦     The (i , j ) element of the connection matrix                for one subject12â€¦â€¦ğ‘µğ‘¹ğ‘¶ğ‘°  ğ’™ğ’‹[ğ’] ++_ ğ’™ ğ’‹|ğ’Š[ğ’]  ğ’†ğ’‹|ğ’Š[ğ’] { Â· }2âˆ‘n ğ’†ğ’‹|ğ’ŠğŸ[ğ’] ğ“˜(ğ’‰ğ’‹|ğ’Š)  ğ’™ğ’‹[ğ’] Ã—  ğ’™ ğ’‹|ğ’Š[ğ’] âˆ‘n{ Â· }2{ Â· }2âˆ‘nâˆ‘nÃ—   Ã· ğ†ğ’‹|ğ’Š nd ğ’‚ (i) the signal is â€˜aâ€™ ğ’‚ ++_ ğ’ƒ  ğ’™ (vi) the output signal â€˜xâ€™ is â€˜x=a-bâ€™ ğ’‚ Ã—  ğ’ƒ  ğ’™ (vii) the output signal â€˜xâ€™ is â€˜x=aÂ·bâ€™ ğ’™ { Â· }2 ğ’š (iv) the output â€˜yâ€™ is â€˜y=x2â€™âˆ‘n ğ’™[ğ’]  ğ’š[ğ’]  (iii) the output â€˜y[n]â€™ is â€˜y[n]=âˆ‘n      x[m]â€™Ã· nd ğ’‚  ğ’ƒ  ğ’™ (viii) the output â€˜yâ€™ is â€˜x=a/bâ€™ (â€œnâ€ for â€œnumeratorâ€ and â€œbâ€ for â€œdenominatorâ€)   ğ’™  ğ’š (v) the output signal â€˜yâ€™ is D ğ’™[ğ’]  ğ’š[ğ’] (ii) the output â€˜y[n]â€™ is â€˜y[n]= x[n-1]â€™  â€˜y=   x â€™m=02.2. Specializations of the fundamental method

The fundamental method can be specialized for particular applications, often

based on what the user knows about the details of the applications. Several such

specializations are described in the following paragraphs.

2.2.1. Constraints on the least squares problems

If the user has information on the type of interactions that are present, then

this information can be used as a constraint on the least square problem that de-

termines the impulse response which is the basis of the prediction. For example,

as in the simulated data of Smith et al. (Smith et al., 2011), the interactions are

ance of the two signals, denoted by Rj,i[m]) by Rj|i =(cid:80)Nhj|i

all positive. Constraining the impulse response values hj|i[n] to be nonnegative
has implications for the values of Ïj|i. Let Rj|i be the covariance of xj and Ë†xj|i.
Rj|i is related to the covariance of xj[n] and xi[nâˆ’ m] (i.e., the m-lagged covari-
m=0 Rj,i[m]hj|i[m].
The covariance Rj|i is the numerator of Ïj|i. Therefore, if all the lagged co-
variances are positive and we require the estimated values of hj|i[m] to be
positive then we are assured of getting a nonnegative value for Rj|i and for
the p-correlation Ïj|i. In the traditional functional connectivity analysis, when

âˆ’1

global signal regression is applied to rs-fMRI timeseries data, the valid inference

of negative correlations cannot be made (Murphy et al., 2009; Saad et al., 2012),

and only positive correlations are interpreted. In this situation, the nonnegative

â€œconstrainedâ€ estimation approach is appropriate.

2.2.2. Thresholding Ïj|i

Three natural methods for thresholding Ïj|i are described in this section.
Even with hj|i[n] â‰¥ 0, it may be that p-correlation is not positive because
one or more of the m-lagged covariance values are negative. Therefore, if non-

negativity is required, we replace all negative Ïj|i values by zeros. One reason for
seeking to have Ïj|i non negative is mean signal regression in the preprocessing

of the fMRI data which makes it diï¬ƒcult to interpret negative correlations.

9

However, alternative preprocessing which omits mean signal regression (Jo et al.,

2013) removes this requirement.

The previous paragraph concerned thresholding at value 0. Higher data-

dependent minimum thresholds are often used for correlation and the same

approach can be applied to p-correlaton. A standard approach (Power et al.,

2011) is to order the values of correlation and leave the top s percent of values

unchanged and set the remaining values to zero. In other words, the threshold

Î³(s) is set to be the 100-s percentile of all values in the p-correlation matrix.

In some problems the interactions are known to be unidirectional, e.g., in

the simulated data of Smith (Smith et al., 2011).

In this situation, a third

thresholding method, which makes p-correlation unidirectional, is natural. The

threshold is to consider the two transpose related elements of the matrix and

set the smaller to zero and leave the larger unchanged.

All of the thresholding methods are nonlinear operation applied to the matrix

of Ïj|i coeï¬ƒcients. Each can be applied to any matrix M to give an output

matrix N , in particular, in the order of the previous three paragraphs,

where Î³(s) is the 100 âˆ’ s percentile of all values in M , and

The thresholding approach forms a NROI Ã— NROI matrix of thresholded connec-
tion weights, from which the network is computed.

2.2.3. Averaging over subjects

In Smith et al. (2011), each subject is processed independently, but in many

investigations using experimental data, e.g., Power et al. (2011, 2013), there is

10

0,

ï£±ï£´ï£²ï£´ï£³Mij,
ï£±ï£´ï£²ï£´ï£³Mij,
ï£±ï£´ï£²ï£´ï£³Mij,

0,

0,

Nij =

Nij =

Nij =

if Mij â‰¥ 0

,

otherwise
if Mij â‰¥ Î³(s)

otherwise

,

if Mij â‰¥ Mji

.

otherwise

(4a)

(4b)

(4c)

averaging over subjects in order to improve the SNR.

Just as the thresholding methods (Section 2.2.2), which are nonlinearities

that can be applied to any matrix, the averaging we use can be applied to any
family of matrices Mk (k âˆˆ {1, . . . , K}, where K is the number of subjects) to
give an output matrix N via N = 1
K

(cid:80)K

k=1 Mk.

In addition, it would be possible to measure the homogeneity of a cohort

of subjects by computing other quantities such as the second central moment.

If the cohort is not homogeneous then many techniques exist for partitioning

the cohort into a small number of discrete classes which are homogeneous (Do-

erschuk and Johnson, 2000) or into a small number of discrete classes each

of which has diï¬€erent heterogeneity and characterize the heterogeneity (Zheng

et al., 2012).

3. Application on Simulated Data

3.1. Data source: simulated BOLD timeseries

Simulated fMRI timeseries from the laboratory of S. M. Smith are docu-

mented (Smith et al., 2011) and available on-line (http://www.fmrib.ox.ac.

uk/analysis/netsim/). The simulations are based on a variety of underlying

networks of diï¬€erent complexity and can be described as having three levels.

First there is a neural level which is a stochastic linear vector diï¬€erential equa-

tion which produces a neural timeseries for each ROI. Second, for each ROI,

there is a nonlinear balloon model driven by the corresponding neural time-

series which produces a vascular timeseries. Third, for each ROI, the fMRI

timeseries is the vascular timeseries plus thermal noise. The current paper con-
siders the ï¬rst four sets of simulations from Smith et al. (2011), Sim1 âˆ’ Sim4,
which are based on diï¬€erent underlying networks with sizes 5, 10, 15, and 50

ROIs, respectively.

These synthetic fMRI timeseries were sampled every 3s (TR= 3s) and the

total duration is Nx = 60 mins. All four simulations have 1% thermal noise

and the hemodynamic response function (HRF) used in the second step has

standard deviation of 0.5 s. The simulation is repeated for each of 50 subjects.

11

3.2. Specialization on p-correlation for the processing of the simulated data

Figure 2: Block diagram describing the specialization of p-correlation for sim-

ulated data. Nonzero entries are ï¬lled by colored dots with higher values repre-

sented by â€œhotterâ€ colors and lower values represented by â€œcolderâ€ colors, and

zero entries are left as blank in the above matrices.

The algorithm is shown in Figure 2. Given that the interactions are all pos-

itive in the simulated data, it is natural to apply the nonnegative constraint

on the least square problem so that no negative impulse responses are allowed.

Through unconstrained p-correlation is also computed on the simulated data,

looking forward to Section 3.5, the numerical results indicate that the con-

strained version is more appropriate.

As is described above, the integer minimization over the impulse function

duration, Nhj|i, is computed by testing from 1 second up to D seconds. Assum-

ing that knowledge of the behavior of a ROI over the past 15 seconds is suï¬ƒcient

to describe its eï¬€ect on a second ROI, we restricted the temporal window for

directional inï¬‚uence between ROIs to no more than 15s, i.e. D = 15s.

Next, we consider the choice of threshold, s in Eq. 4b. We use this method in

order to exploit all of the a priori knowledge about the simulated data. Since the

underlying ground truth networks for the simulated fMRI timeseries, denoted by

aj|i, are given, the threshold value s is among our prior knowledge as is described

below. We denote ROIs that are involved in the connections of the ground

truth network as active ROIs. All connections involving the active ROIs are

12

outin1         2        â€¦       â€¦     1         2        â€¦       â€¦     12â€¦â€¦ğ’™ğ’Š ğ‘µğ‘¹ğ‘¶ğ‘° Retain the dominant connections(Eq. 4c)outin1         2        â€¦       â€¦     1         2        â€¦       â€¦     12â€¦â€¦ğ’™ğ’Š ğ‘µğ‘¹ğ‘¶ğ‘° Matrix of connection weights for one subject (                        )ğ‘µğ‘¹ğ‘¶ğ‘° X ğ‘µğ‘¹ğ‘¶ğ‘° outin1         2        â€¦       â€¦     1         2        â€¦       â€¦     12â€¦â€¦ğ’™ğ’Š ğ‘µğ‘¹ğ‘¶ğ‘° Network of thresholded connection weights (                        )ğ‘µğ‘¹ğ‘¶ğ‘° X ğ‘µğ‘¹ğ‘¶ğ‘° Retain the top â€œs%â€ entries (Eq. 4b)Final network with dominant connections only (                        )ğ‘µğ‘¹ğ‘¶ğ‘° X ğ‘µğ‘¹ğ‘¶ğ‘° ğ†ğ’‹|ğ’Š ğ’„ğ’‹|ğ’Š ğ’…ğ’‹|ğ’Š connections of interest (COIs), including connections that are actually absent

such as the reverse connection in an unidirectional interaction. The value of s is

then the ratio of the number of COIs and the number of all possible connections,

which gives s = 40, 22, 16 and 4 percent for the four simulations, respectively.

An example of computing s for a 5-node network is shown in Fig. 3. For the

(a) A 5-node ground truth network.

(b) 6 pairs COIs.

Figure 3: Example calculation of the threshold s for a 5-node network. (a)

The network with activated ROIs shown in orange. The number of all possible

connections is 52 = 25. (b) The 6 COIs, where the dashed lines are connections

that do not existed in the ground truth but still are considered interesting.

Therefore, s = 6/25 for this network.

Smith simulated data, we have additional prior knowledge that the networks

contain only unidirectional connections. Therefore, as is also done in Smith et al.

(2011), we compare our estimated network dj|i, which includes the unidirectional
condition, with the ground truth network aj|i. The estimated network dj|i is
the output of Eq. 4c where the input is the thresholded network cj|i.

3.3. Performance Criteria

To compare the computed and ground truth networks, we deï¬ne â€œaccuracyâ€,
In particular, A is deï¬ned to be the mean fractional rate of
denoted by A.
detecting the correct directionality of true connections. Speciï¬cally, it is deï¬ned

where 1{L} is 1 if L is true, and 0 otherwise. Like the computation of the â€œd-
accuracyâ€ introduced in Smith et al. (2011), A evaluates the percentage of the

,

(5)

to be

A =

(cid:80)NROI

i=1

(cid:80)NROI
(cid:80)NROI
(cid:80)NROI
j=1 1{aj|i > 0}1{dj|i > 0}
j=1 1{aj|i > 0}

i=1

13

2A 5-node ground truth network, 25 possible pairs of connections.ROIs={1, 2, 3, 4, 5},Activated ROIs={1, 2, 3, 4}. 23214COIs={(1, 2), (2, 1), (1, 3), (3, 1), (3, 4), (4, 3)}.correct directionality. The threshold operation introduced above (Section 3.2)

diï¬€erentiates the performance of directional analytical methods based on their

sensitivity. The more sensitive the method is, the more true connections it can

detect. Notice that application of the threshold s leads to dj|i values that are
almost certainly far from zero or exactly zero. Computing the accuracy A after
the threshold operation tells the directionality after knowing the presence of the

connections, which enable us to evaluate the overall performance of sensitivity

and directionality of a directional analytical method.

3.4. Alternative methods for networks estimation

P-correlation and four alternative methods from Smith et al. (2011), specif-

ically, â€œGranger B1â€, â€œGen Synch S1â€, â€œLiNGAMâ€ and â€œPatelâ€™s conditional
dependence measureâ€, were compared by the accuracy criteria (A), since un-
der both synthetic and experimental scenarios, these methods have been tested

and have relatively good performances among all the others (Smith et al., 2011;

Dawson et al., 2013). The computation of these methods were done by software

provided by Prof. S.M. Smith. Granger B1, a pairwise Granger causality esti-

mation method which provides the best performance among Granger causality

approaches (Smith et al., 2011; Dawson et al., 2013), uses the Bayesian Infor-

mation Criterion to estimate the lag up to 1 TR. Gen Synch S1 is a nonlinear

synchronization method with respect to the time lag 1 TR. It â€œevaluates syn-

chrony by analyzing the interdependence between the signals in a state space

reconstructed domainâ€ (Dauwels et al., 2010, p. 671). The LiNGAM (Linear,

Non-Gaussian, Acyclic causal Models) algorithm is a global network model uti-

lizing higher-order distributional statistics, via independent component analysis,

to estimate the network connections. Patelâ€™s conditional dependence measure

investigates the causality from the imbalance between two conditional proba-
bilities, P (xj|xi) and P (xi|xj). P-correlation, Granger B1, Gen Synch S1 and
LiNGAM all compute an asymmetric matrix ï¬lled with real-number connection

weights, analogous to our cj|i. In all cases, the unidirectional prior knowledge is
applied analogous to our transformation from cj|i to dj|i. For the Patel method

14

implemented by Smith et al. (2011), the thresholding operation was applied on

â€œPatelâ€™s Îº bin 0.75â€ matrix, while the directionality was determined by â€œPatelâ€™s

Ï„ bin 0.75â€ matrix.

In addition to the algorithms included in Smith et al. (2011), Ramsey pro-

posed IMaGES (Ramsey et al., 2010, 2011) and Gates proposed GIMME (Gates

and Molenaar, 2012) algorithms, which are designed for estimating connectivi-

ties based on a group of subjects. The IMaGES algorithm estimates one gener-

alized network from a group of subjects. The GIMME algorithm can be applied

both to event-related data and to resting-state data. For resting-state data,

GIMME is based on the uniï¬ed Structural Equation Modeling (uSEM) model

proposed in Kim et al. (2007) and a practical automatic search procedure intro-

duced in Gates et al. (2010). While for event-related data, GIMME is based on

the extended uniï¬ed SEM (euSEM) proposed in Gates et al. (2011). Though

both IMaGES and GIMME can work with a group of 1, the performance is ei-

ther similar to or less good than the best-performing method described in Smith

et al. (2011) on Smithâ€™s simulation data. Comparing IMaGES and GIMME

with p-correlation, p-correlation can work on individual subjects directly, and is

therefore potentially useful in a clinical environment. In addition, p-correlation

can process networks with hundreds on ROIs while GIMME is limited to 3-

25 ROIs. GIMME and IMaGES estimate a single graph of interactions, while

p-correlation estimates an asymmetrical matrix which can be thresholded as

desired and/or further processed as desired using another algorithm. Therefore,

GIMME and IMaGES are solving somewhat diï¬€erent problems than the p-

correlation method. Other algorithms have been developed as post-processoring

algorithms, which cannot detect connections, but only estimate direction if con-

nections are detected by other methods, e.g., correlation. Among them, pairwise

LiNGAM (HyvÂ¨arinen and Smith, 2013) achieved success on Smith data. Several

algorithms, such as Patelâ€™s Ï„ , LiNGAM and pairwise LiNGAM, chose one of the

two possible directions for each pair of ROIs. Such unidirectionality may be

appropriate in some situations. Alternative algorithms, including p-correlation,

provide strengths for both directions, where the two strengths may be quite

15

diï¬€erent when one direction is dominant.

3.5. Results on simulated data

The methods described in this paper were implemented in Matlab software,

which is available upon request, and were applied to four of Smithâ€™s fMRI simu-
lations (Smith et al., 2011). The four simulations are Sim1 âˆ’ Sim4 which have
a variable number of ROIs (5, 10, 15, 50) but no confounding variables.

The p-correlation method is based on estimation of a linear time-invariant

causal dynamic model. The sample means of the duration of either constrained

or unconstrained impulse responses are 3.34s, 3.58s, 3.64s and 3.76s for the 4

simulations, respectively. By limiting the impulse response duration to 1 TR, it

was veriï¬ed that p-correlation with constraint on Least Squares is equivalent to

the standard correlation as is described in Section 1. After thresholding the p-

correlations computed with the nonnegative constraint on the coeï¬ƒcients of the

linear system, an asymmetric matrix of connection weights cj|i for each subject

was obtained.

The performance of all ï¬ve methods was evaluated by the accuracy criteria
A (Eq. 5) for each subject. Fig. 4 shows the input to the accuracy criteria A,
i.e., aj|i and dj|i, for Subject 14 of Sim2.

Figure 4:

Images of aj|i (for ground truth) and dj|i (for constrained p-
correlation), and quantities analogous to dj|i (for Granger B1, Gen Synch S1,

LiNGAM, and Patel) for Subject 14 of Sim2. Each image uses the same ordering

of colors, but has diï¬€erent range of numerical values.

The mean and standard deviation of accuracy for each simulation, i.e., the
average and square root of the sample variance of A (Eq. 5) over all 50 subjects,

16

ground truth246810246810Granger B1246810246810Gen Synch S1246810246810LiNGAM246810246810Patel Tau bin0.75246810246810p-Corr (15s)246810246810-10  mostpositiveSimulation

# of ROIs

# of COI pairs

Granger B1

Gen Synch S1

LiNGAM

Patel

p-Corr (constrained)

p-Corr (unconstrained)

1

5

10

2

10

22

3

15

36

4

50

122

.440Â±.206
.472Â±.201
.372Â±.229
.528Â±.193
.532Â±.192
.520Â±.218

.295Â±.127
.405Â±.139
.435Â±.177
.491Â±.101
.502Â±.114
.467Â±.123

.262Â±.088
.379Â±.079
.301Â±.106
.446Â±.099
.457Â±.126
.439Â±.109

.130Â±.044
.285Â±.056
.119Â±.037
.366Â±.048
.405Â±.065
.371Â±.058

Table 1: Comparison of the mean and standard deviation of accuracy over 50

subjects among diï¬€erent methods. The standard deviation tend to be larger on

the smaller netowrks (Sim1-Sim4 have 5, 10, 15, 50 ROIs, respectively) because

one error is proportionally of larger impact in a smaller network.

were computed and the results are tabulated in Table 1. For all four simulations,

constrained p-correlation achieved the highest accuracy compared to the others.

The unconstrained p-correlation is less appropriate when applied to a network

with all positive connection weights. We also computed the mean and stan-
dard deviation of A for pairwise LiNGAM, which gives .566Â±.138, .656Â±.206,
.510Â±.119 and .506Â±.056 for four simulations, respectively. The result shows
the highly accurate directionality that pairwise LiNGAM can achieve in this

particular unidirectional network setting. Histograms displaying the distribu-

tion of accuracy for the ï¬ve methods for each simulation are shown in Fig. 5.

The superior performance of p-correlation is demonstrated by the fact that the

bulk of the histogram is further to the right, and the left tail is less massive.

17

Figure 5: Accuracy histogram for Granger B1, Gen Synch S1, LiNGAM, Patel

and constrained p-correlation.

4. The performance of correlation and p-correlation on common drivers

A â€œcommon driverâ€ situation is the case where ROI 1 drives ROIs 2 and 3

but ROIs 2 and 3 do not directly interact. The challenge is to correctly detect
the 1â†’2 and 1â†’3 connections without detecting 2â†’3 or 3â†’2 false connections.
In order to focus exclusively on this situation, we have computed synthetic data

from the three-ROI network shown in Fig. 6 and deï¬ned by

Figure 6: The common driver problem.

18

00.20.40.60.810102030Sim1(5 ROIs)Granger B100.20.40.60.810102030Gen Synch S100.20.40.60.810102030LiNGAM00.20.40.60.810102030Patel00.20.40.60.810102030pâˆ’Corr00.20.40.60.810102030Sim2(10 ROIs)00.20.40.60.81010203000.20.40.60.81010203000.20.40.60.81010203000.20.40.60.81010203000.20.40.60.810102030Sim3(15 ROIs)00.20.40.60.81010203000.20.40.60.81010203000.20.40.60.81010203000.20.40.60.81010203000.20.40.60.810102030Sim4(50 ROIs)00.20.40.60.81010203000.20.40.60.81010203000.20.40.60.81010203000.20.40.60.810102030x1[n + 1] = a1x1[n] + b1w1[n]

x2[n + 1] = a2x2[n] + a21x1[n] + b2w2[n]

x3[n + 1] = a3x3[n] + a31x1[n] + b3w3[n]

(6)

(7)

(8)

where w[n] = [w1[n], w2[n], w3[n]]T is an independent and identically distributed
Gaussian stochastic process with mean 0 and variance I3 (the 3Ã—3 identity
matrix). Zalesky et al. (2012) consider mathematical models of this type and

give theoretical results for correlations. The system is initialized in the steady

state and simulated for 1000 steps, Nx = 1000. We consider only a1 = a2 =

a3 = .8 (so that all ROIs have the same intrinsic memory duration) and b1 =

b2 = b3 = .2 (so that all ROIs have the same intrinsic noise power, and the

intrinsic noises are all independent). We consider the following cases: (1) no

driving: a21 = a31 = 0, (2) weak driving: a21 = a31 = .1, (3) strong driving:

a21 = a31 = .4, and (4) asymmetrical strong driving: a21 = .4, and a31 = .1.

Each simulation was repeated for 50 subjects. Let the maximum allowable

duration of the impulse response be 3 samples. By using the specialization of

p-correlation for Smith simulated data, as is described in Section 3.2, a directed

graph dj|i is estimated by p-correlation (Fig. 2) and the correlation matrix

is computed for each subject. The steady state covariance of Eqs. 6-8 is the

correlation matrix. In Case (1), the mean and standard deviation of nonzero
entries of Ïj|i with constrained least squares (Section 2.2.1) are 5.384e-04Â±0.072.
This number becomes 0.058Â±0.043 when unconstrained least squares is applied.
The smaller magnitude of the results using constrained least squares indicates

that taking advantage of the prior knowledge that the weights are positive (i.e.,

a1 = a2 = a3 = .8) provides improved performance in this case. In Cases (2)

and (3), both the constrained and the unconstrained least squares achieve a

100% accuracy (Eq. 5) for each subject. In the fourth case, the constrained
or the unconstrained least squares gives an average of .800Â±.247 accuracy over
all 50 subjects. We also tested Nx =200, 500, 5000 for all four cases. Notice

that as Nx goes large, correlations become closer to the steady state and the

accuracy computed by the p-correlation method increases as well.

19

In addition, p-correlation estimated the correct hierarchy on the three pairs

of connection weights, which are consistent with â€œstrongâ€, â€œweakâ€ and â€œnon-â€

connections in the ground truth network. It also shows the correct direction of

connections in a pair by a stronger weight. The constrained least squares (Sec-

tion 2.2.1) provides a slightly superior result than the unconstrained approach.

Speciï¬cally, larger numerical diï¬€erences between the zero and nonzero entries,

as well as between the asymmetric strong weights, were shown. On average

across all 50 subjects, p-correlation used an impulse response duration of 1.007

samples for all four cases for both constrained and unconstrained approaches. In

addition, in Case (3) (asymmetric strong weights), correlation mis-detected the

connection between node 2 and 3, speciï¬cally the 2-3 correlation was the high-

est correlation value among the three pairs, whereas p-correlation, for both the

constrained and unconstrained approaches, estimated this value as the lowest

of the three pairs thereby avoiding the error in the correlation results.

5. Performance on experimental fMRI data

While the tools described in this paper can be assembled into many algo-

rithms, we use only one algorithm, which is shown in Figure 7, to further char-

acterize (Xu et al., 2014), a cohort of 132 subjects from the 1000 Functional Con-

nectomes Project (http://www.nitrc.org/projects/fcon_1000/) (Biswal et al.,

2010). We combine our p-correlation ideas with the widely-used (Power et al.,

2011, 2012; Lahnakoski et al., 2012) Infomap graph analytical algorithm (Lanci-

chinetti and Fortunato, 2009) to determine networks within the set of 264 ROIs.

As a function of the value of the threshold s, Infomap creates a variable

number of networks. Following Power et al. (2011, Fig. 1), the network stability
over a range of threshold s âˆˆ {2, . . . , 10} using correlations and p-correlations
are shown in Fig. 8, in which diï¬€erent networks are represented by diï¬€erent

colors. Similar to Power et al. (2011) (the ï¬rst ï¬gure in Fig 8), we note that the

assignment of ROIs to networks remains relatively constant over all values of

20

Figure 7: Block diagram describing the specialization of p-correlation for the

experimental data. Nonzero entries are ï¬lled by colored dots with higher values

represented by â€œhotterâ€ colors and lower values represented by â€œcolderâ€ colors,

and zero entries are left as blank in the above matrices.

the threshold s, illustrated by the constant horizontal bands in diï¬€erent colors.

Also, networks are hierarchically reï¬ned as s rises. In summary, the number

of networks increases as the value of s decreases, and p-correlation replicated

the brain network organizations that were detected by correlation. The network

results are consistent with the network organizations detected in Power et al.

(2011).

Figure 8: The stability of networks across various thresholding criteria (s). The

white regions indicate ROIs that belong to networks with less than four ROIs.

In order to test the robustness of the p-correlation calculation, all 132 sub-

21

outin1         2        â€¦       â€¦     1         2        â€¦       â€¦     12â€¦â€¦ğ’™ğ’Š ğ‘µğ‘¹ğ‘¶ğ‘° Graphicalanalyticaltoolğ‘µğ‘¹ğ‘¶ğ‘° X ğ‘µğ‘¹ğ‘¶ğ‘° ğ’„ğ’‹|ğ’Šğ’” ğ‘µğ’”  ğ† ğ’‹|ğ’Š+ Matrices of positive connection weights for       subjects (                        )outin1         2        â€¦       â€¦     1         2        â€¦       â€¦     12â€¦â€¦ğ’™ğ’Š ğ‘µğ‘¹ğ‘¶ğ‘° ğ†ğ’‹|ğ’Š Matrices of connection weights for       subjects (                        )outin1         2        â€¦       â€¦     1         2        â€¦       â€¦     12â€¦â€¦ğ’™ğ’Š ğ‘µğ‘¹ğ‘¶ğ‘° ğ†ğ’‹|ğ’Š+ Retain allpositive entries (Eq. 4a)ğ‘µğ‘¹ğ‘¶ğ‘° X ğ‘µğ‘¹ğ‘¶ğ‘° ğ‘µğ’”  outin1         2        â€¦       â€¦     1         2        â€¦       â€¦     12â€¦â€¦ğ’™ğ’Š ğ‘µğ‘¹ğ‘¶ğ‘° The matrix of averaged positive connection weights  (                        )ğ‘µğ‘¹ğ‘¶ğ‘° X ğ‘µğ‘¹ğ‘¶ğ‘° Average over allsubjectsoutin1         2        â€¦       â€¦     1         2        â€¦       â€¦     12â€¦â€¦ğ’™ğ’Š ğ‘µğ‘¹ğ‘¶ğ‘° Network of final connection weights (                        )ğ‘µğ‘¹ğ‘¶ğ‘° X ğ‘µğ‘¹ğ‘¶ğ‘° Retain the top â€œs%â€ entries (Eq. 4b)Decomposed network (                        )ğ‘µğ‘¹ğ‘¶ğ‘° X ğ‘µğ‘¹ğ‘¶ğ‘° jects were randomly divided into two equal cohorts, and each cohort was sep-

all subjects in the cohort, which is denoted by Â¯Ï+

arately processed. The average of p-correlation connection strength Ï+

j|i across
j|i, is shown as a scatter plot
in Fig. 9 (a) (in Fig. 9, all (0,0) points are removed). The linear least squares

prediction of Cohort 2 from Cohort 1 is a close ï¬t to the data (r2 = .87) and
is nearly a 45â—¦ diagonal line (Â¯ÏCohort 2
the robust nature of p-correlation. Following the same procedure, the average

+.032), thereby indicating

j|i

=1.013Â¯ÏCohort 1

j|i

of correlation connection strength Ï+

i,j across all subjects in the cohort, which is
i,j, is shown in Fig. 9 (b). Comparing Fig.9 (a) and (b) indicates
that the p-correlation achieves the same robustness as correlation. Additional

denoted by Â¯Ï+

plots in which no points are removed are included in the supplemental material

Fig. 2.

(a) p-correlation

(b) correlation

Figure 9: Scatter plot of p-correlation and correlation for the two cohorts. The

red line is the Least Squares ï¬t for predicting Cohort 2 from Cohort 1. Only

positive values are used in the Least Squares calculation and shown in the plot.

6. Discussion

Standard correlation has been widely used to analyze functional connectivity

from rs-fMRI timeseries between prespeciï¬ed ROIs. Prior work has shown its

22

-0.500.51Cohort1-0.500.51Cohort2r2=0.87Cohort2=1.013*Cohort1+0.032-0.500.51Cohort1-0.500.51Cohort2r2=0.88Cohort2=1.017*Cohort1+0.025high sensitivity for detecting the existence of network architectures under both

simulated and experimental scenarios (Smith et al., 2011; Dawson et al., 2013).

This paper describes methodology for analyzing rs-fMRI data using a gener-

alization of well-established correlation ideas. The generalization, denoted by

â€œp-correlationâ€ (â€œpâ€ for â€œpredictionâ€), is to compute the correlation between the

jth signal and an optimal linear time-invariant causal estimate of the jth signal

based on the ith signal. In this way, it captures additional features concerning

the interaction between two ROIs, speciï¬cally, the causality and directionality

of the information ï¬‚ow on which the interaction depends. Based on the ï¬nite-

memory linear time-invariant causal model, p-correlation allows the memory

duration to be diï¬€erent in the two directions for one pair of ROIs and also to be

diï¬€erent for diï¬€erent pairs of ROIs. In contrast, structural vector autoregres-

sive models (Kim et al., 2007; Chen et al., 2011) are assumed to have the same

memory duration across all ROIs. P-correlation is a generalization of standard

correlation ideas because, if the estimate of the jth signal based on the ith signal

is restricted to use only the current value of the ith signal, then p-correlation

and standard correlation have the same magnitude.

Testing p-correlation on simulated fMRI data provided in Smith et al. (2011),

the greater performance accuracy of p-correlation, which uses lagged informa-

tion from the BOLD timeseries, demonstrates the importance of causal informa-

tion which is missing in standard correlation. In our results, the mean duration

of the impulse response estimated by AIC using a search limited to a maximum

duration of 15s was roughly 4s. In these data, a search extending to 15s is not a

restriction on the maximum duration. As is described in Table 1, the accuracy

of p-correlation on the simulated data of Smith is about 0.5 (0.405 to 0.532).

While higher levels are desirable, this performance exceeds the performance of

many alternative algorithms on all four sets of simulations.

Many approaches have been introduced to assess functional or eï¬€ective con-

nectivity of rs-fMRI data. Smith et al. (2011) evaluated the validity of 38

approaches (Smith et al., 2011, Fig. 4) using simulated BOLD signals and a

variety of performance measures. The methods tend to have diï¬€erent levels

23

of performance for diï¬€erent measures, e.g., detection of a connection versus

determination of the direction of a connection. The p-correlation approach in-

troduced in this paper depends on causal dynamical models and so we focus on

this particular aspect of previous work. Dynamic Causal Modeling (DCM) has

been used with some success to assess causal dynamics in fMRI data by relying

on sophisticated models of neural dynamics. As discussed in Smith et al. (2011,

p. 878), most existing DCM algorithms require knowledge of external inputs

(which are not known for rs-fMRI) although some variations may not (Dau-

nizeau et al., 2009); all versions tend to be mathematically poorly conditioned;

and all versions fail to scale to networks with large numbers of ROIs which

are necessary for experimental studies. In contrast, the p-correlation approach

described in this paper scales similarly to a correlation approach for which hun-

dreds of ROIs are not a challenge (Xu et al., 2014).

Several versions of Granger causality analysis, based on multivariate vector

autoregressive modeling, have been tested and performed poorly (Smith et al.,

2011). Granger causality relies on regression and comparison of two predictions.

The ï¬rst prediction is based purely on an autoregressive model of the signal at

the ith ROI based on the past of the same signal. The second prediction is

based on regression of the signal at the ith ROI based on the past of the signal

at the jth ROI and, possibly, an autoregression as in the ï¬rst case. The sample

covariances of the prediction errors are then combined, essentially by taking

the ratio of the sample covariances scaled by integers describing the amounts

of data, to yield a statistic that is distributed according to the Fisher-Snedecor

F distribution. This statistic, indexed by i and j, is used to ï¬ll an asymmetric

matrix. Although both are based upon lagged information there are important

diï¬€erences between p-correlation and Granger causality. P-correlation is not a

statistic comparing two possible dependencies but rather is a statistic measuring

the accuracy of prediction using a particular dependency. The motivation for the

Granger causality statistic is dependent on the original Gaussian assumptions

on the errors when linear regression is used to describe the ROI time series. P-

correlation is based on just the sample variance of the prediction error and does

24

not have a Gaussian motivation which is advantageous if the BOLD signals lack

Gaussian structure. Multivariate autoregressive processes have been used as the

basis for generative models for complete sets of ROIs. Such models, which focus

on the eï¬€ect of the past on the present, can be combined with structural equation

modeling (SEM) models, which focus on contemporaneous eï¬€ects (Chen et al.,

2011). Other approaches to examining BOLD signal propagation using lags, as

is done in p-correlation, have been highly reproducible (Mitra et al., 2015).

In addition to the algorithms mentioned in Smith et al. (2011), which esti-

mate the directional connectivity for single subject data sets, IMaGES (Ramsey

et al., 2010, 2011) and GIMME (Gates and Molenaar, 2012) algorithms use a

group of subjects. IMaGES estimates one generalized network from a group,

whereas GIMME can reï¬ne the estimate for each individual subject from the

general information estimated from the whole group. Similar to DCMâ€™s limita-

tion on scalability, small networks with less than 25 ROIs are well analyzed by

the IMaGES and GIMME algorithms. However, their performances on large-

scale functional networks are not known. As p-correlation can work with hun-

dreds ROIs so it can be used in evaluating large-scale brain networks, and can

work on individual subjects so it potentially could be applied to patient clinical

data. Other algorithms that estimate direction after a connection is already

detected also exist (Section 3.4). While such algorithms may be useful in some

circumstances, they do not allow for situations where both directions are present

but of diï¬€erent strengths.

Simulated data has lower dimensionality than experimental brain data. For

instance, in the simulation, connections are all unidirectional while most neural

connections are bidirectional. Additionally, in the simulations, most connections

had a value of exactly zero. While this simulated data is not a perfect test

of p-correlation, we leveraged the same data used in Smith et al. (2011) for

comparison with other published metrics, providing a broader context for these

ï¬ndings.

In order to focus on the challenges of a â€œcommon driverâ€, we have produced

additional synthetic data for the three ROI network of Figure 6 in which one

25

ROI drives two other ROIs but the two other ROIs do not directly interact.

Using p-correlation in this network we found that p-correlation can identify

the existence and direction of the interactions between the driving ROI and

the other two ROIs (even when the two interactions are of diï¬€erent strengths).

Furthermore, p-correlation did not introduce false interactions between the two

driven ROIs.

We have applied p-correlation to experimental data from the 1000 Functional

Connectome Project (Biswal et al., 2010). The p-correlation approach success-

fully replicated the modular architecture of the local and distributed networks

previously reported using standard correlation (Xu et al., 2014) (see Section 5

Fig. 8). Highly correlated p-correlation values on the two diï¬€erent cohorts also

demonstrated that the p-correlation is highly reproducible and thus robust on

experimental data.

Here we introduce a novel approach, the p-correlation, to estimate brain con-

nectivity within well-characterized large-scale functional networks. The replica-

tion of previously observed network architectures in experimental data and the

performance against the ground truth in simulated data, both suggest that the

p-correlation approach may hold promise for future investigations of the brainâ€™s

dynamic functional architecture.

7. Acknowledgements

We are very grateful to Prof. S.M. Smith (University of Oxford) for providing

simulation data and his software for applying Patelâ€™s conditional dependence

measures and network measurements as described in his paper (Smith et al.,

2011) as well as for helpful discussion. We are also very grateful to Dr. Chandler

Lutz for providing the pairwise Granger causality code, Dr. Rodrigo Quian

Quiroga for providing the generalized synchronization code, and Drs. Shohei

Shimizu, Patrik Hoyer and Aapo Hyvrinen for providing LiNGAM/FastICA.

Nan Xu and Peter C. Doerschuk are grateful for support by NSF Grant 1217867.

26

8. Supplemental

Figure 1: Accuracy histogram for Granger B1, Gen Synch S1, LiNGAM, Patel

and p-correlation with unconstrained and constrained Least Squares.

(a) p-correlation

(b) correlation

Figure 2: Scatter plot of p-correlation and correlation for the two cohorts. The

red line is the Least Squares ï¬t for predicting Cohort 2 from Cohort 1.

27

00.510102030Sim1(5 ROIs)Granger B100.510102030Gen Synch S100.510102030LiNGAM00.510102030Patel00.510102030pâˆ’corr (unconstrained)00.510102030pâˆ’corr (constrained)00.510102030Sim2(10 ROIs)00.51010203000.51010203000.51010203000.51010203000.51010203000.510102030Sim3(15 ROIs)00.51010203000.51010203000.51010203000.51010203000.51010203000.510102030Sim4(50 ROIs)00.51010203000.51010203000.51010203000.51010203000.510102030-0.500.51Cohort1-0.500.51Cohort2r2=0.88Cohort2=1.004*Cohort1+0.041-0.500.51Cohort1-0.500.51Cohort2r2=0.88Cohort2=1.004*Cohort1+0.034References

References

Akaike, H., 1970. Statistical predictor identiï¬cation. Annals of the Institute of

Statistical Mathematics 22, 203â€“217.

Akaike, H., 1974. A new look at the statistical model identiï¬cation.

IEEE

Transactions on Automatic Control 19, 716â€“723.

Bassett, D.S., Gazzaniga, M.S., 2011. Understanding complexity in the human

brain. Trends in cognitive sciences 15, 200â€“209.

Biswal, B., Zerrin Yetkin, F., Haughton, V.M., Hyde, J.S., 1995. Functional

connectivity in the motor cortex of resting human brain using echo-planar

MRI. Magnetic resonance in medicine 34, 537â€“541.

Biswal, B.B., Mennes, M., Zuo, X.N., Gohel, S., Kelly, C., Smith, S.M., Beck-

mann, C.F., Adelstein, J.S., Buckner, R.L., Colcombe, S., et al., 2010. To-

ward discovery science of human brain function. Proceedings of the National

Academy of Sciences 107, 4734â€“4739.

Cavanaugh, J.E., 1997. Unifying the derivations for the Akaike and corrected

Akaike information criteria. Statistics & Probability Letters 33, 201â€“208.

Chen, G., Glen, D.R., Saad, Z.S., Hamilton, J.P., Thomason, M.E., Gotlib,

I.H., Cox, R.W., 2011. Vector autoregression, structural equation modeling,

and their synthesis in neuroimaging data analysis. Computers in biology and

medicine 41, 1142â€“1155.

Cole, M.W., Bassett, D.S., Power, J.D., Braver, T.S., Petersen, S.E., 2014.

Intrinsic and task-evoked network architectures of the human brain. Neuron

83, 238â€“251.

Daunizeau, J., Friston, K., Kiebel, S., 2009. Variational bayesian identiï¬cation

and prediction of stochastic nonlinear dynamic causal models. Physica D:

Nonlinear Phenomena 238, 2089 â€“ 2118. doi:10.1016/j.physd.2009.08.002.

28

Dauwels, J., Vialatte, F., Musha, T., Cichocki, A., 2010. A comparative study

of synchrony measures for the early diagnosis of Alzheimerâ€™s disease based on

eeg. NeuroImage 49, 668â€“693.

Dawson, D.A., Cha, K., Lewis, L.B., Mendola, J.D., Shmuel, A., 2013. Evalua-

tion and calibration of functional network modeling methods based on known

anatomical connections. NeuroImage 67, 331â€“343.

Doerschuk, P.C., Johnson, J.E., 2000. Ab initio reconstruction and experimental

design for cryo electron microscopy. Information Theory, IEEE Transactions

on 46, 1714â€“1729.

Foster, B.L., Rangarajan, V., Shirer, W.R., Parvizi, J., 2015. Intrinsic and task-

dependent coupling of neuronal population activity in human parietal cortex.

Neuron 86, 578â€“590. doi:10.1016/j.neuron.2015.03.018.

Friston, K.J., 2011. Functional and eï¬€ective connectivity: A review. Brain

Connectivity 1, 13â€“36.

Gates, K.M., Molenaar, P.C., 2012. Group search algorithm recovers eï¬€ective

connectivity maps for individuals in homogeneous and heterogeneous samples.

Neuroimage 63, 310â€“319.

Gates, K.M., Molenaar, P.C., Hillary, F.G., Ram, N., Rovine, M.J., 2010. Auto-

matic search for fmri connectivity mapping: an alternative to granger causal-

ity testing using formal equivalences among sem path modeling, var, and

uniï¬ed sem. NeuroImage 50, 1118â€“1125.

Gates, K.M., Molenaar, P.C., Hillary, F.G., Slobounov, S., 2011. Extended

uniï¬ed sem approach for modeling event-related fmri data. NeuroImage 54,

1151â€“1158.

Hipp, J.F., Siegel, M., 2015. Bold fmri correlation reï¬‚ects frequency-speciï¬c

neuronal correlation. Current Biology .

29

Hurvich, C.M., Tsai, C.L., 1989. Regression and time series model selection in

small samples. Biometrika 76, 297â€“307.

Hurvich, C.M., Tsai, C.L., 1993. A corrected Akaike information criterion for

vector autoregressive model selection. Journal of time series analysis 14, 271â€“

279.

HyvÂ¨arinen, A., Smith, S.M., 2013. Pairwise likelihood ratios for estimation of

non-gaussian structural equation models. The Journal of Machine Learning

Research 14, 111â€“152.

Jo, H.J., Gotts, S.J., Reynolds, R.C., Bandettini, P.A., Martin, A., Cox,

R.W., Saad, Z.S., 2013. Eï¬€ective preprocessing procedures virtually elim-

inate distance-dependent motion artifacts in resting state fmri. J. Applied

Mathematics 2013, 935154:1â€“935154:9.

Kim, J., Zhu, W., Chang, L., Bentler, P.M., Ernst, T., 2007. Uniï¬ed structural

equation modeling approach for the analysis of multisubject, multivariate

functional mri data. Human Brain Mapping 28, 85â€“93.

Lahnakoski, J.M., Glerean, E., Salmi, J., JÂ¨aÂ¨askelÂ¨ainen, I.P., Sams, M., Hari, R.,

Nummenmaa, L., 2012. Naturalistic fmri mapping reveals superior temporal

sulcus as the hub for the distributed brain network for social perception.

Frontiers in human neuroscience 6.

Lancichinetti, A., Fortunato, S., 2009. Community detection algorithms: A

comparative analysis. Phys. Rev. E 80, 056117. doi:10.1103/PhysRevE.80.

056117.

Mitra, A., Snyder, A.Z., Blazey, T., Raichle, M.E., 2015. Lag threads orga-

nize the brainâ€™s intrinsic activity. Proceedings of the National Academy of

Sciences of the United States of America 112, E2235â€“E2244. doi:10.1073/

pnas.1503960112.

30

Murphy, K., Birn, R.M., Handwerker, D.A., Jones, T.B., Bandettini, P.A., 2009.

The impact of global signal regression on resting state correlations: Are anti-

correlated networks introduced? NeuroImage 44, 893â€“905.

Patterson, H.D., Thompson, R., 1971. Recovery of inter-block information when

block sizes are unequal. Biometrika 58, 545â€“554.

Power, J.D., Barnes, K.A., Snyder, A.Z., Schlaggar, B.L., Petersen, S.E., 2012.

Spurious but systematic correlations in functional connectivity mri networks

arise from subject motion. Neuroimage 59, 2142â€“2154.

Power, J.D., Cohen, A.L., Nelson, S.M., Wig, G.S., Barnes, K.A., Church, J.A.,

Vogel, A.C., Laumann, T.O., Miezin, F.M., Schlaggar, B.L., et al., 2011.

Functional network organization of the human brain. Neuron 72, 665â€“678.

Power, J.D., Schlaggar, B.L., Lessov-Schlaggar, C.N., Petersen, S.E., 2013. Ev-

idence for hubs in human functional brain networks. Neuron 79, 798â€“813.

Ramsey, J.D., Hanson, S.J., Glymour, C., 2011. Multi-subject search correctly

identiï¬es causal connections and most causal directions in the dcm models of

the smith et al. simulation study. NeuroImage 58, 838â€“848.

Ramsey, J.D., Hanson, S.J., Hanson, C., Halchenko, Y.O., Poldrack, R.A., Gly-

mour, C., 2010. Six problems for causal inference from fmri. Neuroimage 49,

1545â€“1558.

Rissanen, J., 1978. Modeling by shortest data description. Automatica 14,

465â€“471.

Saad, Z.S., Gotts, S.J., Murphy, K., 0008, G.C., Jo, H.J., Martin, A., Cox,

R.W., 2012. Trouble at rest: How correlation patterns and group diï¬€erences

become distorted after global signal regression. Brain Connectivity 2, 25â€“32.

Sadaghiani, S., Poline, J.B., Kleinschmidt, A., DEsposito, M., 2015. Ongoing

dynamics in large-scale functional connectivity predict perception. Proceed-

ings of the National Academy of Sciences 112, 8463â€“8468.

31

Schwarz, G., 1978. Estimating the dimension of a model. The Annals of Statis-

tics 6, 461â€“464.

Smith, S.M., Miller, K.L., Salimi-Khorshidi, G., Webster, M., Beckmann, C.F.,

Nichols, T.E., Ramsey, J.D., Woolrich, M.W., 2011. Network modelling meth-

ods for fMRI. NeuroImage 54, 875â€“891.

Sporns, O., 2011. The human connectome: a complex network. Annals of the

New York Academy of Sciences 1224, 109â€“125.

Sugiura, N., 1978. Further analysis of the data by Akaikeâ€™s information crite-

rion and the ï¬nite corrections. Communications in Statistics - Theory and

Methods 7, 13â€“26. doi:10.1080/03610927808827599.

Thompson Jr, W., 1962. The problem of negative estimates of variance compo-

nents. The Annals of Mathematical Statistics , 273â€“289.

Van Den Heuvel, M.P., Pol, H.E.H., 2010. Exploring the brain network: a review

on resting-state fmri functional connectivity. European Neuropsychopharma-

cology 20, 519â€“534.

Wallace, C.S., Boulton, D.M., 1968. An information measure for classiï¬cation.

The Computer Journal 11, 185â€“194.

Wig, G., Schlaggar, B., Petersen, S., 2011. Concepts and principles in the

analysis of brain networks. Annals of the New York Academy of Sciences

1224, 126â€“146. doi:10.1111/j.1749-6632.2010.05947.x.

Xu, N., Spreng, R.N., Doerschuk, P.C., 2014. Directed interactivity of large-

scale brain networks: introducing a new method for estimating resting-state

eï¬€ective connectivity mri, in: Image Processing (ICIP), 2014 21st IEEE In-

ternational Conference on, pp. 3508â€“3512.

Yeo, B.T., Krienen, F.M., Sepulcre, J., Sabuncu, M.R., Lashkari, D.,

Hollinshead, M., Roï¬€man, J.L., Smoller, J.W., ZÂ¨ollei, L., Polimeni, J.R.,

32

et al., 2011. The organization of the human cerebral cortex estimated by

intrinsic functional connectivity. Journal of neurophysiology 106, 1125â€“1165.

Zalesky, A., Fornito, A., Bullmore, E., 2012. On the use of correlation as a

measure of network connectivity. Neuroimage 60, 2096â€“2106.

Zheng, Y., Wang, Q., Doerschuk, P.C., 2012. Three-dimensional reconstruction

of the statistics of heterogeneous objects from a collection of one projection

image of each object. J. Opt. Soc. Am. A 29, 959â€“970. URL: http://josaa.

osa.org/abstract.cfm?URI=josaa-29-6-959.

33

