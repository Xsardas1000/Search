6
1
0
2

 
r
a

M
9

 

 
 
]
T
R
h
t
a
m

.

[
 
 

1
v
8
7
7
2
0

.

3
0
6
1
:
v
i
X
r
a

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

HIDEYA WATANABE AND SATOSHI NAITO

Abstract. In 1980, Lusztig introduced the periodic Kazhdan-Lusztig polynomials, which are conjectured to
have important information about the characters of irreducible modules of a reductive group over a ï¬eld of
positive characteristic, and also about those of an aï¬ƒne Kac-Moody algebra at the critical level. The periodic
Kazhdan-Lusztig polynomials can be computed by using another family of polynomials, called the periodic
R-polynomials. In this paper, we prove a (closed) combinatorial formula expressing periodic R-polynomials in
terms of the â€œdoubledâ€ Bruhat graph associated to a ï¬nite Weyl group and a ï¬nite root system.

1. Introduction

In [KL], Kazhdan and Lusztig introduced a family {Py,w(q)}y,wâˆˆW of polynomials, which are called the
Kazhdan-Lusztig polynomials, for an arbitrary Coxeter system (W, S). It is well-known that these polynomials
have important representation-theoretic and geometric meanings. For example, it is known that the Kazhdan-
Lusztig polynomials associated to a ï¬nite Weyl group describe the intersection cohomology of Schubert varieties.
More precisely, let G be a complex semisimple algebraic group, B a Borel subgroup of G, and W the associated
(ï¬nite) Weyl group. Then the ï¬‚ag variety X = G/B admits a decomposition (Bruhat decomposition)

X = GwâˆˆW

BwB/B.

For each w, let Xw denote the closure (with respect to the Zariski topology) of Cw := BwB/B in X; the Xwâ€™s
are called the Schubert varieties. Then the Kazhdan-Lusztig polynomial Py,w(q) for y, w âˆˆ W is identical to
the PoincarÂ´e polynomial

dim IH2i

Cy (Xw) qi;

Xiâ‰¥0

here, IH2i(Xw) denotes the 2i-th intersection cohomology sheaf on Xw, and IH2i
Cy (Xw) is its stalk at a point
of Cy. This equation also shows that the Kazhdan-Lusztig polynomials associated to an arbitrary ï¬nite Weyl
group have no negative coeï¬ƒcients.

About the representation-theoretic side, we know that the Kazhdan-Lusztig polynomials describe the mul-
tiplicities of Verma modules in simple modules. Namely, let g be a ï¬nite-dimensional complex semisimple Lie
algebra, W its (ï¬nite) Weyl group, P the weight lattice of g, and P+ the set of dominant integral weights. It
is known that each ï¬nite-dimensional simple g-module is isomorphic to the unique simple quotient L(Âµ) of the
Verma module V (Âµ) for some Âµ âˆˆ P . Kazhdan and Lusztig conjectured that for Î» âˆˆ P+ and w âˆˆ W , there
holds the equality

chL(w â—¦ Î») = XyâˆˆW

(âˆ’1)â„“(y,w)Py,w(1) chM (y â—¦ Î»),

where â„“ : W â†’ Zâ‰¥0 denotes the length function on W , â„“(y, w) := â„“(w) âˆ’ â„“(y), and W acts on P by the
so-called dot (or shifted) action. This conjecture was proved independently by Beilinson-Bernstein [BeBe] and
Brylinski-Kashiwara [BK].

In the proof of the existence of the Kazhdan-Lusztig polynomials, another family of polynomials {Ry,w(q)}y,wâˆˆW ,

which we call the R-polynomials, play a key role. The Kazhdan-Lusztig polynomials and the R-polynomials are

2010 Mathematics Subject Classiï¬cation. Primary 20F55; Secondary 20C08, 05E10, 05E15.
Key words and phrases. periodic Kazhdan-Lusztig polynomials, periodic R-polynomials, generic Bruhat order.

1

2

H. WATANABE AND S. NAITO

related by the following equation:

(1)

qâ„“(y,w)P y,w(q) âˆ’ Py,w(q) = Ry,w(q) + Xy<z<w

Ry,z(q)Pz,w(q) for y, w âˆˆ W.

Here, < denotes the Bruhat order on W , and f (q) = f (qâˆ’1) for f (q) âˆˆ Z[q, qâˆ’1]. Therefore, determining the
Kazhdan-Lusztig polynomials is equivalent to determining the R-polynomials. As for the R-polynomials, Dyer
proved the following combinatorial formula (in the notation of [BjBr, Chap. 5]).

Theorem 1.0.1 ([D, (3.4) Corollary], [BjBr, Theorem 5.3.4.]). Let < be a refection order on the set Î¦+ of
positive roots of an arbitrary ï¬nite Weyl group W . For y, w âˆˆ W , let B<(y, w) be the set of all sequences âˆ† =
(y, ysÎ²1, ysÎ²1sÎ²2, . . . , ysÎ²1sÎ²2 Â· Â· Â· sÎ²â„“(âˆ†) = w) of elements of W such that y < ysÎ²1 < . . . < ysÎ²1 Â· Â· Â· ysÎ²â„“(âˆ†) = w
and Î²1 < Â· Â· Â· < Î²â„“(âˆ†), where for Î² âˆˆ Î¦+, sÎ² denotes the reï¬‚ection with respect to Î² âˆˆ Î¦+. Then, we have

Ry,w(q) = Xâˆ†âˆˆB<(y,w)

q

1

2(cid:0)â„“(y,w)âˆ’â„“(âˆ†)(cid:1)(q âˆ’ 1)â„“(âˆ†).

Remark 1.0.2. Dyer proved Theorem 1.0.1 in a more general setting of an arbitrary Coxeter group.

Also, in [L], Lusztig introduced a family {Qy,w(q)}y,wâˆˆWaf of polynomials; here, Waf is the aï¬ƒne Weyl group.
We call the Qy,w(q)â€™s the periodic Kazhdan-Lusztig polynomials. These polynomials are also conjectured to
have some representation-theoretic meaning. Let G be a reductive group over a ï¬eld of characteristic p â‰« h,
where h denotes the Coxeter number for the associated root system. By ï¬xing a maximal torus of G, we denote
its character group by X, and set

X+ := {Î» âˆˆ X | Î»(Î±âˆ¨) â‰¥ 0 for all simple coroots Î±âˆ¨} (the set of dominant weights),
X0 := {Î» âˆˆ X | 0 < Î»(Î±âˆ¨) < p for all simple coroots Î±âˆ¨}.

Then, Lusztigâ€™s conjecture is the following:

Conjecture 1.0.3. Let w âˆˆ Waf , and let Î» âˆˆ X+ be such that w â—¦ Î» âˆˆ X0. Then,

chL(w â—¦ Î») = XxâˆˆWaf

xâ—¦Î»âˆˆX0

(âˆ’1)â„“(x,w)Px,w(1) chV (x â—¦ Î»),

where V (x â—¦ Î») denotes the Weyl module of G with simple head L(x â—¦ Î»).

In addition, it is proved in [K] that Lusztigâ€™s conjecture is equivalent to the equality:

chL(w â—¦ Î») = XxâˆˆWaf

Qx,w(1) chV (x â—¦ Î»).

There is another conjecture concerning periodic Kazhdan-Lusztig polynomials, called the Feigin-Frenkel
conjecture. Let gaf be an aï¬ƒne Kac-Moody algebra, haf its Cartan subalgebra, and Waf the associated aï¬ƒne
Weyl group. For each Î» âˆˆ hâˆ—
af , let âˆ†(Î») denote the Verma module with highest weight Î» over gaf . Then, the
restricted Verma module âˆ†(Î») is deï¬ned to be the quotient module of âˆ†(Î») by a certain ideal of the Feigin-
Frenkel center (see [AF, Â§1.4] for details). Also, let L(Î») denote the irreducible quotient of âˆ†(Î»). Now, the
Feigin-Frenkel conjecture is the following:

Conjecture 1.0.4. Let Î» âˆˆ hâˆ—
element of gaf and Ï âˆˆ hâˆ—
dominant in the sense of [AF, Â§1.5]. Then,

af be a weight at the critical level, i.e., Î»(K) = âˆ’Ï(K), where K is the central
af is regular and

af is the Weyl vector, and let y, w âˆˆ Waf . We also assume that Î» âˆˆ hâˆ—

where [âˆ†(w â—¦ Î») : L(y â—¦ Î»)] denotes the Jordan-HÂ¨older multiplicity of L(y â—¦ Î») in âˆ†(w â—¦ Î»).

When one considers the periodic Kazhdan-Lusztig polynomials, the role of the R-polynomials is replaced by

[âˆ†(w â—¦ Î») : L(y â—¦ Î»)] = Qy,w(1),

the periodic R-polynomials {Ry,w(q)}y,wâˆˆWaf . Namely, Lusztig ([L, (7.3.1)]) proved that for y, w âˆˆ Waf ,

(2)

qâ„“

2 (y,w)Qy,w(q) âˆ’ Qy,w(q) = (âˆ’q)â„“

âˆ

âˆ

2 (y,w)Ry,w(q) + Xy< âˆ

2

z< âˆ
2

âˆ

(âˆ’q)â„“

2 (y,z)Ry,z(q)Qz,w(q);

w

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

3

âˆ

âˆ

âˆ

âˆ

2 denotes the semi-inï¬nite length, â„“

here, â„“
the semi-inï¬nite Bruhat order
(deï¬ned later). Roughly speaking, arguments in the periodic case are parallel to those in the ordinary case if
one replaces the ordinary length and Bruhat order by the semi-inï¬nite length and semi-inï¬nite Bruhat order,
respectively. From this point of view, equation (2) seems to be diï¬€erent from the equation obtained from
equation (1) by replacing P , R, â„“, and < by Q, R, â„“
, respectively. However, these two actually
agree because

2 (y), and < âˆ

2 (y, w) := â„“

2 , and < âˆ

2 (w) âˆ’ â„“

âˆ

2

2

Ry,w(q) = (âˆ’q)â„“(y,w)Ry,w(q).

for y, w âˆˆ Waf (see, for example, [BjBr, Chap. 5, Exerc. 1]).

The periodic R-polynomials can also be thought of as a generalization of the ordinary R-polynomials in the

following sense: if y, w âˆˆ W (and if we regard the ï¬nite Weyl group W as a subgroup of Waf ), then

Ry,w(q) = Ry,w(q).

Hence the periodic Kazhdan-Lusztig polynomials can be regarded as a generalization of the ordinary Kazhdan-
Lusztig polynomials in the following sense: if y, w âˆˆ W , then

Qy,w(q) = Py,w(q).

The purpose of this paper is to give a (closed) combinatorial formula expressing periodic R-polynomials,
which generalizes Theorem 1.0.1 in the following sense: if one applies our formula to elements of a ï¬nite Weyl
group, then it agrees with the one in Theorem 1.0.1. Namely, we prove the following theorem:

Theorem 1.0.5. Let y, w âˆˆ Waf . Then we have

Ry,w(q) = Xâˆ†âˆˆP <(y,w)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†);

here, P <(y, w) consists of sequences âˆ† = (y = y0 âˆ’â†’
Î²1

y1 âˆ’â†’
Î²2

Â· Â· Â· âˆ’âˆ’âˆ’â†’
Î²â„“(âˆ†)

yâ„“(âˆ†) = w) such that y = y0 < âˆ

2

Â· Â· Â· < âˆ

2

yâ„“(âˆ†) = w, Î²1 < Â· Â· Â· < Î²â„“(âˆ†), and some additional conditions (see Deï¬nition 2.4.2 for details).

If y, w âˆˆ W , then P <(y, w) agrees with B<(y, w) (in Theorem 1.0.1), and for each âˆ† âˆˆ P <(y, w) = B<(y, w),
we obtain deg(âˆ†) = 1
2 (â„“(y, w)âˆ’â„“(âˆ†)). We prove Theorem 1.0.5 by constructing explicit bijections between (spe-
ciï¬c subsets of) P <(y, w), y, w âˆˆ Waf . In particular, we construct explicit bijections B<(sy, sw) âŠ” B<(sy, w) â†’
B<(y, w) for all y, w âˆˆ W, s âˆˆ S such that y < sy, sw < w, and bijections B<(sy, sw) â†’ B<(y, w) for all
y, w âˆˆ W, s âˆˆ S such that sy < y, sw < w, where S denotes the set of simple reï¬‚ections for W . We remark
that this also gives a new proof of Theorem 1.0.1.

This paper is organized as follows. In Section 2, we ï¬x our notation and recall the notions and basic properties
of aï¬ƒne root systems, reï¬‚ection orders, semi-inï¬nite Bruhat order, R-polynomials, and periodic R-polynomials.
Also, we state our main result (Theorem 2.4.4). Section 3 is devoted to the preparation for the proof of
Theorem 2.4.4. In Section 4, we complete the proof of Theorem 2.4.4. In Section 5, we introduce a directed
graph, which we call the double Bruhat graph, in order to describe Theorem 2.4.4 in a way more suitable for
actual computation.

In this section, we ï¬x our notation and state our main result (Theorem 2.4.4).

2. Setting and the main result

2.1. Aï¬ƒne root systems and aï¬ƒne Weyl groups. Let g be a ï¬nite-dimensional, complex simple Lie algebra
of rank l, and h a Cartan subalgebra of g. We denote by Î¦ âŠ‚ hâˆ— the set of roots of g with respect to h, by
Î  = {Î±1, . . . , Î±l} a set of simple roots, by Î¦+ the set of positive roots with respect to Î , and by {Î±âˆ¨
l } âŠ‚ h
the set of simple coroots. Also, we denote by h , i : hâˆ— Ã— h â†’ C the duality pairing. For each Î± âˆˆ Î¦, let Î±âˆ¨ âˆˆ h
i , and let P âˆ¨ = {Âµ âˆˆ
+ = {Âµ âˆˆ P âˆ¨ | hÎ±i, Âµi â‰¥ 0 for all i = 1, . . . , l}

denote the coroot of Î±. Let Qâˆ¨ =Pl

h | hÎ±i, Âµi âˆˆ Z for all i = 1, . . . , l} be the coweight lattice, with P âˆ¨
the set of dominant coweights.

i be the coroot lattice, with Qâˆ¨

+ =Pl

i=1 Zâ‰¥0Î±âˆ¨

1 , . . . , Î±âˆ¨

i=1 ZÎ±âˆ¨

4

H. WATANABE AND S. NAITO

Let W denote the (ï¬nite) Weyl group of g, with S = {s1, . . . , sl} the set of simple reï¬‚ections. Then W and

Qâˆ¨ act on h on the left: for each i = 1, . . . , l, Î» âˆˆ Qâˆ¨, and Âµ âˆˆ h,

si Â· Âµ = Âµ âˆ’ hÎ±i, ÂµiÎ±âˆ¨
i ,

tÎ» Â· Âµ = Âµ + Î»,

where tÎ» is the image of Î» âˆˆ Qâˆ¨ in the group Aut(h) of all aï¬ƒne transformations on h. Since these actions are
faithful, we can regard W and Qâˆ¨ as subgroups of Aut(h). Also, let Î¸ âˆˆ Î¦+ denote the highest root, and set
s0 = sÎ¸tâˆ’Î¸âˆ¨ âˆˆ Aut(h), where sÎ¸ is the reï¬‚ection with respect to Î¸. Then, Saf := {s0, s1, . . . , sl} generate the
aï¬ƒne Weyl group Waf â‰ƒ W â‹‰ Qâˆ¨.

Now, let gaf := g âŠ— C[t, tâˆ’1] âŠ• CK âŠ• CD be the aï¬ƒne Lie algebra associated to g, where K is the canonical

central element; the corresponding Cartan subagebra is

haf := h âŠ• CK âŠ• CD.

We extend the duality pairing h , i : hâˆ— Ã— h â†’ C to the duality pairing h , i : hâˆ—
hhâˆ—, CK âŠ• CDi = 0. Let Î´ âˆˆ hâˆ—

af be the element deï¬ned by

af Ã— haf â†’ C in such a way that

hÎ´, h âŠ• CKi = 0,
hÎ´, Di = 1.

af,+ of positive real roots of gaf can be written as Î¦re

Then, the set Î¦re
mÎ´ | Î± âˆˆ Î¦+, m âˆˆ Z>0}, and the set Î¦re
is {Î±0, Î±1, . . . , Î±l}, where Î±0 = âˆ’Î¸ + Î´. For each Î² âˆˆ Î¦re

af of real roots is Î¦re

af ,+ âŠ” (âˆ’Î¦re

af,+ = {Î± + mÎ´ | Î± âˆˆ Î¦+, m âˆˆ Zâ‰¥0} âŠ” {âˆ’Î± +
af,+). Also, the set of simple roots of gaf

af , let Î²âˆ¨ âˆˆ haf denote the coroot of Î².

For each Î± âˆˆ Î¦+ and m âˆˆ Z, let FÎ±,m âŠ‚ hR := R âŠ—Z Qâˆ¨ be the hyperplane deï¬ned by

FÎ±,m = {Âµ âˆˆ hR | hÎ±, Âµi = m}.

With this notation, the reï¬‚ection sÎ² âˆˆ Waf corresponding to a positive real root Î² = Â±Î± + mÎ´ âˆˆ Î¦re

reï¬‚ection ï¬xing the hyperplane FÎ±,Â±m pointwise. An alcove is a connected component of hR\(SÎ±âˆˆÎ¦+,mâˆˆZ FÎ±,m).

The set Aâˆ’ := {Î» âˆˆ hR | âˆ’1 < hÎ±, Î»i < 0 for all Î± âˆˆ Î¦+} is an alcove. It is known that the action of Waf
on hâˆ— deï¬ned above induces a transitive and faithful action of Waf on the set of alcoves, that is, the map
w := cl(w)twt(w) 7â†’ Aâˆ’ Â· w := cl(w)âˆ’1Aâˆ’ + wt(w) is a bijection between Waf and the set of alcoves, where
cl(w) âˆˆ W, wt(w) âˆˆ Qâˆ¨. Through this bijection, we sometimes identify these two sets.

af,+ is the

For i = 1, . . . , l (resp., i = 0), the i-wall of Aâˆ’ is deï¬ned to be the intersection of the hyperplane FÎ±i,0 (resp.,
FÎ¸,âˆ’1) and the closure Aâˆ’ of Aâˆ’. The i-wall of an alcove A is the unique element of the orbit of the i-wall of
Aâˆ’ under the action of Waf that is contained in the closure A of A.

2.2. The semi-inï¬nite Bruhat order. The ï¬nite Weyl group W and the aï¬ƒne Weyl group Waf are equipped
with a partial order <, which is known as the Bruhat order. Following [L], we introduce another partial order
on Waf , which we call the semi-inï¬nite Bruhat order. First, for each Î± âˆˆ Î¦+ and m âˆˆ Z, we divide hR into
< âˆ
2
three parts:

hR = F âˆ’

Î±,m âŠ” FÎ±,m âŠ” F +

Î±,m,

where F Â±
Î±,m = {Âµ âˆˆ hR | Â±(hÎ±, Âµi âˆ’ m) > 0}. Next, to each pair (A, B) of alcoves, we associate an integer
d(A, B) âˆˆ Z as follows. Let (A = A0, A1, . . . , Ar = B) be a sequence of alcoves such that Aiâˆ’1 and Ai have
a unique common wall for each i; there exists a unique Î²i âˆˆ Î¦+ and mi âˆˆ Z such that FÎ²i,mi contains the
common wall. Then we deï¬ne d(A, B) by:

d(Aiâˆ’1, Ai),

d(A, B) =

rXi=1
d(Aiâˆ’1, Ai) =(1

âˆ’1

if Ai âŠ‚ F +
if Ai âŠ‚ F âˆ’

Î²i,mi

Î²i,mi

(or equivalently, Aiâˆ’1 âŠ‚ F âˆ’
(or equivalently, Aiâˆ’1 âŠ‚ F +

Î²i,mi

Î²i,mi

),
).

For y, w âˆˆ Waf , we set â„“
simply write â„“
2 (e, w) = â„“
â„“

2 (w) âˆ’ â„“

2 (y).

âˆ

âˆ

âˆ

âˆ

2 (y, w) := d(Aâˆ’ Â· y, Aâˆ’ Â· w).
2 (w) and call it the semi-infnite length of w. By deï¬nition, we have â„“

In particular, when y is the identity element e, we
2 (y, w) =

âˆ

âˆ

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

5

Example 2.2.1. In type A2:

tÎ±âˆ¨
2

tÎ¸âˆ¨

s1s2 w0

s2

s2s1

e

s1

tÎ±âˆ¨
1

s0

2

4

2

3

1

2

0

1

2

âˆ’1

Figure 1. alcoves and elements of Waf

Figure 2. semi-inï¬nite lengths

Finally, we deï¬ne the partial order < âˆ
2

on Waf as follows:

for y, w âˆˆ Waf , we write y < âˆ

2

w if there
af,+ and

exists a sequence (y = y0, y1, . . . , yr = w) of elements of Waf such that yi = yiâˆ’1sÎ²i for some Î²i âˆˆ Î¦re
â„“

w, then â„“

2 (y) < â„“

2 (w).

âˆ

âˆ

âˆ

2 (yiâˆ’1, yi) > 0 for each 1 â‰¤ i â‰¤ r. Note that if y < âˆ
Let C+ denote the dominant Weyl chamber:

2

C+ = {Âµ âˆˆ hR | hÎ±i, Âµi > 0 for all i = 1, . . . , l}.

About the semi-inï¬nite Bruhat order and the semi-inï¬nite length, we know the following.

Proposition 2.2.2 ([P, Lecture 13]).

(1) Let w = cl(w)twt(w) âˆˆ Waf (cl(w) âˆˆ W, wt(w) âˆˆ Qâˆ¨). Then

â„“

âˆ

2 (w) = â„“(cl(w)) + 2hÏ, wt(w)i, where Ï is half the sum of positive roots of g.

(2) Let y, w âˆˆ Waf . Then y < âˆ

2

C+.

w if and only if ytÎ» < wtÎ» for some Î» âˆˆ Qâˆ¨

+ such that Aâˆ’ Â· ytÎ», Aâˆ’ Â· wtÎ» âŠ‚

Lemma 2.2.3 ([P, Lecture 13, Proposition 1]). Let w âˆˆ Waf and Âµ âˆˆ Qâˆ¨

+. Then we have

w < âˆ
2

wtÂµ.

Proof. It suï¬ƒces to show the assertion when Âµ is a simple coroot, that is, when Âµ = Î±âˆ¨
i
We write w = cl(w)twt(w). Assume ï¬rst that cl(w) < cl(w)si. Then, we have

for some i = 1, . . . , l.

cl(w)sitwt(w) = cl(w)tsi (wt(w))si = cl(w)twt(w)âˆ’hÎ±i,wt(w)iÎ±âˆ¨

si
= cl(w)twt(w)sithÎ±i,wt(w)iÎ±âˆ¨

i

i

= wsÎ±i+hÎ±i,wt(w)iÎ´,

and

â„“

âˆ

2 (cl(w)sitwt(W )) = â„“(cl(w)si) + 2hÏ, wt(w)i = â„“(cl(w)) + 1 + 2hÏ, wt(w)i = â„“

âˆ

2 (w) + 1.

Therefore, we obtain w < âˆ

2

cl(w)sitwt(w). Furthermore, we have

wtÎ±âˆ¨

i

= cl(w)sisitwt(w)+Î±âˆ¨

i

= cl(w)sitwt(w)sit(hÎ±i,wt(w)i+1)Î±âˆ¨

i

= cl(w)sitwt(w)sÎ±i+(hÎ±i,wt(w)i+1)Î´,

and

â„“

âˆ

2 (wtÎ±âˆ¨

i

) = â„“(cl(w)) + 2hÏ, wt(w) + Î±âˆ¨

i i = â„“(cl(w)) + 2hÏ, wt(w)i + 2

= â„“

âˆ

2 (w) + 2 = â„“

âˆ

2 (cl(w)sitwt(w)) + 1.

From these, we deduce that cl(w)sitwt(w) < âˆ

2

wtÎ±âˆ¨

i

, and hence

w < âˆ

2

wtÎ±âˆ¨

i

.

Also, we obtain cl(w)sitwt(w) < âˆ
implies the assertion when cl(w)si < cl(w). This proves the lemma.

cl(w)sitwt(w)+Î±âˆ¨

, since wtÎ±âˆ¨

2

i

i

= cl(w)twt(w)+Î±âˆ¨

i

< âˆ

2

cl(w)sitwt(w)+Î±âˆ¨

i

. This
(cid:3)

6

H. WATANABE AND S. NAITO

Lemma 2.2.4 ([P, Lecture 13, Proposition 2]). Let w = cl(w)twt(w) âˆˆ Waf , and Î² = Î± + mÎ´ âˆˆ Î¦re
â„“

2 (sÎ²w) if and only if cl(w)âˆ’1(Î±) âˆˆ Î¦+.

2 (w) < â„“

âˆ

âˆ

af ,+. Then,

Proof. By direct calculation, we see that

sÎ²w = cl(w)scl(w)âˆ’1(Î²)twt(w)

= cl(w)scl(w)âˆ’1(Î±)twt(w)+mcl(w)âˆ’1(Î±âˆ¨).

Hence it follows that

âˆ

2 (sÎ²w) âˆ’ â„“

â„“

âˆ

2 (w) = â„“(cl(w)scl(w)âˆ’1(Î±)) + 2hÏ, Î»(w) + mcl(w)âˆ’1(Î±âˆ¨)i âˆ’ (â„“(cl(w)) + 2hÏ, wt(w)i)

= â„“(cl(w)scl(w)âˆ’1(Î±)) âˆ’ â„“(cl(w)) + 2mhÏ, cl(w)âˆ’1(Î±âˆ¨)i.

We ï¬rst prove the â€œonly ifâ€ part. Assume that â„“

âˆ

2 (w) < â„“

âˆ

2 (sÎ²w) and cl(w)âˆ’1(Î±) âˆˆ âˆ’Î¦+. Then â„“(scl(w)âˆ’1(Î±)) â‰¤

âˆ’2hÏ, cl(w)âˆ’1(Î±âˆ¨)i âˆ’ 1, and

0 < â„“

âˆ

2 (sÎ²w) âˆ’ â„“

âˆ

2 (w) = â„“(cl(w)scl(w)âˆ’1(Î±)) âˆ’ â„“(cl(w)) + 2mhÏ, cl(w)âˆ’1(Î±âˆ¨)i

â‰¤ â„“(cl(w)) + â„“(scl(w)âˆ’1(Î±)) âˆ’ â„“(cl(w)) + 2mhÏ, cl(w)âˆ’1(Î±âˆ¨)i
â‰¤ âˆ’2hÏ, cl(w)âˆ’1(Î±âˆ¨)i âˆ’ 1 + 2mhÏ, cl(w)âˆ’1(Î±âˆ¨)i
< 2(m âˆ’ 1)hÏ, cl(w)âˆ’1(Î±âˆ¨)i.

This implies that m = 0 since hÏ, cl(w)âˆ’1(Î±âˆ¨)i < 0. Therefore, Î± = Î² âˆˆ Î¦re
follows that

af ,+, and hence Î± âˆˆ Î¦+. Hence it

âˆ

2 (sÎ²w) âˆ’ â„“

â„“

âˆ

2 (w) = â„“(sÎ±cl(w)) âˆ’ â„“(cl(w)) < 0

(since Î± âˆˆ Î¦+ and cl(w)âˆ’1(Î±) âˆˆ Î¦+),

which is a contradiction.

Next we prove the â€œifâ€ part. Assume that cl(w)âˆ’1(Î±) âˆˆ Î¦+. From the above, we have

âˆ

2 (sÎ²w) âˆ’ â„“

â„“

âˆ

2 (w) = â„“(cl(w)scl(w)âˆ’1(Î±)) âˆ’ â„“(cl(w)) + 2mhÏ, cl(w)âˆ’1(Î±âˆ¨)i;

note that hÏ, cl(w)âˆ’1(Î±âˆ¨)i > 0. If Î± âˆˆ Î¦+, then cl(w)scl(w)âˆ’1(Î±) = sÎ±cl(w) > cl(w), and hence â„“
â„“

2 (w) > 0. If Î± âˆˆ âˆ’Î¦+, then m > 0 and hence

âˆ

âˆ

2 (sÎ²w) âˆ’

âˆ

2 (sÎ²w) âˆ’ â„“

â„“

âˆ

2 (w) = â„“(cl(w)scl(w)âˆ’1(Î±)) âˆ’ â„“(cl(w)) + 2mhÏ, cl(w)âˆ’1(Î±âˆ¨)i

â‰¥ â„“(cl(w)) âˆ’ â„“(scl(w)âˆ’1(Î±)) âˆ’ â„“(cl(w)) + 2mhÏ, cl(w)âˆ’1(Î±âˆ¨)i
â‰¥ âˆ’2hÏ, cl(w)âˆ’1(Î±âˆ¨)i + 1 + 2mhÏ, cl(w)âˆ’1(Î±âˆ¨)i
= 2(m âˆ’ 1)hÏ, cl(w)âˆ’1(Î±âˆ¨)i + 1 > 0,

as desired. This proves the lemma.

(cid:3)

2.3. R-polynomials and periodic R-polynomials. Let H be the Hecke algebra of W , and Haf the Hecke
algebra of Waf , that is, H (resp., Haf ) is the associative algebra over Z[q, qâˆ’1] generated by {Ts | s âˆˆ S} (resp.,
{Ts | s âˆˆ Saf}) subject to the braid relations and the Hecke relation

T 2
s = q + (q âˆ’ 1)Ts for s âˆˆ S (resp., s âˆˆ Saf ).

), where si1 Â· Â· Â· sik is a
For each x âˆˆ W (resp., w âˆˆ Waf ), we set Tx = Tsi1
reduced expression for x (resp., w). Let Â¯ : H â†’ H (resp., Â¯ : Haf â†’ Haf ) denote the involutive Z-algebra
automorphism that sends q to qâˆ’1 and Ts to T âˆ’1
Deï¬nition 2.3.1. Let u, v âˆˆ W . Then, the R-polynomial Ru,v(q) âˆˆ Z[q, qâˆ’1] is deï¬ned by

s = qâˆ’1Ts + (qâˆ’1 âˆ’ 1).

(resp., Tw = Tsi1

Â· Â· Â· Tsik

Â· Â· Â· Tsik

T v = qâˆ’â„“(v) XuâˆˆW

(âˆ’1)â„“(u,v)Ru,v(q)Tu.

It follows from the next proposition that Ru,v(q) is, in fact, an element of Z[q] of degree â„“(u, v).

Proposition 2.3.2 ([BjBr, 5.3], [H2, 7.5]). The R-polynomials are uniquely determined by the following equa-
tions.

(1) Rv,v(q) = 1 for all v âˆˆ W .

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

7

(2) Ru,v(q) = 0 unless u â‰¤ v (u, v âˆˆ W ).

(3) Ru,v(q) =(Rsu,sv(q)

qRsu,sv(q) + (q âˆ’ 1)Ru,sv(q)

for all u, v âˆˆ W and all s âˆˆ S.

Also, equation (3) can be replaced by

(3â€²) Ru,v(q) =(Rut,vt(q)

qRut,vt(q) + (q âˆ’ 1)Ru,vt(q)

if sv < v and su < u,
if sv < v and u < su,

if vt < v and ut < u,
if vt < v and u < ut,

for all u, v âˆˆ W and all t âˆˆ S.

Now, following [K] (see also [L]), we deï¬ne the periodic R-polynomials. For each Î» âˆˆ Qâˆ¨, there exists

Âµ âˆˆ Qâˆ¨ âˆ© P âˆ¨

+ such that Î» + Âµ âˆˆ Qâˆ¨ âˆ© P âˆ¨

+ . Then we set

it is known that this deï¬nition of X Î» is independent of the choice of Âµ. Also, for each w = cl(w)twt(w)
(cl(w) âˆˆ W, wt(w) âˆˆ Qâˆ¨), we set

X Î» := TtÎ»+ÂµT âˆ’1

tÂµ âˆˆ Haf ;

eTw := Tcl(w)X wt(w).

Then, {eTw | w âˆˆ Waf } forms a basis of Haf . With respect to this basis, we enlarge Haf as follows. We set

dHaf :=( XwâˆˆWaf

aweTw | {w âˆˆ Waf | aw 6= 0} is bounded from above) ,

where a subset Y âŠ‚ Waf is said to be bounded from above if there exists w âˆˆ Waf such that y < âˆ

w for all

such that

y âˆˆ Y ; note that dHaf is no longer an algebra, but is still a left Haf -module.
Theorem 2.3.3 ([K, Proposition 2.8]). There exists a unique involutive Z-linear automorphism Î¨ :dHaf â†’dHaf
(h âˆˆ Haf , m âˆˆdHaf ),
2 (w0tÎ») XxâˆˆW eTxtÎ»

Î¨(cid:16)XxâˆˆW eTxtÎ»(cid:17) = qâˆ’â„“

Î¨(h Â· m) = h Â· Î¨(m)

(Î» âˆˆ Qâˆ¨).

Here, w0 âˆˆ W denotes the longest element.

and

âˆ

2

Deï¬nition 2.3.4. Let y, w âˆˆ Waf . Then the periodic R-polynomial Ry,w(q) is deï¬ned by

Î¨(eTw) = qâˆ’â„“

âˆ

2 (w) XyâˆˆWaf

(âˆ’1)â„“

âˆ

2 (y,w)Ry,w(q)eTy.

It follows from the next proposition that Ry,w(q) is, in fact, an element of Z[q] of degree â„“

âˆ

2 (y, w).

Proposition 2.3.5 ([L, Proposition 11.1]). The periodic R-polynomials are uniquely determined by the following
equations.

(R1) Rw,w(q) = 1 for all w âˆˆ Waf .
(R2) Ry,w(q) = 0 unless y < âˆ

(R3) Ry,w(q) =(Rsy,sw(q)

for all y, w âˆˆ Waf and all s âˆˆ Saf .

(R4)

qRsy,sw(q) + (q âˆ’ 1)Ry,sw(q)

w (y, w âˆˆ Waf ).

2

if sw < âˆ
if sw < âˆ

2

2

w and sy < âˆ
w and y < âˆ

2

y,
sy,

2

âˆ

(âˆ’1)â„“

2 (y,xtÎ»)qâ„“(xw0)Ry,xtÎ»(q) = Î´Î»,Î»(y)

for all Î» âˆˆ Qâˆ¨, y âˆˆ Waf .

XxâˆˆW

8

H. WATANABE AND S. NAITO

Remark 2.3.6. Equation (R4) is equivalent to the second equation in Theorem 2.3.3:

Î¨(cid:16)XxâˆˆW eTxtÎ»(cid:17) = qâˆ’â„“

âˆ

2 (w0tÎ») XxâˆˆW eTxtÎ»

(Î» âˆˆ Qâˆ¨).

2.4. Main result. In this subsection, we recall the notion of reï¬‚ection orders and state our main result of this
paper.

Deï¬nition 2.4.1. A total order < on Î¦+ (resp., Î¦re

af,+) is called a reï¬‚ection order if it satisï¬es the following:

if a, b âˆˆ R>0, Î±, Î², aÎ± + bÎ² âˆˆ Î¦+ (resp., Î¦re

af ,+) and Î± < Î², then Î± < aÎ± + bÎ² < Î².

In the following, we take and ï¬x a reï¬‚ection order < on Î¦+.

Deï¬nition 2.4.2. Let y = cl(y)twt(y), w = cl(w)twt(w) âˆˆ Waf , and Î² âˆˆ Î¦+.

(1) We write y mâˆ’â†’

2

w if either w = ytmÎ²âˆ¨ for some m âˆˆ Z>0, or w = cl(y)sÎ²twt(y)+mÎ²âˆ¨ for some m âˆˆ Zâ‰¥0

Î²
and y < âˆ
w. In the former case, y and w diï¬€er only by a translation, and in the latter case, w is
obtained from y by multiplying the reï¬‚ection sÎ²+(m+hÎ²,wt(y)i)Î´ on the right, where Î² + (m + hÎ², wt(Î»)i)Î´
is a (not necessarily positive) real root; we call an arrow y mâˆ’â†’
w of the former type a translation edge,
and one of the latter type a reï¬‚ection edge. To each edge y mâˆ’â†’

w, we assign an integer d(y mâˆ’â†’

w) as

Î²

Î²

Î²

follows:

d(y mâˆ’â†’

Î²

w) =ï£±ï£´ï£²ï£´ï£³

1
2 â„“
1

2(cid:0)â„“
2(cid:0)â„“

1

âˆ

2 (y, w) + m

âˆ

âˆ

2 (y, w) + 1(cid:1) + m
2 (y, w) âˆ’ 1(cid:1) + m

m1âˆ’âˆ’â†’
Î²1

m2âˆ’âˆ’â†’
Î²2

Â· Â· Â· mkâˆ’âˆ’â†’
Î²k

if w = ytmÎ²âˆ¨,
if w = cl(y)sÎ²twt(y)+mÎ²âˆ¨ and cl(y) < cl(y)sÎ²,
if w = cl(y)sÎ²twt(y)+mÎ²âˆ¨ and cl(y)sÎ² < cl(y).

(2) A label-increasing path of length k from y to w with respect to the reï¬‚ection order < is a sequence
yk = w) of elements of Waf and arrows such that Î²1 < Â· Â· Â· < Î²k; we

âˆ† = (y = y0

y1

simply call this a path from y to w. The length k of a path âˆ† is denoted by â„“(âˆ†). Also, we denote by
P <(y, w) the set of all paths from y to w.

Let âˆ† = (y = y0

m1âˆ’âˆ’â†’
Î²1

y1

m2âˆ’âˆ’â†’
Î²2

Â· Â· Â· mkâˆ’âˆ’â†’
Î²k

yk = w) âˆˆ P <(y, w). We set

e(âˆ†) := {Î²j | j = 1, . . . , k},
r(âˆ†) := {Î²j |

is a reï¬‚ection edge},

t(âˆ†) := {Î²j |

is a translation edge}, and

Î²j

mjâˆ’âˆ’â†’
mjâˆ’âˆ’â†’

Î²j

T (âˆ†) := (mÎ²)Î²âˆˆÎ¦+ , which is ordered in the (ï¬xed) reï¬‚ection order <, where mÎ² is mj if Î² = Î²j, and
is zero otherwise.

Also, we deï¬ne the degree of âˆ† to be the integer:

deg(âˆ†) =

â„“(âˆ†)Xj=1

d(yjâˆ’1

mjâˆ’âˆ’â†’

Î²j

yj) âˆ’ â„“(âˆ†).

Remark 2.4.3. Since â„“

indeed an integer.

âˆ

2 (y, w) is even (resp., odd) if w = ytmÎ²âˆ¨ (resp., w = cl(y)sÎ²twt(y)+mÎ²âˆ¨), d(y mâˆ’â†’

Î²

w) is

Now we are ready to state our main result of this paper.

Theorem 2.4.4. Let y, w âˆˆ Waf . Then we have

Ry,w(q) = Xâˆ†âˆˆP <(y,w)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†).

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

9

Example 2.4.5. In type A2, let y = e, w = w0tÎ±âˆ¨
are as follows:

1 +Î±âˆ¨
2

, Î±1 < Î±1 + Î±2 < Î±2. Then, the elements of P <(y, w)

âˆ†1 = (e

1âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2

w0tÎ±âˆ¨

1 +Î±âˆ¨
2

),

âˆ†2 = (e 0âˆ’â†’
Î±1
âˆ†3 = (e 1âˆ’â†’
Î±1
âˆ†4 = (e 1âˆ’â†’
Î±1

s1

tÎ±âˆ¨

1

1âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2
0âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2
0âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2

1

s1tÎ±âˆ¨

s2s1tÎ±âˆ¨

1 +Î±âˆ¨
2

0âˆ’â†’
Î±2

w0tÎ±âˆ¨

1 +Î±âˆ¨
2

),

w0tÎ±âˆ¨

1

1âˆ’â†’
Î±2

w0tÎ±âˆ¨

1 +Î±âˆ¨
2

),

s2s1tÎ±âˆ¨

1

1âˆ’â†’
Î±2

w0tÎ±âˆ¨

1 +Î±âˆ¨
2

).

In this case, we have

r(âˆ†1) = {Î±1 + Î±2},
r(âˆ†2) = Î¦+,
r(âˆ†3) = {Î±1 + Î±2},
r(âˆ†4) = Î¦+,

t(âˆ†1) = âˆ…,
T (âˆ†1) = (0, 1, 0), deg(âˆ†1) = 4,
t(âˆ†2) = âˆ…,
T (âˆ†2) = (0, 1, 0), deg(âˆ†2) = 3,
t(âˆ†3) = {Î±1, Î±2}, T (âˆ†3) = (1, 0, 1), deg(âˆ†3) = 3,
t(âˆ†4) = âˆ…,
T (âˆ†4) = (1, 0, 1), deg(âˆ†4) = 4,

â„“(âˆ†1) = 1,
â„“(âˆ†2) = 3,
â„“(âˆ†3) = 3,
â„“(âˆ†4) = 3.

Therefore, we have

Re,w0tÎ±âˆ¨

1

+Î±âˆ¨
2

(q) = q4(q âˆ’ 1) + 2q3(q âˆ’ 1)3 + q4(q âˆ’ 1)3.

3. Bijections between sets of paths

3.1. Deï¬nitions. We take and ï¬x a reï¬‚ection order < on the set Î¦+ of positive roots of g. For y, w âˆˆ Waf , let
r (y, w) denote the subset of P <(y, w) that consists of all those âˆ† âˆˆ P <(y, w) having no translation edges; in
P <
v (u, v âˆˆ Waf , Î² âˆˆ Î¦+) appearing in âˆ† âˆˆ P <(y, w), we often drop the label
the following, from an edge u
m.

mâˆ’â†’

Î²

Deï¬nition 3.1.1. Let u, v âˆˆ Waf , s âˆˆ Saf , and let âˆ† = (u = u0 âˆ’â†’
Î²1

u1 âˆ’â†’
Î²2

Â· Â· Â· âˆ’â†’
Î²k

uk = v) âˆˆ P <

r (u, v).

(1) The s-descent set of âˆ† is deï¬ned to be

Ds(âˆ†) := {i âˆˆ {1, 2, . . . , k} | sui = uiâˆ’1}.

(2) The number dâˆ† (resp., dâˆ†) is deï¬ned to be the minimum (resp., maximum) element of Ds(âˆ†). If the

s-descent set is empty, then we set dâˆ† = k + 1 and dâˆ† = 0.
0 (u, v) denote the subset {âˆ† âˆˆ P <
r (u, v) | Ds(âˆ†) 6= âˆ…} of P <

r (u, v). Now, we deï¬ne a map Î¨L : P <

r (u, v) | Ds(âˆ†) = âˆ…} of P <

Let P <
{âˆ† âˆˆ P <

Î¨L(âˆ†) = (su = su0 âˆ’â†’
Î²1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’â†’
Î²dâˆ†âˆ’1

sudâˆ†âˆ’1 = udâˆ† âˆ’âˆ’âˆ’âˆ’â†’
Î²dâˆ†+1

Â· Â· Â· âˆ’â†’
Î²k

Also, we deï¬ne a map Î¨R : P <

+ (u, v) â†’ P <

r (u, sv) by:

r (u, v), and let P <

+ (u, v) denote the subset

+ (u, v) â†’ P <

r (su, v) by
uk = v).

Î¨L(âˆ†) = (u = u0 âˆ’â†’
Î²1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’â†’
Î²dâˆ†âˆ’1

udâˆ†âˆ’1 = sudâˆ† âˆ’âˆ’âˆ’âˆ’â†’
Î²dâˆ†+1

Â· Â· Â· âˆ’â†’
Î²k

suk = sv).

r (su, v) for all âˆ† âˆˆ P <

+ (u, v), and that Î¨R(âˆ†) âˆˆ P <

Î²

v is a reï¬‚ection edge, with v 6= su, we have su < âˆ

+ (u, v). For this, it suï¬ƒces to show that for u < âˆ

r (u, sv)
v âˆˆ Waf , s âˆˆ Saf , Î² âˆˆ Î¦+ such that
sv. This is shown as follows. Let Î± be the simple

Remark 3.1.2. We need to check that Î¨L(âˆ†) âˆˆ P <
for all âˆ† âˆˆ P <
u mâˆ’â†’
root corresponding to the simple reï¬‚ection s. Since u mâˆ’â†’
v is a reï¬‚ection edge, we have v = usÎ² â€², where
af,+ âˆ© {Â±u(Î²â€²)},
Î²â€² = Î² + mâ€²Î´ for some mâ€² âˆˆ Z; note that v = usÎ² â€² = su(Î² â€²)u. Let Î³â€² be the unique element of Î¦re
and write it as Î³â€² = Î³ + nÎ´ for some n âˆˆ Zâ‰¥0. Then, by Proposition 2.2.4, we have (cl(u))âˆ’1(Î³) âˆˆ Î¦+.
Also, we have sv = su = ssÎ³ â€²u = ss(Î³ â€²)u, and s(Î³â€²) = s(Î³) + nÎ´.
af,+ and
(scl(u))âˆ’1(s(Î³)) = (cl(u))âˆ’1(Î³) âˆˆ Î¦+. Hence it follows from Proposition 2.2.4 that su < âˆ
sv. If s(Î³) âˆˆ âˆ’Î¦+,
then Î³ = Î± and n 6= 0 since Î³â€²
af,+. Hence it follows from the same
calculation as above that su < âˆ

6= Î±. Therefore, we obtain s(Î³â€²) âˆˆ Î¦re
sv.

If s(Î³) âˆˆ Î¦+, then s(Î³â€²) âˆˆ Î¦re

Î²

2

2

2

2

10

H. WATANABE AND S. NAITO

3.2. Some properties of paths. By the proof of [BjBr, Proposition 5.2.1] (in which we order {Î±0} âŠ” Î  so that
Î±0 is the smallest), we can show that there exists a reï¬‚ection order on Î¦re
af,+ that extends the ï¬xed reï¬‚ection
order < on Î¦+; in what follows we take such a one and denote it by the same symbol. For three positive real
roots Î±, Î², Î³ âˆˆ Î¦re

af,+, we say that Î± is between Î² and Î³ if either Î² < Î± < Î³ or Î³ < Î± < Î² holds.

For each Î² âˆˆ Î¦re

af , we set

Now we deï¬ne two maps cl : Î¦re

|Î²| :=(Î²

âˆ’Î²
af,+ â†’ Î¦ and cl+ : Î¦re

if Î² âˆˆ Î¦re
otherwise.

af,+,

af â†’ Î¦+ by
cl(Î± + mÎ´) = Î±,

cl+(Î± + mÎ´) = |Î±|.

Lemma 3.2.1. Let u, v âˆˆ Waf , s âˆˆ Saf , and Î² âˆˆ Î¦re
simple root corresponding to the simple reï¬‚ection s.

af ,+ be such that v = usÎ², and su < âˆ

2

u. Let Î± denote the

(1) If sv < âˆ

2

v, then exactly one of the following holds:
(a) cl+(uâˆ’1(Î±)) is between cl+(vâˆ’1(Î±)) and cl+(Î²);
(b) cl+(vâˆ’1(Î±)) is between cl+(uâˆ’1(Î±)) and cl+(Î²);
(c) cl+(uâˆ’1(Î±)) = cl+(vâˆ’1(Î±)) 6= cl+(Î²).

(2) If v < âˆ
2

sv, then exactly one of the following holds:
(d) cl+(Î²) is between cl+(uâˆ’1(Î±)) and cl+(vâˆ’1(Î±));
(e) cl+(uâˆ’1(Î±)) = cl+(vâˆ’1(Î±)) = cl+(Î²).

Proof. (1) Take Î» âˆˆ Qâˆ¨

+ such that utÎ», vtÎ», sutÎ», svtÎ» âŠ‚ C+, and set z := utÎ», x := vtÎ». Then we have

sz < z,

sx < x, and x = zsÎ² â€² for some Î²â€² âˆˆ Î¦re

af,+, with cl(Î²â€²) = cl+(Î²).

The ï¬rst two conditions imply that zâˆ’1(Î±), xâˆ’1(Î±) âˆˆ âˆ’Î¦re
cl(âˆ’xâˆ’1(Î±)) = cl+(vâˆ’1(Î±)). Also, we have

af,+; note that cl(âˆ’zâˆ’1(Î±)) = cl+(uâˆ’1(Î±)) and

âˆ’zâˆ’1(Î±) = âˆ’sÎ² â€²xâˆ’1(Î±) = âˆ’xâˆ’1(Î±) âˆ’ hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨iÎ²â€².

If hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨i < 0, then

âˆ’zâˆ’1(Î±) = âˆ’xâˆ’1(Î±) + (âˆ’hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨i)Î²â€².

Applying the map cl to this equation, we obtain

cl+(uâˆ’1(Î±)) = cl+(vâˆ’1(Î±)) + (âˆ’hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨i)cl+(Î²).

If cl+(vâˆ’1(Î±)) = cl+(Î²), then cl+(uâˆ’1(Î±)) must be cl+(vâˆ’1(Î±)). However, this contradicts that hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨i 6=
0. Hence cl+(vâˆ’1(Î±)) 6= cl+(Î²). It follows from the deï¬nition of reï¬‚ection orders that cl+(uâˆ’1(Î±)) is between
cl+(vâˆ’1(Î±)) and cl+(Î²). Thus, assertion (a) holds.

If hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨i > 0, then by a similar argument, assertion (b) holds.
If hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨i = 0, then cl+(uâˆ’1(Î±)) = cl+(vâˆ’1(Î±)). If, in addition, cl+(uâˆ’1(Î±)) = cl+(Î²), then

0 < hcl+(uâˆ’1(Î±)), cl+(Î²)i = hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨i = 0,

which is a contradiction. Hence assertion (c) holds.

(2) We use the same notation as in the proof of (1).

cl+(vâˆ’1(Î±)). Then we have

In this case, xâˆ’1(Î±) âˆˆ Î¦re

af ,+ and cl(xâˆ’1(Î±)) =

âˆ’zâˆ’1(Î±) + xâˆ’1(Î±) = âˆ’hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨iÎ²â€².

Since the left-hand side is a sum of positive real roots, we deduce that a := âˆ’hâˆ’xâˆ’1(Î±), (Î²â€²)âˆ¨i > 0. Therefore,

Applying the map cl to this equation, we obtain

cl+(Î²) = aâˆ’1cl+(uâˆ’1(Î±)) + aâˆ’1cl+(vâˆ’1(Î±)).

Î²â€² = aâˆ’1(âˆ’zâˆ’1(Î±)) + aâˆ’1xâˆ’1(Î±).

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

11

If cl+(uâˆ’1(Î±)) 6= cl+(vâˆ’1(Î±)), then by the deï¬nition of reï¬‚ection orders, cl+(Î²) is between cl+(uâˆ’1(Î±)) and
cl+(vâˆ’1(Î±)). This proves the lemma.
(cid:3)

In order to make arguments below easier to follow, we introduce some notation.

Deï¬nition 3.2.2. Let u, v âˆˆ Waf , s âˆˆ Saf , and Î² âˆˆ Î¦+.

(1) We write u sâˆ’â†’

Î²

v,

v

, or u

to indicate that u âˆ’â†’
Î²

v and v = su.

s Î²

s Î²

u

v

(2) We write

v

to indicate that v = su and either u âˆ’â†’
Î²

v or v âˆ’â†’
Î²

u holds.

s Î²

u
(3) We write v

to indicate that v = u.

u

For example, the assumption of Lemma 3.2.1 (2) is written as:

u

cl+(Î²)

v

s cl+(uâˆ’1(Î±))

s cl+(vâˆ’1(Î±))

su

cl+(Î²)

sv.

Until the end of this subsection, we assume the following: y < âˆ
2

ui, vi âˆˆ Waf (i âˆˆ Zâ‰¥0). For each i âˆˆ Zâ‰¥0, we deï¬ne Î¶i and Î¾i by

w âˆˆ Waf , s âˆˆ Saf , y < âˆ

2

sy, sw < âˆ
2

w, and

i
where Î± is the simple root corresponding to the simple reï¬‚ection s.

i

Î¶i = cl+(uâˆ’1

(Î±)),

Î¾i = cl+(vâˆ’1

(Î±)),

Lemma 3.2.3.

(1) Let âˆ† = (sy = u0 âˆ’â†’
Î²1

Â· Â· Â· âˆ’â†’
Î²k

uk = w) âˆˆ P <

r (sy, w). Then there exists l âˆˆ

{0, 1, . . . , dâˆ† âˆ’ 1} such that sul < âˆ
if l = k.

2

ul and Î²l < Î¶l < Î²l+1, where Î¶0 < Î²1 if l = 0, and Î²k < Î¶k

(2) Let âˆ† = (y = v0 âˆ’â†’
Î³1

Â· Â· Â· âˆ’â†’
Î³k

vk = sw) âˆˆ P <

r (y, sw). Then there exists r âˆˆ {dâˆ†, dâˆ† + 1, . . . , k} such that

vr < âˆ

2

svr and Î³r < Î¾r < Î³r+1, where Î¾0 < Î³1 if r = 0, and Î³k < Î¾k if r = k.

Proof. We prove part (1); the proof of part (2) is similar. Assume ï¬rst that Ds(âˆ†) 6= âˆ…. What we need to do
is to ï¬nd l for which the following diagram is commutative:

sy

u0

/ u1

/ Â· Â· Â·

/ ul

Î²l

Î²2

Î²1

/ Â· Â· Â·

Î²l+1

s

s Î¶0

s Î¶1

s Î¶l

y

su0

/ su1

/ Â· Â· Â·

/ sul

Î²l

Î²l+1

/ Â· Â· Â·

Î²2

Î²1

s

Î²d

/ udâˆ†

/ udâˆ†âˆ’1

Î²dâˆ†âˆ’1

s Î¶dâˆ†âˆ’1

âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†
âœ†

/ sudâˆ†âˆ’1,

Î²dâˆ†âˆ’1

with Î²l < Î¶l < Î²l+1. If Î¶0 < Î²1, then there is nothing to prove. Assume now that Î²1 â‰¤ Î¶0.

u1. By Lemma 3.2.1 (1), we have Î²1 < Î¶0 < Î¶1, Î²1 < Î¶1 < Î¶0, or Î¶0 = Î¶1 6= Î²1. In each

su1. By Lemma 3.2.1 (2), we have Î¶1 < Î²1 < Î¶0, or Î²1 = Î¶0 = Î¶1. In each case, we

2

Case 1: su1 < âˆ
case, we obtain Î²1 < Î¶1.
Case 2: u1 < âˆ
obtain Î¶1 < Î²2.

2

O
O



O
O
/
/
/
/
/


/
O
O
O
O
/
/
/
O
O
/
/
12

H. WATANABE AND S. NAITO

Case 2-1: su2 < âˆ
Case 2-2: u2 < âˆ
each case, we obtain Î¶2 < Î²2, and hence Î¶2 < Î²3.

u2. By Lemma 3.2.1 (2), we have Î¶1 < Î²2 < Î¶2.
su2. By Lemma 3.2.1 (1), we have Î¶2 < Î¶1 < Î²2, Î¶1 < Î¶2 < Î²2, or Î¶1 = Î¶2 6= Î²2. In

2

2

If we cannot ï¬nd a required l, then by applying the above argument repeatedly, we have either

with Î²dâˆ†âˆ’1 < Î¶dâˆ†âˆ’2, or

udâˆ†âˆ’2

/ udâˆ†âˆ’1

Î²dâˆ†âˆ’1

s Î¶dâˆ†âˆ’2

s Î¶dâˆ†âˆ’1=Î²dâˆ†

sudâˆ†âˆ’2

/ sudâˆ†âˆ’1,

Î²dâˆ†âˆ’1

udâˆ†âˆ’2

udâˆ†âˆ’1

Î²dâˆ†âˆ’1

s Î¶dâˆ†âˆ’2

s Î¶dâˆ†âˆ’1=Î²dâˆ†

sudâˆ†âˆ’2

/ sudâˆ†âˆ’1,

Î²dâˆ†âˆ’1

with Î¶dâˆ†âˆ’2 < Î²dâˆ†âˆ’1. In the former case, by Lemma 3.2.1 (2), we see that Î¶dâˆ†âˆ’1 < Î²dâˆ†âˆ’1 < Î¶dâˆ†âˆ’2. Since
Î¶dâˆ†âˆ’1 = Î²dâˆ† , this contradicts the assumption that Î²dâˆ†âˆ’1 < Î²dâˆ† . In the latter case, by Lemma 3.2.1 (1), we
see that Î¶dâˆ†âˆ’1 < Î¶dâˆ†âˆ’2 < Î²dâˆ†âˆ’1, Î¶dâˆ†âˆ’2 < Î¶dâˆ†âˆ’1 < Î²dâˆ†âˆ’1, or Î¶dâˆ†âˆ’2 = Î¶dâˆ†âˆ’1. In each case, we deduce that
Î²dâˆ† = Î¶dâˆ†âˆ’1 < Î²dâˆ†âˆ’1, which is impossible since Î²dâˆ†âˆ’1 < Î²dâˆ†.

Next, we assume that Ds(âˆ†) = âˆ…. If we cannot ï¬nd a required l among {0, 1, . . . , k âˆ’ 1}, then by the same

argument as above, we have

with Î²k < Î¶kâˆ’1, or

ukâˆ’1

Î²k

/ uk

s Î¶kâˆ’1

s Î¶k

sukâˆ’1

ukâˆ’1

/ suk,

uk

Î²k

Î²k

s Î¶kâˆ’1

s Î¶k

sukâˆ’1

Î²k

/ suk,

with Î¶kâˆ’1 < Î²k. By Lemma 3.2.1, in each case we deduce that Î²k < Î¶k. Therefore, l = k = dâˆ† âˆ’ 1 is a required
one. This proves the lemma.
(cid:3)

Remark 3.2.4. Under the assumption of Lemma 3.2.3 (1), we take an arbitrary l for which the assertion of
the lemma holds, and consider the path

ul

/ Â· Â· Â·

Î²l+1

/ udâˆ†âˆ’1

Î²dâˆ†âˆ’1

s
Î²dâˆ†

/ udâˆ† Î²dâˆ†+1

/ Â· Â· Â·

/ uk = w.

Î²k

s Î¶l

y = su0

/ su1

/ Â· Â· Â·

/ sul

Î²l

Î²2

Î²1

Clearly, this path is an element of Î¨âˆ’1
ul and Î²l < Î¶l < Î²l+1 to the set Î¨âˆ’1
a bijection from the set of l âˆˆ {0, 1, . . . , dâˆ† âˆ’ 1} such that sul < âˆ
Similarly, by Lemma 3.2.3 (2), we obtain a bijection from the set of r âˆˆ {dâˆ†, dâˆ† + 1, . . . , k} such that vr < âˆ
and Î³r < Î¾r < Î³r+1 to the set Î¨âˆ’1

+ (y, w) â†’ P <(sy, w). Moreover, this procedure gives
L (âˆ†).
svr

L (âˆ†), where Î¨L : P <

2

R (âˆ†).

2

/


O
O
/
/
/




/
/
O
O
/
O
O
/
/


/
O
O
/
/
/
/
/
/
/
/
O
O
A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

Lemma 3.2.5. If we are given (ul1 âˆ’âˆ’âˆ’â†’
Î²l1+1

ul1+1 âˆ’âˆ’âˆ’â†’
Î²l1+2

Â· Â· Â· âˆ’âˆ’â†’
Î²l2

ul2) âˆˆ P <

0 (ul1, ul2) such that sul1 < âˆ

2

13

ul1 ,

sul2 < âˆ
Î²d < Î¶d < Î²d+1.

2

ul2 , Î¶l1 < Î²l1+1, and Î²l2 < Î¶l2 , then we can ï¬nd d âˆˆ {l1 + 1, . . . , l2 âˆ’ 1} such that ud < âˆ

sud and

2

Proof. We want to ï¬nd d for which the following diagram is commutative:

ul1 Î²l1+1

/ Â· Â· Â·

/ ud

Î²d

Î²d+1

Â· Â· Â·

Î²l2

/ ul2

s Î¶l1

s Î¶d

s

Î¶l2

sul1

Î²l1+1

/ Â· Â· Â·

/ sud

Î²d

Î²d+1

/ Â· Â· Â·

/ sul2,

Î²l2

with Î²d < Î¶d < Î²d+1. First, we prove that there exists dâ€² such that udâ€² < âˆ
have (by Lemma 3.2.1 (1)) Î¶l1+1 < Î²l1+1(< Î²l1+2), and inductively

2

sudâ€². If this does not hold, then we

Î¶l1+2 < Î²l1+2 < Î²l1+3,
Î¶l1+3 < Î²l1+3 < Î²l1+4,

...
Î¶l2 < Î²l2 .

However, the last inequality contradicts the assumption. Now, we proceed by induction on l2 âˆ’ l1. If l2 âˆ’ l1 = 2,
then we obtain the commutative diagram:

ul1

/ ul1+1

Î²l1+1

Î²l1+2

/ ul1+2

s Î¶l1

s Î¶l1 +1

s

Î¶l1+2

sul1

/ suli+1

Î²l1+1

Î²l1+2

/ sul1+2.

Note that by Lemma 3.2.1 (2), we have Î¶l1 < Î²l1+1 < Î¶l1+1 < Î²l1+2 < Î¶l1+2. Therefore, d := l1 + 1 is a
required one. When l2 âˆ’ l1 > 2, take the minimum index dâ€² such that udâ€² < âˆ
sudâ€²; it is easy to show (by using
Lemma 3.2.1) that Î²dâ€² < Î¶dâ€². If Î¶dâ€² < Î²dâ€²+1, then d := dâ€² is a required one. If not, take the minimum index
lâ€² âˆˆ {dâ€² + 1, . . . , l2} such that sulâ€² < âˆ
ulâ€² . Then, by using Lemma 3.2.1 again, we deduce that either Î¶lâ€² < Î²lâ€² ,
or there exists dâ€²â€² âˆˆ {dâ€² + 1, . . . , lâ€² âˆ’ 1} such that udâ€²â€² < âˆ
sudâ€²â€² and Î²dâ€²â€² < Î¶dâ€²â€² < Î²dâ€²â€²+1. Here, in the former
case, we obtain lâ€² 6= l2, and hence we can complete the proof by our induction hypothesis.
(cid:3)

2

2

2

Proposition 3.2.6. Let âˆ† âˆˆ P <

+ (y, w). Then the following hold.

(1) (cid:12)(cid:12)Î¨âˆ’1
(2) (cid:12)(cid:12)Î¨âˆ’1

L (âˆ†)(cid:12)(cid:12) =(cid:12)(cid:12){âˆ†â€² âˆˆ Î¨âˆ’1
R (âˆ†)(cid:12)(cid:12) =(cid:12)(cid:12)(cid:12){âˆ†â€² âˆˆ Î¨âˆ’1

R (Î¨R(âˆ†)) | dâˆ†â€²

L (Î¨L(âˆ†)) | dâˆ†â€² < dâˆ†}(cid:12)(cid:12).
> dâˆ†}(cid:12)(cid:12)(cid:12).

Proof. We prove part (1); the proof of part (2) is similar. Let us write

Î¨L(âˆ†) = (sy = u0 âˆ’â†’
Î²1

u1 âˆ’â†’
Î²2

Â· Â· Â· âˆ’â†’
Î²k

uk = w),

and {âˆ†â€² âˆˆ Î¨âˆ’1
L (Î¨L(âˆ†)) | dâˆ†â€² â‰¤ dâˆ†} = {âˆ†1, . . . , âˆ†p}, with dâˆ†1 < Â· Â· Â· < dâˆ†p . Observe that if Î¨L(âˆ†â€²) = Î¨L(âˆ†â€²â€²)
and dâˆ†â€² = dâˆ†â€²â€², then âˆ†â€² = âˆ†â€²â€². It follows from Remark 3.2.4 that âˆ†p = âˆ†. Also, from Lemma 3.2.3 (1) and
Remark 3.2.4, we have

sudâˆ†i âˆ’1 < âˆ

2

udâˆ†i âˆ’1 and Î²dâˆ†i âˆ’1 < Î¶dâˆ†i âˆ’1 < Î²dâˆ†i

/
/
/
/


/
O
O
/
/
/
/
O
O
/


/
O
O
/
/
O
O
14

H. WATANABE AND S. NAITO

for all i = 1, . . . , p. Let i â‰¥ 2. Then the path

(udâˆ†iâˆ’1 âˆ’1 âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Î²dâˆ†iâˆ’1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’âˆ’â†’

Î²dâˆ†i

âˆ’1

udâˆ†i âˆ’1)

satisï¬es the assumption of Lemma 3.2.5. Therefore, there exists di âˆˆ {dâˆ†iâˆ’1, . . . , dâˆ†i âˆ’2} for which the following
diagram is commutative:

Â· Â· Â·

Â· Â· Â·

/ udâˆ†iâˆ’1 âˆ’1

Î²dâˆ†iâˆ’1

âˆ’1

Î²dâˆ†iâˆ’1

/ Â· Â· Â·

/ udi

Î²di+1

/ Â· Â· Â·

/ udâˆ†i âˆ’1

âˆ’1

Î²dâˆ†i

Î²dâˆ†i

/ Â· Â· Â·

/ udâˆ†p âˆ’1

âˆ’1

Î²dâˆ†p

Î²dâˆ†p

Î²di

/ Â· Â· Â·

s Î¶dâˆ†iâˆ’1

âˆ’1

s Î¶di

s Î¶dâˆ†i

âˆ’1

s Î¶dâˆ†p

âˆ’1

/ sudâˆ†iâˆ’1 âˆ’1

Î²dâˆ†iâˆ’1

âˆ’1

Î²dâˆ†iâˆ’1

/ Â· Â· Â·

/ sudi Î²di+1

/ Â· Â· Â·

Î²di

/ sudâˆ†i âˆ’1

âˆ’1

Î²dâˆ†i

Î²dâˆ†i

/ Â· Â· Â·

/ sudâˆ†p âˆ’1

âˆ’1

Î²dâˆ†p

Î²dâˆ†p

/ Â· Â· Â· ,

with Î²di < Î¶di < Î²di+1. If we set

âˆ†â€²

i := (sy = u0 âˆ’â†’
Î²1

Â· Â· Â· âˆ’âˆ’â†’
Î²di

sudi âˆ’âˆ’âˆ’âˆ’â†’
Î²di+1

Â· Â· Â·

udi

sâˆ’âˆ’â†’
Î¶di
sâˆ’âˆ’âˆ’âˆ’âˆ’â†’
Î¶dâˆ†p

âˆ’1

âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Î²dâˆ†p

âˆ’1

sudâˆ†p âˆ’1

udâˆ†p âˆ’1 âˆ’âˆ’âˆ’â†’
Î²dâˆ†p

Â· Â· Â· âˆ’â†’
Î²k

uk = w) âˆˆ P <(sy, w),

then we have âˆ†â€²
sudâ€²
that udâ€²
Â· Â· Â· âˆ’âˆ’â†’
(sudâ€²
Î²di

< âˆ
2
âˆ’âˆ’âˆ’âˆ’â†’
Î²dâ€²
i

+1

i

i

i

i âˆˆ Î¨âˆ’1

L (âˆ†p) = Î¨âˆ’1

and Î²dâ€²

i

< Î¶dâ€²

i

L (âˆ†), with dâˆ†â€²
< Î²dâ€²

i

i+1, then we may assume that dâ€²

= di + 1. If there exists another dâ€²

i âˆˆ {dâˆ†iâˆ’1, . . . , dâˆ†i âˆ’ 2} such
i < di. By applying Lemma 3.2.5 to the path
i + 1 < dâˆ†â€² < di + 1 < dâˆ†i â‰¤ dâˆ†p .

sudi), we obtain âˆ†â€² âˆˆ Î¨âˆ’1

L (Î¨L(âˆ†)) such that dâˆ†iâˆ’1 < dâ€²

However, this is impossible because âˆ†â€² âˆˆ {âˆ†â€² âˆˆ Î¨âˆ’1
This proves the proposition.

L (Î¨L(âˆ†)) | dâˆ†â€² â‰¤ dâˆ†} = {âˆ†1, . . . , âˆ†p} and dâˆ†1 < Â· Â· Â· < dâˆ†p .
(cid:3)

3.3. Bijections. Recall that we have assumed that y < âˆ
2
ui, vi âˆˆ Waf (i âˆˆ Zâ‰¥0). Also, for each i âˆˆ Zâ‰¥0, Î¶i and Î¾i are deï¬ned by
Î¾i = cl+(vâˆ’1

Î¶i = cl+(uâˆ’1

(Î±)),

i

(Î±)),

i

w âˆˆ Waf , s âˆˆ Saf , y < âˆ

sy, sw < âˆ
2

w, and

2

where Î± is the simple root corresponding to the simple reï¬‚ection s.
P <

r (sy, w) â†’ P <

r (sy, sw) âŠ” P <

r (y, w). If âˆ† = (sy = u0 âˆ’â†’
Î²1

u1 âˆ’â†’
Î²2

Â· Â· Â· âˆ’â†’
Î²k

In the following, we deï¬ne a map Ï• :
0 (sy, sw), then we

uk = sw) âˆˆ P <

deï¬ne

Ï•(âˆ†) := (y = su0 âˆ’â†’
Î²1

su1 âˆ’â†’
Î²2

Â· Â· Â· âˆ’â†’
Î²k

suk = w);

note that â„“(Ï•(âˆ†)) = â„“(âˆ†).

Let âˆ† = (sy = u0 âˆ’â†’
Î²1

u1 âˆ’â†’
Î²2

Â· Â· Â· âˆ’â†’
Î²k

uk = w) âˆˆ P <

r (sy, w). By Remark 3.2.4, the set Î¨âˆ’1
L (âˆ†) such that dÏ•(âˆ†) < dâˆ†â€² for all âˆ†â€² âˆˆ Î¨âˆ’1

We deï¬ne Ï•(âˆ†) to be the unique element of Î¨âˆ’1
L (âˆ†) \ {Ï•(âˆ†)}; this
Ï•(âˆ†) is realized by taking the smallest l for which the assertion of Lemma 3.2.3 (1) holds. Note that in this
case, we have â„“(Ï•(âˆ†)) = â„“(âˆ†) + 1.
v1 âˆ’â†’
Î³2

+ (sy, sw). Let us write Ds(âˆ†) = {d1, . . . , dm}, with

Let âˆ† = (sy = v0 âˆ’â†’
Î³1

vk = sw) âˆˆ P <

Â· Â· Â· âˆ’â†’
Î³k

L (âˆ†) is not empty.

d1 < Â· Â· Â· < dm. For each i = 1, . . . , m, we have

vdiâˆ’1

svdi

Î³di+1

svdi+1 Î³di+2

/ Â· Â· Â· Î³di+1âˆ’1

/ svdi+1âˆ’1

vdi+1

s Î³di

s Î³di

s Î¾di +1

s Î³di+1

s Î³di+1

svdiâˆ’1

vdi

Î³di+1

/ vdi+1 Î³di+2

Â· Â· Â· Î³di+1âˆ’1

/ vdi+1âˆ’1

svdi+1,

/
/
/


/
/
/
/
/
/
O
O
/
/
/
/
O
O
/
/
O
O
/


/
/


/
/
/
/
/
/
O
O
O
O
A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

15

where dm+1 = k + 1 and vk+1 = w. By applying Lemma 3.2.3 (2) to the path (svdi

vdi+1âˆ’1), we can take the smallest ri âˆˆ {di + 1, di + 2, . . . , di+1 âˆ’ 1} such that vri < âˆ
Then, we have

2

vdi âˆ’âˆ’âˆ’â†’
Î³di+1

sâˆ’âˆ’â†’
Â· Â· Â· âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Î³di
Î³di+1âˆ’1
svri and Î³ri < Î¾ri < Î³ri+1.

âˆ†i := (vdi âˆ’âˆ’âˆ’â†’
Î³di+1

Â· Â· Â· âˆ’âˆ’â†’
Î³ri

vri

sâˆ’âˆ’â†’
Î¾ri

svri âˆ’âˆ’âˆ’â†’
Î³ri+1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Î³di+1âˆ’1

svdi+1âˆ’1 = vdi+1) âˆˆ P <

r (vdi , vdi+1).

Also, we set âˆ†0 := (y = sv0 âˆ’â†’
Î³1

sv1 âˆ’â†’
Î³2

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’â†’
Î³d1âˆ’1

svd1âˆ’1 = vd1) âˆˆ P <

0 (y, vd1). Now we deï¬ne Ï•(âˆ†) to be the

concatenation of the paths âˆ†0, âˆ†1, . . . , âˆ†m. Namely, we deï¬ne Ï•(âˆ†) = (y = u0 âˆ’â†’
Î²1

u1 âˆ’â†’
Î²2

Â· Â· Â· âˆ’â†’
Î²k

uk = w), as

follows:

(3)

(4)

uj =ï£±ï£´ï£²ï£´ï£³
Î²j =ï£±ï£´ï£´ï£´ï£²ï£´ï£´ï£´ï£³

svj
vj+1
svj

Î³j
Î³j+1
Î³j
Î¾ri

(j = 0, 1, . . . , d1 âˆ’ 1),
(j = di, di + 1, . . . , ri âˆ’ 1, and i = 1, . . . , m),
(j = ri, ri + 1, . . . , di+1 âˆ’ 1, and i = 1, . . . , m),

(j = 1, . . . , d1 âˆ’ 1),
(j = di, di + 1, . . . , ri âˆ’ 1, and i = 1, . . . , m),
(j = ri + 1, . . . , di+1 âˆ’ 1, and i = 1, . . . , m),
(j = ri, and i = 1, . . . , m).

Note that in this case, we have â„“(Ï•(âˆ†)) = â„“(âˆ†).

Proposition 3.3.1. The map Ï• : P <

r (sy, sw) âŠ” P <

r (sy, w) â†’ P <

Proof. We prove the assertion by constructing a map Ï•â€² : P <
to be the inverse of Ï•. Let âˆ†â€² = (y = u0 âˆ’â†’
Î²1

Â· Â· Â· âˆ’â†’
Î²k

uk = w) âˆˆ P <

r (y, w) â†’ P <

r (y, w) is a bijection.
r (sy, sw) âŠ” P <
r (y, w). If âˆ†â€² âˆˆ P <

r (sy, w), which turns out
0 (y, w), then âˆ†â€² = Ï•(âˆ†),

where

âˆ† := (sy = su0 âˆ’â†’
Î²1

su1 âˆ’â†’
Î²2

Â· Â· Â· âˆ’â†’
Î²k

suk = sw) âˆˆ P <

0 (sy, sw).

Hence we deï¬ne Ï•â€²(âˆ†â€²) := âˆ†.

Assume that âˆ†â€² âˆˆ P <

+ (y, w).

If the set Î¨âˆ’1

L (âˆ†â€²) is empty, then by Proposition 3.2.6, dâˆ†â€² â‰¤ dâˆ†â€²â€² for all

âˆ†â€²â€² âˆˆ Î¨âˆ’1

L (Î¨L(âˆ†â€²)). Therefore, by the deï¬nition of Ï•, we have
âˆ†â€² = Ï•(Î¨L(âˆ†â€²)).

Hence we deï¬ne Ï•â€²(âˆ†â€²) := Î¨L(âˆ†â€²).

Next, assume that âˆ†â€² âˆˆ P <

m}, with
1 < Â· Â· Â· < dâ€²
dâ€²
1 âˆ’ 2} such
that sul1 < ul1 and Î²l1 < Î¶l1 < Î²l1+1 (see Remark 3.2.3). For each i = 1, . . . , m âˆ’ 1, we have the following
commutative diagram:

L (âˆ†â€²) is not empty, we can take the maximum index l1 âˆˆ {1, . . . , dâ€²

L (âˆ†â€²) is not empty. Let us write Ds(âˆ†â€²) = {dâ€²

m. Since Î¨âˆ’1

+ (y, w) and Î¨âˆ’1

1, . . . , dâ€²

udâ€²

iâˆ’1

sudâ€²

i Î²dâ€²
i

sudâ€²

i+1

+1

Î²dâ€²
i

+2

/ Â· Â· Â·

Î²dâ€²

i+1

/ sudâ€²

âˆ’1

i+1âˆ’1

udâ€²

i+1

s Î²dâ€²
i

s Î²dâ€²
i

s Î¶dâ€²
i

+1

s Î²dâ€²

i+1

s Î²dâ€²

i+1

sudâ€²

iâˆ’1

udâ€²

i

/ udâ€²

i+1

Î²dâ€²
i

+1

Î²dâ€²
i

+2

Â· Â· Â·

Î²dâ€²

i+1

/ udâ€²

âˆ’1

i+1âˆ’1

sudâ€²

i+1

.

By applying Lemma 3.2.3 (1) to the path (sudâ€²

iâˆ’1 = udâ€²

i

âˆ’âˆ’âˆ’âˆ’â†’
Î²dâ€²
i

+1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’âˆ’â†’

Î²dâ€²

âˆ’1

i+1

udâ€²

i+1âˆ’1

sâˆ’âˆ’âˆ’âˆ’â†’
Î²dâ€²

i+1

sudâ€²

i+1âˆ’1 = udâ€²

i+1

), we

can take the maximum index li+1 âˆˆ {dâ€²
Then, we have

i, dâ€²

i + 1, . . . , dâ€²

i+1 âˆ’ 2} such that suli+1 < uli+1 and Î²li+1 < Î¶li+1 < Î²li+1+1.

âˆ†â€²

i := (udâ€²

iâˆ’1 = sudâ€²

i

âˆ’âˆ’âˆ’âˆ’â†’
Î²dâ€²
i

+1

Â· Â· Â· âˆ’âˆ’âˆ’â†’

Î²dâ€²
li

suli+1

sâˆ’âˆ’âˆ’â†’
Î¶li+1

uli+1 âˆ’âˆ’âˆ’â†’
Î²li+1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’âˆ’â†’

Î²dâ€²

âˆ’1

i+1

udâ€²

i+1âˆ’1) âˆˆ P <

r (udâ€²

iâˆ’1, udâ€²

i+1âˆ’1).



/
/


/
/
/
/
/
/
O
O
O
O
16

H. WATANABE AND S. NAITO

Also, we set âˆ†â€²

(udâ€²

mâˆ’1 = sudâ€²

0 = (sy = su0 âˆ’â†’
Î²1
Â· Â· Â· âˆ’â†’
Î²k
+ (sy, sw) of the paths âˆ†â€²

m âˆ’âˆ’âˆ’âˆ’â†’
m+1

Î²dâ€²

Â· Â· Â· âˆ’âˆ’â†’
Î²l1

sul1

sâˆ’âˆ’â†’
Î¶l1

suk = sw) âˆˆ P <

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’â†’

ul1 âˆ’âˆ’âˆ’â†’
Î²l1+1
mâˆ’1, sw). We deï¬ne Ï•â€²(âˆ†â€²) to be the concatenation

1âˆ’1) and âˆ†â€²

1âˆ’1) âˆˆ P <

r (sy, udâ€²

m :=

udâ€²

Î²dâ€²
1

âˆ’1

0 (udâ€²

0, âˆ†â€²

1, . . . , âˆ†â€²

m. Namely, we deï¬ne âˆ† = (sy = v0 âˆ’â†’
Î³1

v1 âˆ’â†’
Î³2

Â· Â· Â· âˆ’â†’
Î³k

vk = sw) as

âˆ† âˆˆ P <

follows:

(5)

(6)

vj =ï£±ï£´ï£²ï£´ï£³
Î³j =ï£±ï£´ï£´ï£´ï£²ï£´ï£´ï£´ï£³

suj
ujâˆ’1
suj

Î²j
Î²jâˆ’1
Î²j
Î¶li+1

i + 1, . . . , li+1, and i = 0, 1, . . . , m âˆ’ 1),

i, dâ€²

(j = dâ€²
(j = li+1 + 1, li+1 + 2, . . . , dâ€²
(j = dâ€²

m + 1, . . . , k),

m, dâ€²

i+1 âˆ’ 1, and i = 0, 1, . . . , m âˆ’ 1),

i + 1, . . . , li+1, and i = 0, 1, . . . , m âˆ’ 1),

(j = dâ€²
(j = li+1 + 2, . . . , dâ€²
(j = dâ€²
(j = li+1 + 1, and i = 0, 1, . . . , m âˆ’ 1),

m + 1, . . . , k),

i+1, and i = 0, 1, . . . , m âˆ’ 1),

m, dâ€²

where dâ€²

0 := 0.

1 âˆ’ 2 < dâ€²

We show that Ï•(âˆ†) = âˆ†â€². By the deï¬nition of âˆ†, we have Ds(âˆ†) = {l1 + 1, l2 + 1, . . . , lm + 1}, with
i coincides with the minimum
svri and Î³ri < Î¾ri < Î³ri+1 for all i = 1, . . . , m (here we set

l1 â‰¤ dâ€²
index ri âˆˆ {li + 2, li + 3, . . . , li+1} such that vri < âˆ
lm+1 = k + 1). If this does not hold, then we obtain the following commutative diagram:

m âˆ’ 2. We claim that dâ€²

2 â‰¤ Â· Â· Â· â‰¤ lm â‰¤ dâ€²

1 â‰¤ l2 â‰¤ dâ€²

2 âˆ’ 2 < dâ€²

2

vli

svli+1

Â· Â· Â·

/ svri

/ Â· Â· Â·

/ svdâ€²

i

/ Â· Â· Â·

/ svli+1

vli+1+1

s

s

s Î¾ri

s Î²dâ€²
i

s

s

svli

vli+1

/ Â· Â· Â·

/ vri

Â· Â· Â·

/ vdâ€²

i

Â· Â· Â·

/ vli+1

svli+1+1.

By Lemma 3.2.5, there exists d âˆˆ {ri + 1, . . . , dâ€²
Î¾d(= Î¶dâˆ’1) < Î³d+1Î²d. However, this contradicts the maximality of li. If we write Ï•(âˆ†) = (y = uâ€²
Â· Â· Â· âˆ’â†’ uâ€²
i = 1, . . . , m) and (5).

0 âˆ’â†’ uâ€²
k = w), then it is easy to see that Ï•(âˆ†) = âˆ†â€² by using equations (3) (with di = li + 1, ri = dâ€²

vd = udâˆ’1 and Î²dâˆ’1 = Î³d <
1 âˆ’â†’
i for

i âˆ’ 1} such that sudâˆ’1 = svd < âˆ

2

It remains to show that Ï•â€²(Ï•(âˆ†)) = âˆ† for all âˆ† âˆˆ P <
0 (sy, sw) âŠ”
r (sy, w). When âˆ† âˆˆ P <
P <
+ (sy, sw), we deduce from the deï¬nition of Ï•(âˆ†) (in particular, that of âˆ†0) that
Î¨âˆ’1
L (Ï•(âˆ†)) is not empty. Based on this fact, we can show that Ï•â€²(Ï•(âˆ†)) = âˆ† in a way similar to the above.
This completes the proof of the proposition.
(cid:3)

r (sy, w). It is easy when âˆ† âˆˆ P <

r (sy, sw) âŠ” P <

Now, we deï¬ne a map Ïˆ : P <
r (y, sw). When âˆ† âˆˆ P <
P <

0 (y, sw), we deï¬ne

r (y, sw) â†’ P <

r (sy, w) as follows. Let âˆ† = (y = v0 âˆ’â†’
Î³1

Â· Â· Â· âˆ’â†’
Î³k

vk = sw) âˆˆ

Ïˆ(âˆ†) := (sy = sv0 âˆ’â†’
Î³1

sv1 âˆ’â†’
Î³2

Â· Â· Â· âˆ’â†’
Î³k

svk = w) âˆˆ P <

0 (sy, w).

Assume that âˆ† âˆˆ P <
for each i = 1, . . . , m, we can take the minimum index ri âˆˆ {di + 1, . . . , di+1 âˆ’ 1} such that vri < âˆ
Î³ri < Î¾ri < Î³ri+1; hence we can deï¬ne âˆ†i âˆˆ P <

+ (y, sw). We write Ds(âˆ†) = {d1, . . . , dm}, with d1 < Â· Â· Â· < dm. As in the deï¬nition of Ï•,
svri and

r (vdi, vdi+1) by

2

âˆ†i := (vdi âˆ’âˆ’âˆ’â†’
Î³di+1

Â· Â· Â· âˆ’âˆ’â†’
Î³ri

vri

sâˆ’âˆ’â†’
Î¾ri

svri âˆ’âˆ’âˆ’â†’
Î³ri+1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’âˆ’â†’
Î³di+1âˆ’1

svdi+1âˆ’1 = vdi+1) âˆˆ P <

r (vdi , vdi+1),

where dm+1 = k + 1 and vk+1 = w. Also, we set âˆ†0 := (sy = sv0 âˆ’â†’
Î³1

sv1 âˆ’â†’
Î³2

P <

0 (sy, vd1). We deï¬ne Ïˆ(âˆ†) to be the concatenation of the paths âˆ†0, âˆ†1, . . . , âˆ†m.

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’â†’
Î³d1âˆ’1

svd1âˆ’1 = vd1) âˆˆ



/
/


/
/
/
/
/
/
/
/
/
O
O
/
/
/
O
O
/
O
O
O
O
A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

17

In a way similar to the deï¬nition of Ï•â€² above, we deï¬ne a map Ïˆâ€² : P <

r (sy, w) â†’ P <

r (y, sw). Let âˆ†â€² = (sy =

uk = w) âˆˆ P <

r (sy, w). If âˆ†â€² âˆˆ P <

0 (sy, w), then âˆ†â€² = Ïˆ(âˆ†), where

u0 âˆ’â†’
Î²1

Â· Â· Â· âˆ’â†’
Î²k

(7)

âˆ† := (y = su0 âˆ’â†’
Î²1

Â· Â· Â· âˆ’â†’
Î²k

suk = sw) âˆˆ P <

0 (y, sw).

Hence we deï¬ne Ïˆâ€²(âˆ†â€²) := âˆ†.

Assume that âˆ†â€² âˆˆ P <

+ (sy, w). By Lemma 3.2.3 and Remark 3.2.4, Î¨âˆ’1

L (âˆ†â€²) is not empty. Let us write
m. For each i = 0, 1, . . . , m âˆ’ 1, we have the following

Ds(âˆ†â€²) = {dâ€²
1, . . . , dâ€²
commutative diagram:

m}, with 0 = dâ€²

0 < dâ€²

1 < Â· Â· Â· dâ€²

udâ€²

iâˆ’1

sudâ€²

i Î²dâ€²
i

+1

sudâ€²

i+1 Î³dâ€²

/ Â· Â· Â·

+2

Î²dâ€²

i+1

i

/ sudâ€²

âˆ’1

i+1âˆ’1

udâ€²

i+1

s Î²dâ€²
i

s Î²dâ€²
i

s Î¶dâ€²
i

+1

s Î²dâ€²

i+1

s Î²dâ€²

i+1

sudâ€²

iâˆ’1

udâ€²

i

/ udâ€²

i+1

Î³dâ€²
i

+1

Î²dâ€²
i

+2

Â· Â· Â·

Î²dâ€²

i+1

/ udâ€²

âˆ’1

i+1âˆ’1

sudâ€²

i+1

,

where uâˆ’1 = y. By applying Lemma 3.2.3 (1) to the path (sudâ€²

iâˆ’1 = udâ€²

i

âˆ’âˆ’âˆ’âˆ’â†’
Î²dâ€²
i

+1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’âˆ’â†’

Î²dâ€²

âˆ’1

i+1

udâ€²

i+1âˆ’1

sâˆ’âˆ’âˆ’âˆ’â†’
Î²dâ€²

i+1

i+1âˆ’1 = udâ€²

sudâ€²
Î³li+1 < Î³li+1 < Î³li+1+1. Then, we have

i+1

), we can take the maximum index li+1 âˆˆ {dâ€²

i, dâ€²

i + 1, . . . , dâ€²

i+1 âˆ’ 2} such that suli+1 < uli+1 and

âˆ†â€²

i := (udâ€²

iâˆ’1 = sudâ€²

i

âˆ’âˆ’âˆ’âˆ’â†’
Î²dâ€²
i

+1

Â· Â· Â· âˆ’âˆ’â†’

Î³dâ€²
li

suli+1

sâˆ’âˆ’âˆ’â†’
Î¶li+1

uli+1 âˆ’âˆ’âˆ’â†’
Î²li+1

Â· Â· Â· âˆ’âˆ’âˆ’âˆ’âˆ’â†’

Î²dâ€²

âˆ’1

i+1

udâ€²

i+1âˆ’1) âˆˆ P <

r (udâ€²

iâˆ’1, udâ€²

i+1âˆ’1).

Also, we set âˆ†â€²

m := (udâ€²

mâˆ’1 = sudâ€²

suk = sw) âˆˆ P <

0 (udâ€²

mâˆ’1, sw). We deï¬ne Ï•â€²(âˆ†â€²) to be the

concatenation âˆ† âˆˆ P <

+ (y, sw) of the paths âˆ†â€²

m âˆ’âˆ’âˆ’âˆ’â†’
m+1

Î²dâ€²

Â· Â· Â· âˆ’â†’
Î²k
1, . . . , âˆ†â€²
0, âˆ†â€²

m.

The proof of the following proposition is similar to that of Proposition 3.3.1.

Proposition 3.3.2. The map Ïˆ : P <

r (y, sw) â†’ P <

r (sy, w) is a bijection, with Ïˆâ€² its inverse.

We now summarize the results obtained in this section:

Corollary 3.3.3. Let y, w âˆˆ Waf , s âˆˆ Saf . Assume that sw < âˆ
P <

w. Then, there exist bijections Ï• : P <
r (sy, w). Moreover, they have the following properties:

r (y, w) and Ïˆ : P <

r (y, sw) â†’ P <

r (sy, w) â†’ P <

2

r (sy, sw)âŠ”

â„“(Ï•(âˆ†)) =(â„“(âˆ†)

â„“(âˆ†) + 1

(âˆ† âˆˆ P <
(âˆ† âˆˆ P <

r (sy, sw)),
r (sy, w)),

â„“(Ïˆ(âˆ†)) = â„“(âˆ†).

4. Proof of Theorem 2.4.4

4.1. Recursion relations. Let y, w âˆˆ Waf , and let < be a (ï¬xed) reï¬‚ection order on Î¦+. Recall that P <
is deï¬ned to be the set of all paths from y to w without translation edges. Also, we deï¬ne P <
set of all paths from y to w without reï¬‚ection edges.

r (y, w)
t (y, w) to be the

Deï¬nition 4.1.1. For y, w âˆˆ Waf , we deï¬ne

r<

y,w(q) := Xâˆ†âˆˆP <
y,w(q) := Xâˆ†âˆˆP <

t<

r (y,w)

t (y,w)

q

1

2(cid:0)â„“

âˆ

2 (y,w)âˆ’â„“(âˆ†)(cid:1)(q âˆ’ 1)â„“(âˆ†),

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†).

Proposition 4.1.2. Let y, w âˆˆ Waf , and s âˆˆ Saf . Assume that sw < âˆ

2

w.



/
/


/
/
/
/
/
/
O
O
O
O
18

H. WATANABE AND S. NAITO

(1) It holds that

(2) It holds that

y,w(q) =(r<

r<

sy,sw(q)
qr<
sy,sw(q) + (q âˆ’ 1)r<

sy,w(q)

(sy < âˆ
(y < âˆ

2

y),
sy).

2

t<
y,w(q) = t<

sy,sw(q).

Proof. (1) If sy < âˆ
â„“(Ïˆ(âˆ†)) = â„“(âˆ†) for all âˆ† âˆˆ P <

2

y, then by Corollary 3.3.3, there exists a bijection Ïˆ : P <

r (sy, sw) â†’ P <

r (y, w) such that

r (sy, sw). Also, we have â„“

âˆ

âˆ

2 (y, w) = â„“

2 (sy, sw). Therefore, we see that

r (sy,sw)

r<

sy,sw(q) = Xâˆ†âˆˆP <
= Xâˆ†â€²âˆˆP <

= r<

y,w(q).

r (y,w)

q

1

âˆ

2 (sy,sw)âˆ’â„“(âˆ†)(cid:1)(q âˆ’ 1)â„“(âˆ†)
2(cid:0)â„“
2 (y,w)âˆ’â„“(âˆ†â€²)(cid:1)(q âˆ’ 1)â„“(âˆ†â€²)
2(cid:0)â„“

âˆ

1

q

Next, assume that y < âˆ
such that â„“(Ï•(âˆ†)) = â„“(âˆ†) if âˆ† âˆˆ P <
have â„“

2 (sy, w) + 1 = â„“

âˆ

âˆ

âˆ

2

2 (y, w) = â„“
qr<

sy,sw(q) + (q âˆ’ 1)r<

sy,w(q)

sy. By Corollary 3.3.3, there exists a bijection Ï• : P <

r (sy, sw) âŠ” P <

r (sy, sw), and such that â„“(Ï•(âˆ†)) = â„“(âˆ†) + 1 if âˆ† âˆˆ P <
2 (sy, sw) + 2. Therefore, we see that

r (sy, w) â†’ P <

r (y, w)
r (sy, w). Also, we

q

1

2(cid:0)â„“

r (sy,sw)

=

= Xâˆ†âˆˆP <
Xâˆ†â€²âˆˆP <
= Xâˆ†â€²âˆˆP <

Ï•âˆ’1(âˆ†â€²)âˆˆP <

r (y,w)

= r<

y,w(q),

r (y,w)

r (sy,sw)

q

1

2(cid:0)â„“

1

âˆ

âˆ

q

2 (y,w)âˆ’â„“(âˆ†â€²)(cid:1)(q âˆ’ 1)â„“(âˆ†â€²) +

2 (sy,sw)âˆ’â„“(âˆ†)(cid:1)+1(q âˆ’ 1)â„“(âˆ†) + Xâˆ†âˆˆP <
2(cid:0)â„“
2 (y,w)âˆ’â„“(âˆ†â€²)(cid:1)(q âˆ’ 1)â„“(âˆ†â€²)

âˆ

q

1

2(cid:0)â„“

âˆ

2 (sy,s)âˆ’â„“(âˆ†)(cid:1)(q âˆ’ 1)â„“(âˆ†)+1

q

1

2(cid:0)â„“

âˆ

2 (y,w)âˆ’â„“(âˆ†â€²)(cid:1)(q âˆ’ 1)â„“(âˆ†â€²)

r (sy,w)

Xâˆ†â€²âˆˆP <

r (y,w)

Ï•âˆ’1(âˆ†â€²)âˆˆP <

r (sy,w)

as desired.

(2) Let âˆ† = (y = u0

m1âˆ’âˆ’â†’
Î²1

u1

m2âˆ’âˆ’â†’
Î²2

Â· Â· Â· mkâˆ’âˆ’â†’
Î²k

uk = w) âˆˆ P <

2 (ui, ui+1) = â„“

2 (sui, sui+1) for all i = 0, 1, . . . , k âˆ’ 1. Hence we obtain a path (sy = su0

âˆ

suk = sw) âˆˆ P <

t (sy, sw). This procedure obviously gives a bijection from P <

t (y, w). Since every edge in âˆ† is a translation edge, we
m2âˆ’âˆ’â†’
Î²2
t (sy, sw),

t (y, w) to P <

m1âˆ’âˆ’â†’
Î²1

su1

âˆ

have â„“
Â· Â· Â· mkâˆ’âˆ’â†’
Î²k

which preserves both of degree and length of paths. Therefore, we see that

t<

y,w(q) = Xâˆ†âˆˆP <
= Xâˆ†â€²âˆˆP <

t (y,w)

= t<

sy,sw(q),

t (sy,sw)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

qdeg(âˆ†â€²)(q âˆ’ 1)â„“(âˆ†â€²)

as desired.

(cid:3)

Deï¬nition 4.1.3. For y, w âˆˆ Waf , we deï¬ne

R<

y,w(q) := Xâˆ†âˆˆP <(y,w)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†).

In order to prove Theorem 2.4.4, it suï¬ƒces to show that the R<
(r1) R<

w,w(q) = 1 for all w âˆˆ Waf .

y,w(q)â€™s satisfy the following equations.

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

19

âˆ

2 w for all y, w âˆˆ Waf .

y,w(q) = 0 unless y â‰¤
sy,sw(q)
sy,sw(q) + (q âˆ’ 1)R<

qR<

y,sw(q)

for all y, w âˆˆ Waf and all s âˆˆ Saf .

(r2) R<

(r3) R<

y,w(q) =(R<
(r4) PxâˆˆW (âˆ’1)â„“

âˆ

Equations (r1) and (r2) are obvious from the deï¬nition of R<
remaining equations.

2 (y,xtÎ»)qâ„“(xw0)R<

y,xtÎ»(q) = Î´Î»,Î»(y) for all Î» âˆˆ Qâˆ¨, y âˆˆ Waf .

if sw < âˆ
if sw < âˆ

2

2

w and sy < âˆ
w and y < âˆ

2

y,
sy,

2

y,w(q)â€™s. In the next two subsections, we prove the

4.2. Proof of equation (r3). In order to prove equation (r3), we need the equation

(8)

R<

y,w(q) = XÂµâˆˆQâˆ¨

+

y,wtâˆ’Âµ(q)t<
r<

wtâˆ’Âµ,w(q);

by using this, equation (r3) follows immediately from Proposition 4.1.2 (see Corollary 4.2.3). Note that the
right-hand side of equation (8) is actually a ï¬nite sum because by the deï¬nition of r<
y,wtâˆ’Âµ(q), it is equal to zero
unless y < âˆ
wtâˆ’Âµ. The idea for the
proof of this equation is to divide a path âˆ† âˆˆ P <(y, w) into two paths âˆ†1 âˆˆ P <
t (wtâˆ’Âµ, w)
for each Âµ âˆˆ Qâˆ¨

wtâˆ’Âµ, and because there are only ï¬nitely many Âµ âˆˆ Qâˆ¨

r (y, wtâˆ’Âµ) and âˆ†2 âˆˆ P <

+ satisfying y < âˆ

2

2

+ as follows.

Let us take an arbitrary path âˆ† = (y = u0

m1âˆ’âˆ’â†’
Î²1

Â· Â· Â· mkâˆ’âˆ’â†’
Î²k

uk = w) âˆˆ P <(y, w), and write T (âˆ†) = (mÎ²)Î²âˆˆÎ¦+ .

We deï¬ne (mâ€²

Î²)Î²âˆˆÎ¦+ âˆˆ (Zâ‰¥0)|Î¦+| by:

if Î² /âˆˆ r(âˆ†),
if Î² = Î²i âˆˆ r(âˆ†), ui = cl(uiâˆ’1)sÎ²i twt(uiâˆ’1)+miÎ²âˆ¨
if Î² = Î²i âˆˆ r(âˆ†), ui = cl(uiâˆ’1)sÎ²i twt(uiâˆ’1)+miÎ²âˆ¨

i

i

and cl(uiâˆ’1) < cl(uiâˆ’1)sÎ²i,
and cl(uiâˆ’1)sÎ²i < cl(uiâˆ’1),

mâ€²

Î²Î²âˆ¨ âˆˆ Qâˆ¨

+. Let (nÎ²)Î²âˆˆÎ¦+ âˆˆ (Zâ‰¥0)|Î¦+| be such that

nÎ² = mâ€²
Î²
0 â‰¤ nÎ² â‰¤ mâ€²
Î²

(Î² /âˆˆ r(âˆ†)), and

(Î² âˆˆ r(âˆ†)).

mâ€²

mÎ²
mi
mi âˆ’ 1

Î² =ï£±ï£´ï£²ï£´ï£³
and set Âµâ€² =PÎ²âˆˆÎ¦+
Then, for Âµ :=PÎ²âˆˆÎ¦+

(10)

(9)

nÎ²Î²âˆ¨, there exists a unique pair (âˆ†(nÎ² ),r, âˆ†(nÎ² ),t) âˆˆ P <

t (wtâˆ’Âµ, w) such
that r(âˆ†(nÎ² ),r) = r(âˆ†), T (âˆ†(nÎ² ),t) = (nÎ²)Î²âˆˆÎ¦+ , and T (âˆ†) = T (âˆ†(nÎ² ),r) + T (âˆ†(nÎ² ),t), where the sum is
taken componentwise. More precisely, we deï¬ne âˆ†(nÎ² ),r and âˆ†(nÎ² ),t as follows. If we write {1 â‰¤ i â‰¤ â„“(âˆ†) |
Î²i âˆˆ r(âˆ†)} = {i1, i2, . . . , il} with i1 < Â· Â· Â· < il, and {1 â‰¤ j â‰¤ â„“(âˆ†) | nj 6= 0} = {j1, j2, . . . , jlâ€² } with
j1 < j2 < Â· Â· Â· < jlâ€² , then

r (y, wtâˆ’Âµ) Ã— P <

âˆ†(nÎ² ),r := (y

âˆ†(nÎ² ),t := (wtâˆ’Âµ

Â· Â· Â·

mÎ²il
âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’â†’

âˆ’nÎ²il
Î²il

wtâˆ’Âµ),

mÎ²i1
âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’âˆ’â†’

âˆ’nÎ²i1
Î²i1
nÎ²j1âˆ’âˆ’âˆ’â†’
Î²j1

Â· Â· Â·

nÎ²j
lâ€²âˆ’âˆ’âˆ’â†’
Î²j

lâ€²

w).

r (y, wtâˆ’Âµ)Ã—P <

for some Âµ âˆˆ Qâˆ¨

Conversely, let (âˆ†1, âˆ†2) âˆˆ P <

we have Âµ = PÎ²âˆˆÎ¦+

+. We write T (âˆ†1) = (n1,Î²)Î²âˆˆÎ¦+ and T (âˆ†2) = (n2,Î²)Î²âˆˆÎ¦+ . Since âˆ†2 âˆˆ P <

t (wtâˆ’Âµ, w) be such that r(âˆ†1) = r(âˆ†) and T (âˆ†1)+T (âˆ†2) = T (âˆ†)
t (wtâˆ’Âµ, w),
n2,Î²Î²âˆ¨. Also, T (âˆ†1) + T (âˆ†2) = T (âˆ†) implies that (n2,Î²)Î²âˆˆÎ¦+ satisï¬es condition (9)
and that 0 â‰¤ nÎ² â‰¤ mÎ² for all Î² âˆˆ r(âˆ†). Moreover, if Î² = Î²i âˆˆ r(âˆ†), ui = cl(uiâˆ’1)sÎ²twt(uiâˆ’1)+mÎ²âˆ¨, and
cl(uiâˆ’1)sÎ² < cl(uiâˆ’1), then by the deï¬nition, we have n1,Î²i â‰¥ 1. Hence (n2,Î²)Î²âˆˆÎ¦+ satisï¬es condition (10).
Thefore, âˆ†(n2,Î² ),r and âˆ†(n2,Î² ),t deï¬ned above agree with âˆ†1 and âˆ†2, respectively.

Thus we obtain a one-to-one correspondence between the set

A(âˆ†) := {(nÎ²)Î²âˆˆÎ¦+ âˆˆ (Zâ‰¥0)|Î¦+| | (nÎ²)Î²âˆˆÎ¦+ satisï¬es conditions (9) and (10)}

and the set B(âˆ†) :=FÂµâˆˆQâˆ¨

B(âˆ†)Âµ := {(âˆ†1, âˆ†2) âˆˆ P <

+

B(âˆ†)Âµ, where

r (y, wtâˆ’Âµ) Ã— P <

t (wtâˆ’Âµ, w) | r(âˆ†1) = r(âˆ†) and T (âˆ†1) + T (âˆ†2) = T (âˆ†)}.

20

H. WATANABE AND S. NAITO

Lemma 4.2.1. For each âˆ† âˆˆ P <(y, w), we have

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†) = XÂµâˆˆQâˆ¨

+ X(âˆ†1,âˆ†2)âˆˆB(âˆ†)

âˆ†1âˆˆP <

r (y,wtâˆ’Âµ)

q

1

2(cid:0)â„“

âˆ

2 (y,wtâˆ’Âµ)âˆ’â„“(âˆ†1)(cid:1)+deg(âˆ†2)(q âˆ’ 1)â„“(âˆ†1)+â„“(âˆ†2).

Proof. We employ the notation above. Noting that (mâ€²

Î²)Î²âˆˆÎ¦+ âˆˆ A(âˆ†), we set

a(q) = a(âˆ†)(q) := q

1

2(cid:0)â„“

âˆ

2 (y,wtâˆ’Âµâ€² )âˆ’â„“(âˆ†(mâ€²
Î²

),r )(cid:1)+deg(âˆ†(mâ€²

Î²

),t)

(q âˆ’ 1)

â„“(âˆ†(mâ€²
Î²

),r )+â„“(âˆ†(mâ€²
Î²

),t)

.

For each (nÎ²)Î²âˆˆÎ¦+ âˆˆ A(âˆ†) withPÎ²âˆˆÎ¦+

nÎ²Î²âˆ¨ = Âµ, we see from the deï¬nitions of âˆ†(nÎ² ),r and âˆ†(nÎ² ),t that

(11)

(12)

â„“(âˆ†(nÎ² ),r) = |r(âˆ†)| ,
â„“(âˆ†(nÎ² ),t) = |{Î² âˆˆ Î¦+ | nÎ² 6= 0}| .

Also, we have

â„“(âˆ†(nÎ² ),t)

deg(âˆ†(nÎ² ),t) =

(13)

=

1
2

+Â·Â·Â·+nÎ²ijâˆ’1

Î²âˆ¨

ijâˆ’1

nÎ²ijâˆ’âˆ’âˆ’â†’

Î²ij

wtâˆ’Âµ+nÎ²i1

Î²âˆ¨
i1

+Â·Â·Â·+nÎ²ij

Î²âˆ¨
ij

) âˆ’ â„“(âˆ†(nÎ² ),t)

Î²âˆ¨
i1

d(wtâˆ’Âµ+nÎ²i1

Xj=1
2 (wtâˆ’Âµ, w) + XÎ²âˆˆÎ¦+

âˆ

â„“

nÎ² âˆ’ â„“(âˆ†(nÎ² ),t).

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

21

If we write r(âˆ†) âˆ© {Î² âˆˆ Î¦+ | mâ€²
follows:

Î² 6= 0} = {Î²i1 , . . . , Î²ikâ€² } and mâ€²

j = mâ€²

Î²ij

for 1 â‰¤ j â‰¤ kâ€², then we compute as

âˆ

2 (y,wtâˆ’Âµ)âˆ’â„“(âˆ†(nÎ² ),r )(cid:1)+deg(âˆ†(nÎ² ),t)(q âˆ’ 1)â„“(âˆ†(nÎ² ),r )+â„“(âˆ†(nÎ² ),t)

âˆ

1

q

1

q

q

q

),t)

Î²

âˆ

1
2 â„“

),t)

Î²

(q âˆ’ 1)

âˆ’ PÎ² (mâ€²

PÎ² nÎ² Î²âˆ¨=Âµ

PÎ² nÎ² Î²âˆ¨=Âµ

PÎ² nÎ² Î²âˆ¨=Âµ

Î² âˆ’nÎ² )âˆ’â„“(âˆ†(nÎ² ),t)+â„“(âˆ†(mâ€²

2 (wtâˆ’Âµâ€² ,wtâˆ’Âµ)+deg(âˆ†(nÎ² ),t)âˆ’deg(âˆ†(mâ€²

2(cid:0)â„“
+ X(nÎ² )âˆˆA(âˆ†)

2 (y,wtâˆ’Âµ)âˆ’â„“(âˆ†1)(cid:1)+deg(âˆ†2)(q âˆ’ 1)â„“(âˆ†1)+â„“(âˆ†2)
+ X(âˆ†1,âˆ†2)âˆˆB(âˆ†)Âµ
XÂµâˆˆQâˆ¨
2(cid:0)â„“
= XÂµâˆˆQâˆ¨
+ X(nÎ² )âˆˆA(âˆ†)
= a(q) XÂµâˆˆQâˆ¨
+ X(nÎ² )âˆˆA(âˆ†)
= a(q) XÂµâˆˆQâˆ¨
+ X(nÎ² )âˆˆA(âˆ†)
= a(q) XÂµâˆˆQâˆ¨
mâ€²2Xn2=0
kâ€²Xnkâ€² =0
1Xn1=0
kâ€²Xlkâ€² =0
2Xl2=0
1Xl1=0
kâ€²Xlkâ€² =0
2Xl2=0
1Xl1=0
= a(q)ï£«ï£¬ï£­1 +
kâ€²Xj=1 X1â‰¤i1<Â·Â·Â·<ij â‰¤kâ€²

Î² âˆ’nÎ² )(cid:18) q
j âˆ’nj )(cid:18) q
q âˆ’ 1(cid:19)kâ€²âˆ’|{1â‰¤jâ‰¤kâ€² | lj 6=mj }|
q âˆ’ 1(cid:19)|{1â‰¤jâ‰¤kâ€² | nj =mj }|
qâˆ’li1 âˆ’Â·Â·Â·âˆ’lij(cid:18) q
ijXlij =1

j=1 lj(cid:18) q
j=1 lj(cid:18) q
i1Xli1 =1

qâˆ’ PÎ² (mâ€²

Î²

),t)

q âˆ’ 1(cid:19)âˆ’â„“(âˆ†(nÎ² ),t)+â„“(âˆ†(mâ€²
q âˆ’ 1(cid:19)kâ€²âˆ’|{1â‰¤jâ‰¤kâ€² | nj 6=0}|

PÎ² nÎ² Î²âˆ¨=Âµ

qâˆ’ Pkâ€²

j=1(mâ€²

qâˆ’ Pkâ€²

qâˆ’ Pkâ€²

= a(q)

= a(q)

= a(q)

mâ€²

mâ€²

mâ€²

mâ€²

mâ€²

mâ€²

mâ€²

mâ€²

Â· Â· Â·

Â· Â· Â·

Â· Â· Â·

Â· Â· Â·

mâ€²

mâ€²

(q âˆ’ 1)

â„“(âˆ†(nÎ² ),t)âˆ’â„“(âˆ†(mâ€²

),t)

Î²

â„“(âˆ†(nÎ² ),t)âˆ’â„“(âˆ†(mâ€²

),t)

(by (13))

Î²

(by changing nj with lj)

ir }|ï£¶ï£·ï£¸ .
q âˆ’ 1(cid:19)|{1â‰¤râ‰¤j | lir =mâ€²

Here, by induction on j, we deduce that

mâ€²

i1Xli1 =1

Â· Â· Â·

mâ€²

ijXlij =1

Indeed, when j = 1, we have

qâˆ’li1 âˆ’Â·Â·Â·âˆ’lij(cid:18) q

q âˆ’ 1(cid:19)|{1â‰¤râ‰¤j | lir =mâ€²

ir

}|

=(cid:18) 1

q âˆ’ 1(cid:19)j

.

mâ€²

i1Xli1 =1

qâˆ’li1(cid:18) q

q âˆ’ 1(cid:19)Î´li1

,mâ€²

i1 = qâˆ’mâ€²

i1

q

q âˆ’ 1

+

mâ€²

i1

âˆ’1Xli1 =1

qâˆ’li1

i1

+1)

=

=

qâˆ’mâ€²

i1

+1

q âˆ’ 1

qâˆ’mâ€²

i1

+1

q âˆ’ 1

+

+

qâˆ’1(1 âˆ’ qâˆ’mâ€²
1 âˆ’ qâˆ’1
+1

1 âˆ’ qâˆ’mâ€²
q âˆ’ 1

i1

=

1

q âˆ’ 1

.

22

H. WATANABE AND S. NAITO

When j â‰¥ 2, we obtain

ir }|

q âˆ’ 1(cid:19)|{1â‰¤râ‰¤j | lir =mâ€²
qâˆ’li2 âˆ’Â·Â·Â·âˆ’lij(cid:18) q
qâˆ’li2 âˆ’Â·Â·Â·âˆ’lij(cid:18) q

q âˆ’ 1(cid:19)|{2â‰¤râ‰¤j | lir =mâ€²
q âˆ’ 1(cid:19)|{2â‰¤râ‰¤j | lir =mâ€²

ir }|

ir }| mâ€²

i1Xli1 =1

1

q âˆ’ 1

(by our induction hypothesis)

mâ€²

i1Xli1 =1

Â· Â· Â·

mâ€²

mâ€²

mâ€²

mâ€²

=

Â· Â· Â·

qâˆ’li1 âˆ’Â·Â·Â·âˆ’lij(cid:18) q
ijXlij =1
ijXlij =1
i1Xli2 =1
ijXlij =1
i1Xli2 =1
q âˆ’ 1(cid:19)jâˆ’1
=(cid:18) 1
q âˆ’ 1(cid:19)j
=(cid:18) 1

q âˆ’ 1

Â· Â· Â·

=

mâ€²

1

.

qâˆ’li1(cid:18) q

q âˆ’ 1(cid:19)Î´li1

,mâ€²

i1

q âˆ’ 1(cid:19)|{1â‰¤râ‰¤j | lir =mâ€²

ir

}|ï£¶ï£·ï£¸

Therefore, we deduce that

mâ€²

mâ€²

Â· Â· Â·

i1Xli1 =1

a(q)ï£«ï£¬ï£­1 +
qâˆ’li1 âˆ’Â·Â·Â·âˆ’lij(cid:18) q
kâ€²Xj=1 X1â‰¤i1<Â·Â·Â·<ij â‰¤kâ€²
ijXlij =1
= a(q)ï£«ï£­1 +
q âˆ’ 1(cid:19)jï£¶ï£¸
kâ€²Xj=1 X1â‰¤i1<Â·Â·Â·<ij â‰¤kâ€²(cid:18) 1
q âˆ’ 1(cid:19)jï£¶ï£¸
= a(q)ï£«ï£­
kâ€²Xj=1(cid:18)kâ€²
j(cid:19)(cid:18) 1
q âˆ’ 1(cid:19)kâ€²
= a(q)(cid:18) q
),r )(cid:1)+deg(âˆ†(mâ€²
2(cid:0)â„“

2 (y,wtâˆ’Âµâ€² )âˆ’â„“(âˆ†(mâ€²
Î²

(q âˆ’ 1)

),t)+kâ€²

= q

âˆ

Î²

1

â„“(âˆ†(mâ€²
Î²

),r )+â„“(âˆ†(mâ€²
Î²

),t)âˆ’kâ€²

(by the deï¬nition of a(q)).

To ï¬nish the proof of the lemma, we need to show the following:

1

2(cid:0)â„“

âˆ

2 (y, wtâˆ’Âµâ€² ) âˆ’ â„“(âˆ†(mâ€²

Î² ),r)(cid:1) + deg(âˆ†(mâ€²

Î² ),r) + â„“(âˆ†(mâ€²

â„“(âˆ†(mâ€²

Î² ),t) + kâ€² = deg(âˆ†),
Î² ),t) âˆ’ kâ€² = â„“(âˆ†).

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

23

These are veriï¬ed as follows:

Î² ),r) + (â„“(âˆ†(mâ€²

Î² ),t) âˆ’ kâ€²) = |r(âˆ†)| + |t(âˆ†)| = â„“(âˆ†)

(by (11) and (12)),

â„“(âˆ†(mâ€²
1
2

(â„“

âˆ

=

=

=

deg(âˆ†) =

=

=

1
2

1
2

1
2

1
2

1
2

1
2

â„“

â„“

â„“

â„“

â„“

2 (y, wtâˆ’Âµâ€² ) âˆ’ â„“(âˆ†(mâ€²

Î² ),r)) + deg(âˆ†(mâ€²

Î² ),t) + kâ€²

âˆ

2 (y, w) âˆ’

â„“

â„“(âˆ†(mâ€²

âˆ

2 (y, w) +

âˆ

2 (y, w) +

â„“(âˆ†(mâ€²

â„“(âˆ†(mâ€²

1
2

1
2

1
2

âˆ

âˆ

2 (y, w) + XÎ²âˆˆÎ¦+
2 (y, w) + XÎ²âˆˆÎ¦+
2 (y, w) + XÎ²âˆˆÎ¦+

âˆ

Î² ),t) âˆ’ kâ€²(cid:1)

mâ€²

mâ€²

Î² âˆ’(cid:0)â„“(âˆ†(mâ€²
Î² âˆ’(cid:0)â„“(âˆ†(mâ€²

Î² ),r) + XÎ²âˆˆÎ¦+
Î² ),r) + XÎ²âˆˆÎ¦+
Î² ),r) + XÎ²âˆˆÎ¦+
2(cid:12)(cid:12){Î² âˆˆ r(âˆ†) | mâ€²
Î² = mÎ²}(cid:12)(cid:12) âˆ’
|r(âˆ†)| âˆ’(cid:12)(cid:12){Î² âˆˆ r(âˆ†) | mâ€²

Î² âˆ’ â„“(âˆ†),

mâ€²

1
2

1

mÎ² +

mÎ² +

mâ€²

Î² +

â„“(âˆ†(mâ€²

Î² ),r) âˆ’ â„“(âˆ†).

1
2

Î² ),r) + â„“(âˆ†(mâ€²

Î² ),t) âˆ’ kâ€²(cid:1)

Î² = mÎ² âˆ’ 1}(cid:12)(cid:12) âˆ’ â„“(âˆ†)

1

2(cid:12)(cid:12){Î² âˆˆ r(âˆ†) | mâ€²
Î² = mÎ² âˆ’ 1}(cid:12)(cid:12) âˆ’ â„“(âˆ†)

This completes the proof of the lemma.

Proposition 4.2.2. For each y, w âˆˆ Waf , we have

R<

y,w(q) = XÂµâˆˆQâˆ¨

+

Proof. We compute as follows:

y,wtâˆ’Âµ(q)t<
r<

wtâˆ’Âµ,w(q).

R<

y,w(q) = Xâˆ†âˆˆP <(y,w)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

+ X(âˆ†1,âˆ†2)âˆˆB(âˆ†)Âµ
r (y,wtâˆ’Âµ) Xâˆ†2âˆˆP <

= Xâˆ†âˆˆP <(y,w) XÂµâˆˆQâˆ¨
+ Xâˆ†1âˆˆP <
= XÂµâˆˆQâˆ¨
+ Xâˆ†1âˆˆP <
= XÂµâˆˆQâˆ¨
= XÂµâˆˆQâˆ¨

+

q

1

2(cid:0)â„“

âˆ

2 (y,wtâˆ’Âµ)âˆ’â„“(âˆ†1)(cid:1)+deg(âˆ†2)(q âˆ’ 1)â„“(âˆ†1)+â„“(âˆ†2)
2(cid:0)â„“

2 (y,wtâˆ’Âµ)âˆ’â„“(âˆ†1)(cid:1)+deg(âˆ†2)(q âˆ’ 1)â„“(âˆ†1)+â„“(âˆ†2)

âˆ

1

q

(by Lemma 4.2.1)

t (wtâˆ’Âµ,w)

q

1

2(cid:0)â„“

âˆ

2 (y,wtâˆ’Âµ)âˆ’â„“(âˆ†1)(cid:1)(q âˆ’ 1)â„“(âˆ†1) Xâˆ†2âˆˆP <

t (wtâˆ’Âµ,w)

r (y,wtâˆ’Âµ)
y,wtâˆ’Âµ(q)t<
r<

wtâˆ’Âµ,w(q)

(by the deï¬nitions).

qdeg(âˆ†2)(q âˆ’ 1)â„“(âˆ†2)

This proves the proposition.

Corollary 4.2.3. For each y, w âˆˆ Waf , we have

y,w(q) =(R<

qR<

R<

sy,sw(q)
sy,sw(q) + (q âˆ’ 1)R<

y,sw(q)

if sw < âˆ
if sw < âˆ

2

2

w and sy < âˆ
w and y < âˆ

2

y,
sy.

2

(cid:3)

(cid:3)

Proof. By Proposition 4.1.2 (2), we have

t<
xtâˆ’Âµ,x(q) = t<

wtâˆ’Âµ,w(q)

for all x, w âˆˆ Waf and all Âµ âˆˆ Qâˆ¨. Hence the assertion follows from equation (8) and Proposition 4.1.2.

(cid:3)

24

H. WATANABE AND S. NAITO

4.3. Proof of equation (r4). In this subsection, we prove equation (r4):

âˆ

(âˆ’1)â„“

2 (y,xtÎ»)qâ„“(xw0)R<

y,xtÎ»(q) = Î´Î»,Î»(y) (Î» âˆˆ Qâˆ¨, y âˆˆ Waf ).

XxâˆˆW

By translating all elements in a path by Î» âˆˆ Qâˆ¨, we obtain a bijection P <(y, w) â†’ P <(ytÎ», wtÎ») for all
y, w âˆˆ Waf . Hence we may assume that y âˆˆ W (or equivalently, Î»(y) = 0).
In this subsection, we write
Î¦+ = {Î²1, . . . , Î²n}, with Î²1 < Â· Â· Â· < Î²n ; here, < is the ï¬xed reï¬‚ection order. To prove equation (r4), we will
prove stronger statements:

âˆ

(âˆ’1)â„“

2 (y,x)qâ„“(xw0)R<

y,x(q) = 1,

XxâˆˆW

(âˆ’1)â„“

XxâˆˆW

âˆ

2 (y,xtÎ»)qâ„“(xw0) Xâˆ†âˆˆP <(y,xtÎ»)

Î²kâ‰¤e(âˆ†)

qdeg âˆ†(q âˆ’ 1)â„“(âˆ†) = 0 (Î» âˆˆ Qâˆ¨ \ {0}, k âˆˆ {1, . . . , n}),

where Î²k â‰¤ e(âˆ†) means that Î²k â‰¤ Î² for all Î² âˆˆ e(âˆ†).

Proposition 4.3.1. If w âˆˆ W , then R<
Î» = 0.

y,w(q) = Ry,w(q) for all y âˆˆ W . In particular, equation (r4) holds when

Proof. The polynomials Ry,w(q) for y, w âˆˆ W are uniquely determined by equations (R1), (R2), and (R3) (see
Proposition 2.3.5). Here, recall that we have proved that the polynomials R<
y,w(q) for y, w âˆˆ W satisfy the
corresponding equations (r1), (r2), and (r3). Therefore, it follows that R<
y,w(q) = Ry,w(q) for all y, w âˆˆ W . In
particular, equation (r4) with Î» = 0 is just equation (R4) with Î» = 0. Hence the second assertion follows from
Proposition 2.3.5.
(cid:3)

Lemma 4.3.2. For every z âˆˆ W and k âˆˆ {1, . . . , n}, we have

XxâˆˆW

(âˆ’1)â„“(z,x)qâ„“(xw0) Xâˆ†âˆˆP <(z,x)

Î²kâ‰¤e(âˆ†)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†) = q|{j | j<k and z<zsÎ²j }|.

Proof. We prove the desired equation by descending induction on â„“(z). When â„“(z) = â„“(w0), then z = w0 and
hence the desired equation follows immediately.

Now, we assume that â„“(z) < â„“(w0), and proceed also by induction on k. When k = 1, we have

(âˆ’1)â„“(z,x)qâ„“(xw0) Xâˆ†âˆˆP <(z,x)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

(âˆ’1)â„“(z,x)qâ„“(xw0)R<

z,x(q) = 1

(by (r4) with Î» = 0),

and

L.H.S. = XxâˆˆW
= XxâˆˆW

R.H.S. = q0 = 1.

Hence we assume that k â‰¥ 2. Here observe that since z, x âˆˆ W , every edge of a path in P <(z, x) is a reï¬‚ection
edge, and hence mÎ²l = 0 for all l = 1, . . . , n.

If zsÎ²kâˆ’1 < z, then there does not exist any path beginning with an edge of the form z

0âˆ’âˆ’âˆ’â†’
Î²kâˆ’1
for each âˆ† âˆˆ P <(z, x), we have Î²k â‰¤ e(âˆ†) if and only if Î²kâˆ’1 â‰¤ e(âˆ†). From this, we deduce that

. Therefore,

L.H.S. = XxâˆˆW

Xâˆ†âˆˆP <(z,x), Î²kâ‰¤e(âˆ†)

(âˆ’1)â„“(z,x)qâ„“(xw0)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

= q|{j | j<kâˆ’1 and z<zsÎ²j }|
= q|{j | j<k and z<zsÎ²j }|.

(by our induction hypothesis applied to k âˆ’ 1)

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

25

If z < zsÎ²kâˆ’1, then we see that

L.H.S. = XxâˆˆW

(âˆ’1)â„“(z,x)qâ„“(xw0)(cid:0) Xâˆ†âˆˆP <(z,x)

Î²kâˆ’1â‰¤e(âˆ†)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†) âˆ’ Xâˆ†âˆˆP <(z,x)

Î²kâˆ’1â‰¤e(âˆ†) and Î²kâˆ’1âˆˆe(âˆ†)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)(cid:1)

= q|{j | j<kâˆ’1 and z<zsÎ²j }|

(âˆ’1)â„“(zsÎ²kâˆ’1

+ XxâˆˆW

,x)qâ„“(xw0) Xâˆ†âˆˆP <(zsÎ²kâˆ’1

Î²kâ‰¤e(âˆ†)

,x)

qdeg(âˆ†)+ 1

2(cid:0)â„“(z,zsÎ²kâˆ’1 )âˆ’1(cid:1)(q âˆ’ 1)â„“(âˆ†)+1

= q|{j | j<kâˆ’1 and z<zsÎ²j }|

+ (q âˆ’ 1)q

1

2(cid:0)â„“(z,zsÎ²kâˆ’1 )âˆ’1(cid:1)+|{j | j<k and zsÎ²kâˆ’1

< zsÎ²kâˆ’1

sÎ²j }|,

where the second equality follows from our induction hypothesis applied to k âˆ’ 1, and the third one follows from
the desired equality for zsÎ²kâˆ’1. Therefore, if we show the equality

(cid:12)(cid:12){j | j < k âˆ’ 1 and z < zsÎ²j }(cid:12)(cid:12) =(cid:12)(cid:12){j | j < k and zsÎ²kâˆ’1 < zsÎ²kâˆ’1sÎ²j }(cid:12)(cid:12) +

then we can complete the proof of the lemma. This equality will be shown in the next lemma.

1

2(cid:0)â„“(z, zsÎ²kâˆ’1) âˆ’ 1(cid:1),

(cid:3)

Lemma 4.3.3. Let z âˆˆ W , and k âˆˆ {2, . . . , n} be such that z < zsÎ²kâˆ’1. Then,

(cid:12)(cid:12){j | j < k âˆ’ 1 and z < zsÎ²j }(cid:12)(cid:12) =(cid:12)(cid:12){j | j < k and zsÎ²kâˆ’1 < zsÎ²kâˆ’1sÎ²j }(cid:12)(cid:12) +

1

2(cid:0)â„“(z, zsÎ²kâˆ’1) âˆ’ 1(cid:1).

Proof. Let i âˆˆ {1, . . . , n}. Then we easily deduce the following by using basic facts about the ordinary Bruhat
order and length function:

z < zsÎ²i if and only if z(Î²i) âˆˆ Î¦+;
zsÎ²kâˆ’1 < zsÎ²kâˆ’1sÎ²i if and only if zsÎ²kâˆ’1(Î²i) âˆˆ Î¦+;
â„“(z) = |{j | z(Î²j) âˆˆ âˆ’Î¦+}|;

â„“(zsÎ²kâˆ’1) =(cid:12)(cid:12){j | zsÎ²kâˆ’1(Î²j ) âˆˆ âˆ’Î¦+}(cid:12)(cid:12).

following:

Now, let iâ€² âˆˆ {1, . . . , n} be such that sÎ²kâˆ’1(Î²i) âˆˆ {Î²iâ€² , âˆ’Î²iâ€² }. Then, i âˆˆ {1, . . . , n} satisï¬es exactly one of the

[1] i < k âˆ’ 1, z(Î²i) âˆˆ âˆ’Î¦+, and zsÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+;
[2] i > k âˆ’ 1, z(Î²i) âˆˆ âˆ’Î¦+, and zsÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+;
[3] i < k âˆ’ 1, z(Î²i) âˆˆ Î¦+, and zsÎ²kâˆ’1(Î²i) âˆˆ Î¦+;
[4] i > k âˆ’ 1, z(Î²i) âˆˆ Î¦+, and zsÎ²kâˆ’1(Î²i) âˆˆ Î¦+;
[5] i = k âˆ’ 1;
[6] i < k âˆ’ 1, z(Î²i) âˆˆ âˆ’Î¦+, zsÎ²kâˆ’1(Î²i) âˆˆ Î¦+, and sÎ²kâˆ’1(Î²i) âˆˆ Î¦+;
[7] i > k âˆ’ 1, z(Î²i) âˆˆ âˆ’Î¦+, zsÎ²kâˆ’1(Î²i) âˆˆ Î¦+, and sÎ²kâˆ’1(Î²i) âˆˆ Î¦+;
[8] i < k âˆ’ 1, z(Î²i) âˆˆ Î¦+, zsÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+, and sÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+;
[9] i > k âˆ’ 1, z(Î²i) âˆˆ Î¦+, zsÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+, and sÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+;
[10] i < k âˆ’ 1, z(Î²i) âˆˆ âˆ’Î¦+, zsÎ²kâˆ’1(Î²i) âˆˆ Î¦+, and sÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+;
[11] i > k âˆ’ 1, z(Î²i) âˆˆ âˆ’Î¦+, zsÎ²kâˆ’1(Î²i) âˆˆ Î¦+, and sÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+;
[12] i < k âˆ’ 1, z(Î²i) âˆˆ Î¦+, zsÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+, and sÎ²kâˆ’1(Î²i) âˆˆ Î¦+;
[13] i > k âˆ’ 1, z(Î²i) âˆˆ Î¦+, zsÎ²kâˆ’1(Î²i) âˆˆ âˆ’Î¦+, and sÎ²kâˆ’1(Î²i) âˆˆ Î¦+.

In the following, for each a = 1, 2, . . . , 13, we denote by ca the number of l, 1 â‰¤ l â‰¤ n, satisfying condition
[a]. If we are in case [6], then we have z(sÎ²kâˆ’1(Î²i)) âˆˆ Î¦+, zsÎ²kâˆ’1(sÎ²kâˆ’1 (Î²i)) âˆˆ âˆ’Î¦+, sÎ²kâˆ’1(sÎ²kâˆ’1 (Î²i)) âˆˆ Î¦+,
sÎ²kâˆ’1 (Î²i) = Î²iâ€² , and sÎ²kâˆ’1(Î²i) = Î²i âˆ’ hÎ²i, Î²âˆ¨
kâˆ’1iÎ²kâˆ’1. Since i < k âˆ’ 1 in this case, either i < iâ€² < k âˆ’ 1 or
iâ€² < i < k âˆ’ 1 holds. Hence case [12] holds for iâ€². Conversely, by a similar argument, case [12] for i implies case
[6] for iâ€². Therefore, we ï¬nd that c6 = c12. Similarly, we can show that c7 = c13, c8 = c9, and c10 = c11.

26

H. WATANABE AND S. NAITO

Finally, from the equalities above, we deduce by using the assertions at the beginning of the proof that

(cid:12)(cid:12){j < k âˆ’ 1 | z < zsÎ²j }(cid:12)(cid:12) = c1 + c8 + c12,
(cid:12)(cid:12){j < k | zsÎ²kâˆ’1 < zsÎ²kâˆ’1sÎ²j }(cid:12)(cid:12) = c1 + c6 + c10,

= c5 + 2(c8 âˆ’ c10),

â„“(z, zsÎ²kâˆ’1) = c1 + c2 + c5 + c8 + c9 + c12 + c13 âˆ’ (c1 + c2 + c6 + c7 + c10 + c11)

c3 = 1.

These equalities, together with the equality c6 = c12, prove the lemma.

(cid:3)

Proposition 4.3.4. For every z âˆˆ W and k âˆˆ {1, 2, . . . , n} such that z < zsÎ²k, we have

XxâˆˆW

(âˆ’1)â„“(z,x)qâ„“(xw0) Xâˆ†âˆˆP <(z,x)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

Î²k<e(âˆ†)
q

+

q âˆ’ 1 XxâˆˆW

(âˆ’1)â„“(z,x)qâ„“(xw0)

Xâˆ†âˆˆP <(z,x)

Î²kâ‰¤e(âˆ†) and Î²kâˆˆe(âˆ†)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†) = 0.

Proof. We compute as follows:

L.H.S. = XxâˆˆW

(âˆ’1)â„“(z,x)qâ„“(xw0) Xâˆ†âˆˆP <(z,x)
q âˆ’ 1 XxâˆˆW

Î²kâ‰¤e(âˆ†)

(âˆ’1)â„“(z,x)qâ„“(xw0)

1

+

= q|{j|j<k and z<zsÎ²j }|

+

1

q âˆ’ 1 XxâˆˆW

(âˆ’1)â„“(z,x)qâ„“(xw0)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

Xâˆ†âˆˆP <(z,x)

Î²kâ‰¤e(âˆ†) and Î²kâˆˆe(âˆ†)

Xâˆ†âˆˆP <(z,x)

Î²kâ‰¤e(âˆ†) and Î²kâˆˆe(âˆ†)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

= q|{j|j<k and z<zsÎ²j }|

âˆ’

1

q âˆ’ 1 XxâˆˆW

(âˆ’1)â„“(zsÎ²k

,x)qâ„“(xw0) Xâˆ†â€²âˆˆP <(zsÎ²k

Î²k+1â‰¤e(âˆ†â€²)

,x)

= q|{j|j<k and z<zsÎ²j }| âˆ’ q|{j|j<k+1 and zsÎ²k
= 0 (by Lemma 4.3.3),

<zsÎ²k

sÎ²j }|+ 1

2(cid:0)â„“(z,zsÎ²k )âˆ’1(cid:1)

qdeg(âˆ†â€²)+ 1

2(cid:0)â„“(z,zsÎ²k )âˆ’1(cid:1)(q âˆ’ 1)â„“(âˆ†â€²)+1

where the second and fourth equalities follow from Lemma 4.3.2. This proves the proposition.

(cid:3)

Proposition 4.3.5. Let z âˆˆ W , Î» âˆˆ Qâˆ¨ \ {0}, and k âˆˆ {1, . . . , n}. Then we have

(âˆ’1)â„“

XxâˆˆW

âˆ

2 (z,xtÎ»)qâ„“(xw0) Xâˆ†âˆˆP <(z,xtÎ»)

Î²kâ‰¤e(âˆ†)

qdeg âˆ†(q âˆ’ 1)â„“(âˆ†) = 0.

Proof. If Î» /âˆˆ Qâˆ¨
Î» âˆˆ Qâˆ¨

+ \ {0}.

+, then the set P <(z, xtÎ») is empty since z (cid:2) âˆ

2

xtÎ» for any x âˆˆ W . Hence we assume that

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

27

Since Î» 6= 0, for each âˆ† = (z = z0

m1âˆ’âˆ’â†’
Î²i1

Â· Â· Â· mrâˆ’âˆ’â†’
Î²ir

zr = xtÎ») âˆˆ P <(z, xtÎ»), we can take the largest j for which

zj âˆˆ W ; clearly, j < r. With this notation, we deï¬ne b(âˆ†) âˆˆ W tÎ²âˆ¨

by:

ij+1

If we set

ij+1

zjtÎ²âˆ¨
zjsÎ²ij+1

tÎ²âˆ¨

ij+1

if zj < zjsÎ²ij+1
if zj > zjsÎ²ij+1

,

.

b(âˆ†) =ï£±ï£²ï£³

m1âˆ’âˆ’â†’
Î²i1

Â· Â· Â·

mjâˆ’âˆ’â†’
Î²ij
mj+2âˆ’âˆ’âˆ’â†’
Î²ij+2

zj

1âˆ’âˆ’âˆ’â†’
Î²ij+1
Â· Â· Â· mrâˆ’âˆ’â†’
Î²ir
mj+2âˆ’âˆ’âˆ’â†’
Î²ij+2

âˆ†â€² = (z = z0

b(âˆ†)) âˆˆ P <(z, b(âˆ†)),

âˆ†â€²â€² = (b(âˆ†) = zj+1

zr = xtÎ») âˆˆ P <(b(âˆ†), xtÎ»),

âˆ†â€²â€²â€² = (b(âˆ†)

mj+1âˆ’1
âˆ’âˆ’âˆ’âˆ’âˆ’â†’

Î²ij+1

zj+1

Â· Â· Â· mrâˆ’âˆ’â†’
Î²ir

zr = xtÎ») âˆˆ P <(b(âˆ†), xtÎ»),

then we can check by direct calculation that

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†) =(qdeg(âˆ†â€²)(q âˆ’ 1)â„“(âˆ†â€²)qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²)

qdeg(âˆ†â€²)(q âˆ’ 1)â„“(âˆ†â€²) q

qâˆ’1 qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²)

if b(âˆ†) = zj+1,
if b(âˆ†) 6= zj+1.

Conversely, assume that we are given b = cl(b)twt(b) âˆˆ Waf , âˆ†â€² âˆˆ P <(z, b), and âˆ†â€²â€² âˆˆ P <(b, xtÎ») satisfying

the following conditions:

(âˆ—) wt(b) = Î²âˆ¨
i
(âˆ—âˆ—) Î²k â‰¤ e(âˆ†â€²), and all elements of Waf appearing in âˆ†â€² belong to W , except for b;

for some i â‰¥ k;

(âˆ— âˆ— âˆ—) wt(b) < e(âˆ†â€²â€²).
Then we can construct âˆ† âˆˆ P <(z, xtÎ») by concatenating âˆ†â€² and âˆ†â€²â€²; this âˆ† satisï¬es

b(âˆ†) = b,

Î²k â‰¤ e(âˆ†),

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†) = qdeg(âˆ†â€²)(q âˆ’ 1)â„“(âˆ†â€²)qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²).

Similarly, if we are given b âˆˆ Waf , âˆ†â€² âˆˆ P <(z, b), and âˆ†â€²â€²â€² âˆˆ P <(b, xtÎ») satisfying conditions (âˆ—), (âˆ—âˆ—), and that
wt(b) â‰¤ e(âˆ†â€²â€²â€²), wt(b) âˆˆ e(âˆ†â€²â€²â€²), then we can construct âˆ† âˆˆ P <(z, xtÎ») by concatenating âˆ†â€² and âˆ†â€²â€²â€²; this âˆ†
satisï¬es

b(âˆ†) = b,

Î²k â‰¤ e(âˆ†),

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†) = qdeg(âˆ†â€²)(q âˆ’ 1)â„“(âˆ†â€²)

q

q âˆ’ 1

qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²).

From the above, we see that

âˆ

2 (z,xtÎ»)qâ„“(xw0) Xâˆ†âˆˆP <(z,xtÎ»)

Î²kâ‰¤e(âˆ†)

qdeg âˆ†(q âˆ’ 1)â„“(âˆ†)

âˆ

(âˆ’1)â„“

(âˆ’1)â„“

XxâˆˆW
= XbâˆˆWaf
Î²kâ‰¤wt(b)âˆˆÎ¦+ XxâˆˆW
Î²kâ‰¤wt(b)âˆˆÎ¦+ Xâˆ†â€²âˆˆP <(z,b)
= XbâˆˆWaf
Â·(cid:16) Xâˆ†â€²â€²âˆˆP <(b,xtÎ»)

wt(b)<e(âˆ†â€²â€²)

2 (z,xtÎ»)qâ„“(xw0)

Xâˆ†âˆˆP <(z,xtÎ»)
qdeg(âˆ†â€²)(q âˆ’ 1)â„“(âˆ†â€²) XxâˆˆW

Î²kâ‰¤e(âˆ†) and b(âˆ†)=b

(âˆ’1)â„“

qdeg(âˆ†)(q âˆ’ 1)â„“(âˆ†)

âˆ

2 (z,xtÎ»)qâ„“(xw0)

âˆ†â€² satisï¬es (âˆ—âˆ—)
qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²) +

q

q âˆ’ 1

Xâˆ†â€²â€²â€²âˆˆP <(b,xtÎ»)

wt(b)â‰¤e(âˆ†â€²â€²â€²) and wt(b)âˆˆe(âˆ†â€²â€²â€²)

qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²)(cid:17).

equation

Now, let us write Î» = Pl
XxâˆˆW

2 (z,xtÎ»)qâ„“(xw0)

(âˆ’1)â„“

âˆ

Â·(cid:16) Xâˆ†â€²â€²âˆˆP <(b,xtÎ»)

wt(b)<e(âˆ†â€²â€²)

28

H. WATANABE AND S. NAITO

i=1 niÎ±âˆ¨

i âˆˆ Qâˆ¨

+, and set |Î»| = Pl

i=1 ni. We complete the proof by showing the

qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²) +

q

q âˆ’ 1

Xâˆ†â€²â€²â€²âˆˆP <(b,xtÎ»)

wt(b)â‰¤e(âˆ†â€²â€²â€²) and wt(b)âˆˆe(âˆ†â€²â€²â€²)

qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²)(cid:17) = 0

for all b âˆˆ Waf such that Î²k â‰¤ wt(b) âˆˆ Î¦+ by induction on |Î»|. When |Î»| = 1, then Î» is a simple coroot,
and hence either Î» âˆ’ wt(b) /âˆˆ Qâˆ¨
+ or Î» âˆ’ wt(b) = 0 holds for each b âˆˆ Waf such that Î²k â‰¤ wt(b) âˆˆ Î¦+. If
Î» âˆ’ wt(b) /âˆˆ Qâˆ¨
+, then the sum in the parentheses above is equal to 0 since P <(b, xtÎ») is empty. If Î» âˆ’ wt(b) = 0,
then we compute:

qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²) +

qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²) +

wt(b)â‰¤e(âˆ†â€²â€²â€²) and wt(b)âˆˆe(âˆ†â€²â€²â€²)

q

q âˆ’ 1 Xâˆ†â€²â€²â€²âˆˆP <(b,xtÎ»)
q âˆ’ 1 Xâˆ†â€²â€²â€²âˆˆP <(cl(b),x)

q

qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²)(cid:17)
qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²)(cid:17)

wt(b)â‰¤e(âˆ†â€²â€²â€²) and wt(b)âˆˆe(âˆ†â€²â€²â€²)

qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²) +

q

q âˆ’ 1 Xâˆ†â€²â€²â€²âˆˆP <(cl(b),x)

qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²)(cid:17)

wt(b)â‰¤e(âˆ†â€²â€²â€²) and wt(b)âˆˆe(âˆ†â€²â€²â€²)

âˆ

(âˆ’1)â„“

wt(b)<e(âˆ†â€²â€²)

2 (z,xtÎ»)qâ„“(xw0)(cid:16) Xâˆ†â€²â€²âˆˆP <(b,xtÎ»)
(âˆ’1)â„“(z,x)qâ„“(xw0)(cid:16) Xâˆ†â€²â€²âˆˆP <(cl(b),x)

XxâˆˆW
= XxâˆˆW
= (âˆ’1)â„“(z,cl(b)) XxâˆˆW

(âˆ’1)â„“(cl(b),x)qâ„“(xw0)

wt(b)<e(âˆ†â€²â€²)

Â·(cid:16) Xâˆ†â€²â€²âˆˆP <(cl(b),x)

wt(b)<e(âˆ†â€²â€²)

= 0 (by Proposition 4.3.4),

âˆ

(âˆ’1)â„“

2 (z,xtÎ»)qâ„“(xw0)(cid:16) Xâˆ†â€²â€²âˆˆP <(b,xtÎ»)

wt(b)<e(âˆ†â€²â€²)

âˆ

(âˆ’1)â„“

2 (z,xtÎ»)qâ„“(xw0)

XxâˆˆW
= XxâˆˆW

Â·(cid:16)

X

âˆ†â€²â€²âˆˆP <(cl(b),xtÎ»âˆ’wt(b))

wt(b)<e(âˆ†â€²â€²)

2 (z,xtÎ») = (âˆ’1)â„“(z,x)+2hÏ,Î»i = (âˆ’1)â„“(z,x), and the third equality follows
where the ï¬rst equality holds since (âˆ’1)â„“
from Proposition 4.3.4 applied to cl(b) âˆˆ W and wt(b) âˆˆ Î¦+ (note that we have cl(b) < cl(b)swt(b) by the
deï¬nitions of b and b(âˆ†)). This proves the desired equation when |Î»| = 1. When |Î»| â‰¥ 2, we compute:

âˆ

qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²) +

q

q âˆ’ 1 Xâˆ†â€²â€²â€²âˆˆP <(b,xtÎ»)

qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²)(cid:17)

wt(b)â‰¤e(âˆ†â€²â€²â€²) and wt(b)âˆˆe(âˆ†â€²â€²â€²)

qdeg(âˆ†â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²) +

q

q âˆ’ 1 X

âˆ†â€²â€²â€²âˆˆP <(cl(b),xtÎ»âˆ’wt(b))

wt(b)â‰¤e(âˆ†â€²â€²â€²) and wt(b)âˆˆe(âˆ†â€²â€²â€²)

qdeg(âˆ†â€²â€²â€²)(q âˆ’ 1)â„“(âˆ†â€²â€²â€²)(cid:17)

= 0 (by our induction hypothesis applied to |Î»| âˆ’ wt(b)).

This completes the proof of the proposition.

(cid:3)

5. Another description of Theorem 2.4.4

In the actual computation of periodic R-polynomials for which Theorem 2.4.4 is used, it is sometimes diï¬ƒcult
to determine whether or not a given path is an element of P <(y, w). Hence it would be convenient to describe
the paths in P <(y, w) in a diï¬€erent way. For this purpose, we introduce a new ï¬nite directed graph, which we
call the double Bruhat graph (DBG). The idea is to take the â€œï¬niteâ€ part of a path.

5.1. The double Bruhat graph.

Deï¬nition 5.1.1. The double Bruhat graph associated to a ï¬nite Weyl group W and a ï¬nite root system
Î¦ is the directed graph with vertex set W , in which two vertices yâ€² and wâ€² are joined by a labeled arrow
yâ€² dâˆ’â†’

wâ€² (Î² âˆˆ Î¦+, d âˆˆ Z>0) if and only if one of the following conditions holds:

Î²

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

29

(1) yâ€² < wâ€², wâ€² = yâ€²sÎ² and d = 1
(2) yâ€² > wâ€², wâ€² = yâ€²sÎ² and d = 1

2 (â„“(yâ€², wâ€²) + 1);
2 (â„“(yâ€², wâ€²) + 2hÏ, Î²âˆ¨i + 1).

An edge that satisfy condition (1) (resp., (2)) is called a Bruhat edge (resp., quantum edge).

Example 5.1.2. In type A2, the DBG is as follows.

s1s2

Î±1

w0

Î±1 + Î±2

2

s2

Î±1 + Î±2

Î±2

Î±2

2

Î±2

Î±1

s2s1

Î±1 + Î±2

2

Î±1

e

s1

The Bruhat edges and quantum edges are indicated by the ordinary arrows and dotted arrows, respectively;
the labels 1 are omitted.

Fix a reï¬‚ection order < on Î¦+. Let y, w âˆˆ Waf , and write them as y = cl(y)twt(y) and w = cl(w)twt(w).

Deï¬nition 5.1.3. A label-increasing double Bruhat path of length k from y to w with respect to the reï¬‚ection
d1âˆ’â†’
order < is a sequence âˆ† = (cl(y) = yâ€²
yâ€²
k = cl(w)) of directed edges in DBG such that Î²1 â‰¤ Â· Â· Â· â‰¤ Î²k
0
Î²1
Î²âˆ¨
i = wt(w) âˆ’ wt(y); we denote the length k of a path âˆ† by â„“(âˆ†). Let

Â· Â· Â· dkâˆ’â†’
Î²k

and Piâˆˆ{1,...,k | yâ€²

diâˆ’â†’
Î²i

iâˆ’1

yâ€²
i is quantum}

DBP<(y, w) denote the set of label-increasing double Bruhat paths from y to w.

Deï¬nition 5.1.4. Let âˆ† = (yâ€² = yâ€²
0

d1âˆ’â†’
Î²1

Â· Â· Â· dkâˆ’â†’
Î²k

k = wâ€²) âˆˆ DBP<(y, w).
yâ€²

(1) We set e(âˆ†) := {Î²i | i = 1, 2, . . . , k}; the cardinality of this set is denoted by â„“â€²(âˆ†), which does not

necessarily agree with k = â„“(âˆ†).

(2) The degree of âˆ† is deï¬ned to be the integer

deg(âˆ†) :=

di âˆ’ â„“â€²(âˆ†).

kXi=1

5.2. Another description.
Proposition 5.2.1. For each y, w âˆˆ Waf , there exists a bijection DBP<(y, w) â†’ P <(y, w), âˆ† 7â†’ Ëœâˆ†, such that
deg(âˆ†) = deg( Ëœâˆ†) and â„“â€²(âˆ†) = â„“( Ëœâˆ†).
Proof. Let âˆ† âˆˆ DBP<(y, w), and write it as:

âˆ† = (cl(y) = yâ€²
0

d0,1âˆ’âˆ’â†’
Î²1

yâ€²
0,1

d0,2âˆ’âˆ’â†’
Î²1

yâ€²
0,2

d0,3âˆ’âˆ’â†’
Î²1

Â· Â· Â·

d0,a1âˆ’âˆ’âˆ’â†’

Î²1

0,a1 = yâ€²
yâ€²

1

d1,1âˆ’âˆ’â†’
Î²2

yâ€²
1,1

d1,2âˆ’âˆ’â†’
Î²2

Â· Â· Â·

dkâˆ’1,ak
âˆ’âˆ’âˆ’âˆ’âˆ’â†’

Î²k

yâ€²
kâˆ’1,ak = yâ€²

k = cl(w)),

with Î²1 < Î²2 < Â· Â· Â· < Î²k. For each i = 1, . . . , k, we deï¬ne ui = cl(ui)twt(ui) âˆˆ Waf as follows:

u0 = y,

ui =(uiâˆ’1tmiÎ²âˆ¨

i

cl(uiâˆ’1)sÎ²i twt(uiâˆ’1)+miÎ²âˆ¨

i

(ai = 2mi),
(ai = 2mi Â± 1),

30

H. WATANABE AND S. NAITO

where mi is the number of quantum edges in the path yâ€²
then yâ€²
uiâˆ’1

iâˆ’1 âˆ’â†’ yâ€²
iâˆ’1,1 is a Bruhat edge, and if ai = 2mi âˆ’ 1 then, yâ€²

ui, and

iâˆ’1 âˆ’â†’ yâ€²
miâˆ’âˆ’â†’
Î²i

iâˆ’1,1 âˆ’â†’ Â· Â· Â· âˆ’â†’ yâ€²
iâˆ’1 âˆ’â†’ yâ€²

iâˆ’1,ai; note that if ai = 2mi + 1,
iâˆ’1,1 is a quantum edge. Then, we have

2 (uiâˆ’1, ui) âˆ’ 2(cid:1) + mi
2 (uiâˆ’1, ui) âˆ’ 1(cid:1) + mi
2 (uiâˆ’1, ui) âˆ’ 1(cid:1) + mi âˆ’ 1.

âˆ

(ai = 2mi),
(ai = 2mi + 1),
(ai = 2mi âˆ’ 1).

deg(uiâˆ’1

miâˆ’âˆ’â†’
Î²i

âˆ

âˆ

1

1

1

ui) =ï£±ï£´ï£²ï£´ï£³
2(cid:0)â„“
2(cid:0)â„“
2(cid:0)â„“
eâˆ† := (y = u0

iâˆ’1

diâˆ’1,1âˆ’âˆ’âˆ’âˆ’â†’

Î²i

Â· Â· Â·

diâˆ’1,ai
âˆ’âˆ’âˆ’âˆ’â†’

Î²i

u1

m1âˆ’âˆ’â†’
Î²1

m2âˆ’âˆ’â†’
Î²2

Â· Â· Â· mkâˆ’âˆ’â†’
Î²k

We now deï¬ne eâˆ† to be
It is easy to see that eâˆ† âˆˆ P <(y, w) and â„“â€²(âˆ†) = â„“(eâˆ†).
In order to show that deg(âˆ†) = deg(eâˆ†), we need to compare the contribution of yâ€²
yi to deg(eâˆ†). If ai = 2mi, then the former is
aiXj=1

i to deg(âˆ†) and that of yiâˆ’1

iâˆ’1,ai = yâ€²
yâ€²

diâˆ’1,j âˆ’ 1,

uk = w).

miâˆ’âˆ’â†’
Î²i

and the latter is

deg(uiâˆ’1

miâˆ’âˆ’â†’
Î²i

ui) =

1
2

â„“

âˆ

2 (uiâˆ’1, ui) + mi âˆ’ 1.

= hÏ, miÎ²âˆ¨

i i + mi âˆ’ 1.

Here, by the deï¬nition of DBP<(y, w), we have

diâˆ’1,jâˆ’1 + diâˆ’1,j = hÏ, Î²âˆ¨

i i + 1

for all j = 2, 4, . . . , ai. Therefore, we see that

aiXj=1

diâˆ’1,j âˆ’ 1 =

1
2

ai(hÏ, Î²âˆ¨

i i + 1) âˆ’ 1

= mi(hÏ, Î²âˆ¨
= mihÏ, Î²âˆ¨

i i + 1) âˆ’ 1
i i + mi âˆ’ 1.

If ai = 2mi + 1, then the former is

and the latter is

deg(uiâˆ’1

miâˆ’âˆ’â†’
Î²i

ui) =

=

=

âˆ

1

diâˆ’1,1 +

diâˆ’1,j âˆ’ 1,

aiXj=2
2 (uiâˆ’1, ui) âˆ’ 1(cid:1) + mi
2(cid:0)â„“
2(cid:0)â„“
2(cid:0)â„“(cl(uiâˆ’1), cl(uiâˆ’1)sÎ²i) + 1(cid:1) + hÏ, miÎ²âˆ¨

2 (uiâˆ’1, cl(uiâˆ’1)sÎ²itwt(uiâˆ’1)) + â„“

i i + mi âˆ’ 1.

1

1

âˆ

âˆ

= diâˆ’1,1 + mihÏ, Î²âˆ¨

2 (cl(uiâˆ’1)sÎ²itwt(uiâˆ’1), ui) âˆ’ 1(cid:1) + mi

i i âˆ’ 1 + mi

In a way similar to the case ai = 2mi, we deduce that

diâˆ’1,j = mihÏ, Î²âˆ¨

i i + mi.

aiXj=2

A COMBINATORIAL FORMULA EXPRESSING PERIODIC R-POLYNOMIALS

31

If ai = 2mi âˆ’ 1, then the former is

diâˆ’1,j âˆ’ 1,

and the latter is
miâˆ’âˆ’â†’
Î²i

deg(uiâˆ’1

ui) =

=

=

âˆ

1

diâˆ’1,1 +

aiXj=2
2 (uiâˆ’1, ui) âˆ’ 1(cid:1) + mi âˆ’ 1
2(cid:0)â„“
2(cid:0)â„“
2(cid:0)â„“(cl(uiâˆ’1), cl(uiâˆ’1)sÎ²i tÎ²âˆ¨

2 (uiâˆ’1, cl(uiâˆ’1)sÎ²i twt(uiâˆ’1+Î²âˆ¨

i i + mi âˆ’ 2.

1

1

âˆ

i

= diâˆ’1,1 + (mi âˆ’ 1)hÏ, Î²âˆ¨

i )) + â„“

âˆ

2 (cl(uiâˆ’1)sÎ²i twt(uiâˆ’1)+Î²âˆ¨

i

) + 1(cid:1) + hÏ, (mi âˆ’ 1)Î²âˆ¨

i i âˆ’ 1 + mi âˆ’ 1

, ui) âˆ’ 1(cid:1) + mi âˆ’ 1

In a way similar to the case ai = 2mi, we deduce that

diâˆ’1,j = (mi âˆ’ 1)hÏ, Î²âˆ¨

i i + mi âˆ’ 1.

aiXj=2

Thus, in all cases above, the equality deg(âˆ†) = deg(eâˆ†) holds.
The correspondence âˆ† 7â†’ eâˆ† is bijective. Indeed, its inverse is given as follows. Let eâˆ† = (y = u0

uk = w) âˆˆ P <(y, w). To each uiâˆ’1

ui, we assign a path

miâˆ’âˆ’â†’
Î²i

m1âˆ’âˆ’â†’
Î²1

Â· Â· Â· mkâˆ’âˆ’â†’
Î²k

where

(yâ€²

iâˆ’1

diâˆ’1,1âˆ’âˆ’âˆ’âˆ’â†’

Î²i

yâ€²
iâˆ’1,1

diâˆ’1,2âˆ’âˆ’âˆ’âˆ’â†’

Î²i

Â· Â· Â·

diâˆ’1,ai
âˆ’âˆ’âˆ’âˆ’â†’

Î²i

iâˆ’1,ai = yâ€²
yâ€²

i),

2mi

2mi + 1

2mi âˆ’ 1

ai =ï£±ï£´ï£´ï£´ï£²ï£´ï£´ï£´ï£³

yâ€²
iâˆ’1 = cl(uiâˆ’1),

iâˆ’1,j =(cl(uiâˆ’1)

cl(uiâˆ’1)sÎ²i

yâ€²

(uiâˆ’1

(uiâˆ’1

(uiâˆ’1

miâˆ’âˆ’â†’
Î²i
miâˆ’âˆ’â†’
Î²i
miâˆ’âˆ’â†’
Î²i

ui is a translation edge),

ui is a reï¬‚ection edge and cl(uiâˆ’1) < cl(uiâˆ’1)sÎ²i),

ui is a reï¬‚ection edge and cl(uiâˆ’1) > cl(uiâˆ’1)sÎ²i),

(j is even),
(j is odd).

By concatenating the paths above, we obtain a path âˆ† âˆˆ DBP<(y, w) such that deg(âˆ†) = deg(eâˆ†) and â„“â€²(âˆ†) =
â„“(eâˆ†). This completes the proof of the proposition.

Theorem 5.2.2. For each y, w âˆˆ Waf , we have

(cid:3)

Ry,w(q) = Xâˆ†âˆˆDBP<(y,w)

qdeg(âˆ†)(q âˆ’ 1)â„“â€²(âˆ†).

Proof. This follows from Theorem 2.4.4 and Lemma 5.2.1

(cid:3)

Example 5.2.3. In type A2, let y = e, w = w0tÎ±âˆ¨
as follows:

1 +Î±âˆ¨
2

, Î±1 < Î±1 + Î±2 < Î±2. The elements of DBP<(y, w) are

âˆ†1 = (e

2âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2

w0

1âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2

e

s2s1

âˆ†2 = (e 1âˆ’â†’
Î±1
âˆ†3 = (e 1âˆ’â†’
Î±1
âˆ†4 = (e 1âˆ’â†’
Î±1

s1

s1

s1

1âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2
1âˆ’â†’
Î±1
1âˆ’â†’
Î±1

e

2âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2

e 1âˆ’â†’
Î±1

s1

2âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2
2âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2

w0

1âˆ’â†’
Î±2
1âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2

w0),

s1

1âˆ’âˆ’âˆ’âˆ’â†’
Î±1+Î±2
1âˆ’â†’
Î±2
1âˆ’â†’
Î±2

s2s1

s2s1

s2s1

1âˆ’â†’
Î±2

w0),

w0),

w0

1âˆ’â†’
Î±2

s2s1

1âˆ’â†’
Î±2

w0).

32

H. WATANABE AND S. NAITO

In this case, we have

Therefore, we obtain

deg(âˆ†1) = 4,
deg(âˆ†2) = 3,
deg(âˆ†3) = 3,
deg(âˆ†4) = 4,

â„“â€²(âˆ†1) = 1,
â„“â€²(âˆ†2) = 3,
â„“â€²(âˆ†3) = 3,
â„“â€²(âˆ†4) = 3.

Re,w0tÎ±âˆ¨

1 +Î±âˆ¨
2

(q) = q4(q âˆ’ 1) + 2q3(q âˆ’ 1)3 + q4(q âˆ’ 1)3.

References

[AF] T. Arakawa and P. Fiebig, On the restricted Verma modules at the critical level, Trans. Amer. Math. Soc. 364 (2012), no. 9,

4683-4712.

[BeBe] A. Beilinson and J. Bernstein, Localisation de g-modules, C. R. Acad. Sci. Paris SÂ´er. I Math. 292 (1981), no. 1, 15-18.
[BjBr] A. BjÂ¨orner and F. Brenti, Combinatorics of Coxeter Groups, Graduate Texts in Mathematics vol. 231, Springer, New York,

2005.

[BK] J. L. Brylinski and M. Kashiwara, Kazhdan-Lusztig conjecture and holonomic systems, Invent. Math. 64 (1981), no. 3,

387-410.

[D] M. J. Dyer, Hecke algebras and shellings of Bruhat intervals, Compositio Math. 89 (1993), no. 1, 91-115.
[H1] J. Humphreys, Introduction to Lie Algebras and Representation Theory: second printing, revised edition, Graduate Texts in

Mathematics vol. 9, Springer-Verlag, New York-Berlin, 1978.

[H2] J. Humphreys, Reï¬‚ection Groups and Coxeter Groups, Cambridge Studies in Advanced Mathematics vol. 29, Cambridge

University Press, Cambridge, 1990.

[K] S. Kato, On the Kazhdan-Lusztig polynomials for aï¬ƒne Weyl groups, Adv. in Math. 55 (1985), no. 2, 103-130.
[KL] D. Kazhdan and G. Lusztig, Representations of Coxeter groups and Hecke algebras, Invent. Math. 53 (1979), no. 2, 165-184.
[L] G. Lusztig, Hecke algebras and Jantzenâ€™s generic decomposition patterns, Adv. in Math. 37 (1980), no. 2, 121-164.
[P] D. Peterson, Quantum Cohomology of G/P, Lecture Notes, Cambridge, MA, Massachusetts Institute of Technology, 1997.

(H. Watanabe) Department of Mathematics, Tokyo Institute of Technology, 2-12-1 Oh-okayama, Meguro-ku, Tokyo

152-8551, Japan

E-mail address: watanabe.h.at@m.titech.ac.jp

(S. Naito) Department of Mathematics, Tokyo Institute of Technology, 2-12-1 Oh-okayama, Meguro-ku, Tokyo

152-8551, Japan

E-mail address: naito@math.titech.ac.jp

