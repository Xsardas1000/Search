UNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

1

Dynamic Stackelberg User-in-the-Loop Repeated

Game for Device-to-Device Communications

Nicole Sawyer, Student Member, IEEE, and David Smith, Member, IEEE.

6
1
0
2

 
r
a

M
1

 

 
 
]
I

N
.
s
c
[
 
 

1
v
4
0
1
0
0

.

3
0
6
1
:
v
i
X
r
a

Abstract‚ÄîThis paper proposes a dynamic Stackelberg repeated
game for decentralized Device-to-Device (D2D) communications
overlaying cellular communications. The proposed game aims
to jointly optimize D2D user behavior via a user-in-the-loop
(UIL) approach; and minimize transmit power, while maximizing
packet delivery ratio (PDR) for all D2D users. The Stackelberg
game architecture consists of a single leader (base station - BS)
and multiple followers (D2D users), where the leader selects
its satisfaction with the social welfare of the D2D users by
considering the reaction of the followers from the charged price
it assigns. The followers on the other hand select transmit power
so as to guarantee a certain level of quality-of-experience (QoE)
for all players. We express D2D user behavior as: (i) low data
requirement; (ii) medium data requirement; and (iii) high data
requirement. Therefore, each type of data requirement is assigned
different utility functions due to the performance demands of
D2D users. Both the leader and followers aim to maximize their
utility function within the Stackelberg game. We prove that there
exists an overall Stackelberg Equilibrium for our proposed game
for all players, which is a sub-game perfect equilibrium, as
the equilibrium achieved at each stage is independent of the
game history. Our simulation results illustrate that once the
leader rapidly converges to an optimal outcome with respect
to satisfaction, the followers then rapidly converge to a Pareto-
efÔ¨Åcient outcome with respect to transmit power and PDR.

Keywords‚ÄîD2D communications, dynamic Stackelberg game,
power control, user-in-the-loop, quality-of-experience, Pareto-
optimality, Nash Equilibrium, wireless communications.

I.

INTRODUCTION

Device-to-Device (D2D) communications have been intro-
duced to cellular communications to help take the load off
the cellular network, by reducing the demand on the central
network operator, i.e., the base station (BS) [1]‚Äì[5]. Opti-
mization of D2D communications is important for optimal
mode selection, resource utilization, interference management,
power control, and spectral efÔ¨Åciency. Recently D2D user
behavior has been considered for Ô¨Åfth generation (5G) cellular
networks, using the user-in-the-loop (UIL) approach. UIL is
a closed loop system with feedback, which allows D2D users
to choose what their requirements are and whether they will
allow their behavior to be controlled/inÔ¨Çuenced [6]‚Äì[10], i.e.,
smart communications.

The authors are with NICTA (Data61), Canberra ACT 2601, Australia (e-
mail: Nicole.Sawyer, David.Smith@nicta.com.au). The authors are also with
The Australian National University.

NICTA is funded by the Australian Government through the Department of
Communications and the Australian Research Council through the ICT Centre
of Excellence Program.

Game theory is a decision making process, and allows
rational players (e.g., cellular and D2D users) to select their
action from an action set [11]. During the game, each player
aims to maximize their utility with respect to their action, to
Ô¨Ånd an optimal solution and/or equilibrium in the game [11],
[12]. Here we will focus on a non-cooperative game, with no
communication between players. There are several types of
games which can be used to optimize D2D communications,
such as non-cooperative power control games, Stackelberg
games, and auction-based games [11].

In this paper, we propose a dynamic Stackelberg game
for resource allocation in distributed D2D communications,
with D2D overlay to cellular users. The BS is the Stack-
elberg leader, where it determines a price to charge the
followers, such that it can optimally select its satisfaction of
the communication cell. The D2D users are the competing
Stackelberg followers accessing the same spectrum, who try
to optimally select transmit power while guaranteeing quality-
of-service (QoS) and quality-of-experience (QoE), with respect
to the satisfaction price set by the BS. Hence, the following
contributions are made:

1) Our dynamic Stackelberg repeated non-cooperative
game jointly optimizes user behavior at the application
layer and transmit power at the physical (PHY) layer,
to increase overall system capacity, QoS, and QoE for
each D2D user, as well as guaranteeing social welfare
across all D2D users.

2) We investigate D2D user behavior with respect to three
types of data requirements: (i) low; (ii) medium; (iii)
high. Each behavior group is assigned a different utility
function which suits the particular behavior and its
properties.

3) The performance metric packet delivery ratio (PDR) is
used to measure communication priority and reliability
for each D2D user. We show the effects of PDR on
our proposed game by setting different minimum PDR
targets for each level of data requirements, e.g., low
data requirement has a minimum target PDR of 0.90,
medium data requirement has a minimum target PDR of
0.94, and high data requirement has a minimum target
PDR of 0.98.

4) We show that our proposed game overall has a unique
Stackelberg Equilibrium, and it is a sub-game perfect
equilibrium at each stage in the game which is in-
dependent of the game history. The leader, i.e., the
BS, and followers, i.e., the D2D users, converge to
optimal outcomes. The leader‚Äôs satisfaction Ô¨Årst rapidly
converges to an optimal outcome, then the followers

UNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

2

rapidly converge to a Pareto-efÔ¨Åcient transmit power
and PDR outcome. The optimal outcome for the leader
in terms of satisfaction helps guarantee social welfare
across all D2D users.

The rest of this paper is organized as follows: In Section II,
we investigate related work to our proposed game. Section
III outlines the system model of our proposed game. In
Section IV we deÔ¨Åne our dynamic Stackelberg repeated game,
describe the leader‚Äôs utility function plus the three types of
utility functions for the followers, and investigate the cost
function assigned to the followers utility function. We prove
that there exists a unique Nash Equilibrium for the leader
and followers, resulting in a Stackelberg Equilibrium for our
proposed game. Simulation results for our proposed game are
outlined in Section V, where we compare our game results to
three different non-cooperative power control games. Finally,
concluding remarks are made in Section VI.

II. RELATED WORK

D2D communications can be implemented in licensed or
unlicensed spectrum. We study D2D communications in li-
censed spectrum (in-band), i.e. the cellular spectrum [1], [5],
[13], [14]. Depending on how D2D and cellular users share
the spectrum, D2D communications could introduce two-types
of interference within the network; inter-cell interference and
intra-cell interference. Inter-cell interference is the interference
generated between D2D and cellular users from other cells [1],
[11], [13], [15], where intra-cell interference is the interference
generated between cellular and D2D users within each cell
[1], [11], [13], [15]. Non-cooperative power control games
and other power control methods have been implemented in
D2D communications to help minimize transmit power and
mitigate interference, while guaranteeing QoS for all users, as
in [11], [16]‚Äì[18]. Stackelberg games have been implemented
for resource utilization, such as power control, interference
management, mode selection, and scheduling, as in [11], [19]‚Äì
[23].

OfÔ¨Çoading trafÔ¨Åc from the BS provides the following advan-
tages to the network: (i) the BS can accommodate more users
within the cell and increase system capacity and throughput
[5], [11], [24], [25]; (ii) increasing spectral efÔ¨Åciency of the
network [5], [11], [24], [25]; (iii) reduced latency for both
cellular and D2D users [5]; (iv) reducing the required power
consumption of the BS, cellular users, and D2D users [11],
[16]‚Äì[18], [24]. As a result, the BS will have more resources
to allocate to determining the cell layout, user locations within
the cell, priority, and type of communications.

The BS can also measure each D2D user‚Äôs satisfaction
within the cell [24], [26], in order to satisfy cell requirements.
Satisfaction of a D2D user can be measured by guaranteeing
either QoS [27], or QoE [6]. In [24], a user satisfaction based
resource allocation algorithm for D2D communications was
established, using an artiÔ¨Åcial Ô¨Åsh swarm approach. From
[24] the proposed approach provides improved average system
satisfaction and increased system throughput, as the number
of D2D pairs is increased. The BS can determine the social
welfare of the cell by summing all the D2D users satisfaction

[25], [28], where social welfare is a socially optimal outcome
for particular network users-of-interest [29], [30].

User-in-the-loop (UIL) is an approach which can be used
to enable, and measure, D2D user satisfaction. UIL aims to
aid user‚Äôs experience by reducing trafÔ¨Åc and delay within
the network. Within UIL users can choose what their behav-
ior/requirements are, and depending on their chosen behavior
incentives or penalties may be charged to users, while ensuring
users maintain a certain level of QoE [8], [9]. Depending on
the D2D user‚Äôs chosen behavior, the incentives provided to
the user may consist of postponing their non-urgent message to
another time when there is less trafÔ¨Åc, or moving to a different
location where there is less trafÔ¨Åc [7], [8]. On the other hand,
the penalties provided to the user may consist of charging the
user a cost, if they did not wish to postpone their message
or move to a different location [7], [8]. Considering user be-
havior within the network, overall network spectral efÔ¨Åciency
can be increased, along with QoE for each D2D user [6].
Jointly optimizing user behavior and resource utilization is an
important research problem that needs to be addressed for D2D
communications, as outlined in [31]. Such joint optimization,
as will be outlined in this paper, can lead to signiÔ¨Åcantly
improved user experience and require less user input, while
optimizing communication parameters that increase network
efÔ¨Åciency.

III. SYSTEM MODEL

We implement our proposed game in a single cell for a
future Ô¨Åfth generation (5G) cellular network, where D2D com-
munications overlay the cellular network. Future 5G cellular
networks will supersede Long Term Evolution - Advanced
(LTE-A) cellular networks where some forms of D2D com-
munications can already be deployed. Within the cell there
exists one base station (BS), one channel, one cellular user,
and N D2D users, {d1,d2,. . . ,dN}, as illustrated in Fig. 1.
This simpliÔ¨Åed scenario can be applied to a more general case
with many cellular and D2D users. For two D2D users to

Fig. 1. System topology of the dynamic Stackelberg repeated game.

Base Station (BS)Cellular or D2D UserD2D Pair ‚ÄìDedicated Modec1d1d2d3d4d5d6d7d8d9d10Communication FlowUNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

3

there exists N

communicate to one another, both users must be within the
maximum transmission range, creating a D2D (transmitter-
receiver) pair. Within the cell
2 D2D pairs.
As D2D communications is implemented as an overlay to
cellular communications, cellular and D2D users transmit in
orthogonal spectrum, hence eliminating interference between
the particular cellular user and D2D users, as D2D users
operate on dedicated spectrum [11], [13]‚Äì[15]. (Importantly,
the D2D users can still cause signiÔ¨Åcant radio interference
to each other, i.e. non-paired D2D transmitters act as hidden
terminals to D2D pairs within the cell). Additionally, here we
consider a single cell scenario, so inter-cell interference is not
considered.

The cell has been allocated one channel, which is divided
into K orthogonal subchannels as in [13], [14] [18], [20],
[23], where the BS allocates part of the uplink spectrum
from cellular users to D2D users, and the left-over spectrum
can be utilized by the cellular user. The D2D users will
compete against one another for the spectrum without causing
interference to the cellular user due to the overlay scenario.
Due to the spectrum allocation by the BS, both users within a
D2D pair cannot transmit at the same time, as this would result
in large self-interference [32]. To determine which D2D user
transmits within the D2D pair, we have assigned D2D users
with an odd index to transmit in odd time slots, and D2D users
with an even index to transmit in even time slots.

Depending on spectrum allocation by the BS, interference
between D2D pairs may be large. The interference received at
a D2D receiver, is the sum of the non-paired D2D transmitters
sharing the same subchannel. To guarantee QoS to D2D and
cellular users, we place a threshold on Signal-to-Interference-
plus-Noise Ratio (SINR), to help ensure signal quality. The
SINR at the receiver for the i-th D2D pair using part of the
k-th subchannel at time slot t is given by,

Œ≥di,k(t) =

(cid:80) N

2
j=1
j(cid:54)=i

pdi,k(t)|g(di,di(cid:48)),k|2
pdj,k(t)|g(dj,di(cid:48)),k|2 + N0,d
Œ≥di,k ‚â• ¬ØŒ≥d,

,

(1)

(2)

where pdi,k(t) is transmit power of the i-th D2D user in sub-
channel k at time t; pdj,k(t) is the interfering transmit power of
the j-th D2D user, who is sharing the same subchannel as the
i-th D2D user; g(di,di(cid:48)),k is the channel gain between a D2D
pair, di and di(cid:48), in subchannel k; g(dj,di(cid:48)),k is the interfering
channel gain between the i-th D2D pair receiver and j-th D2D
transmitter, in subchannel k; N0,d is the noise power for D2D
users; ¬ØŒ≥d is the target SINR for D2D users.

The SINR for the i-th cellular user using subchannel k at

time t is given by,

Œ≥ci,k(t) =

pci,k(t)|g(ci,BS),k|2

N0,c
Œ≥ci,k ‚â• ¬ØŒ≥c,

,

(3)

(4)

where pci,k(t) is transmit power of the i-th cellular user in
subchannel k at time t; g(ci,BS),k is the channel gain between

Fig. 2. Comparing simulation and approximation results for PDR vs SINR.

TABLE I.

ESTIMATED PARAMETERS, ac AND bc, FROM (5)

Modulation
QPSK
16-QAM
64-QAM

Coding Gain
13.75 dB
15.75 dB
17 dB

ac
2.331
1.383
0.762

bc
6.355
6.565
7.014

a
-0.0001
-0.0014
-0.2669

b
-6.22
-6.88
-7.021

the cellular user and the BS, in subchannel k; N0,c is the
noise power for the cellular user; ¬ØŒ≥c is the target SINR for the
cellular user, to ensure signal quality.

A. Performance Metric - Packet Delivery Ratio

The performance metric PDR, is a compressed exponential

function of inverse SINR [33], as follows,

(cid:18)

‚àí

(cid:18) 1

Œ≥iac

(cid:19)bc(cid:19)

,

pdri = exp

(5)

pdri = exp(cid:0)aŒ≥b

(cid:1),

where Œ≥i is the SINR of the i-th user; ac and bc are constants
which depend on packet size, type of modulation, and coding
scheme. We can rearrange (5) into a simpler form as follows,

(6)
)bc; and b = ‚àíbc. We use PDR to help
where a = ‚àí( 1
determine reliability of a signal and measure communication
priority.

ac

i

No

According to the 3GPP standards, the modulation schemes
employed are QPSK, 16-QAM, and 64-QAM, with a turbo
code rate 1/3 [34]. We are able to solve Bit Error Rate (BER)

(cid:1) for the three modulations, with

with respect to SINR (cid:0) Eb

no coding and with coding for the same packet length of
1024 bytes. Due to the turbo code rate 1/3, this introduces
a coding gain to the uncoded modulation schemes, which
are, 13.75 dB for QPSK, 15.75 dB for 16-QAM, and 17 dB
for 64-QAM. Fig. 2 compares simulated PDR results to an
approximation of PDR. The PDR approximation, approximates
the constants ac and bc by taking the minimum error margin
between the simulated PDR and approximated PDR. We see
that this approximation result is very close to the simulation.
Table I outlines the approximated values for ac and bc, for all
three modulations, with the same packet length of 1024 bytes.

Eb/No(dB)-20-15-10-505101520PDR00.10.20.30.40.50.60.70.80.91QPSKCodedPDRSimulationQPSKCodedPDRApproximation16-QAMCodedPDRSimulation16-QAMCodedPDRApproximation64-QAMCodedPDRSimulation64-QAMCodedPDRApproximationUNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

4

IV. DYNAMIC STACKELBERG USER-IN-THE-LOOP GAME

We propose a dynamic Stackelberg user-in-the-loop (S-
UIL) repeated game, which is Ô¨Ånitely repeated for T times,
0 ‚â§ t ‚â§ T , where T < ‚àû. The S-UIL game consists of a
single leader and multiple followers. Where the leader of the
game is the BS and the D2D users are the followers, as outlined
in Fig. 3. The BS aims to gain optimal satisfaction within the
cell, with respect to the D2D users. Initially, the BS has little
satisfaction and knowledge about the cell and the D2D users.
Thus, the BS assigns a satisfaction price to the D2D users to
gain more information. The satisfaction price assigned to the
D2D users, must be reasonable, such that appropriate levels of
interference and transmit power are maintained by D2D users.
D2D users on the other hand behave selÔ¨Åshly with respect to
each other and the BS. The followers of the proposed game
have imperfect information, which means that all followers
select their action simultaneously. The followers individual
strategy is to minimize their transmit power within the transmit
power range, pmin ‚â§ pi ‚â§ pmax. When a follower selects it‚Äôs
action, there are two factors which must be considered: the
satisfaction price set by the BS; and the aim to maximize their
own utility function. Our proposed game is a sequential game,
which is evident in Fig. 3, thus the leader Ô¨Årst solves its utility
function and assigns a price to the followers, the followers
then solve their utility functions and share their measured
performance to the BS, such that it can update its satisfaction,
for the next iteration in the game.

D2D users must also guarantee QoE by providing users with
three types of behavior to choose from, which are outlined as
follows,

(i)
(ii)
(iii)

Low Data Requirement;
Medium Data Requirement;
High Data Requirement.

These three levels of behavior are quite broad and thus
address all types of practical applications for D2D users, which
include: local voice calls; SMS (Short Message Service); local

security and safety; MMS (Multimedia Messaging Service);
video calls; video sharing; gaming; uploading and download-
ing. Each kind of data requirement has its own utility function,
due to the different demands/conditions required for each
behavior with respect to transmit power and PDR. Initially,
D2D users sort themselves into one of the behavior groups
(as in Fig. 3), according to the type of data requirement and
practical applications the user requires. Once D2D users have
assigned themselves to a behavior group, they cannot change
behaviors during the Ô¨Ånite stages of the repeated game, as
their actions are deterministic and thus the D2D users have
pure strategies. For a fair comparison between the different
behaviors, we ensure that there is an even number of D2D
transmitters (from the D2D pairs) in each of the behavior
groups. Since we consider only one of the D2D users within
the pair transmitting, hence the receiver from the D2D pair
can either lie within the same behavior group or another.

A. Leader Utility Function Analysis

The leader aims to obtain optimal satisfaction within the
cell with respect to the D2D users, by maximizing its utility
function with respect to satisfaction. The action set of the
leader is a Ô¨Ånite set, where it measures its satisfaction as a
percentage, i.e. x ‚àà (0, 1]. Satisfaction of 0% means that the
BS has no satisfaction within the cell, and satisfaction of 100%
means that the BS has total satisfaction within the cell. We
have disregarded the case where the BS has no satisfaction,
i.e. 0%, as in a real world scenario the BS would have some
general information about the cell.

The utility function for the leader of the dynamic Stack-
elberg UIL repeated game is an arbitrary quadratic function,
chosen for its particular and simple properties. The leader‚Äôs
utility function is a function of satisfaction (x) and average
measured performance of the followers (i.e. average transmit
power, ¬Øp), UBS(x, ¬Øp). The leader reacts to the average mea-
sured performance of the followers by updating its satisfaction
with the cell accordingly. The utility function for the leader
(BS) is as follows,

UBS(x, ¬Øp) = ‚àíŒ±x2 + Œ≤x + Œ∫,

(7)

(cid:80)N/2

i=1 pi(t‚àí1)

,

Œ± = ¬Øp =

N/2

Œ≤ = 2Œ±x ln(t),
Œ∫ = Œ∫c ln(t),

where Œ± is the average measured performance of all
the
followers; pi(t‚àí1) is the followers transmit power from the
previous time slot; t is the iteration/time step of each stage in
the proposed game, t ‚àà [0, T ]; Œ∫c is a positive scalar, Œ∫c > 0;
x is the satisfaction of the leader. At the end of each iteration
in the proposed game the leader maximizes its utility function
(7), with respect to the leader‚Äôs satisfaction, to Ô¨Ånd the best
satisfaction for the BS, as given by,

maximize
UBS(x, ¬Øp)
subject to x ‚àà (0, 1].

x

Fig. 3. Dynamic Stackelberg UIL repeated game architecture.

Leader: Base Station (BS);Action: BS Satisfaction, ùë•‚àà0,1;Leader Utility FunctionUnique Solution:ùë•‚ãÜ=ùõΩ2ùõºFollowers: D2D Users;Action: Transmit Power Range, ùëùùëñùëöùëñùëõ‚â§ùëùùëñ‚â§ùëùùëñùëöùëéùë•;Low Data Requirement UtilityMedium Data Requirement UtilityHigh Data Requirement UtilityUnique Solution: ùëù= ùëñ=1ùëÅ/2ùëùùëñùëÅ/2Follower Utility Functions:LowFollowers Select BehaviorGroups:MediumHighUNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

5

B. Followers Utility Function Analysis

The followers play a non-cooperative power control game
taking into account the leader‚Äôs satisfaction price. The fol-
lowers aim to minimize their transmit power while reducing
interference, resulting in a power efÔ¨Åcient network. The action
set implemented for the followers is a Ô¨Ånite set and is bounded
by a minimum transmit power and maximum transmit power,
pmin ‚â§ pi ‚â§ pmax. The followers further consider QoE
and initially select a behavior which best suits their data
requirements and practical applications. The three types of data
requirements considered in our proposed game, are assigned
different utility functions. Sections IV-B1, IV-B2, and IV-B3,
introduce the three types of data requirements, by explaining
their practical applications and corresponding utility functions.
1) Low Data Requirement Utility Function: D2D users who
select low data requirement as their behavior, may perform one
of the following practical applications: local voice call1; SMS;
local security and safety communications2 [5], [31]. The utility
function for D2D users with low data requirement behavior,
has been taken from [36], UF L,i(x, pi). This utility function
is an SINR-balancing function and is modiÔ¨Åed to include the
cost function charged to the followers. This type of utility
function was selected for this behavior as it gives improved
emphasis on transmit power and less emphasis on PDR,
while still maintaining minimum target PDR. The practical
application for this behavior requires low transmit power and
quality compared to the other two types of behaviors, as the
information being transmitted is much simpler. Hence, the
utility function for low data requirement is deÔ¨Åned as follows,

UF L,i(x, pi) =

,

(8)

(cid:19)

(cid:18) ¬ØŒ≥d
(cid:123)(cid:122)
(cid:124)

Œ≥di,k

D2D User‚Äôs
Measured
Performance

‚àí C(x, pi)

(cid:124) (cid:123)(cid:122) (cid:125)

Cost Function

pi

(cid:125)

where pi is transmit power for the i-th D2D user at time t;
¬ØŒ≥d is target SINR for D2D users, which is set by target PDR;
Œ≥di,k is SINR for the i-th D2D user using the k-th subchannel,
at time t; C(x, pi) is the cost function which is analyzed in
Section IV-C. At the end of each iteration in the proposed
game, the follower‚Äôs utility function (8) is maximized, to Ô¨Ånd
optimal transmit power and PDR for all users with this type
of behavior,

maximize

pi

UF L,i(x, pi) ‚àÄi ‚àà N

subject to [pmin, pmax]mW.

2) Medium Data Requirement Utility Function: D2D users
whose behavior type is medium data requirement, may be
performing one of the following practical applications: MMS;
video calling; video sharing; gaming [5], [31]. The utility func-
tion for medium data requirement is taken from [36], where the

1It is believed that in the Ô¨Åfth generation (5G) cellular network and future
networks, voice calls will be sent via packets instead of bits, and possibly
referred to as VoLTE (Voice-over-LTE) [35].

2Local security and safety communications would be utilized in a scenario
where local coordination and communication between neighboring police
ofÔ¨Åcers, Ô¨Åreman, and ambulance ofÔ¨Åcers would be necessary.

utility function was originally a cost function. By taking the
negative of the cost function from [36], we transform it into a
utility function, UF M,i(x, pi), and include the cost function
charged to the followers. We have assigned the following
utility function to this behavior, as it gives approximately
equal emphasis to transmit power and PDR. The practical
application for this behavior requires complex communication,
which means a slightly higher demand for transmit power, as
opposed to the low data requirement behavior, to ensure good
signal quality at the receiver without larger latency periods.
The utility function for medium data requirement for any
player, is given by,

(cid:124)

(cid:0)¬ØŒ≥d ‚àí Œ≥di,k
(cid:123)(cid:122)

(cid:1)2
(cid:125)

D2D User‚Äôs

Measured Performance

‚àí C(x, pi)

(cid:124) (cid:123)(cid:122) (cid:125)

Cost Function

,

(9)

UF M,i(x, pi) = ‚àíbipi ‚àí ci

where pi is transmit power for the i-th D2D user at time t;
Œ≥di,k is SINR for the i-th D2D user using the k-th subchannel,
at time t; bi > 0 and ci > 0 are positive scalars; C(x, pi) is the
cost function, which is analyzed in Section IV-C. At the end
of each iteration in the proposed game, the follower‚Äôs utility
function (9) is maximized, to Ô¨Ånd optimal transmit power and
PDR for all users with medium data requirement behavior,

maximize

pi

UF M,i(x, pi, ) ‚àÄi ‚àà N

subject to [pmin, pmax]mW.

3) High Data Requirement Utility Function: High data
requirement behavior for D2D users, may be performing one of
the following practical applications: uploading; downloading
[5], [31]. The utility function for high data requirement is taken
from [29], where the utility function is a function of transmit
power and PDR, UF H,i(x, pi). We modify the utility function
from [29] to include cost function. This utility function has
been assigned to this behavior as it gives larger emphasis on
PDR and less emphasis on transmit power. Users implementing
this behavior would require signiÔ¨Åcantly higher transmit power
than the other two behaviors, due to, e.g., uploading and
downloading of large content, and general higher throughput
requirements. Due to the greater emphasis on higher PDR, this
means that signal quality is ensured, communication reliability
is guaranteed, and content is fully uploaded/downloaded in a
reasonable timeframe without any signiÔ¨Åcant latency concerns.
The utility function for the high data requirement behavior, is
given by,

UF H,i(x, pi) = ‚àípwi

(cid:124)

(cid:123)(cid:122)
i ‚àí di
pdrvi
i

(cid:125)

D2D User‚Äôs

Measured Performance

‚àí C(x, pi)

(cid:124) (cid:123)(cid:122) (cid:125)

Cost Function

,

(10)

where pi is transmit power for the i-th D2D user at time t; pdri
is PDR for the i-th D2D user at time t; di > 0 is a positive
scalar; wi > 0 and vi > 0 are positive exponents; C(x, pi)
is the cost function, which is analyzed in Section IV-C. At
the end of each iteration in the proposed game, the follower‚Äôs
utility function (10) is maximized, to Ô¨Ånd optimal transmit
power and PDR for all users with this type of behavior,

UNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

6

maximize

pi

UF H,i(x, pi) ‚àÄi ‚àà N

subject to [pmin, pmax]mW.

C. Followers Cost Function

The three utility functions for the followers, (8), (9), (10),
are assigned a cost function. The aim of the cost function is
to charge the followers for using the dedicated spectrum. The
cost function we have created for the followers considers both
the leader‚Äôs satisfaction and the individual follower‚Äôs transmit
power. The cost function is given by,

(cid:18) ‚àÜ

(cid:19)(cid:18)

C(x, pi) =

ln(q ‚àí x)

1

ln(y ‚àí pi
z )

(11)

(cid:19)

.

Equation (11) logarithmically combines the leader‚Äôs satisfac-
tion x and the follower‚Äôs individual transmit power pi. As
a result,
the followers utility functions will decrease with
increasing cost.
DeÔ¨Ånition 1. The pair of strategies for the leader and follow-
ers A‚àó = [x, pi] = [(x(cid:63), p(cid:63)
N/2)] for the
BS and every D2D pair i ‚àà N
2 , is a Stackelberg Equilibrium
in the proposed repeated game, if the following is satisÔ¨Åed:
1) The leader Ô¨Årst achieves a unique Nash Equilibrium:

2), . . . , (x(cid:63), p(cid:63)

1), (x(cid:63), p(cid:63)

UBS([x(cid:63), ¬Øp]) ‚â• UBS([x, ¬Øp])
for all x.

2) The followers then achieve a unique Nash Equilibrium

thereafter:

i ], [x(cid:63), p(cid:63)‚àíi]) ‚â• UF,i([x, pi], [x(cid:63), p(cid:63)‚àíi])

UF,i([x(cid:63), p(cid:63)
for all pi ‚àà p, for all x and for all i ‚àà N

2

Remark 1. Once the leader achieves a unique Nash Equilib-
rium, the followers will then achieve a unique Nash Equilib-
rium thereafter, resulting in a Stackelberg Equilibrium.
Proposition 1. The Stackelberg Equilibrium,
the best
response for the leader and all the followers, exists over all
stages of the game. Furthermore it is sub-game perfect as it
is independent of the game history (previous stages).

i.e.,

From DeÔ¨Ånition 1 we prove that there exists a Stackelberg
Equilibrium for the proposed game, across all players, in the
following two proofs.

Proof: To prove that

the leader has a unique Nash
Equilibrium, we have to test if its utility function (7), is strictly
continuous and concave. To show strict continuity, this can be
‚àÇx = 0,
done by solving the Ô¨Årst order derivative condition, ‚àÇUBS

‚àÇUBS(¬∑)
‚àÇUBS(¬∑)

‚àÇx

‚àÇx

= ‚àí2Œ±x + Œ≤,

= 0,

‚à¥ x(cid:63) =

Œ≤
2Œ±

.

(12)

(13)

From (12) we can see that (7) is a continuous function within
(xmin, xmax]. We are also able to solve for a unique solution
for the leader‚Äôs satisfaction (13), which is always maximum.
We input x(cid:63) into the follower‚Äôs utility functions, which is a
unique solution for x. Next, to show that the utility function
(7) is strictly concave, we solve the second order derivative
condition, ‚àÇ2UBS

‚àÇx2 < 0,

‚àÇ2UBS(¬∑)
‚àÇ2UBS(¬∑)

‚àÇx2

‚àÇx2

= ‚àí2Œ±,

< 0.

(14)

Equation (14) proves that the leader‚Äôs utility function (7) is
strictly concave, due to Œ± > 0.

Proof: More particularly we prove that the three utility
functions for the followers (8), (9), (10) have a unique Nash
Equilibrium. To determine if the functions are strictly con-
tinuous, we must solve the Ô¨Årst order derivative condition,
‚àÇUF,i
‚àÇpi
(i) Low Data Requirement:

= 0.

= ‚àíA,

= 0,

‚àÇUF L,i

‚àÇUF L,i

‚àÇpi

‚àÇpi

(cid:19)(cid:18)

(cid:18)

(cid:19)

.

where A =
z(y‚àí pi
(ii) Medium Data Requirement:

ln(q‚àíx)

‚àÜ

1

z )(ln(y‚àí pi

z ))2

2ciŒ≥i(Œ≥tgt ‚àí Œ≥i)

pi

‚àí A,

‚àÇUF M,i

‚àÇpi

‚àÇUF M,i

‚àÇpi

= ‚àíbi +

= 0.

(iii) High Data Requirement:
= ‚àíwipwi‚àí1

‚àÇUF H,i

i

‚àÇpi

+

diviabŒ≥b
i p
pdrvi
i

‚àí1
i

‚àí A,

‚àÇUF H,i

‚àÇpi

= 0.

(15)

(16)

(17)

From (15), (16) and (17) we can see that
the follower‚Äôs
utility functions are continuous within the range [pmin, pmax].
If we substitute x(cid:63) for x from (13), each follower‚Äôs utility
function will have a unique solution for transmit power, p(cid:63)
i ,
which maximizes their utility function. We take an average
of all
the player‚Äôs unique solutions producing an average
unique solution, ¬Øp, which is in equilibrium and input to the
leader‚Äôs utility function (7). Therefore, the Nash Equilibrium
is a hierarchial equilibrium, as the leader Ô¨Årst achieves a
Nash Equilibrium and the followers achieve Nash Equilibrium
thereafter. Next, to show that the followers utility functions
are strictly concave, we solve the second order derivative
condition, ‚àÇ2UF (cid:63)
‚àÇp2
i
(i) Low Data Requirement:

< 0.

‚àÇ2UF L,i

‚àÇp2
i

‚àÇ2UF L,i

‚àÇp2
i

= ‚àí B,

<0,

(18)

(cid:18)

(cid:19)(cid:18)

(cid:19)

UNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

.

‚àÜ

z ))2

z2(y‚àí pi

2
ln(y‚àí pi
z )+1

z )2 ln(q‚àíx)(ln(y‚àí pi

where B =
For (18) to satisfy the second order derivative condition,
B > 0. We know that x and pi are always positive, thus the
constants must satisfy the following conditions; ‚àÜ > 0, q > 0,
y > 0, and z > 0.
(ii) Medium Data Requirement:
= ‚àí 2ci

(cid:18) Œ≥2

‚àÇ2UF M,i

‚àí B,

(cid:19)

‚àÇp2
i

‚àÇ2UF M,i

i
p2
i

(19)

<0,

‚àÇp2
i

(cid:0) Œ≥2

(cid:1) > 0 and B > 0 to satisfy the second

where 2ci
order derivative condition. We know that x, pi, and Œ≥i are
always positive, thus the constants must satisfy the following
conditions; ci > 0, ‚àÜ > 0, q > 0, y > 0, and z > 0.
(iii) High Data Requirement:

i
p2
i

7

Algorithm 1 Dynamic Stackelberg User-in-the-Loop Repeated
Game
1: Initialize all variables for the leader and followers.
2: At t = 0 the leader selects initial satisfaction, x = 0.001 from

x = 0.001, . . . , 1.

3: At t = 0 followers select initial transmit power from power

vector, p = 0, 0.1, 0.2, . . . , 23 dBm.

4: Sort D2D transmitters into one of the three behavior groups;
5: Play S-UIL Game:
6: loop for T times.
7: Calculate the leader‚Äôs utility parameters;

Œ± = ¬Øp(t‚àí1);

Œ≤ = 2Œ±x(t‚àí1) ln(t); Œ∫ = Œ∫c ln(t);

8: Calculate leader‚Äôs optimal satisfaction:

UBS = ‚àíŒ±x2 + Œ≤x + Œ∫;
(UBS);

q = arg max

x

x(cid:63)
(t) = x(q).

(cid:19)

abdiviŒ≥b
i
i (pdrvi
p2
i )
‚àí B,

(20)

9: Assign the satisfaction price, x(cid:63)
10: Calculate Œ≥i and Œ≥i for all cellular and D2D users;
11: Calculate the follower‚Äôs utility for all

(t), to each of the follower‚Äôs utility;

the different behavior

groups:

= ‚àí wi(wi ‚àí 1)pwi‚àí2

+

i

(‚àí1 + b) ‚àí abviŒ≥b

i

(cid:18)

‚àÇ2UF H,i

‚àÇp2
i

√ó

‚àÇ2UF H,i

‚àÇp2
i

<0.

We can split (20) into three sections, the Ô¨Årst and third sections
will always be negative, if the constants satisfy the following
conditions; wi ‚â• 1, ‚àÜ > 0, q > 0, y > 0, and z > 0. We know
that x, pi, Œ≥i, and pdri are always positive, hence, in order
for the second part of (20) to satisfy the overall second order
derivative condition of concavity, the constants must satisfy
the following conditions; a < 0, b < 0, di > 0, and vi > 0. In
appendix A, we also prove that the follower‚Äôs utility functions
(8), (9), (10) are strictly concave and continuous with respect
to the leader‚Äôs satisfaction.
Remark 2. For the game to have a Pareto-efÔ¨Åcient outcome,
the leader must Ô¨Årst converge to an optimal outcome, then
the followers will converge to an Pareto-optimal outcome
thereafter.
Remark 3. When the leader has maximized satisfaction, which
includes knowledge of an efÔ¨Åcient outcome from the followers,
it is an optimal outcome for the leader that guarantees social
welfare across all the followers.
Proposition 2. The game is Pareto-efÔ¨Åcient as the leader‚Äôs
satisfaction is maximized and then all
followers transmit
powers are minimized, while achieving desired packet delivery
ratio (PDR), in our dynamic Stackelberg repeated game.

Proof: A Pareto-efÔ¨Åcient outcome is fully deÔ¨Åned over the
entire game, according to Algorithm 1. The leader Ô¨Årst obtains
an efÔ¨Åcient outcome with respect
then the
followers converge to a Pareto-efÔ¨Åcient outcome with respect
to transmit power and PDR, such that the game achieves an
overall Pareto-optimal outcome. When the BS‚Äôs satisfaction,
x, is maximized the desired outcome in terms of satisfaction
is achieved. Hence, each D2D transmitter, i, will minimize its
transmit power with respect to all other transmitters, ‚àíi, until

to satisfaction,

¬ØŒ≥d

)pi(t‚àí1) ‚àí C(x, pi);

Œ≥i(t‚àí1)

UF L,i = (
UF M,i = ‚àíbip ‚àí ci(¬ØŒ≥d ‚àí Œ≥i)2 ‚àí C(x, pi);
UF H,i = ‚àípwi ‚àí di
pdrvi
i

‚àí C(x, pi);

(cid:18)

(cid:19)(cid:18)

(cid:19)

;

where C(x, pi) =

‚àÜ

ln(q‚àíx(cid:63)

)

(t)

1

ln(y‚àí pi(t‚àí1)

)

z

12: Calculate the follower‚Äôs optimal transmit power, depending on

the selected behavior group:

li = arg max

(UF L,i);

pi

mi = arg max

(UF M,i);

hi = arg max

(UF H,i);

pi

(cid:80)N/2

pi
i=1 pi(t)
N/2

;

¬Øp(t) =

pi(t) = p(li);

pi(t) = p(mi);

pi(t) = p(hi);

13: Assign the measured performance of the D2D users, ¬Øp(t), to the

leader‚Äôs utility for the next time step;

14: end loop when t = T.
15: Output: x(cid:63),pi;

no transmitter can further decrease its transmit power over T
stages, and at the same time desired PDR is achieved for each
D2D-pair follower.

V. SIMULATION RESULTS

In this section, we outline the simulation results of our
proposed game from Algorithm 1. We compare the three levels
of data quality with respect to transmit power and PDR. We
also look at the effect of the leader‚Äôs satisfaction price and
the cost function, on D2D users. The results of our dynamic
Stackelberg user-in-the-loop game are compared to three non-

UNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

8

cooperative power control games. All simulation values are
outlined in Table II.

A. Channel Model

The channel model has been taken from [33], and modiÔ¨Åed
to suit
is
calculated based on a path loss model and small-scale fading
(i.e. Rayleigh fading), as follows,

the UMTS standards [37]. The channel model

(cid:19) œï

2

(cid:18) d0

di,i(cid:48)

gdi,di(cid:48) = AP LASSF

,

(21)

where AP L is the free space path loss channel attenuation;
ASSF is the small-scale fading (i.e. Rayleigh fading) channel
attenuation, calculated using jakes model; d0 is the reference
distance between users; di,i(cid:48) is the distance between the i-th
transmitter and the i(cid:48)-th receiver; œï is the path loss exponent.

B. Game Results

Algorithm 1 was implemented over, T = 100, stages and
repeated, RP T = 400, times. We set a minimum target PDR
of 0.9 for all levels of behavior, which results in a target SINR
of 0.534, using the modulation scheme 16-QAM with 1/3
rate turbo code. In Fig. 4, we look at the leader‚Äôs satisfaction
within the cell, with respect to whether the D2D users consider

TABLE II.

SIMULATION PARAMETERS AND VALUES

Parameter
Cell Radius (R)
Maximum Distance between D2D Pairs
Carrier Frequency
BS Per Cell
D2D Users Per Cell N
Reference D2D Distance (d0)
AP L
Doppler Spread (fDTs)
Path Loss Exponent for D2D users œï
D2D Transmit Power Range
Cellular User Constant Transmit Power
D2D User Noise Power (N0)

Value
500 m
50 m
2 GHz
1
48
20 m
10‚àí3.22
0.01
4
0-23 dBm
14 dBm
‚àí99.21 dBm

Fig. 4. Leader‚Äôs satisfaction evolving throughout our proposed game, with
and without priority. Leader‚Äôs utility function (7) constant: Œ∫c = 4.

priority or not. Our dynamic Stackelberg user-in-the-loop (S-
UIL) game maximizes the BS‚Äôs measured performance and
obtains optimum satisfaction. As the game evolves over the
number of stages in the game, so does the satisfaction of the
BS, which grows from 0.001 to 1 during 6 stages. The BS‚Äôs
satisfaction is evolving due to the average measured followers
performance fed back to the leader after each iteration of the
game. Fig. 4 shows that if the D2D users consider priority
for each level of behavior, there is no effect on the leader‚Äôs
satisfaction, if D2D users were not to consider priority. Fig. 4
also shows fast convergence to an optimal satisfaction for the
leader in our proposed game for both cases , i.e., 1.

that

is evident

Fig. 5a, plots the average transmit power for the three
types of behavior for all the followers in our dynamic S-
UIL repeated game, without priority. The distances between
D2D pairs are random and do not exceed the maximum D2D
transmission range. It
the proposed S-UIL
game reduces transmit power on average more than the non-
cooperative power control (NPC) games. Table III outlines
the average outcome of transmit power for the three levels
of D2D user behavior for both the NPC games and S-UIL
game. Also in Table III we include the average outcome of
transmit power before and after the BS converges to an optimal
outcome, for our proposed S-UIL game. As a result, once
the BS converges to an optimal satisfaction, as in Fig. 4,
the followers then further reduce their transmit power to a
Pareto-efÔ¨Åcient outcome, while maintaining their PDR, and
as a result guaranteeing social welfare across all D2D users.
Due to the D2D users in our S-UIL game reducing their
transmit power more than the NPC games, this means that the
interference generated by D2D users is reduced signiÔ¨Åcantly.
Another beneÔ¨Åt for reducing transmit power for D2D users
allows for an increase in battery lifetime, hence creating a
power efÔ¨Åcient network.

Fig. 5b, plots average PDR for the three levels of behavior
for all followers in the dynamic S-UIL repeated game, without

TABLE III.

AVERAGE TRANSMIT POWER RESULTS FOR THE NPC

GAMES AND SUIL GAME

Low Data
Require-
ment
9.407 dBm

Behavior Type
Medium Data
Requirement

8.993 dBm

High Data
Require-
ment
7.216 dBm

1.567 dBm

2.761 dBm

5.609 dBm

1.152 dBm

2.248 dBm

5.525 dBm

Average Transmit Power
(NPC Game)
Average Transmit Power be-
fore BS convergence (S-UIL
Game)
Average Transmit Power af-
ter BS convergence (S-UIL
Game)

TABLE IV.

AVERAGE PACKET DELIVERY RATIO RESULTS

NPC Games
Low Data Requirement
Medium Data Requirement
High Data Requirement
S-UIL Game Behavior Type
Low Data Requirement
Medium Data Requirement
High Data Requirement

PDR
0.9584
0.9586
0.9663
PDR
0.9070
0.9639
0.9768

Time(t)0.....19212325272931.....100LeaderSatisfaction00.10.20.30.40.50.60.70.80.91NoPriorityPriorityUNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

9

(a) Average transmit power of the followers, without priority.

(b) Average packet delivery ratio of the followers, without priority.

(c) Average transmit power of the followers, with priority.

(d) Average packet delivery ratio of the followers, with priority.

Fig. 5. Simulation results for the followers. The followers utility functions (8), (9), and (10) constants are: ‚àÜ = 1.8, q = 3, y = 2.001, z = 0.6, bi = 0.05,
ci = 1, wi = 2, vi = 4.

priority. Table IV outlines the average outcome of PDR for
the NPC games and our proposed game. In Fig. 5b, we
observe that our S-UIL game has different effects on PDR,
depending on user behavior. High data requirement from the
S-UIL game maximizes PDR more than the NPC games,
where medium data requirement has little change in PDR when
comparing the S-UIL game and the NPC game with medium
data requirement. Low data requirement on the other hand has
the lowest PDR out of all simulation results, however it is
still above minimum target PDR. The different PDR outcomes
for the three behaviors, illustrates the range of communication
reliability and quality (above a minimum PDR target). High
data requirement behavior maximizes PDR on average more
than all other results, hence by maximizing reliability this
allows uploading and downloading of content to be done in
an efÔ¨Åcient manner at high quality with little latency.

Fig. 5c and Fig. 5d plot average transmit power and PDR for
D2D users respectively, by taking into account different levels
of priority for each behavior, i.e. low data requirement has

a minimum target PDR of 0.9, medium data requirement has
a minimum target PDR of 0.94, and high data requirement
has a minimum target PDR of 0.98. Fig. 5c exhibits the
same characteristics as Fig. 5a, with a slight decrease in
average transmit power as the leader converges to an optimal
satisfaction. Fig. 5d on the other hand shows the effects of PDR
when different levels of priority is considered for each behavior
group. In Fig. 5d, the high data requirement for the S-UIL
game achieves its minimum target PDR of 0.98, except this is
not the case for the NPC game with high data requirement. For
all other behaviors, our proposed game and the NPC games
also achieve their minimum target PDRs. Hence, our dynamic
S-UIL repeated game achieves better communication reliability
for all levels of behavior than the NPC games.

As the leader becomes more satisÔ¨Åed within the game and
converges to its optimal satisfaction outcome, the D2D users
also further reduce their transmit power, as in both Fig. 5a and
Fig. 5c, while maintaining their PDR, as in Fig. 5b and Fig. 5d.
Therefore, once the leader converges to optimal satisfaction,

Time(t)0102030405060708090100AverageTransmitPower(dBm)051015LowDataRequirementNPCGameMediumDataRequirementNPCGameHighDataRequirementNPCGameLowDataRequirementS-UILGameMediumDataRequirementS-UILGameHighDataRequirementS-UILGameTime(t)0102030405060708090100AveragePacketDeliveryRatio0.80.820.840.860.880.90.920.940.960.981LowDataRequirementNPCGameMediumDataRequirementNPCGameHighDataRequirementNPCGameLowDataRequirementS-UILGameMediumDataRequirementS-UILGameHighDataRequirementS-UILGameMinimumTargetPDR=0.9Time(t)0102030405060708090100AverageTransmitPower(dBm)246810121416LowDataRequirementNPCGameMediumDataRequirementNPCGameHighDataRequirementNPCGameLowDataRequirementS-UILGameMediumDataRequirementS-UILGameHighDataRequirementS-UILGameTime(t)0102030405060708090100AveragePacketDeliveryRatio0.80.820.840.860.880.90.920.940.960.981LowDataRequirementNPCGameMediumDataRequirementNPCGameHighDataRequirementNPCGameLowDataRequirementS-UILGameMediumDataRequirementS-UILGameHighDataRequirementS-UILGameMinimumTargetPDR=0.9MinimumTargetPDR=0.94MinimumTargetPDR=0.98UNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

as in Fig. 4, the social welfare is guaranteed across all D2D
users.

VI. CONCLUSION

The number of users within cellular communications net-
works is ever increasing. Introducing D2D communications as
an overlay to cellular networks can help reduce the load on
the cellular network, while increasing network efÔ¨Åciency. In
this paper, we proposed a dynamic Stackelberg repeated game
with input from D2D users via a user-in-the-loop approach .
We designed a dynamic Stackelberg-UIL repeated game, which
jointly optimizes D2D user behavior and transmit power. The
BS was assigned as the leader of the dynamic Stackelberg
game whose strategy was to measure satisfaction with the D2D
users within the cell, and the D2D users are the followers
of the proposed game whose strategy is to minimize transmit
power. The utility function for the leader and followers all have
a unique Nash Equilibrium, and we proved that these utility
functions are also strictly concave and continuous. Hence, the
proposed game achieved a Stackelberg Equilibrium, which is
sub-game perfect due to being independent of the game history.
Simulation results have shown that as the BS converges to a
an optimal satisfaction, the followers then converge to Pareto-
efÔ¨Åcient transmit power and PDR. We compared our game to
three NPC games which reÔ¨Çect the three different behaviors.
Finally, we considered prioritized behavior, by setting different
minimum PDR targets to different behaviors. From simulation
results it
that our proposed game has a much
better outcome than traditional NPC games, as players transmit
power are further minimized, and PDR is also achieved and
maximized.

is evident

APPENDIX A

PROOF THE FOLLOWER‚ÄôS UTILITY FUNCTION IS STRICTLY

CONCAVE W.R.T. THE LEADER‚ÄôS SATISFACTION

We prove that the follower‚Äôs utility functions (8), (9), (10)
are also strictly concave and continuous with respect to the
leader‚Äôs satisfaction. To show strict continuality, this is done by
solving the Ô¨Årst order derivative condition, ‚àÇUF (cid:63)
‚àÇx = 0, where
(cid:63) represents all three utility functions for the followers. The
cost charged to the followers is the same for all the follower
utility functions.

(cid:18)

‚àÇUF (cid:63)
‚àÇx
‚àÇUF (cid:63)
‚àÇx

= ‚àí

= 0.

(cid:19)(cid:18)

(cid:19)

‚àÜ

(q ‚àí x) ln(q ‚àí x)2

1

ln(y ‚àí pi
z )

,

(22)

Next to show the utility function (8), (9), (10) are also
strictly concave, we solve the second order derivative condi-
tion, ‚àÇ2UF (cid:63)

‚àÇx2 < 0,

(cid:18)

(cid:18)
‚àÇ2UF (cid:63)
‚àÇx2 = ‚àí

‚àÜ

(cid:19)

(q ‚àí x2) ln(q ‚àí x)2 ln(y ‚àí pi
z )
2

‚àí 1

,

ln(q ‚àí x)

(cid:19)

√ó

10

(23)

‚àÇ2UF (cid:63)
‚àÇx2 <0.

To satisfy the second order derivative condition, the re-
strictions on the variables (q, x, y, pi, z) must satisfy their
conditions in Section IV-B.

REFERENCES

[1] X. Lin, J. G. Andrews, and A. Ghosh, ‚ÄúSpectrum Sharing for Device-
to-Device Communication in Cellular Networks,‚Äù Wireless Communi-
cations, IEEE Transactions on, vol. 13, no. 12, pp. 6727‚Äì6740, 2014.
J. Gu, H.-W. Yoon, J. Lee, S. J. Bae, and M. Y. Chung, ‚ÄúA resource
allocation scheme for Device-to-Device communications using LTE-A
uplink resources,‚Äù Pervasive and Mobile Computing, vol. 18, pp. 104‚Äì
117, 2015.

[2]

[3] M. J. Yang, S. Y. Lim, H. J. Park, and N. H. Park, ‚ÄúSolving the Data
Overload: Device-to-Device Bearer Control Architecture for Cellular
Data OfÔ¨Çoading,‚Äù Vehicular Technology Magazine, IEEE, vol. 8, no. 1,
pp. 31‚Äì39, 2013.

[4] G. Fodor, E. Dahlman, G. Mildh, S. Parkvall, N. Reider, G. Mikl¬¥os,
and Z. Tur¬¥anyi, ‚ÄúDesign Aspects of Network Assisted Device-to-Device
Communications,‚Äù Communications Magazine, IEEE, vol. 50, no. 3, pp.
170‚Äì177, 2012.
J. Liu, N. Kato, J. Ma, and N. Kadowaki, ‚ÄúDevice-to-Device Communi-
cation in LTE-Advanced Networks: A Survey,‚Äù IEEE Communications
Surveys and Tutorials, pp. 1‚Äì19, 2014.

[5]

[6] R.

Schoenen, G. Bulu, A. Mirtaheri, T. Beitelmal,

and
H. Yanikomeroglu, ‚ÄúQuantiÔ¨Åed User Behavior in User-in-the-Loop
Spatially and Demand Controlled Cellular Systems,‚Äù in European
Wireless, 2012. EW. 18th European Wireless Conference. VDE, 2012,
pp. 1‚Äì8.

[8] R.

[7] R. Schoenen and H. Yanikomeroglu, ‚ÄúUser-in-the-Loop: Spatial and
Temporal Demand Shaping for Sustainable Wireless Networks,‚Äù Com-
munications Magazine, IEEE, vol. 52, no. 2, pp. 196‚Äì203, 2014.
Schoenen, G. Bulu, A. Mirtaheri, T. Beitelmal,

and
H. Yanikomeroglu, ‚ÄúFirst Survey Results of QuantiÔ¨Åed User Behavior
in User-in-the-Loop Scenarios for Sustainable Wireless Networks,‚Äù
in Vehicular Technology Conference (VTC Fall), 2012 IEEE.
IEEE,
2012, pp. 1‚Äì5.

[9] Z. Wang, R. Schoenen, H. Yanikomeroglu, and M. St-Hilaire, ‚ÄúLoad
Balancing in Cellular Networks with User-in-the-Loop: A Spatial
TrafÔ¨Åc Shaping Approach,‚Äù in Communications (ICC), 2015 IEEE
International Conference on.

IEEE, 2015, pp. 2638‚Äì2643.

[10] R. Schoenen and H. Yanikomeroglu, ‚ÄúDynamic Demand Control with
Differentiated QoS in User-in-the-Loop Controlled Cellular Networks,‚Äù
in Vehicular Technology Conference (VTC Spring), 2013 IEEE 77th.
IEEE, 2013, pp. 1‚Äì6.

[12]

[11] L. Song, D. Niyato, Z. Han, and E. Hossain, ‚ÄúGame-theoretic Resource
Allocation Methods for Device-to-Device (D2D) Communication,‚Äù
Wireless Communications, IEEE, vol. 21, no. 3, pp. 136‚Äì144, 2014.
J. Huang, Y. Zhao, and K. Sohraby, ‚ÄúResource Allocation for Intercell
Device-to-Device Communication Underlaying Cellular Network: A
Game-Theoretic Approach,‚Äù in Computer Communication and Networks
(ICCCN), 2014 23rd International Conference on.
IEEE, 2014, pp.
1‚Äì8.

UNDER REVIEW FOR IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY

11

[13] R. Yin, G. Yu, H. Zhang, Z. Zhang, and G. Y. Li, ‚ÄúPricing-Based Inter-
ference Coordination for D2D Communications in Cellular Networks,‚Äù
Wireless Communications, IEEE Transactions on, vol. 14, no. 3, pp.
1519‚Äì1532, 2015.

[14] X. Lin and J. G. Andrews, ‚ÄúOptimal Spectrum Partition and Mode
Selection in Device-to-Device Overlaid Cellular Networks,‚Äù in Global
Communications Conference (GLOBECOM), 2013 IEEE.
IEEE, 2013,
pp. 1837‚Äì1842.
J. Liu, B. Li, B. Lan, and J. Chang, ‚ÄúA Resource Reuse Scheme of D2D
Communication Underlaying LTE Network with Intercell Interference,‚Äù
Communications and Network, vol. 5, no. 03, p. 187, 2013.

[15]

[16] G. Fodor and N. Reider, ‚ÄúA Distributed Power Control Scheme for
Cellular Network Assisted D2D Communications,‚Äù in Global Telecom-
munications Conference (GLOBECOM 2011), 2011 IEEE. IEEE, 2011,
pp. 1‚Äì6.

[17] G. Fodor, D. Della Penda, M. Belleschi, M. Johansson, and A. Abrardo,
‚ÄúA Comparative Study of Power Control Approaches for Device-
to-Device Communications,‚Äù in Communications (ICC), 2013 IEEE
International Conference on.

IEEE, 2013, pp. 6008‚Äì6013.

[18] P. Phunchongharn, E. Hossain, and D. I. Kim, ‚ÄúResource Allocation for
Device-to-Device Communications Underlaying LTE-Advanced Net-
works,‚Äù Wireless Communications, IEEE, vol. 20, no. 4, pp. 91‚Äì100,
2013.

[19] Q. Wang, W. Wang, S. Jin, H. Zhu, and N. T. Zhang, ‚ÄúQuality-
Optimized Joint Source Selection and Power Control for Wireless
Multimedia D2D Communication Using Stackelberg Game,‚Äù IEEE,
Transactions on Vehicular Technology, 2014.

[20] F. Wang, L. Song, Z. Han, Q. Zhao, and X. Wang, ‚ÄúJoint Scheduling and
Resource Allocation for Device-to-Device Underlay Communication,‚Äù
in Wireless Communications and Networking Conference (WCNC),
2013 IEEE.

IEEE, 2013, pp. 134‚Äì139.

[21] C. Xia, S. Xu, and K. S. Kwak, ‚ÄúResource allocation for Device-
to-Device communication in LTE-A network: A Stackelberg game
approach,‚Äù in Vehicular Technology Conference (VTC Fall), 2014 IEEE
80th.

IEEE, 2014, pp. 1‚Äì5.

[22] K. Zhu and E. Hossain, ‚ÄúJoint Mode Selection and Spectrum Parti-
tioning for Device-to-Device Communication: A Dynamic Stackelberg
Game,‚Äù Wireless Communications, IEEE Transactions on, vol. 14, no. 3,
pp. 1406‚Äì1420, 2015.

[23] R. Yin, G. Yu, C. Zhong, and Z. Zhang, ‚ÄúDistributed Resource Al-
location for D2D Communication Underlaying Cellular Networks,‚Äù in
Communications Workshops (ICC), 2013 IEEE International Confer-
ence on.

IEEE, 2013, pp. 138‚Äì143.

[24] M. Han, P. Wang, H. F. Pang, F. Q. Liu, X. H. Wang, and N. V.
Nguyen, ‚ÄúUser Satisfaction based Resource Allocation using ArtiÔ¨Åcial

Fish Swarm Algorithm for D2D Communication,‚Äù in Applied Mechanics
and Materials, vol. 475. Trans Tech Publ, 2014, pp. 885‚Äì892.

[25] Y. Chen, S. He, F. Hou, Z. Shi, and X. Chen, ‚ÄúOptimal user-centric
relay assisted Device-to-Device communications: an auction approach,‚Äù
Communications, IET, vol. 9, no. 3, pp. 386‚Äì395, 2015.

[26] K. Doppler, M. Rinne, C. Wijting, C. B. Ribeiro, and K. Hugl, ‚ÄúDevice-
to-Device Communication as an Underlay to LTE-Advanced Networks,‚Äù
Communications Magazine, IEEE, vol. 47, no. 12, pp. 42‚Äì49, 2009.

[27] S. Wen, X. Zhu, X. Zhang, and D. Yang, ‚ÄúQoS-Aware Mode Selection
and Resource Allocation Scheme for Device-to-Device (D2D) Commu-
nication in cellular networks,‚Äù in Communications Workshops (ICC),
2013 IEEE International Conference on.
IEEE, 2013, pp. 101‚Äì105.
[28] P. Marbach and R. Berry, ‚ÄúDownlink Resource Allocation and Pricing
for Wireless Networks,‚Äù in INFOCOM 2002. Twenty-First Annual Joint
Conference of
the IEEE Computer and Communications Societies.
Proceedings. IEEE, vol. 3.
J. Dong, D. Smith, and L. Hanlen, ‚ÄúSocially Optimal Coexistence of
Wireless Body Area Networks Enabled by a Non-Cooperative Game,‚Äù
arXiv preprint arXiv:1504.07728, 2015.

IEEE, 2002, pp. 1470‚Äì1479.

[29]

[30] C. U. Saraydar, N. B. Mandayam, and D. J. Goodman, ‚ÄúEfÔ¨Åcient Power
Control via Pricing in Wireless Data Networks,‚Äù Communications, IEEE
Transactions on, vol. 50, no. 2, pp. 291‚Äì303, 2002.

[31] S. Andreev, D. Moltchanov, O. Galinina, A. Pyattaev, A. Ometov, and
Y. Koucheryavy, ‚ÄúNetwork-Assisted Device-to-Device Connectivity:
Contemporary Vision and Open Challenges,‚Äù in European Wireless
2015; 21th European Wireless Conference; Proceedings of.
VDE,
2015, pp. 1‚Äì8.

[32] S. Ali, N. Rajatheva, and M. Latva-aho, ‚ÄúFull Duplex Device-to-Device
Communication in Cellular Networks,‚Äù in Networks and Communica-
tions (EuCNC), 2014 European Conference on.
IEEE, 2014, pp. 1‚Äì5.
[33] D. B. Smith, M. Portmann, W. L. Tan, and W. Tushar, ‚ÄúMulti-Source‚Äì
Destination Distributed Wireless Networks: Pareto-EfÔ¨Åcient Dynamic
Power Control Game With Rapid Convergence,‚Äù Vehicular Technology,
IEEE Transactions on, vol. 63, no. 6, pp. 2744‚Äì2754, 2014.
J. Zyren and W. McCoy, ‚ÄúOverview of the 3GPP Long Term Evolution
Physical Layer,‚Äù Freescale Semiconductor, Inc., white paper, 2007.

[34]

[35] V. Paisal, ‚ÄúSeamless Voice over LTE,‚Äù in Internet Multimedia Services
Architecture and Application (IMSAA), 2010 IEEE 4th International
Conference on.

IEEE, 2010, pp. 1‚Äì5.

[36] S. Koskie and Z. Gajic, ‚ÄúA Nash Game Algorithm for SIR-Based Power
Control in 3G Wireless CDMA Networks,‚Äù IEEE/ACM Transactions on
Networking (TON), vol. 13, no. 5, pp. 1017‚Äì1026, 2005.

[37] S. ETSI, ‚ÄúSelection procedures for the choice of radio transmission
technologies of the UMTS,‚Äù UMTS Technical Report TR 101 112
(UMTS 30.03), Version 3.2. 0, Sects, Tech. Rep., 1998.

