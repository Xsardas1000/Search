6
1
0
2

 
r
a

 

M
6
1

 
 
]

O
L
.
s
c
[
 
 

1
v
4
1
2
5
0

.

3
0
6
1
:
v
i
X
r
a

Chair for Theoretical Computer Science (Informatik 8)
Friedrich-Alexander University Erlangen-NÂ¨urnberg, Germany
mail@stefan-milius.eu

tadeusz.litak@fau.de

Guard Your Daggers and Traces: Properties of

Guarded (Co-)recursion

invited to a special issue of Fundamenta Informaticae (FiCSâ€™13)

Stefan Milius

Tadeusz Litak

March 17, 2016

Motivated by the recent interest in models of guarded (co-)recursion, we study
their equational properties. We formulate axioms for guarded ï¬xpoint operators
generalizing the axioms of iteration theories of Bloom and Â´Esik. Models of these
axioms include both standard (e.g., cpo-based) models of iteration theories and
models of guarded recursion such as complete metric spaces or the topos of trees
studied by Birkedal et al. We show that the standard result on the satisfaction
of all Conway axioms by a unique dagger operation generalizes to the guarded
setting. We also introduce the notion of guarded trace operator on a category,
and we prove that guarded trace and guarded ï¬xpoint operators are in one-to-one
correspondence. Our results are intended as ï¬rst steps leading, hopefully, towards
future description of classifying theories for guarded recursion.

1. Introduction

Our ability to describe concisely potentially inï¬nite computations or inï¬nite behaviour of
systems relies on recursion, corecursion and iteration. Most programming languages and
speciï¬cation formalisms include a ï¬xpoint operator. In order to give semantics to such oper-
ators one usually considers either

â€¢ models based on complete partial orders where ï¬xpoint operators are interpreted by

least ï¬xpoints using the Kleene-Knaster-Tarski theorem or

â€¢ models based on complete metric spaces and unique ï¬xpoints via Banachâ€™s theorem or
â€¢ term models where unique ï¬xpoints arise by unfolding speciï¬cations syntactically.

In the last of these cases, one only considers guarded (co-)recursive deï¬nitions; see e.g. Mil-
nerâ€™s solution theorem for CCS [27] or Elgotâ€™s iterative theories [13]. Thus, the ï¬xpoint
operator becomes a partial operator deï¬ned only on a special class of maps. For a concrete
example, consider complete metric spaces which form a category with all non-expansive maps
as morphisms, but unique ï¬xpoints are taken only of contractive maps.

1

Recently, there has been a wave of interest in expressing guardedness by a new type con-
structor (cid:73), a kind of â€œlaterâ€ modality, which allows to make the ï¬xpoint operator total
[29, 30, 3, 6, 22, 21, 8, 7, 4, 23]. For example, in the case of complete metric spaces, (cid:73) can
be an endofunctor scaling the metric of any given space by a ï¬xed factor 0 < r < 1 so that
non-expansive maps of type (cid:73)X â†’ X are precisely r-contractive ones. This allows to deï¬ne
a guarded (parametrized) ï¬xpoint operator on the model that assigns to every morphism
e : (cid:73)X Ã— Y â†’ X a morphism eâ€  : Y â†’ X. Languages with a guarded ï¬xpoint operator
can be also interpreted in the â€œtopos of treesâ€, i.e., presheaves on Ï‰op [8] or, more generally,
sheaves on complete Heyting algebras with a well-founded basis [12, 8]. Note that by using (cid:73),
guarded recursion becomes a generalization of standard recursion (since (cid:73) can be the identity
functor) rather than a specialization as in previous approaches.

This paper initiates the study of the essential properties of such operators. Iteration the-
ories [9] are known to axiomatize equalities of unguarded ï¬xpoint terms in models based on
complete partial orders (see also [31]). We make here the ï¬rst steps towards similar complete-
ness results in the guarded setting.

We begin with formalizing the notion of a guarded ï¬xpoint operator on a cartesian category.
We discuss a number of models, including not only all those mentioned above, but also some
not mentioned so far in the context of (cid:73)-guarded (co-)recursion. In fact, we consider the
inclusion of examples such as the lifting functor on CPO and, more broadly, let-cccâ€™s with
a ï¬xpoint object [11] (see Examples 2.4.(6)â€“(7) and Theorem 3.6) or completely iterative
monads (Section 2.2) a pleasant by-product of our work and a potentially fruitful connection
for future research.
In Section 3, we formulate (cid:73)-guarded generalizations of standard axioms of Conway and
iteration theories (see, e.g., [9, 31]) and prove their soundness. In particular, models with
unique guarded ï¬xpoint operators satisfy all our axioms (Theorem 3.4). Without the assump-
tion of uniqueness, some problems appear (notably, Open Problems 3.8, 3.16 and 3.17) and
generalizations of several known derivations, like that of the BekiË‡c identity from the Con-
way axioms (Proposition 3.10) require some ingenuity. We believe these are positive signs:
sticking (cid:73) in â€œall the right placesâ€ cannot always be done on autopilot and subtle aspects
of (co)-recursion invisible to the unguarded eye come to light, even on the purely equational
level. For natural examples, however, most properties in question seem to hold even without
requiring uniqueness, as witnessed, e.g., by Theorems 3.6 and 3.7.

Hasegawa [18] proved that giving a parametrized ï¬xpoint operator on a cartesian category
is equivalent to giving a traced cartesian structure [20] on that category.1 In Section 4, we
introduce a natural notion of a guarded trace operator on a category, and we prove in Theo-
rem 4.5 that guarded traces and guarded ï¬xpoint operators are in one-to-one correspondence.
This extends to an isomorphism between the (2-)categories of guarded traced cartesian cate-
gories and guarded Conway categories (Corollary 4.10). Just like in the unguarded case, the
notion of trace would make sense in a general monoidal setting (Remarks 4.1 and 4.3). We
leave this as an exciting avenue for future research.

Finally, Section 5 concludes and discusses further work.
A few words are due on diï¬€erences with a previously published extended abstract of this
paper [26]. We obviously provide full proof details of all results. We also discuss additional
equational properties of guarded ï¬xpoint operators in Sections 3.1 and 3.2. Moreover, The-
orem 3.6 concerning let-cccâ€™s is new and so is, e.g., Example 2.8 (the last provided by AleË‡s

1Cartesian here refers to the monoidal product being the ordinary categorical product.

2

Bizjak).

We decided to move some more technical proofs to an appendix in order to make the paper

more readable.

1.1. Notational Conventions

Ï€(cid:96)

Ï€r

A Ã— B

We assume familiarity with basic notions of category theory. We denote the product of two
/B and âˆ† : A â†’ A Ã— A denotes the diagonal. For every functor
objects by A
F we write can = (cid:104)F Ï€(cid:96), F Ï€r(cid:105) : F (A Ã— B) â†’ F A Ã— F B for the canonical morphism. We
denote the terminal object in a cartesian category as 1 and the unique morphism for each
X as ! : X â†’ 1. Wherever convenient, we use freely other standard conventions such as
identifying X and 1 Ã— X or dropping subscripts of natural transformations if they are clear
from the context.

CPO denotes the category of complete partial orders (cpoâ€™s), i.e. partially ordered sets
(possibly without a least element) having joins of Ï‰-chains. The morphisms of CPO are
Scott-continuous maps, i.e. maps preserving joins of Ï‰-chains. CPOâŠ¥ is the full subcategory
of CPO given by all cpoâ€™s with a least element âŠ¥. We will also consider the category CMS of
complete 1-bounded metric spaces and non-expansive maps, i.e. maps f : X â†’ Y such that
for all x, y âˆˆ X, dY (f x, f y) â‰¤ dX (x, y); see Krishnaswami and Benton [22, 21] or Birkedal et
al. [8, Section 5] and references therein.
Instead of writing â€œthe following square commutesâ€ or â€œthe following diagram commutesâ€,
we write (cid:9) in the middle of the diagram in question. We also use objects to denote their
identity morphisms. Finally, we sometimes write X = Y to indicate that two objects in a
category are isomorphic.

2. Guarded Fixpoint Operators

In this section we deï¬ne the notion of a guarded ï¬xpoint operator on a cartesian category and
present an extensive list of examples. Some of these examples like the lifting functor (âˆ’)âŠ¥
on CPO (see Example 2.4.6) or completely iterative monads (see Section 2.2) do not seem to
have been considered as instances of the guarded setting before. We also discuss in detail the
connection with models of guarded ï¬xpoint terms of Birkedal et al. [8], see Proposition 2.7.

2.1. Deï¬nition and Examples of Guarded Fixpoint Operators
Assumption 2.1. We assume throughout the rest of the paper that (C, (cid:73)) is a pair consisting
of a category C with ï¬nite products (also known as a cartesian category) and a pointed
endofunctor (cid:73) : C â†’ C, i.e. we have a natural transformation p : Id â†’ (cid:73). The endofunctor (cid:73)
is called delay or the â€œlaterâ€ modality.

Remark 2.2. In references like Birkedal et al.
[8, 7], much more is assumed about both the
underlying category and the delay endofunctor. Modelling simply-typed lambda calculus
requires cartesian closure. Dependent types require additional conditions like being a type-
theoretic ï¬bration category (see, e.g., [7, Deï¬nition IV.1]).
In such a case, one also wants
to impose some limit-preservation or at least ï¬nite-limit-preservation condition on the delay
endofunctor [8, Deï¬nition 6.1]â€”e.g., to ensure the transfer of the guarded ï¬xpoint operator
to slices. We do not impose any of those restrictions because we do not need them in our

3

o
o
/
derivations. For more on the connection with the setting of Birkedal et al. [8], see Proposition
2.7 below.
Deï¬nition 2.3. A guarded ï¬xpoint operator on (C, (cid:73)) is a family of operations

such that for every f : (cid:73)X Ã— Y â†’ X,

â€ X,Y : C((cid:73)X Ã— Y, X) â†’ C(Y, X)

Y
(cid:104)fâ€ ,Y (cid:105)

X Ã— Y

fâ€ 

(cid:9)

X

f

/ (cid:73)X Ã— Y

pXÃ—Y

(2.1)

where (as usual) we drop the subscripts and write fâ€  : Y â†’ X in lieu of â€ X,Y (f ). We call the
triple (C, (cid:73),â€ ) a guarded ï¬xpoint category.
Moreover, (C, (cid:73),â€ ) is called a unique guarded ï¬xpoint category if for every f : (cid:73)XÃ—Y â†’ X,
fâ€  is the unique morphism satisfying (2.1). In this case, we can just write a pair (C, (cid:73)) instead
of a triple (C, (cid:73),â€ ).

If one does not require that fâ€  is the unique solution of (2.1), one usually assumes that â€ 
satisï¬es further properties. For example, Simpson and Plotkin [31] require that a parametrized
ï¬xpoint operator â€  is natural in Y in the base deï¬nition. We will come to the study of
properties of â€  such as naturality in Section 3. Let us begin with a list of examples. Note
that in most cases, we do not explicitly mention the action of (cid:73) on morphisms whenever it
is canonical; for Example (5), it is given in Appendix A.
Examples 2.4. (1) Taking as (cid:73) the identity functor on C and pX the identity on X we arrive
at the special case of categories with an ordinary ï¬xpoint operator C(XÃ—Y, X) â†’ C(Y, X)
(see e.g. Hasegawa [18, 19] or Simpson and Plotkin [31]). Concrete examples are: the
category CPOâŠ¥ with its usual least ï¬xpoint operator or (the dual of) any iteration theory
of Bloom and Â´Esik [9].

(2) Taking (cid:73) to be the constant functor (cid:73)X = 1 and pX = ! : X â†’ 1, a trivial guarded

ï¬xpoint operator is given by the family of identity maps on the hom-sets C(Y, X).

(3) Take C to be CMS, r âˆˆ (0, 1), (cid:73)r : CMS â†’ CMS to be the endofunctor keeping the carrier
of the space and multiplying all distances by r, and pX : X â†’ (cid:73)rX to be the obvious
â€œcontracted identityâ€ mapping. Note that a non-expansive mapping f : (cid:73)rX â†’ X is
the same as an r-contractive endomap, i.e. an endomap satisfying d(f x, f y) â‰¤ r Â· d(x, y)
for every x, y âˆˆ X. An application of Banachâ€™s unique ï¬xpoint theorem yields a guarded
ï¬xpoint operator: for every f : (cid:73)rX Ã— Y â†’ X we consider the map

Î¦f : CMS(Y, X) â†’ CMS(Y, X),

Î¦f (m) = f Â· (pX Ã— Y ) Â· (cid:104)m, Y (cid:105);

notice that CMS(Y, X) is a complete metric space with the sup-metric

dY,X (m, n) = sup
yâˆˆY

{dX (my, ny)}.

Using that non-expansive maps are closed under composition, product and pairing, it
is easy to show that Î¦f is an r-contractive map, and so its ï¬xpoint is the unique non-
expansive map fâ€  : Y â†’ X satisfying (2.1).

4

/
/


/
O
O
(4) Let A be a category with ï¬nite products and C be the presheaf category presh(Ï‰,A) =
AÏ‰op of Ï‰op-chains in A. The delay functor is given by (cid:73)X(0) = 1 and (cid:73)X(n + 1) = X(n)
for n â‰¥ 0, whereas pX is given by (pX )0 = ! : X(0) â†’ 1 and (pX )n+1 = X(n + 1 â‰¥ n) :
X(n+1) â†’ X(n). For every f : (cid:73)XÃ—Y â†’ X there is a unique fâ€  : Y â†’ X satisfying (2.1)
given by f

â€ 
0 = f0 : Y (0) â†’ X(0) and

â€ 
f
n+1 = (Y (n + 1)

(cid:104)f

â€ 
nÂ·Y (n+1â‰¥n),Y (n+1)(cid:105)

/X(n) Ã— Y (n + 1)

fn+1 /

/X(n + 1)).

Notice that for A = Set, C is the â€œtopos of treesâ€ of Birkedal et al.
The next example generalizes this one.

[8].

(5) Assume W = (W,â‰¤) is a well-founded poset, i.e, contains no inï¬nite descending chains.
As usual we write x < y whenever x â‰¤ y and x (cid:54)= y. Furthermore, let D be a (small)
complete category and C = presh(W,D), i.e., C = D(W,>). Deï¬ne (cid:73)X(w) to be the
limit of the diagram whose nodes are X(v) for v < w and whose arrows are restriction
morphisms: (cid:73)X(w) = limv<w X(v). As restriction mappings from X(w) itself form a
cone on that diagram, a natural pX : X â†’ (cid:73)X is given by the universal property of the
limits. Note that for any minimal element r âˆˆ W , we have that ((cid:73)X)(r) is the terminal
object 1 of D. The â€ -operation on f : (cid:73)X Ã— Y â†’ X is deï¬ned by induction on (W,â‰¤):
assuming that f

â€ 
v is already deï¬ned for all v < w let

fâ€ 
w = (Y (w)

(cid:104)k,Y (w)(cid:105)

/(cid:73)X(w) Ã— Y (w)

fw /

/X(w)),

where k : Y (w) â†’ (cid:73)X(w) is the morphism uniquely induced by the cone

Y (w>v)

Y (w)

â€ 
v

f

/Y (v)

/X(v)

for every v < w.

This includes the case of a minimal element r for which the above deï¬nition yields f
fr : Y (r) = 1 Ã— Y (r) â†’ X(r).
One can prove that fâ€  is a unique morphism of presheaves satisfying (2.1); more details
can be found in Appendix A. This result generalizes Birkedal et al. [8, Theorem 2.4].

â€ 
r =

Regarding the examples given by Birkedal et al. [8], see also Proposition 2.7 below, which
also establishes that a let-ccc with a ï¬xpoint object with (cid:73) and â€  just deï¬ned forms a
guarded ï¬xpoint category.

(6) Let (cid:73) be the lifting functor (âˆ’)âŠ¥ on CPO, i.e. for any cpo X, XâŠ¥ is the cpo with a newly
added least element and the natural transformation pX : X â†’ XâŠ¥ is the embedding of
X into XâŠ¥. Taking least ï¬xpoints yields a guarded ï¬xpoint operator. To see this notice
that the hom-sets CPO(X, Y ) are cpos with the pointwise order: f â‰¤ g iï¬€ f (x) â‰¤ g(x)
for all x âˆˆ X. Now any continuous f : XâŠ¥ Ã— Y â†’ X gives rise to a continuous map Î¦f
on CPO(Y, XâŠ¥):

Î¦f : CPO(Y, XâŠ¥) â†’ CPO(Y, XâŠ¥),

Î¦f (m) = pX Â· f Â· (cid:104)m, Y (cid:105).
/XâŠ¥ Ã— Y

f

Using the least ï¬xpoint s of Î¦f deï¬ne fâ€  = (Y
/X ). As s = Î¦f (s), one
can easily show fâ€  satisï¬es (2.1). Just as Example (5) was more general than (4), the
present example is also known to be an instance of a more general situation:

(cid:104)s,Y (cid:105)

5

/
/
/
/
/
/
(7) Crole and Pitts [11, 10] deï¬ne a let-ccc with a ï¬xpoint object as a tuple

(C, T, Î·, Âµ, s, T â„¦ Ïƒâˆ’â†’ â„¦, 1 Ï‰âˆ’â†’ â„¦),

where

â€¢ C is a cartesian closed category,
â€¢ (T, Î·, Âµ, s) is a strong monad on C, i.e. a monad together with a strength viz. a
family of morphisms sA,B : AÃ— T B â†’ T (AÃ— B) natural in A and B and compatible
with the monad structure in the obvious way,

â€¢ Ïƒ : T â„¦ â†’ â„¦ is an initial algebra for the functor T and
â€¢ Ï‰ is the equalizer of Ïƒ Â· Î·â„¦ and identity on â„¦ (i.e., the unique ï¬xpoint of Ïƒ Â· Î·â„¦) .

Recall from Crole and Pitts [10, 11] (and cf. Manes [24]) that a strong monad can be
âˆ—
speciï¬ed by an object assignment T , a family of morphisms Î·A and an operation (âˆ’)
:
C(A Ã— B, T C) â†’ C(A Ã— T B, T C) satisfying the following laws:
(a) for any f : A Ã— B â†’ T C, we have fâˆ— Â· (A Ã— Î·B) = f ;
(b) (Î·B Â· Ï€r)
âˆ—
(c) given f : A â†’ A(cid:48) and g : A(cid:48) Ã— B â†’ T C we have (g Â· (f Ã— B))
âˆ—
(d) given f : A Ã— B â†’ T C and g : A Ã— C â†’ T D we have (gâˆ— Â· (cid:104)Ï€(cid:96), f(cid:105))
The initiality of â„¦ and cartesian closedness of C yield that for any f : C Ã— T A â†’ A there
exists a unique morphism it(f ) : C Ã— â„¦ â†’ A such that

= Ï€r : A Ã— T B â†’ T B;

= gâˆ— Â· (f Ã— T B);

âˆ—

= gâˆ— Â· (cid:104)Ï€(cid:96), fâˆ—(cid:105).

C Ã— â„¦
CÃ—Ïƒ
C Ã— T â„¦

it(f )

(cid:9)

(cid:104)Ï€(cid:96),(Î·Â·it(f ))âˆ—(cid:105)

A

f

/ C Ã— T A

(2.2)

Now set (cid:73) = T and for any f : Y Ã— T X â†’ X deï¬ne2 fâ€  = it(f )Â· (Y Ã— Ï‰). To see that this
âˆ—
example covers the preceding one, follow [11] and set T = (âˆ’)âŠ¥, Î·X = pX , (âˆ’)
the strict
extension (i.e. with fâˆ—(a,âŠ¥) = âŠ¥) and â„¦ = {0 (cid:64) 1 (cid:64) Â·Â·Â· (cid:64) (cid:62)}. We return to let-cccâ€™s in
Theorem 3.6 below.

Remark 2.5. If we replaced initiality of â„¦ in Example 2.4.(7) by the (parametrized) universal
property (2.2) of â„¦ we could drop cartesian closure of C and simply assume C to be a category
with products; cf. Crole and Pitts [11, Lemma 2.2] and an explict claim therein: if one simply
has a category with ï¬nite products and a strong monad, the deï¬nition of ï¬xpoint object should
be strengthened to a parametrised form. See also Proposition 2.7 below for an analogous
discussion.

Birkedal et al.

[8] provide a general setting for topos-theoretic examples like 2.4.(4)
and 2.4.(5) (the latter restricted to the case of Set-presheaves) by deï¬ning a notion of a
model of guarded recursive terms and showing that sheaves over complete Heyting algebras
with a well-founded basis proposed by Di Gianantonio and Miculan [12] are instances of this
notion. The diï¬€erence between Deï¬nition 6.1 in [8] and our Deï¬nition 2.3 is that in the
2Note that to be consistent with [11] we put (cid:73)X in the right-hand product component of the domain of f .

6

/
/
O
O
/
O
O
former a) the delay endofunctor (cid:73) is also assumed to preserve ï¬nite limits, in particular ï¬nite
products. On other hand b) our equality (2.1) is only postulated in the case where Y is the
terminal object, i.e., only a non-parametrized ï¬xpoint identity is assumed but c) the dagger
in this less general version of (2.1) is assumed to be unique. Now, one can show that as-
sumptions a) and c) imply our parametrized identity (2.1) whenever the underlying category
is cartesian closed, in particular whenever C is a topos. Let us state both the deï¬nition and
the result formally:
Deï¬nition 2.6. A weak model of guarded ï¬xpoint terms is a triple (C, (cid:73),â€¡), where

â€¢ (C, (cid:73)) satisfy our general Assumption 2.1,
â€¢ (cid:73) preserves ï¬nite products with canâˆ’1

isomorphism,

X,Y : (cid:73)X Ã— (cid:73)Y â†’ (cid:73)(X Ã— Y ) as the witnessing

â€¢ â€¡ is a family of operations â€¡X : C((cid:73)X, X) â†’ C(1, X) such that for every f : (cid:73)X â†’ X,

fâ€¡ is a unique morphism for which

fâ€¡

(cid:9)

1

fâ€¡

X pX

X

f

/ (cid:73)X

(2.3)

A model of guarded ï¬xpoint terms [8] is a weak model in which in addition C has ï¬nite

limits (not just products) and (cid:73) preserves them.
Proposition 2.7. If (C, (cid:73),â€¡) is a weak model of guarded ï¬xpoint terms and C is cartesian
closed with

curryX

Y,Z : C(X Ã— Y, Z) â†’ C(X, ZY ),

then the operator â€ X,Y : C((cid:73)X Ã— Y, X) â†’ C(Y, X) deï¬ned as

(cid:18)(cid:104)

(cid:16)

fâ€  = evalY,X Â·

curry

(cid:73)(X Y )
Y,X

f Â· (cid:104)(cid:73)evalY,X Â· canâˆ’1

is a unique guarded ï¬xpoint operator on (C, (cid:73)).
Proof. Take f : (cid:73)X Ã— Y â†’ X. For notational simplicity, let

and

evalY,Z : ZY Ã— Y â†’ Z,

X Y ,Y Â· ((cid:73)(X Y ) Ã— pY ), Ï€r(cid:105)(cid:17)(cid:105)â€¡ Ã— Y

(cid:19)

g = f Â· (cid:104)(cid:73)evalY,X Â· canâˆ’1

so that fâ€  = evalY,X Â· ((cid:98)gâ€¡ Ã— Y ). We need to show (2.1) for fâ€  deï¬ned this way, i.e., commu-

X Y ,Y Â· ((cid:73)(X Y ) Ã— pY ), Ï€r(cid:105)

(cid:73)(X Y )
Y,X (g)

tativity of the outside of the diagram below:

and (cid:98)g = curry

(cid:98)gâ€¡Ã—Y

(cid:9) by (2.3)
pÃ—Y

Y = 1 Ã— Y
(cid:98)gâ€¡Ã—Y
X Y Ã— Y

(cid:104)eval,Ï€r(cid:105)

X Ã— Y

X Y Ã— Y
(cid:98)gÃ—Y
(cid:73)(X Y ) Ã— Y

(cid:104)p,Ï€r(cid:105)

(cid:9) by pointedness

(cid:9) by ccc

eval

g

(cid:104)(cid:73)(X Y )Ã—p,Ï€r(cid:105)

/ (cid:73)(X Y ) Ã— (cid:73)Y Ã— Y
(cid:104)(?),(cid:9)(cid:105)
canâˆ’1Ã—Y
(cid:73)(X Y Ã— Y ) Ã— Y

X

f

(cid:9) by def. of g

(cid:73)evalÃ—Y

(cid:73)X Ã— Y

pÃ—Y

7

/
/


/
O
O
/
/


/
/
/
/


,
,
2
2
O
O
/


/
/
O
O
O
O
Thus, we need to show the left-hand product component (?) of the inner triangle commutes.
We postcompose both sides with the isomorphism can : (cid:73)(X Y Ã— Y ) â†’ (cid:73)(X Y ) Ã— (cid:73)Y and
obtain

can Â· pX Y Ã—Y = (cid:104)(cid:73)Ï€(cid:96), (cid:73)Ï€r(cid:105) Â· pX Y Ã—Y = (cid:104)pX Y Â· Ï€(cid:96), pY Â· Ï€r(cid:105) = pX Y Ã— pY ,

where the middle equation holds by the naturality of p.
s = f Â· (pX Ã— Y ) Â· (cid:104)s, Y (cid:105). Let c = curry1

It remains to prove that fâ€  is the unique solution of (2.1). Suppose that s : Y â†’ X satisï¬es
Y,X (s) : 1 â†’ X Y . We show that (2.3) holds with fâ€¡

replaced by c, i.e. that c =(cid:98)g Â· pX Y Â· c. Equivalently, we show
In order to see this ï¬rst modify the above diagram by replacing (cid:98)gâ€¡ in the upper left-hand

evalY,X Â· (c Ã— Y ) = evalY,X Â· ((cid:98)g Ã— Y ) Â· (pX Y Ã— Y ) Â· (c Ã— Y ).

square by c. Notice that our desired equation corresponds to the (modiï¬ed) upper left-hand
square postcomposed with evalY,X , i.e., the right-hand morphism of the upper edge. Since
evalY,X Â· (c Ã— Y ) = s, the outside of the modiï¬ed diagram commutes by hypothesis. Thus,
since all other parts commute as indicated we obtain the desired equation. This implies that

c =(cid:98)gâ€¡, by the uniqueness of the latter. Hence

s = evalY,X Â· (c Ã— Y ) = evalY,X Â· ((cid:98)gâ€¡ Ã— Y ) = fâ€ ,

which completes the proof.

Proposition 2.7 cannot be reversed: Example 2.4.(6) is a guarded ï¬xpoint category, but
(âˆ’)âŠ¥ clearly fails to preserve even ï¬nite products and hence it does not yield a model of
guarded recursive terms.

Example 2.8. A counterexample kindly provided by AleË‡s Bizjak shows that Proposition
2.7 does not hold without the assumption that C is cartesian closed: there are examples of
models of guarded recursive terms which are not guarded ï¬xpoint categories. In fact, the
adjective â€œguardedâ€ can be removed altogether from the previous sentence: C in the Bizjak
counterexample is the category of groups and (cid:73) = IdC. Initial and ï¬nal objects coincide in
C, which entails two things: 1) cartesian closure fails and 2) there is exactly one canonical
choice for â€¡ possible; fâ€¡ : 1 â†’ X is the unique morphism from the zero object for every group
endomorphism f : (cid:73)X = X â†’ X. However, picking X to be any non-trivial abelian group
shows there is no way of deï¬ning â€ X,X . It is enough to consider h : (cid:73)X Ã— X = X Ã— X â†’ X as
being simply the group operation +: Equation (2.1) then yields hâ€ (x) + x = hâ€ (x) for every
x âˆˆ X and using inverses one has x = 0 contradicting nontriviality of X.

However, to apply Proposition 2.7, it is enough that (C, (cid:73),â€¡) is a full subcategory of a
cartesian closed model of guarded recursive terms such that, moreover, the inclusion functor
preserves products and (cid:73).

Example 2.9. Monads provide perhaps the most natural and well-known examples of pointed
endofunctors. Among delay endofunctors in Example 2.4, (1), (2), (6) and (7) happen to be
monads. In (3), i.e. the CMS example, the type (cid:73)(cid:73)A â†’ (cid:73)A is still inhabited (by any constant
mapping), but one can easily show that monad laws cannot hold whatever candidate for
monad multiplication is postulated. In the remaining (i.e., topos-theoretic) examples, monad
laws fail more dramatically: (cid:73)(cid:73)A â†’ (cid:73)A is not even always inhabited.

8

Section 2.2 below discusses a class of examples of guarded ï¬xpoint categories with unique
dagger, where the delay endofunctor arises from (a module for) a monad. Later on, in Example
2.15 and Theorem 3.6, we will return to Examples 2.4.(6)â€“(7): we will see that while they do
not possess uniqueness, they do enjoy other properties introduced in Section 3 below.

2.2. Completely Iterative Theories

In this subsection we will explain how categories with guarded ï¬xpoint operator capture
a classical setting in which guarded recursive deï¬nitions are studiedâ€”Elgotâ€™s (completely)
iterative theories [13, 14]. The connection to guarded ï¬xpoint operators is most easily seen if
we consider monads in lieu of Lawvere theories, and so we follow the presentation of completely
iterative monads by Milius [25]. First we recall details of their motivating example: inï¬nite
trees on a signature Î£, i.e. a sequence (Î£n)n<Ï‰ of sets of operation symbols with prescribed
arity n. A Î£-tree t on a set X of generators is a rooted and ordered (ï¬nite or inï¬nite) tree
whose nodes with n > 0 children are labelled by n-ary operation symbols from Î£ and a leaf
is labelled by a constant symbol from Î£0 or by a generator from X. One considers systems
of mutually recursive equations of the form

xi â‰ˆ ti((cid:126)x, (cid:126)y)

i âˆˆ I,

where X = {xi | i âˆˆ I} is a set of recursion variables and each ti is a Î£-tree on X + Y
with Y a set of parameters (i.e. generators that do not occur on the left-hand side of a
recursive equation). A system of recursive equations is guarded if none of the trees ti is only
a recursion variable x âˆˆ X. Every guarded system has a unique solution, which assigns to
â€ 
â€ 
every recursion variable xi âˆˆ X a Î£-tree t
i ((cid:126)y) on Y such that t
i ((cid:126)y) = ti[Ïƒ], where Ïƒ is the
â€ 
substitution replacing each xj by t
j((cid:126)y). For a concrete example, let Î£ consist of a binary
operation symbol âˆ— and a constant symbol c, i.e. Î£0 = {c}, Î£2 = {âˆ—} and Î£n = âˆ… else. Then
the following system

x1 â‰ˆ x2 âˆ— y1

x2 â‰ˆ (x1 âˆ— y2) âˆ— c,

where y1 and y2 are parameters, has the following unique solution:

âˆ—

y2

c

âˆ—

y1

âˆ—

c

âˆ—

âˆ—

y2

âˆ—

y1

â€ 
1 =

t

âˆ—

c

âˆ—

y2

âˆ—

âˆ—

y1

y1

c

and

â€ 
2 =
t

âˆ—

y2

âˆ—

y1

âˆ—

âˆ—

c

For any set X, let TÎ£(X) be the set of Î£-trees on X. It has been realized by Badouel [5]

that TÎ£ is the object part of a monad. A system of equations is then nothing but a map

f : X â†’ TÎ£(X + Y ),

9

and a solution is a map fâ€  : X â†’ TÎ£Y such that
fâ€ 

X

f

(cid:9)

TÎ£Y

ÂµY

TÎ£(X + Y )

TÎ£[fâ€ ,Î·Y ]

/ TÎ£TÎ£Y

where Î· and Âµ are the unit and multiplication of the monad TÎ£, respectively.

It is clear that the notion of equation and solution can be formulated for every monad S.
However, the notion of guardedness requires one to speak about non-variables in S. This is
enabled by Elgotâ€™s notion of ideal theory [13], which for a ï¬nitary monad on Set is equivalent
to the notion recalled in the following deï¬nition. We assume for the rest of this subsection
that A is a category with ï¬nite coproducts such that coproduct injections are monomorphic.
Deï¬nition 2.10 ([1]). An ideal monad on A is a six-tuple (S, Î·, Âµ, S(cid:48), Ïƒ, Âµ(cid:48)) consisting of a
monad (S, Î·, Âµ) on A, a subfunctor Ïƒ : S(cid:48) (cid:44)â†’ S and a natural transformation Âµ(cid:48) : S(cid:48)S â†’ S(cid:48)
such that
(1) S = S(cid:48) + Id with coproduct injections Ïƒ and Î·, and
(2) Âµ restricts to Âµ(cid:48) along Ïƒ, i.e.,

S(cid:48)S

ÏƒS

SS

S(cid:48)

Ïƒ

/ S

(2.4)

Âµ(cid:48)

(cid:9)

Âµ

The subfunctor S(cid:48) of an ideal monad S allows us to formulate the notion of a guarded
equation system abstractly; this leads to the notion of completely iterative theory of Elgot et
al. [14] for which we here present the formulation with monads from Milius [25]:
Deï¬nition 2.11. Let (S, Î·, Âµ, S(cid:48), Ïƒ, Âµ(cid:48)) be an ideal monad on A.

1. An equation morphism is a morphism f : X â†’ S(X + Y ) in A, where X is an object

(â€œof variablesâ€) and Y is an object (â€œof parametersâ€).
2. A solution of f is a morphism fâ€  : X â†’ SY such that

X

f

fâ€ 

(cid:9)

S(X + Y )

S[fâ€ ,Î·Y ]

SY

ÂµY

/ SSY

(2.5)

3. The equation morphism f is called guarded if it factors through the summand S(cid:48)(X +

Y ) + Y of S(X + Y ) = S(cid:48)(X + Y ) + X + Y :

X

f

S(X + Y )

(cid:9)

[ÏƒX+Y ,Î·X+Y Â·inr]

S(cid:48)(X + Y ) + Y

(2.6)

10

/
/


/
O
O
/
/




/
/
/


/
O
O
/
/
(
(
O
O
4. The given ideal monad is called completely iterative if every guarded equation morphism

has a unique solution.

Examples 2.12. We only brieï¬‚y mention two examples of completely iterative monads. More
can be found in literature [1, 25, 2].

(1) The monad TÎ£ of Î£-trees is a completely iterative monad.
(2) A more general example is given by parametrized ï¬nal coalgebras. Let H : A â†’ A be an
endofunctor such that for every object X of A a ï¬nal coalgebra T X for H(âˆ’) + X exists.
Then T is the object assignment of a completely iterative monad; in fact, T is the free
completely iterative monad on H (see [25]).

We will now explain how a completely iterative monad S yields a guarded ï¬xpoint category.
Namely, let us show that the dual of its Kleisli category C = (AS)op is equipped with a guarded
ï¬xpoint operator. First, since AS has coproducts given by the coproducts in A, we see that
C has products. Next we need to obtain the endofunctor (cid:73) on C. This will be given as the
dual of an extension of the subfunctor S(cid:48) : A â†’ A of S to the Kleisli category AS. Indeed, it
is well-known that to have an extension of S(cid:48) to AS is equivalent to having a distributive law
of the functor S(cid:48) over the monad S (see Mulry [28]).

One easily veriï¬es that the natural transformation S(cid:48)S

/SS(cid:48) satisï¬es the two
required laws and thus yields a distributive law. The corresponding extension of S(cid:48) maps X
to S(cid:48)X and a morphism X â†’ SY of AS to
S(cid:48)fâˆ’âˆ’â†’ S(cid:48)SY

Î·S(cid:48)Yâˆ’âˆ’âˆ’â†’ SS(cid:48)Y.

Âµ(cid:48)
Yâˆ’âˆ’â†’ S(cid:48)Y

S(cid:48)X

Âµ(cid:48)

/S(cid:48) Î·S(cid:48)

Moreover, the endofunctor (cid:73)op = S(cid:48) on AS is copointed, i.e. we have a natural transfor-
mation p from S(cid:48) to Id : AS â†’ AS; indeed, its components at X are given by the coproduct
injections ÏƒX : S(cid:48)X â†’ SX, and it is not diï¬ƒcult to verify that this is a natural transformation;
thus, (cid:73) is a pointed endofunctor on C.
Now observe that C((cid:73)X Ã— Y, X) is just A(X, S(S(cid:48)X + Y )). We are ready to describe the
guarded ï¬xpoint operator on C.
Construction 2.13. For any morphism f : X â†’ S(S(cid:48)X + Y ) form the following morphism

f = (X

f

/S(S(cid:48)X + Y )

S(ÏƒX +Î·Y )

/S(SX + SY ) Scan /

/SS(X + Y )

ÂµX+Y /

/S(X + Y )),

where can = [Sinl, Sinr] : SX + SY â†’ S(X + Y ). We shall verify that f is a guarded equation
morphism for S which allows deï¬ning fâ€  : X â†’ SY as the unique solution of f .
Proposition 2.14. For every f , fâ€  from Construction 2.13 is the unique morphism satisfying
(2.1).
Proof. We ï¬rst verify that fâ€  is well-deï¬ned, i.e. f is guarded with the following factor f 0:

X

f 0

S(cid:48)(X + Y ) + Y

f

S(S(cid:48)X + Y )

[Ïƒ,Î·]âˆ’1

Y

(cid:48) i n l] +

(cid:48) , S
[ Âµ

S(cid:48)S(X + Y ) + S(cid:48)X + Y

n

a

(cid:48) c
S

Y

/ S(cid:48)(S(cid:48)X + Y ) + S(cid:48)X + Y
(cid:48) X
S
S(cid:48)(SX + SY ) + S(cid:48)X + Y

S(cid:48)(Ïƒ+Î·)+S(cid:48)X+Y

+

+

11

/
/
/
/
/
/


/


o
o
o
o
Notice that both f and f 0 start with f . Thus, in order to prove f = [ÏƒX+Y , Î·X+Y Â· inr] Â· f 0
(see (2.6)) we can remove f . Then it suï¬ƒces to prove that the two remaining morphisms are
equal when precomposed with the isomorphism [Ïƒ, Î·] : S(cid:48)(S(cid:48)X +Y )+S(cid:48)X +Y â†’ S(S(cid:48)X +Y ),
i.e. we verify

[ÏƒX+Y , Î·X+Y Â· inr] Â· ([Âµ(cid:48)

X+Y , S(cid:48)inl] + Y ) Â· (S(cid:48)can + S(cid:48)X + Y ) Â· (S(cid:48)(ÏƒX + Î·Y ) + S(cid:48)X + Y )

= ÂµX+Y Â· Scan Â· S(ÏƒX + Î·Y ) Â· [ÏƒS(cid:48)X+Y , Î·S(cid:48)X+Y ].

We consider the two coproduct components separately and compute for the left-hand com-
ponent

ÏƒX+Y Â· Âµ(cid:48)

X+Y Â· S(cid:48)can Â· S(cid:48)(ÏƒX + Î·Y )

(2.4)

= ÂµX+Y Â· ÏƒS(X+Y ) Â· S(cid:48)can Â· S(cid:48)(ÏƒX + Î·Y )
= ÂµX+Y Â· Scan Â· S(ÏƒX + Î·Y ) Â· ÏƒS(cid:48)X+Y ,

where the second step uses naturality of Ïƒ twice; for the right-hand component we obtain
ÂµX+Y Â· Scan Â· S(ÏƒX + Î·Y ) Â· Î·S(cid:48)X+Y = ÂµX+Y Â· Î·S(X+Y ) Â· can Â· (ÏƒX + Î·Y )

(cid:124)

(cid:123)(cid:122)

(cid:125)

Â·(ÏƒX + Î·Y )

=can

= [Sinl, Sinr]
= [Sinl Â· ÏƒX , Sinr Â· Î·Y ]
= [ÏƒX+Y Â· S(cid:48)inl, Î·X+Y Â· inr]
= [ÏƒX+Y , Î·X+Y Â· inr] Â· (S(cid:48)inl + Y ).

(by nat. of Î·)
(since Âµ Â· Î·S = id)

(by nat. of Ïƒ and Î·)

This ï¬nishes the proof of guardedness of f .

Now observe that (2.1) can equivalently be expressed in A (using C = (AS)op) as the outside

square of the following diagram

X

f

(cid:9)

S(S(cid:48)X + Y )

fâ€ 

f

cf. (2.5)

SY
Âµ

SSY

S[fâ€ ,Î·Y ]

S(Ïƒ+Î·)

/ S(SX + SY )

/ SS(X + Y ) ÂµX+Y

/ S(X + Y )

Scan

This outside commutes iï¬€ the upper right-hand triangle commutes iï¬€ fâ€  is a solution of f .
Since the latter exists uniquely we see that fâ€  is the desired unique morphism satisfying (2.1).

Examples 2.15. Several items in Examples 2.4 are unique guarded ï¬xpoint categories; this
holds for Examples 2.4.(2)â€“(5), and also for the example of completely iterative monads in
Section 2.2. However, Example 2.4.(6) is not a unique guarded ï¬xpoint category:
for let
X = {0, 1} be the two-chain, Y = 1 the one element cpo and f : XâŠ¥ = XâŠ¥ Ã— Y â†’ X be the
map with f (0) = f (âŠ¥) = 0 and f (1) = 1. Then both 0 : 1 â†’ X and 1 : 1 â†’ X make (2.1)
commutative.

3. Properties of Guarded Fixpoint Operators

In this section, we study properties of guarded ï¬xpoint operators. Except for uniformity,
these properties are purely equational. They are generalizing analogous properties of Bloom

12

/
/


,
,
O
O
/
/
/
O
O
and Â´Esikâ€™s iteration theories [9]; more precisely, they would collapse to the original, unguarded
counterparts when (cid:73) is instantiated to the identity endofunctor as in Example 2.4.(1). Just
like these original counterparts, they are all satisï¬ed whenever the operator assigns a unique
ï¬xpoint (Theorem 3.4), but this is not a necessary condition for them to hold, as witnessed
by Theorems 3.6 and 3.7 concerning Examples 2.4.(6)â€“(7). However, the standard notion
of dinaturality turns out to behave surprisingly enough in the guarded setting to merit a
separate Subsection 3.2. As a prerequisite, we also discuss the so-called BekiË‡c identity in
Section 3.1.

Deï¬nition 3.1. We deï¬ne the following possible properties of a guarded ï¬xpoint category
(C, (cid:73),â€ ):
(1) Fixpoint Identity (â€ ). For every f : (cid:73)X Ã— Y â†’ X, (2.1) holds. This is built into the
deï¬nition of guarded ï¬xpoint categories and only mentioned here again for the sake of
completeness.

(2) Parameter Identity (P). For every f : (cid:73)X Ã— Y â†’ X and every h : Z â†’ Y ,

Z h /

/Y

fâ€ 

/X = ((cid:73)X Ã— Z

(cid:73)XÃ—h /

/(cid:73)X Ã— Y

f

/X )â€ .

(3) (Simpliï¬ed) Composition Identity (C). Given f : (cid:73)X Ã— Y â†’ Z and g : Z â†’ X,

((cid:73)X Ã— Y

f

/Z

g

/X )â€  = (Y

(fÂ·((cid:73)gÃ—Y ))â€ 

g

/Z

/X ).

(4) Double Dagger Identity (â€ â€ ). For every f : (cid:73)X Ã— (cid:73)X Ã— Y â†’ X,

fâ€ â€ 

/X ) = ((cid:73)X Ã— Y

âˆ†Ã—Y /

/(cid:73)X Ã— (cid:73)X Ã— Y

f

/X )â€ .

(Y

(5) Uniformity (U). Given f : (cid:73)X Ã— Y â†’ X, g : (cid:73)X(cid:48) Ã— Y â†’ X(cid:48) and h : X â†’ X(cid:48),

(cid:73)X Ã— Y
(cid:73)hÃ—Y
(cid:73)X(cid:48) Ã— Y

(cid:9)

f

g

X

h

/ X(cid:48)

=â‡’

Y

fâ€ 

gâ€ 

(cid:9)

X

h

X(cid:48)

We call the ï¬rst four properties (1)â€“(4) the Conway axioms.

Notice that the Conway axioms are equational properties while (5) is quasiequational, i.e.,

an implication between equations.
Next we shall show that in the presence of certain of the above properties the natural
transformation p : Id â†’ (cid:73) is a derived structure. Let (C, (cid:73)) be equipped with an operator
â€  not necessarily satisfying (2.1). For every object X of C deï¬ne qX : X â†’ (cid:73)X as follows:
consider

fX = ((cid:73)((cid:73)X Ã— X) Ã— X

(cid:73)Ï€rÃ—X /

/(cid:73)X Ã— X )

and form

qX = (X

â€ 
X /

f

/(cid:73)X Ã— X

Ï€(cid:96)

/(cid:73)X ).

13

/
/
/
/
/
/
/
/
/
/




/


9
9
%
%
/
Lemma 3.2.

1. If â€  satisï¬es the parameter identity and uniformity, then q : Id â†’ (cid:73) is a natural trans-

formation.

2. If â€  satisï¬es the ï¬xpoint identity, then qX = pX for all X.

Proof. 1. For every morphism h : X â†’ Y we have the following diagram:

X

h

Y

â€ 
X

f

â€ 
Y

f

(fY Â·((cid:73)((cid:73)Y Ã—Y )Ã—h))â€ 

qX
(cid:9)

(cid:73)X Ã— X
(cid:73)hÃ—h
/ (cid:73)Y Ã— Y
(cid:9)
qY

Ï€(cid:96)

(cid:9)

Ï€(cid:96)

(cid:73)X
(cid:73)h
/ (cid:73)YO

Of the left-hand square, the lower left-hand triangle commutes by the parameter identity and
the upper right-hand triangle by uniformity since we have

(cid:73)((cid:73)X Ã— X) Ã— X

(cid:73)((cid:73)hÃ—h)Ã—X

(cid:73)((cid:73)hÃ—h)Ã—h
(cid:73)((cid:73)Y Ã— Y ) Ã— X (cid:73)((cid:73)Y Ã—Y )Ã—h

(cid:9)

fX =
(cid:73)Ï€rÃ—X

(cid:9)

(cid:73)((cid:73)Y Ã— Y ) Ã— Y

(cid:73)Ï€rÃ—Y
fY =

/ (cid:73)X Ã— X
(cid:73)hÃ—h
(cid:73)Y Ã— Y

2. Notice ï¬rst that from the ï¬xpoint identity for f

Ï€r Â· f

â€ 
X

â€ 
X we have:
(â€ )
â€ 
X , X(cid:105)
= Ï€r Â· fX Â· (p(cid:73)XÃ—X Ã— X) Â· (cid:104)f
= Ï€r Â· ((cid:73)Ï€r Ã— X) Â· (p(cid:73)XÃ—X Ã— X) Â· (cid:104)f
= idX

â€ 
X , X(cid:105)

Then we consider the following diagram:

X

âˆ†

â€ 
X

f

X Ã— X

pÃ—X

(cid:73)X Ã— X

pÃ—X
(cid:73)Ï€rÃ—X
(cid:9)
/ (cid:73)((cid:73)X Ã— X) Ã— X

(cid:9)

â€ 
X ,X(cid:105)
(cid:104)f
(cid:73)X Ã— X Ã— X

Ï€rÃ—X

(nat. of p)

â€ 
X = Ï€(cid:96) Â· (pX Ã— X) Â· âˆ† = pX .

Since its outside commutes by the ï¬xpoint identity so does the upper inner triangle. It follows
that we have qX = Ï€(cid:96) Â· f
Deï¬nition 3.3. A guarded ï¬xpoint category (C, (cid:73),â€ ) satisfying the Conway axioms (i.e.
ï¬xpoint, parameter, composition and double dagger identities) is called a guarded Conway
category.
If in addition uniformity is satisï¬ed, we call (C, (cid:73),â€ ) a uniform guarded Conway category.

14

/
/


*
*
/
/






/
/
O


*
*
/


/
/
/
/
/
/


)
)
5
5
6
6
/
O
O
Note that an example of a guarded ï¬xpoint category that is not a guarded Conway category
and an example of a guarded Conway category that is not a uniform guarded Conway category
exist already in the realm of iteration theories of Bloom and Â´Esik (cf. Examples 2.4.1). See
Â´Esik [15], Model 2 and Section 3, respectively.
Theorem 3.4. A unique guarded ï¬xpoint category (C, (cid:73)) is a uniform guarded Conway cat-
egory.
Proof. We shall prove that â€  satisï¬es the Conway axioms and uniformity.
(1) The ï¬xpoint identity for â€  is satisï¬ed by deï¬nition of a unique guarded ï¬xpoint category.
(2) Parameter identity. Given f : (cid:73)X Ã— Y â†’ X and h : Z â†’ Y we have

Z

(cid:104)fâ€ Â·h,Z(cid:105)

h

(cid:9)

Y
(cid:104)fâ€ ,Y (cid:105)

X Ã— Y

XÃ—h

X Ã— Z

pXÃ—Z

fâ€ 

(cid:9) by (â€ )

pXÃ—Y
(cid:9)

/ X

f

(cid:73)X Ã— Y

(cid:73)XÃ—h
/ (cid:73)X Ã— Z

Thus, fâ€  Â· h ï¬ts square (2.1) for f Â· ((cid:73)X Ã— h), and thus we have the desired equation by the
uniqueness of (f Â· ((cid:73)X Ã— h))â€ .

(3) Composition Identity. Let f and g be as in the deï¬nition of the identity. Then we have

(fÂ·((cid:73)gÃ—Y ))â€ 

Y

Z

f

(cid:104)(fÂ·((cid:73)gÃ—Y ))â€ ,Y (cid:105)

(cid:9) by (â€ )

(cid:73)X Ã— Y
(cid:73)gÃ—Y
(cid:73)Z Ã— Y

pZÃ—Y
(cid:9) by nat. of p

pXÃ—Y

Z Ã— Y
gÃ—Y
X Ã— Y

g

(cid:9)

f

(cid:9)

/ X

g

Z

f

(cid:73)gÃ—Y

/ (cid:73)X Ã— Y

Since the outside commutes we obtain the desired equation by the unicity of (g Â· f )â€ .

(4) Double Dagger Identity. Let f : (cid:73)X Ã— (cid:73)X Ã— Y â†’ X. Then we have

Y

fâ€ â€ 

(cid:9) by (â€ )

(cid:73)X Ã— Y

fâ€ 

(cid:9) by (â€ )

X

f

(cid:104)fâ€ ,(cid:73)XÃ—Y (cid:105)

(cid:104)(âˆ—),(cid:9),(cid:9)(cid:105)
X Ã— (cid:73)X Ã— Y

((XÃ—pX )Â·âˆ†)Ã—Y

pXÃ—Y

15

(cid:104)fâ€ â€ ,Y (cid:105)

pXÃ—Y

X Ã— Y

pXÃ—(cid:73)XÃ—Y

(cid:9)

(cid:73)X Ã— (cid:73)X Ã— Y

âˆ†Ã—Y
/ (cid:73)X Ã— Y



/
/


/
/
/
O
O
7
7
/
O
O
/
/


/
O
O
/
/
O
O
/
/


O
O
(
(
/
O
O
/
/


4
4


/
/
O
O
5
5
5
5
/
O
O
We do not claim that part (âˆ—) commutes, but it commutes when precomposed with (cid:104)fâ€ â€ , Y (cid:105).
This is because the lower passage yields simply fâ€ â€  and the upper passage yields fâ€  Â· (pX Ã—
Y ) Â· (cid:104)fâ€ â€ , Y (cid:105), which is equal to fâ€ â€  by the ï¬xpoint identity. We conclude that the outside of
the diagram commutes and so we obtain the desired equality by the unicity of (f Â· (âˆ†Ã— Y ))â€ .

(5) Uniformity. Let f , g and h be as in the deï¬nition of uniformity. Then we have

Y

fâ€ 

(cid:104)fâ€ ,Y (cid:105)

(cid:9) by (â€ )

(cid:104)hÂ·fâ€ ,Y (cid:105)

(cid:9)

X Ã— Y

X

f

(cid:73)X Ã— Y

hÃ—Y

X(cid:48) Ã— Y

pXÃ—Y

(cid:9) by nat. of p

pX(cid:48)Ã—Y

X(cid:48)

g

h

(cid:9)

(cid:73)hÃ—Y

/ (cid:73)X(cid:48) Ã— Y

Since the outside commutes we obtain h Â· fâ€  = gâ€  by unicity of gâ€ .
Example 3.5. Coming back to Example 2.15 we see that the unique â€  in Examples 2.4.(2)â€“
(5 and the one for the example of completely iterative monads in Section 2.2 satisfy all the
properties in Deï¬nition 3.1. But Example 2.15 also entails that for let-cccâ€™s with ï¬xpoint
objects of Example 2.4.(7) one cannot hope for uniqueness. So how about all the properties
of Deï¬nition 3.1?
Theorem 3.6. Let (C, T, Î·, Âµ, s, T â„¦ Ïƒâˆ’â†’ â„¦, 1 Ï‰âˆ’â†’ â„¦) be a let-ccc with a ï¬xpoint object, let
(cid:73) = T and for any f : Y Ã— T X â†’ X deï¬ne fâ€  = it(f ) Â· (Y Ã— Ï‰), as in Example 2.4.(7).
Then (cid:73) satisï¬es all properties introduced in Deï¬nition 3.1, except, possibly, the double dagger
identity (â€ â€ ).

We will see in Theorem 3.7 below that for the special case where C = CPO and T = (âˆ’)âŠ¥

(see Example 2.4.(6)) more can be shown.
âˆ—
Proof. Recall ï¬rst the 4 axioms (a)â€“(d) of the operation (âˆ’)
observe that the action of T on a morphism g : Z = 1 Ã— Z â†’ X is deï¬ned by

from Example 2.4.(7). Further

T g = (Î·X Â· g)

âˆ—

: T Z = 1 Ã— T Z â†’ T X.

(3.1)
Notice that axioms (a) and (d) imply for f : B â†’ T C and g : C â†’ T D (i.e. the special case
for A = 1) the usual extension laws of Manes [24, Deï¬nition 2.13]:
= gâˆ— Â· fâˆ—.

(3.2)
Finally, recall that for let-cccâ€™s we write T = (cid:73) on the right-hand side of product compo-
The ï¬xpoint identity (â€ ). Take f : Y Ã— T X â†’ X. Then:

fâˆ— Â· Î·B = f

âˆ—
(gâˆ— Â· f )

nents.

and

Y = Y Ã— 1
Y Ã—Ï‰
(cid:9)

(cid:104)Ï€(cid:96),fâ€ (cid:105)

(cid:104)Ï€(cid:96),it(f )(cid:105)

Y Ã— X

fâ€ 
(cid:9)

Y Ã—Ï‰

(cid:9) by def. of Ï‰
Y Ã— â„¦

Y Ã—Î·

(cid:9) by axiom (a)

Y Ã— â„¦
Y Ã—Ïƒ
Y Ã— T â„¦

it(f )

/ X

(cid:9) by (2.2)

f

(cid:104)Ï€(cid:96),(Î·Â·it(f ))âˆ—(cid:105)

/ Y Ã— T X

Y Ã—Î·

16

/
/


'
'
/
/
/
/
w
w
O
O
(
(
/
O
O
/
/
&
&


/


/
/
x
x
&
&
O
O
/
O
O
The parameter identity (P). Take f : Y Ã—T X â†’ X and h : Z â†’ Y , and deï¬ne g = fÂ·(hÃ—T X).
Then

(fÂ·(hÃ—T X))â€ 

Z = Z Ã— 1

h=hÃ—1

ZÃ—Ï‰

(cid:9)

ZÃ—Ï‰

(cid:9) by def. of Ï‰
ZÃ—Î·

Z Ã— â„¦

hÃ—â„¦

Y = Y Ã— 1

Y Ã—Ï‰

(cid:104)(cid:9),(âˆ—)(cid:105)

(cid:104)(cid:9),(âˆ—âˆ—)(cid:105)

(cid:9) by (2.2)
(cid:104)Ï€(cid:96),(Î·XÂ·it(g))âˆ—(cid:105)

/ Z Ã— â„¦
ZÃ—Ïƒ
Z Ã— T â„¦
hÃ—T â„¦
Y Ã— T â„¦ (cid:104)Ï€(cid:96),(Î·XÂ·it(f ))âˆ—(cid:105)
Y Ã—Ïƒ
Y Ã— â„¦

(cid:9) by (2.2)

it(g)

Z Ã— T X
hÃ—T X
Y Ã— T X

it(f )

(cid:9)

(cid:9)

(cid:9)

g

f

X

The part (âˆ—) by itself does not need to commute, but it does when precomposed with Ï‰. The
task reduces then to showing (âˆ—âˆ—), viz. the equation

(Î·X Â· it(f ))

âˆ— Â· (h Ã— T â„¦) = (Î·X Â· it(f Â· (h Ã— T X)))
âˆ—

.

fâ€ 

By axiom (c), this reduces to showing

(Î·X Â· it(f ) Â· (h Ã— â„¦))

âˆ—

âˆ—
= (Î·X Â· it(f Â· (h Ã— T X)))

.

To show this it is suï¬ƒcient to prove

it(f ) Â· (h Ã— â„¦) = it(f Â· (h Ã— T X)).

A proof of this relies on it(âˆ’) being the unique morphism satisfying a suitable instance of
(2.2):

hÃ—â„¦

(cid:9)

hÃ—T â„¦

Z Ã— â„¦

ZÃ—Ïƒ

Z Ã— T â„¦

Y Ã— â„¦
Y Ã—Ïƒ
Y Ã— T â„¦

it(f )

(cid:9) by (2.2)

X

f

(cid:104)Ï€(cid:96),(Î·Â·it(f ))âˆ—(cid:105)

/ Y Ã— T X
hÃ—T X
Z Ã— T X

(cid:104)(cid:9),((cid:63))(cid:105)

(cid:104)Ï€(cid:96),(Î·Â·it(f )Â·(hÃ—â„¦))âˆ—(cid:105)

and we get ((cid:63)) by axiom (c) again.

Composition Identity (C). Assume f : Y Ã— T X â†’ Z and g : Z â†’ X. We want to show:

it(g Â· f ) Â· (Y Ã— Ï‰) = g Â· it(f Â· (Y Ã— T g)) Â· (Y Ã— Ï‰).

For this, it is enough to show

it(g Â· f ) = g Â· it(f Â· (Y Ã— T g)).

17

)
)




/
 
 
/
/
#
#


/
/
O
O


(
(
/
/


/
/
/
/
O
O
6
6
/
/
/
/
O
O
/
O
O
O
O
5
5
/
/
O
O
We again use the fact that it(âˆ’) is the unique morphism satisfying a suitable instance of (2.2),
which in this case is:

Y Ã— â„¦

it(fÂ·(Y Ã—T g))

/ Z
fÂ·(Y Ã—T g)

Y Ã—Ïƒ

(cid:9) by (2.2)

Y Ã— T Z

(cid:104)Ï€(cid:96),(Î·Â·it(fÂ·(Y Ã—T g)))âˆ—(cid:105)

(cid:104)(cid:9),(âˆ—)(cid:105)

g

(cid:9)
Y Ã—T g

/ X

g

Z

f

Y Ã— T X

(cid:104)Ï€(cid:96),(Î·Â·gÂ·it(fÂ·(Y Ã—T g)))âˆ—(cid:105)

= (Î·X Â· g)

âˆ— Â·(cid:0)Î·Z Â· it(f Â· (Y Ã— T g))(cid:1)âˆ—
âˆ— Â· Î·Z Â· it(f Â· (Y Ã— T g))(cid:1)âˆ—

= (cid:0)(Î·X Â· g)
= (cid:0)Î·X Â· g Â· it(f Â· (Y Ã— T g))(cid:1)âˆ—

by (3.1)
by (3.2)
by (3.2).

Y Ã— T â„¦

For part (âˆ—) we compute

T g Â·(cid:0)Î·Z Â· it(f Â· (Y Ã— T g))(cid:1)âˆ—

Uniformity (U). Assume f : Y Ã— T X â†’ X, g : Y Ã— T X(cid:48) â†’ X(cid:48) and h : X â†’ X(cid:48) are such
that h Â· f = g Â· (Y Ã— T h) holds. Our goal is to show h Â· fâ€  = gâ€ , for which it is suï¬ƒcient to
show it(g) = h Â· it(f ). Once again, we rely on initiality property (2.2), i.e., we need to show:

Y Ã— â„¦

it(f )

X

h

Y Ã—Ïƒ

Y Ã— T â„¦

(cid:9) by (2.2)

(cid:9) by assumption

f

Y Ã— T X
(cid:104)(cid:9),(âˆ—)(cid:105)

(cid:104)Ï€(cid:96),(Î·Â·it(f ))âˆ—(cid:105)

Y Ã—T h

(cid:104)Ï€(cid:96),(Î·Â·hÂ·it(f ))âˆ—(cid:105)

Y Ã— T X(cid:48)

X(cid:48)

g

For (âˆ—) we reason as follows:

âˆ—
T h Â· (Î·X Â· it(f ))

= (Î·X(cid:48) Â· h)
= ((Î·X(cid:48) Â· h)
âˆ—
= (Î·X(cid:48) Â· h Â· it(f ))

âˆ— Â· (Î·X Â· it(f ))
âˆ—
âˆ—
âˆ— Â· Î·X Â· it(f ))

by (3.1)
by (3.2)
by (3.2).

Theorem 3.7. The category CPO with (cid:73) = (âˆ’)âŠ¥ and the dagger given by least ï¬xpoint as
in Example 2.4.(6) satisï¬es all the properties of Deï¬nition 3.1.
Proof. In the light of Theorem 3.6, we only need to show (â€ â€ ). We use the notation of
In addition, for any f : XâŠ¥ Ã— Y â†’ X, we deï¬ne continuous functions
Example 2.4.(6).
sn : Y â†’ XâŠ¥, n âˆˆ N as

so that the least ï¬xpoint of Î¦f is s =(cid:70)

s0 = Î»y.âŠ¥,

nâˆˆN sn.

sn+1 = Î¦f (sn)

Now suppose we are given f : XâŠ¥ Ã— XâŠ¥ Ã— Y â†’ X. To prove (â€ â€ ) we will ï¬rst show that the

least ï¬xpoints s of Î¦fâ€  and s(cid:48) of Î¦fÂ·(âˆ†Ã—Y ) coincide, i.e. we prove (a) s (cid:118) s(cid:48) and (b) s(cid:48) (cid:118) s.

18

/
/
O
O
)
)
O
O
O
O
5
5
/
/
O
O
/
/
/
/
O
O
(
(
6
6
O
O
/
/
O
O
For (a), it suï¬ƒces to show that s(cid:48) is a preï¬xpoint of Î¦fâ€ , i.e.

pX Â· fâ€  Â· (cid:104)s(cid:48), Y (cid:105) (cid:118) s(cid:48).

To see this let s(cid:48)(cid:48) be the least ï¬xpoint of Î¦f . We will prove that

s(cid:48)(cid:48) Â· (cid:104)s(cid:48), Y (cid:105) = s(cid:48).

by showing the two inequalities below by induction on n:

n Â· (cid:104)s(cid:48), Y (cid:105) (cid:118) s(cid:48)
s(cid:48)(cid:48)

and

n (cid:118) s(cid:48)(cid:48) Â· (cid:104)s(cid:48), Y (cid:105).
s(cid:48)

Note that the left-hand inequalities above already imply (3.3) using that

pX Â· fâ€  = pX Â· f Â· (cid:104)s(cid:48)(cid:48), Y (cid:105) = Î¦f (s(cid:48)(cid:48)) = s(cid:48)(cid:48).

(3.3)

(3.4)

(3.5)

The right-hand inequalities in (3.5) will be used at the end of our proof.

For the induction proofs the base cases are obvious: âŠ¥Â·(cid:104)s(cid:48), Y (cid:105) = âŠ¥ (cid:118) s(cid:48) and âŠ¥ (cid:118) s(cid:48)(cid:48)Â·(cid:104)s(cid:48), Y (cid:105).

For the induction steps we obtain
n+1 Â· (cid:104)s(cid:48), Y (cid:105) = pX Â· f Â· (cid:104)s(cid:48)(cid:48)
s(cid:48)(cid:48)

n, XâŠ¥ Ã— Y (cid:105) Â· (cid:104)s(cid:48), Y (cid:105)
(cid:118) pX Â· f Â· (cid:104)s(cid:48), XâŠ¥ Ã— Y (cid:105) Â· (cid:104)s(cid:48), Y (cid:105)
= pX Â· f Â· (cid:104)s(cid:48), s(cid:48), Y (cid:105)
= pX Â· f Â· (âˆ† Ã— Y ) Â· (cid:104)s(cid:48), Y (cid:105)
= s(cid:48)

n+1 = Î¦f (s(cid:48)(cid:48)
n)

since s(cid:48)(cid:48)
by induction hypothesis

since s(cid:48) = Î¦fÂ·(âˆ†Ã—Y )(s(cid:48))

and

n+1 = pX Â· f Â· (âˆ† Ã— Y ) Â· (cid:104)s(cid:48)
s(cid:48)

n, Y (cid:105)
= pX Â· f Â· (cid:104)s(cid:48)
(cid:118) pX Â· f Â· (cid:104)s(cid:48)(cid:48) Â· (cid:104)s(cid:48), Y (cid:105), s(cid:48), Y (cid:105)
= pX Â· f Â· (cid:104)s(cid:48)(cid:48), XâŠ¥ Ã— Y (cid:105) Â· (cid:104)s(cid:48), Y (cid:105)
= s(cid:48)(cid:48) Â· (cid:104)s(cid:48), Y (cid:105)

n, s(cid:48)

n, Y (cid:105)

n+1 = Î¦fÂ·(âˆ†Ã—Y )(s(cid:48)
n)

since s(cid:48)
by induction hypothesis and s(cid:48)
since s(cid:48)(cid:48) = Î¦f (s(cid:48)(cid:48)).

n (cid:118) s(cid:48)

For inequality (b) we prove by induction on n that sn (cid:118) s(cid:48) holds for all n. The base case
n (cid:118) s. Then we consider the

is again trivial: âŠ¥ (cid:118) s(cid:48). For the induction step suppose that s(cid:48)
following diagram

s(cid:48)

n+1

(cid:118)
s

(cid:9) since s = Î¦fâ€  (s)

fâ€ 
(cid:104)fâ€ ,XâŠ¥Ã—Y (cid:105)

XâŠ¥

pX

X

(cid:9) by (â€ )

Y
(cid:118)

(cid:104)s,Y (cid:105)

(cid:104)s(cid:48)
n,Y (cid:105)
XâŠ¥ Ã— Y

âˆ†Ã—Y

(cid:104)(âˆ—),(cid:9),(cid:9)(cid:105)

X Ã— XâŠ¥ Ã— Y

XâŠ¥ Ã— XâŠ¥ Ã— Y

pXÃ—XâŠ¥Ã—Y

f

n) and (âˆ—) commutes when extended by (cid:104)s, Y (cid:105)
Its outside commutes since s(cid:48)
since s is a ï¬xpoint of Î¦fâ€ . The equalities in the diagram together with the inequality obtained

n+1 = Î¦fÂ·(âˆ†Ã—Y )(s(cid:48)

19

-
-
1
1




/
/
(
(


O
O
v
v
O
O
from the induction hypothesis in the upper left-hand corner yield the desired inequality in
the top row.

We are now ready to prove the desired equality fâ€ â€  = (f Â· (âˆ† Ã— Y ))â€ :

fâ€ â€  = fâ€  Â· (cid:104)s, Y (cid:105)

= f Â· (cid:104)s(cid:48)(cid:48), Y (cid:105) Â· (cid:104)s, Y (cid:105)
= f Â· (cid:104)s(cid:48)(cid:48), Y (cid:105) Â· (cid:104)s(cid:48), Y (cid:105)
= f Â· (cid:104)s(cid:48), s(cid:48), Y (cid:105)
= f Â· (âˆ† Ã— Y ) Â· (cid:104)s(cid:48), Y (cid:105)
= (f Â· (âˆ† Ã— Y )â€ 

by def. of fâ€ â€ 
by def. of fâ€ 
since s = s(cid:48)
by (3.4)
by def. of (âˆ’)â€ 

This completes the proof.

Open Problem 3.8. Do let-cccâ€™s with ï¬xpoint objects with the dagger deï¬ned as in Exam-
ple 2.4.(7) satisfy the double dagger property (â€ â€ )?

We do not see how an argument using two inequalities as in (a) and (b) as well as in (3.5)
generalizes to let-cccâ€™s. However, as the ï¬‚agship Example 2.4.(6) satisï¬es (â€ â€ ), we believe
that a counterexample might be intricate.

3.1. The BekiË‡c Identity

We generalize here the known fact that the double dagger identity can be replaced by the BekiË‡c
identity (also known as the pairing identity) among axioms of unguarded Conway theories
(see, e.g., [32], [9, Ch. 6.2, 6.8â€“6.9], [16], [19, Ch. 7.1] and references therein). We will make
use of this in our discussion of another property, dinaturality, in Section 3.2 and also in the
discussion of trace operators in Section 4.

Deï¬nition 3.9. We introduce the following possible property of a guarded ï¬xpoint category
(C, (cid:73),â€ ):
BekiË‡c identity (BË‡c). For any f : (cid:73)X Ã— (cid:73)Y Ã— A â†’ X and g : (cid:73)X Ã— (cid:73)Y Ã— A â†’ Y ,

canÃ—A /

/(cid:73)X Ã— (cid:73)Y Ã— A

(cid:104)f,g(cid:105)

/X Ã— Y(cid:1)â€ 

where

(cid:0)(cid:73)(X Ã— Y ) Ã— A
eR =(cid:0)(cid:73)Y Ã— A
eL =(cid:0)(cid:73)X Ã— A

(cid:104)pXÂ·fâ€ ,(cid:73)Y Ã—A(cid:105)

â€ 
(cid:73)XÃ—(cid:104)pY Â·e
R,A(cid:105)

/(cid:73)X Ã— (cid:73)Y Ã— A
/(cid:73)X Ã— (cid:73)Y Ã— A

g

f

â€ 
â€ 
R(cid:105),
= (cid:104)e
L, e

/Y(cid:1),
/X(cid:1).

Proposition 3.10. The BekiË‡c identity holds in each guarded Conway category (C, (cid:73),â€ ).
Proof. First observe that can = ((cid:73)Ï€(cid:96) Ã— (cid:73)Ï€r) Â· âˆ†:
(cid:73)(XÃ—Y )

(cid:73)(X Ã— Y )

(cid:73)(âˆ†)

(cid:73)((X Ã— Y ) Ã— (X Ã— Y ))

(cid:73)(Ï€(cid:96)Ã—Ï€r)

(cid:73)(X Ã— Y )

âˆ†

(cid:9)

can

(cid:9)

can

(cid:73)(X Ã— Y ) Ã— (cid:73)(X Ã— Y ) (cid:73)Ï€(cid:96)Ã—(cid:73)Ï€r

/ (cid:73)X Ã— (cid:73)Y

20

/
/
/
/
/
/
/
*
*
/
/






/
Next we compute:

((cid:104)f, g(cid:105) Â· (can Ã— A))â€  = ((cid:104)f, g(cid:105) Â· ((cid:73)Ï€(cid:96) Ã— (cid:73)Ï€r Ã— A) Â· (âˆ† Ã— A))â€ 

(â€ â€ )
= ((cid:104)f, g(cid:105) Â· ((cid:73)Ï€(cid:96) Ã— (cid:73)Ï€r Ã— A))â€ â€ 
= ((cid:104)f, g(cid:105) Â· ((cid:73)Ï€(cid:96) Ã— (cid:73)Y Ã— A) Â· ((cid:73)(X Ã— Y ) Ã— (cid:73)Ï€r Ã— A))â€ â€ 
= (((cid:104)f, g(cid:105) Â· ((cid:73)Ï€(cid:96) Ã— (cid:73)Y Ã— A))â€  Â· ((cid:73)Ï€r Ã— A))â€ 

(P )

Now let h = (cid:104)f, g(cid:105) Â· ((cid:73)Ï€(cid:96) Ã— (cid:73)Y Ã— A) : (cid:73)(X Ã— Y ) Ã— (cid:73)Y Ã— A â†’ X Ã— Y . Then we have

Ï€(cid:96) Â· hâ€  = Ï€(cid:96) Â· ((cid:104)f, g(cid:105) Â· ((cid:73)Ï€(cid:96) Ã— (cid:73)Y Ã— A))â€ 

(C)

= (Ï€(cid:96) Â· (cid:104)f, g(cid:105))â€ 
= fâ€ .

And we have

(cid:104)hâ€ ,(cid:73)Y Ã—A(cid:105)

(cid:73)Y Ã—A

(cid:104)fâ€ ,(cid:73)Y Ã—A(cid:105)

XÃ—Y Ã—((cid:73)Y Ã—A)
(cid:9)

Ï€(cid:96)Ã—(cid:73)Y Ã—A
XÃ—(cid:73)Y Ã—A

hâ€ 

(cid:9) by (â€ )
pÃ—((cid:73)Y Ã—A)
(cid:9) by nat. of p

pÃ—(cid:73)Y Ã—A

(cid:73)(XÃ—Y )Ã—(cid:73)Y Ã—A

(cid:73)Ï€(cid:96)Ã—(cid:73)Y Ã—A
/ (cid:73)XÃ—(cid:73)Y Ã—A

(cid:9)

h

g

XÃ—Y

Ï€r

/ Y

(3.6)

Plugging h into our ï¬rst computation above we obtain

Ï€r Â· ((cid:104)f, g(cid:105) Â· (can Ã— A))â€  = Ï€r Â· (hâ€  Â· ((cid:73)Ï€r Ã— A))â€ 

(3.6)

(C)

= (Ï€r Â· hâ€ )â€ 
= (g Â· (pX Ã— (cid:73)Y Ã— A) Â· (cid:104)fâ€ , (cid:73)Y Ã— A(cid:105))â€ 
= (g Â· (cid:104)pX Â· fâ€ , (cid:73)Y Ã— A(cid:105))â€ 
= e

â€ 
R.

Let z = (cid:104)f, g(cid:105) Â· ((cid:73)Ï€(cid:96) Ã— (cid:73)Ï€r Ã— A). We saw previously that ((cid:104)f, g(cid:105) Â· (can Ã— A))â€  = zâ€ â€ ; thus

we have

Ï€(cid:96) Â· ((cid:104)f, g(cid:105) Â· (can Ã— A))â€  = Ï€(cid:96) Â· zâ€ â€ 

(â€ )
= Ï€(cid:96) Â· zâ€  Â· (pXÃ—Y Ã— A) Â· (cid:104)zâ€ â€ , A(cid:105)
= Ï€(cid:96) Â· zâ€  Â· (cid:104)pXÃ—Y Â· zâ€ â€ , A(cid:105)

= Ï€(cid:96) Â·(cid:0)z Â· ((cid:73)(X Ã— Y ) Ã— (cid:104)pXÃ—Y Â· zâ€ â€ , A(cid:105))(cid:1)â€ 

(P )

(âˆ—)

Substitute the deï¬nition of z and use that

to obtain that (âˆ—) is equal to

â€ 
(cid:73)Ï€r Â· pXÃ—Y Â· zâ€ â€  = pY Â· Ï€r Â· zâ€ â€  = pY Â· Ï€r Â· ((cid:104)f, g(cid:105) Â· (can Ã— A))â€  = pY Â· e
R

Ï€(cid:96) Â·(cid:0)(cid:104)f, g(cid:105) Â· ((cid:73)Ï€(cid:96) Ã— (cid:73)Ï€r Ã— A) Â· ((cid:73)(X Ã— Y ) Ã— (cid:104)pXÃ—Y Â· zâ€ â€ , A(cid:105))(cid:1)â€ 

â€ 
= Ï€(cid:96) Â· ((cid:104)f, g(cid:105) Â· ((cid:73)X Ã— (cid:104)pY Â· e
R, A(cid:105)) Â· ((cid:73)Ï€(cid:96) Ã— A))â€ 
â€ 
= (Ï€(cid:96) Â· (cid:104)f, g(cid:105)
R, A(cid:105)))â€ 
Â·((cid:73)X Ã— (cid:104)pY Â· e

(C)

(cid:124)

(cid:123)(cid:122)

=f

(cid:125)

â€ 
= e
L.

This completes the proof.

21

/
/
)
)


/
/
/
/






/
/
Remark 3.11. Notice that the BekiË‡c identity can also be formulated without mentioning eL.
In fact, by the parameter identity we have

â€ 
L = (A

e

(cid:104)pY Â·e

â€ 
R,A(cid:105)

/(cid:73)Y Ã— A

fâ€ 

/X ).

(3.7)

Proposition 3.10 states the BekiË‡c identity can be derived from Conway laws. But it can
be also postulated directly as an axiom replacing (â€ â€ ). This is a guarded counterpart of
Proposition 5.3.15 in Bloom and Â´Esik [9]:
Proposition 3.12. Each guarded ï¬xpoint category (C, (cid:73),â€ ) satisfying the ï¬xpoint, parameter,
composition and BekiË‡c identities is a guarded Conway category.
Proof. We must derive (â€ â€ ) from the identities listed in the statement. Given f : (cid:73)X Ã—(cid:73)X Ã—
A â†’ X we apply the BekiË‡c identity to obtain

where
By the ï¬xpoint identity we have eR = fâ€ . Thus, we obtain

eR = f Â· (cid:104)pX Â· fâ€ , (cid:73)X Ã— A(cid:105)

â€ 
â€ 
((cid:104)f, f(cid:105) Â· (can Ã— A))â€  = (cid:104)e
R(cid:105),
L, e
â€ 
eL = f Â· ((cid:73)X Ã— (cid:104)pX Â· e
R, A(cid:105)).

and

â€ 
fâ€ â€  = e
R

(BË‡c)

Â· (f Â· (can Ã— A) Â· ((cid:73)(âˆ†X ) Ã— A))â€ 

(C)

= Ï€r Â· ((cid:104)f, f(cid:105) Â· (can Ã— A))â€ 
= Ï€r Â· (âˆ†X Â· f Â· (can Ã— A))â€ 
= Ï€r Â· âˆ†X
= (f Â· (âˆ†(cid:73)X Ã— A))â€ ,

(cid:124) (cid:123)(cid:122) (cid:125)

=idX

where the last equation follows from

can Â· (cid:73)(âˆ†X ) = (cid:104)(cid:73)Ï€(cid:96), (cid:73)Ï€r(cid:105) Â· (cid:73)(âˆ†X ) = (cid:104)(cid:73)(idX ), (cid:73)(idX )(cid:105) = (cid:104)id(cid:73)X , id(cid:73)X(cid:105) = âˆ†(cid:73)X .

This completes the proof.

3.2. Dinaturality

Finally, we discuss a property that is essentially a parametrized version of the composition
In fact, Bloom and Â´Esik [9] use the very name composition identity in this con-
identity.
text, calling the unguarded counterpart of our earlier (C) the simpliï¬ed composition identity
instead. As it turns out, this property and its variants are not easy to understand in the
guarded setting, leaving us with Open Problems 3.16 and 3.17. But ï¬rst, let us state basic
notions and facts.

Deï¬nition 3.13. We introduce the following possible property of a guarded ï¬xpoint category
(C, (cid:73),â€ ):
Dinaturality (D). For every f : (cid:73)X Ã— A â†’ Y and g : (cid:73)Y Ã— A â†’ X,

((cid:73)X Ã— A

(cid:104)pY Â·f,Ï€r(cid:105)

/(cid:73)Y Ã— A

g

/X )â€  = A

(cid:104)pY Â·hâ€ ,A(cid:105)

/(cid:73)Y Ã— A

g

/X,

where h = ((cid:73)Y Ã— A

(cid:104)pXÂ·g,Ï€r(cid:105)

/(cid:73)X Ã— A

f

/Y ).

22

/
/
/
/
/
/
/
/
For unguarded ï¬xpoint operators, it is well-known that the four Conway axioms are equiv-
alent to dinaturality, the parameter and double dagger identities (D, P, â€ â€ ), in other words,
dinaturality can replace the ï¬xpoint and composition identities (see, e.g., [32], [9, Ch. 6.2,
6.8â€“6.9], [16], [19, Ch. 7.1] and references therein). Proposition 3.15 below shows that we can
derive dinaturality from the Conway axioms at the price of extra assumptions on (cid:73). However,
no extra assumptions are needed for:
Proposition 3.14. Dinaturality holds in each unique guarded ï¬xpoint category (C, (cid:73)).

Proof. Given f , g and h as in the deï¬nition of dinaturality, we only need to prove that
g Â·(cid:104)pY Â· hâ€ , A(cid:105) : A â†’ X satisï¬es the ï¬xpoint identity (2.1) w.r.t. g Â·(cid:104)pY Â· f, Ï€r(cid:105) : (cid:73)X Ã— A â†’ X.
Consider the diagram below:

A
(cid:104)pY Â·hâ€ ,A,A(cid:105)

(cid:104)pY Â·hâ€ ,A(cid:105)
(cid:9)
(cid:73)Y Ã— A Ã— A

(cid:73)Y Ã—âˆ†

(cid:104)pY Â·hâ€ ,A(cid:105)
(cid:104)hâ€ ,A(cid:105)
(cid:73)Y Ã— A

(cid:9)

gÃ—A
X Ã— A

(cid:73)Y Ã— A
pY Ã—A

Y Ã— A

(cid:9)

(cid:104)(âˆ—),(cid:9)(cid:105)

(cid:104)pXÂ·g,Ï€r(cid:105)

pXÃ—A

g

(cid:9)

pY Ã—A /
(cid:104)f,Ï€r(cid:105)

X

g

/ (cid:73)Y Ã— A
(cid:9)
/ (cid:73)X Ã— A

(cid:104)pY Â·f,Ï€r(cid:105)

For (âˆ—), recall h = f Â· (cid:104)pX Â· g, Ï€r(cid:105) and then apply the ï¬xpoint identity.
Proposition 3.15. Dinaturality holds in each guarded Conway category (C, (cid:73),â€ ) such that
(cid:73) preserves products and is well-pointed (i.e. we have (cid:73)p = p(cid:73)).

Proof. We prove this property from the ï¬xpoint, composition and BekiË‡c identities. Given
f : (cid:73)X Ã— A â†’ Y and g : (cid:73)Y Ã— A â†’ X, let k = (cid:104)pY Â· f, Ï€r(cid:105). By (C), we have

(g Â· k)â€  = (A

(kÂ·((cid:73)gÃ—A))â€ 

/(cid:73)Y Ã— A

g

/X ).

Thus, in order to complete the proof it suï¬ƒces to show that

(cid:104)pY Â· hâ€ , A(cid:105) = ((cid:73)((cid:73)Y Ã— A) Ã— A

/(cid:73)Y Ã— A)â€ .
Since (cid:73) preserves products, we have canâˆ’1 : (cid:73)(cid:73)Y Ã— (cid:73)A â†’ (cid:73)((cid:73)Y Ã— A). Now let

/(cid:73)X Ã— A

k

(cid:73)gÃ—A /

m = pY Â· f Â· ((cid:73)g Ã— A) Â· (canâˆ’1 Ã— A) : (cid:73)(cid:73)Y Ã— (cid:73)A Ã— A â†’ (cid:73)Y,
n = Ï€r : (cid:73)(cid:73)Y Ã— (cid:73)A Ã— A â†’ A.

Then we clearly have (cid:104)m, n(cid:105) Â· (can Ã— A) = k Â· ((cid:73)g Ã— A). Now we apply the BekiË‡c identity to
obtain

â€ 
â€ 
((cid:104)m, n(cid:105) Â· (can Ã— A))â€  = (cid:104)e
R(cid:105) : A â†’ (cid:73)Y Ã— A,
L, e

where

eR

eL

by def

= n Â· (cid:104)p(cid:73)Y Â· mâ€ , (cid:73)A Ã— A(cid:105) = Ï€r : (cid:73)A Ã— A â†’ A
â€ 
R, A(cid:105)) : (cid:73)(cid:73)Y Ã— A â†’ (cid:73)Y.
= m Â· ((cid:73)(cid:73)Y Ã— (cid:104)pA Â· e

by def

23



/
/
+
+
(
(
/
/


o
o
+
+
O
O
O
O
/
O
O
g
g
/
/
/
Using eR = Ï€r we see that e

â€ 
Thus we obtain e
L

â€ 
R

(â€ )
= eR Â· (pA Ã— A) Â· (cid:104)e

eL = pY Â· f Â· ((cid:73)g Ã— A) Â· (canâˆ’1 Ã— A)

(cid:124)
= pY Â·(cid:0)f Â· ((cid:73)g Ã— A) Â· (canâˆ’1 Ã— A) Â· ((cid:73)(cid:73)Y Ã— (cid:104)pA, A(cid:105)) Â· ((cid:73)pY Ã— A)(cid:1)â€ 

â€ 
R, A(cid:105) = idA. So we have
(cid:125)
Â·((cid:73)(cid:73)Y Ã— (cid:104)pA, A(cid:105)).

(cid:123)(cid:122)

(C)

m

= pY Â· (f Â· (cid:104)pX Â· g, Ï€r(cid:105))â€ ,

f (cid:46) g =(cid:0)(cid:73)Y Ã— A
(cid:0)(cid:73)X Ã— A

where the second equation is derived as follows: it is suï¬ƒcient to prove that the two morphisms
inside â€  after removal of f are equal, and for this one considers the product components of
(cid:73)X Ã— A (their codomain) separately. The right-hand component is obviously Ï€r and the
left-hand one follows from
pX Â· g

(cid:73)g Â· p(cid:73)Y Ã—A = (cid:73)g Â· canâˆ’1 Â· ((cid:73)pY Ã— pA),

(nat. of p)

=

where the second equation is derived using well-pointedness of (cid:73): can Â· p(cid:73)Y Ã—A = p(cid:73)Y Ã— pA =
(cid:73)pY Ã— pA.
Open Problem 3.16. Do (D, P, â€ â€ ) imply the ï¬xpoint and simpliï¬ed composition identities?
Further inspection reveals a curious asymmetry here. Under the assumption that (cid:73) pre-
serves products one can formulate two related versions of dinaturality where the given mor-
phisms only contain one (cid:73). For these properties we use for given f : (cid:73)X Ã— A â†’ Y and
g : Y Ã— A â†’ X the morphism

(cid:73)Y Ã—(cid:104)pA,A(cid:105)

/(cid:73)Y Ã— (cid:73)A Ã— A

canâˆ’1Ã—A /

/(cid:73)(Y Ã— A) Ã— A

(cid:73)gÃ—A /

/(cid:73)X Ã— A

f

/Y(cid:1).

Property (D1). Given f : (cid:73)X Ã— A â†’ Y and g : Y Ã— A â†’ X we have

/Y Ã— A
Property (D2). Given f : X Ã— A â†’ Y and g : (cid:73)Y Ã— A â†’ X we have

/Y Ã— A

g

(cid:104)(f (cid:46) g)â€ ,A(cid:105)

(cid:104)f,Ï€r(cid:105)

/X(cid:1)â€ 

=(cid:0)A

/X(cid:1).

g

where h =(cid:0)(cid:73)Y Ã— A

(cid:104)g,Ï€r(cid:105)

/X Ã— A

f

/Y(cid:1).

(g (cid:46) f )â€  = g Â· (cid:104)pY Â· hâ€ , A(cid:105),

Whenever (cid:73) is moreover well-pointed, each of (D1) and (D2) implies (D). One also readily
proves, by adapting the proofs for unguarded operators, that (D1) implies the simpliï¬ed
composition identity (C) and that (D2) implies the ï¬xpoint identity (â€ ). Conversely, the
Conway axioms imply the ï¬rst version of dinaturality (D1). For the sake of brevity we leave
the details to the reader. What defeats us at the moment is:

Open Problem 3.17.

â€¢ Do the Conway axioms imply (D2)?
â€¢ Does (D1) imply (D2)?

24

/
/
/
/
/
/
/
/
4. Guarded Trace Operators
In the special case of Example 2.4.(1), i.e., (cid:73) being the identity functor, it is well-known that
a ï¬xpoint operator satisfying the Conway axioms is equivalent to a trace operator w.r.t. the
product on C [18, 19]. In this section we present a similar result for a generalized notion of a
guarded trace operator on (C, (cid:73)).
Remark 4.1. Recall that Joyal, Street and Verity [20] introduced the unguarded notion of
a trace operator for (symmetric) monoidal categories. The applicability to non-cartesian
tensor products is in fact one of main reasons of its popularity. Our generalization can also be
formulated in the symmetric monoidal setting, see Remark 4.3 below. However, Theorems 4.5
and 4.7, the main results in this section, do not make any use of this added generality. Hence,
we keep the Assumption 2.1 like in the remainder of the paper.
Deï¬nition 4.2. A (cartesian) guarded trace operator on (C, (cid:73)) is a natural family of opera-
tions

A,B : C((cid:73)X Ã— A, X Ã— B) â†’ C(A, B)
TrX

subject to the following three conditions:

1. Vanishing. (V1) For every f : (cid:73)1 Ã— A â†’ B âˆ¼= 1 Ã— B we have

A,B(f ) = (A âˆ¼= 1 Ã— A
Tr1

/(cid:73)1 Ã— A
(V2) For every f : (cid:73)X Ã— (cid:73)Y Ã— A â†’ X Ã— Y Ã— B we have
canÃ—A /

p1Ã—A /

A,B(TrX(cid:73)Y Ã—A,Y Ã—B(f )) = TrXÃ—Y
TrY

A,B ((cid:73)(X Ã— Y ) Ã— A

f

/B ).

/(cid:73)X Ã— (cid:73)Y Ã— A

f /

/X Ã— Y Ã— B ).

2. Superposing (S). For every f : (cid:73)X Ã— A â†’ X Ã— B we have
A,B(f ) Ã— C.

AÃ—C,BÃ—C(f Ã— C) = TrX
TrX

3. Yanking (Y). Consider the canonical isomorphism c : (cid:73)X Ã— X â†’ X Ã— (cid:73)X. Then we

have

TrX

X,(cid:73)X (c) = (X

pX /

/(cid:73)X ).

If Tr is a (cartesian) guarded trace operator on (C, (cid:73)), (C, (cid:73), Tr) is called a guarded traced

(cartesian) category.

Of course, when (cid:73) is taken to be the identity on C as in Example 2.4.(1), our notion of
guarded trace specializes to the notion of an ordinary trace operator (w.r.t. product) of Joyal,
Street and Verity. In addition, the naturality of Tr can equivalently be expressed by three
more axioms, just like in the unguarded case:

4. Left-tightening (Lt). Given f : (cid:73)X Ã— A â†’ X Ã— B and g : A(cid:48) â†’ A we have

A(cid:48),B((cid:73)X Ã— A(cid:48)
TrX

(cid:73)XÃ—g

/(cid:73)X Ã— A

f

/X Ã— B ) = (A(cid:48)

g

/A

TrX

A,B(f )

/B ).

25

/
/
/
/
/
5. Right-tightening (Rt). Given f : (cid:73)X Ã— A â†’ X Ã— B and g : B â†’ B(cid:48) we have

A,B(cid:48)((cid:73)X Ã— A
TrX

/B
6. Sliding (Sl). Given f : (cid:73)X Ã— A â†’ X(cid:48) Ã— B and g : X(cid:48) â†’ X we have

f

/X Ã— B

XÃ—g /

/X Ã— B(cid:48) ) = (A

TrX

A,B(f )

g

/B(cid:48) ).

gÃ—B /

(cid:73)gÃ—A /

f

/X(cid:48) Ã— B

A,B((cid:73)X(cid:48) Ã— A

/X Ã— B ) = TrX(cid:48)

A,B((cid:73)X Ã— A
TrX

/X(cid:48) Ã— B ).
Remark 4.3. The generalization for a symmetric monoidal category (C,âŠ—, I, c) equipped with
a pointed endofunctor (cid:73) : C â†’ C requires the assumption that (cid:73) is comonoidal, i.e., equipped
with a morphism mI : (cid:73)I â†’ I and a natural transformation mX,Y : (cid:73)(X âŠ— Y ) â†’ (cid:73)X âŠ— (cid:73)Y
satisfying the usual coherence conditions. In fact, in the formulation of Vanishing (V2) we
used that in every category the product Ã— is comonoidal via mX,Y = can.
Construction 4.4.

1. Let (C, (cid:73), Tr) be a guarded traced category. Deï¬ne a guarded

/(cid:73)X Ã— A

f

ï¬xpoint operator â€ Tr : C((cid:73)X Ã— A, X) â†’ C(A, X) by

fâ€ Tr = TrX

A,X ((cid:73)X Ã— A

(cid:104)f,f(cid:105)

/X Ã— X ) : A â†’ X.

2. Conversely, suppose (C, (cid:73),â€ ) is a guarded ï¬xpoint category. Deï¬ne Trâ€ X

A, X Ã— B) â†’ C(A, B) by setting for every f : (cid:73)X Ã— A â†’ X Ã— B

A,B : C((cid:73)X Ã—

Trâ€ X

A,B(f ) = (A

(cid:104)(Ï€(cid:96)Â·f )â€ ,A(cid:105)

/X Ã— A

pXÃ—A

/(cid:73)X Ã— A

f

/X Ã— B

Ï€r

/B ).

Theorem 4.5.

1. Whenever (C, (cid:73), Tr) is a guarded traced category, (C, (cid:73),â€ Tr) is a guarded

Conway category. Furthermore, Trâ€ Tr is the original operator Tr.

2. Whenever (C, (cid:73),â€ ) is a guarded Conway category, (C, (cid:73), Trâ€ ) is guarded traced. Fur-

thermore, â€ Trâ€  is the original operator â€ .

The proof details are similar to the unguarded case in Hasegawa [19]. As the derivation of
the guarded version of the BekiË‡c identity in Proposition 3.10 has already shown, it is not a
completely automatic adaptation. We give a complete proof in Appendix B below.

The process requires some creativity at times.
Hasegawa related uniformity of trace to uniformity of dagger and we can do the same
in the guarded setup. Recall that in iteration theories uniformity (called functorial dagger
implication) plays an important role. On the one hand, this quasiequation implies the so-
called commutative identities, an inï¬nite set of equational axioms that are added to the
Conway axioms in order to yield a complete axiomatization of ï¬xpoint operators in domains.
On the other hand, most examples of iteration theories actually satisfy uniformity, and so
uniformity gives a convenient suï¬ƒcient condition to verify that a given Conway theory is
actually an iteration theory.
Deï¬nition 4.6. A guarded trace operator Tr is called uniform if for every f : (cid:73)X Ã— A â†’
X Ã— B, f(cid:48) : (cid:73)X(cid:48) Ã— A â†’ X(cid:48) Ã— B and h : X â†’ X(cid:48),

(cid:73)X Ã— A
(cid:73)hÃ—A
(cid:73)X(cid:48) Ã— A

X Ã— B
hÃ—B
/ X(cid:48) Ã— B

f

(cid:9)

f(cid:48)

=â‡’

26

A,B(f ) = TrX(cid:48)

A,B(f(cid:48)) : A â†’ B.

TrX

/
/
/
/
/
/
/
/
/
/
/
/




/
A uniform guarded traced category is a guarded traced category (C, (cid:73), Tr) where Tr is uniform.
1. Whenever (C, (cid:73), Tr) is a uniform guarded traced category, (C, (cid:73),â€ Tr) is

Theorem 4.7.

a uniform guarded Conway category.

2. Whenever (C, (cid:73),â€ ) is a uniform guarded Conway category, (C, (cid:73), Trâ€ ) is a uniform

guarded traced category.

The proof is in Appendix C.

Remark 4.8. Actually, Hasegawa proved a slightly stronger statement concerning uniformity
than what we stated in Theorem 4.7; he showed that a Conway operator is uniform w.r.t. any
ï¬xed morphism h : X â†’ X(cid:48) (i.e. satisï¬es uniformity just for h) iï¬€ the corresponding trace
operator is uniform w.r.t. this morphism h. The proof is somewhat more complicated and in
our guarded setting we leave this as an exercise to the reader.

Finally, let us note that the bijective correspondence between guarded Conway opera-
tors and guarded trace operators established in Theorem 4.5 yields an isomorphism of the
(2-)categories of (small) guarded Conway categories and guarded traced (cartesian) categories.
The corresponding notions of morphisms are, of course, as expected:

Deï¬nition 4.9.

1. F : (C, (cid:73)C,â€ ) â†’ (D, (cid:73)D,â€¡) is a morphism of guarded Conway cate-

gories whenever F : C â†’ D is a ï¬nite-product-preserving functor satisfying

C (cid:73)C
(cid:9)

F

D (cid:73)D

C

F

/ D

and pD

F X = F (pC

X ) : F X â†’ (cid:73)DF X = F ((cid:73)CX),

(4.1)

and preserving dagger, i.e., for every f : (cid:73)X Ã— A â†’ X we have

F (fâ€ ) = ((cid:73)DF X Ã— F A âˆ¼= F ((cid:73)CX Ã— A)

F f /

/F X )â€¡.

2. A morphism F : (C, (cid:73)C, TrC) â†’ (D, (cid:73)D, TrD) of guarded traced categories is a ï¬nite-
product-preserving F : C â†’ D satisfying (4.1) above and preserving the trace operation:
for every f : (cid:73)CX Ã— A â†’ X Ã— B in C we have
F (Tr XC A,B(f )) = Tr F XD F A,F B((cid:73)DF X Ã— F A âˆ¼= F ((cid:73)CX Ã— A)

/F (X Ã— B) âˆ¼= F X Ã— F B ).

F f /

Corollary 4.10. The (2-)categories of guarded Conway categories and of guarded traced
(cartesian) categories are isomorphic.

The proof is in Appendix D.

5. Conclusions and Future Work

We have made the ï¬rst steps in the study of equational properties of guarded ï¬xpoint opera-
tors popular in the recent literature [29, 30, 3, 6, 8, 22, 21, 8, 4, 23]. We began with an extensive
list of examples, including some not discussed so far as instances of delay endofunctorsâ€”e.g.,

27

/
/




/
Example 2.4.(6) or completely iterative theories in Section 2.2. Furthermore, we formulated
the four Conway axioms and the uniformity property in analogy to their unguarded counter-
parts and we showed their soundness w.r.t. the models discussed in Section 2. In particular,
Theorem 3.4 proved that our axioms hold in all categories with a unique guarded dagger. In
Theorem 4.5, we have a generalization of a result by Hasegawa for ordinary ï¬xpoint operators:
we proved that to give a (uniform) guarded ï¬xpoint operator satisfying the Conway axioms
is equivalent to giving a (uniform) guarded trace operator on the same category.

Our paper can be considered as a work in progress report. The long-term goal is to arrive
at completeness results similar to the ones for iteration theories. We do not claim that the
axioms we presented are complete. In the unguarded setting, completeness is obtained by
adding to the Conway axioms an inï¬nite set of equational axioms called the commutative
identities
[9, 31]. We did not consider those here, but we considered the quasi-equational
property of uniformity which implies the commutative identities and is satisï¬ed in most models
of interest. Only further research can show whether this property can ensure completeness in
the guarded setup or one needs to postulate stronger ones.
Let us recall Open Problem 3.8 regarding soundness of (â€ â€ ) in the general setting of Crole
and Pitts [10, 11] and intriguingly complex status of guarded dinaturality leading to Open
Problems 3.16 and 3.17.

It would also be interesting to study further examples of guarded traced monoidal categories
which are not ordinary traced monoidal categories and which do not arise from guarded
Conway categories. We have obtained some such examples but more work is needed to
develop a full-blown theory. We postpone a detailed discussion to future work.

Acknowledgements We would like to thank the anonymous referees whose comments have
helped to improve the presentation of our paper. Thanks are also due to AleË‡s Bizjak for
providing us with Example 2.8. Besides, we would like to acknowledge an inspiring discussion
with Erwin R. Catesbeiana on (un-)productive (non-)termination. Finally, we have to credit
in general William and Arthur for their very insistence on modal undertones in modern
modelling of this major phenomenon (cf. [3, 17]).

References

[1] Aczel, P., AdÂ´amek, J., Milius, S., Velebil, J.: Inï¬nite Trees and Completely Iterative

Theories: A Coalgebraic View, Theoret. Comput. Sci., 300, 2003, 1â€“45.

[2] AdÂ´amek, J., Milius, S.: Terminal Coalgebras and Free Iterative Theories, Inform. and

Comput., 204, 2006, 1139â€“1172.

[3] Appel, A. W., Melli`es, P.-A., Richards, C. D., Vouillon, J.: A very modal model of a
modern, major, general type system, POPL (M. Hofmann, M. Felleisen, Eds.), ACM,
2007, ISBN 1-59593-575-4.

[4] Atkey, R., McBride, C.: Productive Coprogramming with Guarded Recursion, Proceed-
ings of the 18th ACM SIGPLAN International Conference on Functional Programming,
ICFP â€™13, ACM, New York, NY, USA, 2013, ISBN 978-1-4503-2326-0.

[5] Badouel, E.: Terms and inï¬nite trees as monads over a signature, Lecture Notes Com-

put. Sci., 351, 1989, 89â€“103.

28

[6] Benton, N., Tabareau, N.: Compiling functional types to relational speciï¬cations for
low level imperative code, TLDI (A. Kennedy, A. Ahmed, Eds.), ACM, 2009, ISBN
978-1-60558-420-1.

[7] Birkedal, L., MÃ¸gelberg, R. E.: Intensional Type Theory with Guarded Recursive Types

qua Fixed Points on Universes, Proceedings of LICS, 2013.

[8] Birkedal, L., MÃ¸gelberg, R. E., Schwinghammer, J., StÃ¸vring, K.: First Steps in Synthetic
Guarded Domain Theory: Step-Indexing in the Topos of Trees, Logical Methods in
Computer Science, 8(4:1), 2012, 1â€“45.

[9] Bloom, S. L., Â´Esik, Z.: Iteration Theories: the equational logic of iterative processes,

EATCS Monographs on Theoretical Computer Science, Springer, 1993.

[10] Crole, R. L.: Programming Metalogics with a Fixpoint Type, Ph.D. Thesis, Computer

Laboratory, University of Cambridge, 1991.

[11] Crole, R. L., Pitts, A. M.: New Foundations for Fixpoint Computations: FIX-

Hyperdoctrines and FIX-Logic, Inform. and Comput., 98(2), 1992, 171â€“210.

[12] Di Gianantonio, P., Miculan, M.: Unifying Recursive and Co-recursive Deï¬nitions in
Sheaf Categories,
in: Foundations of Software Science and Computation Structures
(I. Walukiewicz, Ed.), vol. 2987 of Lecture Notes in Computer Science, Springer Berlin
/ Heidelberg, 2004, ISBN 978-3-540-21298-0, 136â€“150, 10.1007/978-3-540-24727-2 11.

[13] Elgot, C. C.: Monadic Computation and Iterative Algebraic Theories, Logic Colloquium
â€™73 (H. E. Rose, J. C. Sheperdson, Eds.), 80, North-Holland Publishers, Amsterdam,
1975.

[14] Elgot, C. C., Bloom, S. L., Tindell, R.: On the algebraic structure of rooted trees,

J. Comput. System Sci., 16, 1978, 362â€“399.

[15] Â´Esik, Z.: Independence of the Equational Axioms for Iteration Theories, J. Comput. Sys-

tem Sci., 36, 1988, 66â€“76.

[16] Â´Esik, Z.: Fixed Point Theory, in: Handbook of Weighted Automata (M. Droste, W. Kuich,
H. Vogler, Eds.), Monographs in Theoretical Computer Science. An EATCS Series,
Springer Berlin Heidelberg, 2009, ISBN 978-3-642-01491-8, 29â€“65.

[17] Gilbert, W. S., Sullivan, A.: The Pirates of Penzance, or The Slave of Duty, 1879.

[18] Hasegawa, M.: Recursion from Cyclic Sharing: Traced Monoidal Categories and Models
of Cyclic Lambda Calculi, Proc. 3rd International Conference on Typed Lambda Calculi
and Applications, 1210, Springer-Verlag, 1997.

[19] Hasegawa, M.: Models of Sharing Graphs: A Categorical Semantics of let and letrec,

Distinguished Dissertation Series, Springer, 1999.

[20] Joyal, A., Street, R., Verity, D.: Traced Monoidal Categories, Math. Proc. Cambridge

Philos. Soc., 119(3), 1996, 447â€“468.

[21] Krishnaswami, N. R., Benton, N.: A semantic model for graphical user interfaces, ICFP
(M. M. T. Chakravarty, Z. Hu, O. Danvy, Eds.), ACM, 2011, ISBN 978-1-4503-0865-6.

29

[22] Krishnaswami, N. R., Benton, N.: Ultrametric Semantics of Reactive Programs, LICS,

IEEE Computer Society, IEEE Computer Society, 2011, ISBN 978-0-7695-4412-0.

[23] Litak, T.: Constructive modalities with provability smack, in: Leo Esakia on duality in
modal and intuitionistic logics (G. Bezhanishvili, Ed.), vol. 4 of Outstanding Contribu-
tions to Logic, Springer, 2014, 179â€“208.

[24] Manes, E. G.: Handbook of Algebra, vol. 3, chapter Monads of Sets, Elsevier, 2003,

67â€“153.

[25] Milius, S.: Completely Iterative Algebras and Completely Iterative Monads, Inform. and

Comput., 196, 2005, 1â€“41.

[26] Milius, S., Litak, T.: Guard Your Daggers and Traces: On The Equational Properties of
Guarded (Co-)recursion, Proc. Fixed Points in Computer Science (FICSâ€™13) (D. Baelde,
A. Carayol, Eds.), Electron. Proc. Theoret. Comput. Sci., 2013.

[27] Milner, R.: Communication and Concurrency, International Series in Computer Science,

Prentice Hall, 1989.

[28] Mulry, P. S.: Lifting Theorems for Kleisli Categories, Proc. Mathematical Foundations
of Programming Semantics (MFPSâ€™93) (S. Brookes, M. Main, A. Melton, M. Mislove,
D. Schmidt, Eds.), 802, Springer, 1994.

[29] Nakano, H.: A Modality for Recursion, LICS, IEEE Computer Society, 2000,

ISBN

0-7695-0725-5.

[30] Nakano, H.: Fixed-Point Logic with the Approximation Modality and Its Kripke Com-
pleteness, TACS (N. Kobayashi, B. C. Pierce, Eds.), 2215, Springer, 2001, ISBN 3-540-
42736-8.

[31] Simpson, A., Plotkin, G. D.: Complete axioms for categorical ï¬xed-point operators,
Proc. 15th Symposium on Logic in Computer Science (LICSâ€™00), IEEE Computer Society,
2000.

[32] Stefanescu, G.: On Flowchart Theories. I. The Deterministic Case, J. Comput. Syst.

Sci., 35(2), 1987, 163â€“191.

A. Details for Example 2.4.(5)
First observe that (cid:73)X is clearly a presheaf: for every w(cid:48) â‰¤ w there exists a canonical morphism
(cid:73)X(w) = limv<w X(v) â†’ limv<w(cid:48) X(v) = (cid:73)X(w(cid:48)) induced by the universal property of the
limit in the codomain; the functoriality easily follows from the uniqueness.
Next we deï¬ne (cid:73) on a morphism f : X â†’ Y componentwise: for every w, ((cid:73)f )w is the

unique morphism such that the following equations hold:

Ï€v Â· ((cid:73)f )w = fv Â· Ï€v,

(v < w),

where Ï€v : X(w) = limv<w X(v) â†’ X(v) denotes the limit projection. To see that ((cid:73)f )w
is natural in w it suï¬ƒces to show that for any w > w(cid:48) the corresponding naturality square

30

commutes when extended by the projection Ï€(cid:48)

v : (cid:73)Y (w(cid:48)) â†’ Y (v) for every v < w(cid:48):
((cid:73)f )w

(cid:73)Y (w)

(cid:73)X(w)

Ï€v

(cid:73)X(w>w(cid:48))

(cid:9)
Ï€(cid:48)
(cid:73)X(w(cid:48))

v

X(v)

(cid:9)
fv /

(cid:9)

Y (v)

Ï€v

(cid:9)
Ï€(cid:48)

v

(cid:73)Y (w>w(cid:48))

((cid:73)f )w(cid:48)

(cid:73)Y (w(cid:48))

â€ 
w is well-deï¬ned and that fâ€  is a morphism of C, i.e., f

A routine calculation then shows that (cid:73) : C â†’ C is functorial.
The point p : Id â†’ (cid:73) is given componentwise as the unique morphism (pX )w : X(w) â†’
(cid:73)X(w) such that Ï€v Â· (pX )w = X(w > v) for all v < w. Two easy routine calculations using
the deï¬nitions of (cid:73)X and (cid:73) on morphisms, respectively, show that each component pX is
natural in w and that p is natural in X.
Let us now turn to the guarded ï¬xpoint operator â€ . We ï¬rst prove simultaneously that
â€ 
w is natural in w. This is done
each f
by induction on (W,â‰¤) (note that we do not have to distinguish the base case and induction
â€ 
step here). Fix any w âˆˆ W and assume that f
v is well-deï¬ned for any v < w and that the
â€ 
v holds for any v(cid:48) < v which are smaller
naturality condition f
than w. (Note that for a minimal w âˆˆ W this holds trivially.) The latter naturality condition
â€ 
implies the cone property for f
w is well-
deï¬ned. We proceed to showing the naturality condition for any w > w(cid:48) using the following
diagram (with k(cid:48) induced by the cone f

â€ 
v Â· Y (w > v) inducing k : Y (w) â†’ (cid:73)X(w) so that f

â€ 
v(cid:48) Â· Y (v > v(cid:48)) = X(v > v(cid:48)) Â· f

â€ 
v Â· Y (w(cid:48) > v)):

(cid:104)k,Y (w)(cid:105)

Y (w)

Y (w>w(cid:48))

(cid:104)(âˆ—),(cid:9)(cid:105)

Y (w(cid:48)) (cid:104)k(cid:48),Y (w(cid:48))(cid:105)

(cid:73)X(w) Ã— Y (w)
(cid:73)X(w>w(cid:48))Ã—Y (w>w(cid:48))
/ (cid:73)X(w(cid:48)) Ã— Y (w(cid:48))

â€ 
f
w
(cid:9)

(cid:9)
â€ 
w(cid:48)

f

fw

(cid:9)

fw(cid:48)

X(w)

X(w>w(cid:48))

/ X(w(cid:48))

(Note that (cid:104)(âˆ—), (cid:9)(cid:105) indicates that the right-hand product component of that part obviously
commutes and the left-hand part, called (âˆ—) is considered further.) Part (âˆ—) is seen commu-
tative by extending it with the limit projection Ï€v : Y (w(cid:48)) â†’ Y (v) for every v < w(cid:48) and
performing a routine calculation. (Note again that this covers the cases where w or w(cid:48) are
minimal and consequently k and k(cid:48), respectively, are the unique morphisms with codomain
1.)
We are ready to verify the commutativity of (2.1). This is done componentwise by induction
on (W,â‰¤). Assume that for a given w all components of (2.1) at v < w commute. Then we
obtain for the w-component of fâ€  the following diagram (where k is again induced by the cone
â€ 
v Â· Y (w > v) and h by the cone fv Â· ((pX )v Ã— Y (v))Â· (Ï€v Ã— Y (w > v)) : (cid:73)X(w)Ã— Y (w) â†’ X(v)
f

31

/
/


%
%


y
y
/
/
/
9
9
e
e


/
/
/
/






/
/
O
O
Y (v)

f

â€ 
v

Y (w>v)

Y (w)

(cid:9)

k

Ï€v

(cid:73)X(w)

X(v)

fv

(cid:104)f

â€ 
v ,Y (v)(cid:105)

(cid:9)

X(v) Ã— Y (v)

(i)

(cid:104)k,Y (w)(cid:105)
(cid:73)X(w) Ã— Y (w)
Ï€vÃ—Y (w>v)

h

(pX )vÃ—Y (v)

(cid:9)

/ (cid:73)X(v) Ã— Y (v)

for all v < w):

â€ 
f
w
(cid:9)

(cid:73)X(w) Ã— Y (w)

(cid:104)k,Y (w)(cid:105)

Y (w)

(cid:104)(i),(cid:9)(cid:105)
(cid:104)k,Y (w),Y (w)(cid:105)
(cid:73)X(w) Ã— Y (w) Ã— Y (w)

hÃ—Y (w)

(cid:104)(ii),(cid:9)(cid:105)

fw

X(w)

(cid:9)

fw

fwÃ—Y (w)
X(w) Ã— Y (w)

(pX )wÃ—Y (w)

/ (cid:73)X(w) Ã— Y (w)

Note that we are done if w is minimal since (cid:73)X(w) = 1 is the terminal object. Otherwise
for part (i) we extend with the limit projection Ï€v for every v < w to obtain the following
diagram (its outside commutes by the induction hypothesis, hence, so does part (i) extended
by Ï€v):

For part (ii) observe ï¬rst that (pX )v Â· Ï€v = (cid:73)X(w > v); indeed, this follows by routine
calculation extending both sides by the limit projection Ï€u : (cid:73)X(v) â†’ X(u) for every u < v.
Now we obtain the commutativity of part (ii) by extending it with every limit projection Ï€v:

(cid:73)X(w) Ã— Y (w)

(cid:73)

X

(

w

h

Ï€vÃ—Y (w>v)

(cid:73)X(w)

(cid:9)
)Ã—

X(v) Ã— Y (v)

(cid:9)

Ï€v

>

v

fw

(cid:9)

(nat. of f )

X(w)

Y

(

w

>

v

)

(pX )vÃ—Y (v)
fv

(cid:73)X(v) Ã— Y (v)

(cid:9)

X(w>v)

(def. of p)

(pX )w

/ X(v)

Ï€v

/ (cid:73)X(w)

It remains to prove that fâ€  is unique such that (2.1) commutes. Suppose that s : Y â†’ X
is such that s = f Â· (pX Ã— Y )Â·(cid:104)s, Y (cid:105). Then we prove that fâ€  = s componentwise by induction
â€ 
on (W,â‰¤). Assume that sv = f
v holds for all v < w. This implies that k is the morphism
induced by the cone sv Â· Y (w > v) = X(w > v) Â· sw : Y (w) â†’ X(v). Hence, for all v < w we
have

Ï€v Â· k = X(w > v) Â· sw = Ï€v Â· (pX )w Â· sw

32

/
/


/
/


4
4


/
O
O


/
/
h
h
/
/


7
7
v
v
7
7
/
O
O
/
/


"
"
)
)




/
3
3
/
O
O
from which we conclude that k = (pX )w Â· sw. (In the special case where w is minimal this
equation holds since it is an equation between morphisms with codomain (cid:73)X(w) = 1.) Thus,
we obtain

â€ 
w = fw Â· (cid:104)k, Y (w)(cid:105)
f

= fw Â· (cid:104)(pX )w Â· sw, Y (w)(cid:105)
= sw

â€ 
w)

(def. of f
(since k = (pX )w Â· sw)
(since s = f Â·(pX Ã—Y )Â·(cid:104)s, Y (cid:105)).

This completes the proof.

B. Proof of Theorem 4.5

The proof of Theorem 4.5 proceeds in three steps:
1. We show that â€ Tr deï¬ned in Construction 4.4.1 is a guarded trace operator.
2. We show that Trâ€  deï¬ned in Construction 4.4.2 satisï¬es the Conway axioms.
3. We show that the two constructions are mutually inverse, i.e. â€ T râ€  = â€  and Trâ€ Tr = Tr.

In the ï¬rst two sections we shall drop the subscripts and only write Tr and â€  in lieu of Trâ€ 
and â€ Tr, respectively. The proof is an adaptation of Hasegawaâ€™s proof for ordinary traces and
ï¬xpoint operators in [19].

B.1. From trace to dagger
We will now prove that the â€ -operation deï¬ned in Construction 4.4.1 satisï¬es the Conway
axioms. But before we need an analogue of the ï¬xpoint identity for traces:
Lemma B.1. For every f : (cid:73)X Ã— A â†’ X Ã— B we form

(cid:0)(cid:73)X Ã— A

h = TrX

A,X

f

/X Ã— B

Ï€(cid:96)

/X âˆ† /

/X Ã— X(cid:1).

Then we have

A,B(f ) =(cid:0)A

TrX

(cid:104)h,A(cid:105)

/X Ã— A

pXÃ—A /

/(cid:73)X Ã— A

f

/X Ã— B

Ï€r

/B(cid:1).

Proof. Let c : (cid:73)X Ã— X â†’ X Ã— (cid:73)X denote the canonical isomorphism swapping components.
Observe that we have

c Â· (pX Ã— X) Â· âˆ†X = c Â· (cid:104)pX , X(cid:105) = (cid:104)X, pX(cid:105) = (X Ã— pX ) Â· âˆ†X

and

(X Ã— c) Â· (c Ã— X) Â· ((cid:73)X Ã— âˆ†X ) = (âˆ†X Ã— (cid:73)X) Â· c.

(B.1)

(B.2)

33

/
/
/
/
/
Now we compute

pX Â· h = pX Â· TrX

A,X (âˆ†X Â· Ï€(cid:96) Â· f )

by def. of h

(Rt)
= TrX
(B.1)
= TrX
(Y )
= TrX
(S)
= TrX
(Lt)
= TrX
(Rt)
= TrX
(B.2)
= TrX
= TrXÃ—X
(V 2)
(Sl)
= TrX
= TrX

X,(cid:73)X (c) Ã— X) Â· âˆ†X Â· Ï€(cid:96) Â· f )
XÃ—X,(cid:73)XÃ—X (c Ã— X) Â· âˆ†X Â· Ï€(cid:96) Â· f )

A,(cid:73)X ((X Ã— pX ) Â· âˆ†X Â· Ï€(cid:96) Â· f )
A,(cid:73)X (c Â· (pX Ã— X) Â· âˆ†X Â· Ï€(cid:96) Â· f )
A,(cid:73)X (c Â· (TrX
A,(cid:73)X (c Â· TrX
A,(cid:73)X (c Â· TrX(cid:73)XÃ—A,(cid:73)XÃ—X ((c Ã— X) Â· ((cid:73)X Ã— (âˆ†X Â· Ï€(cid:96) Â· f ))))
A,(cid:73)X (TrX(cid:73)XÃ—A,XÃ—(cid:73)X ((X Ã— c) Â· (c Ã— X) Â· ((cid:73)X Ã— (âˆ†X Â· Ï€(cid:96) Â· f ))))
A,(cid:73)X (TrX(cid:73)XÃ—A,XÃ—(cid:73)X ((âˆ†X Ã— (cid:73)X) Â· c Â· ((cid:73)X Ã— (Ï€(cid:96) Â· f ))))
A,(cid:73)X ((âˆ†X Ã— (cid:73)X) Â· c Â· ((cid:73)X Ã— (Ï€(cid:96) Â· f )) Â· (can Ã— A))
A,(cid:73)X (c Â· ((cid:73)X Ã— (Ï€(cid:96) Â· f )) Â· (can Ã— A) Â· ((cid:73)(âˆ†X ) Ã— A))
A,(cid:73)X (c Â· ((cid:73)X Ã— (Ï€(cid:96) Â· f )) Â· (âˆ†(cid:73)X Ã— A))

Using this we can ï¬nish the proof:
Ï€r Â· f Â· (cid:104)pX Â· h, A(cid:105) = Ï€r Â· f Â· ((pX Â· h) Ã— A) Â· âˆ†A

(S)

= Ï€r Â· f Â· TrX
= Ï€r Â· f Â· TrX

(Lt)

AÃ—A,(cid:73)XÃ—A((c Ã— A) Â· ((cid:73)X Ã— (Ï€(cid:96) Â· f ) Ã— A) Â· (âˆ†(cid:73)X Ã— A Ã— A)) Â· âˆ†A
(cid:125)
A,(cid:73)XÃ—A((c Ã— A) Â· ((cid:73)X Ã— (Ï€(cid:96) Â· f ) Ã— A) Â· (âˆ†(cid:73)X Ã— A Ã— A) Â· ((cid:73)X Ã— âˆ†A)

(cid:123)(cid:122)
=âˆ†(cid:73)XÃ—âˆ†A
A,B((X Ã— (Ï€r Â· f )) Â· (c Ã— A) Â· ((cid:73)X Ã— (Ï€(cid:96) Â· f ) Ã— A) Â· (âˆ†(cid:73)X Ã— âˆ†A))
A,B((cid:104)Ï€(cid:96) Â· f, Ï€r Â· f(cid:105))
A,B(f ),

(cid:124)

)

(Rt)
= TrX
= TrX
= TrX

which completes the proof of the lemma.

We now verify the Conway axioms for the â€ -operation from Construction 4.4.1.
(1) Fixpoint identity. Given f : (cid:73)X Ã— A â†’ X we apply Lemma B.1 to (cid:104)f, f(cid:105); then

h = TrX

A,X (âˆ†X Â· Ï€(cid:96) Â· (cid:104)f, f(cid:105)) = TrX

A,X ((cid:104)f, f(cid:105)) = fâ€ 

and therefore we have

fâ€  = TrX

A,X(cid:104)f, f(cid:105)

by def. of â€ 
= Ï€r Â· (cid:104)f, f(cid:105) Â· (pX Ã— A) Â· (cid:104)h, A(cid:105) by Lemma B.1
= f Â· (pX Ã— A) Â· (cid:104)fâ€ , A(cid:105)
since h = fâ€ .

(2) Parameter identity. Let f : (cid:73)X Ã— A â†’ X and h : A(cid:48) â†’ A. Then we have
(f Â· ((cid:73)X Ã— h))â€  = TrX
= TrX
(Lt)
= TrX
= fâ€  Â· h

A(cid:48),X ((cid:104)f Â· ((cid:73)X Ã— h), f Â· ((cid:73)X Ã— h)(cid:105)) by def. of â€ 
A(cid:48),X ((cid:104)f, f(cid:105) Â· ((cid:73)X Ã— h))
A,X ((cid:104)f, f(cid:105)) Â· h

by def. of â€ .

34

(3) Composition identity. Given f : (cid:73)X Ã— A â†’ Y and g : Y â†’ X we compute

by def. of â€ 

A,X ((cid:104)g Â· f, g Â· f(cid:105))
A,X ((X Ã— g) Â· (cid:104)g Â· f, f(cid:105))

(g Â· f )â€  = TrX
= TrX
= g Â· TrX
(Rt)
= g Â· TrX
= g Â· TrY
= g Â· TrY
= g Â· (f Â· ((cid:73)g Ã— A))â€ 

(Sl)

A,Y ((cid:104)g Â· f, f(cid:105))
A,Y ((g Ã— X) Â· (cid:104)f, f(cid:105))
A,Y ((cid:104)f, f(cid:105) Â· ((cid:73)g Ã— A))
A,Y ((cid:104)f Â· ((cid:73)g Ã— A), f Â· ((cid:73)g Ã— A)(cid:105))

by def. of â€ .
(4) Double dagger identity. Given f : (cid:73)X Ã— (cid:73)X Ã— A â†’ X we have
by def. of â€ 
by def. of â€ 

fâ€ â€  = TrX
= TrX
(Rt)
= TrX
= TrXÃ—X
(V 2)
= TrXÃ—X
(Sl)
= TrX

A,X ((cid:104)fâ€ , fâ€ (cid:105))
A,X (âˆ†X Â· TrX(cid:73)XÃ—A,X ((cid:104)f, f(cid:105)))
A,X (TrX(cid:73)XÃ—A,XÃ—X ((X Ã— âˆ†X ) Â· (cid:104)f, f(cid:105)))
A,X ((cid:104)f, f, f(cid:105) Â· (can Ã— A))
A,X ((âˆ†X Ã— X) Â· (cid:104)f, f(cid:105) Â· (can Ã— A))
(cid:123)(cid:122)
(cid:125)
A,X ((cid:104)f, f(cid:105) Â· (can Ã— A) Â· ((cid:73)(âˆ†X ) Ã— A)
A,X ((cid:104)f Â· (âˆ†(cid:73)X Ã— A), f Â· (âˆ†(cid:73)X Ã— A))

=âˆ†(cid:73)XÃ—A

(cid:124)

)

= TrX
= (f Â· (âˆ†(cid:73)X Ã— A))â€ 

by def. of â€ .

B.2. From dagger to trace

We prove that the operation Tr deï¬ned in Construction 4.4.2 satisï¬es all the axioms of a
guarded trace operator. Again we start with a technical lemma.
Lemma B.2. Let f : (cid:73)X Ã— A â†’ X Ã— B and deï¬ne

h = ((cid:73)(X Ã— B) Ã— A

(cid:73)Ï€(cid:96)Ã—A /

/(cid:73)X Ã— A

f

/X Ã— B ).

Then we have

A,B(f ) = (A hâ€ 
TrX

/X Ã— B

Ï€r

/B ).

Proof. Notice ï¬rst that by the simpliï¬ed composition identity we have Ï€(cid:96) Â· hâ€  = (Ï€(cid:96) Â· f )â€ . This
implies that

(cid:104)(Ï€(cid:96)Â·f )â€ ,A(cid:105)

(cid:9)
Ï€(cid:96)Ã—A

X Ã— A

A

(cid:104)hâ€ ,A(cid:105)
X Ã— B Ã— A

hâ€ 

(cid:9) by (â€ )

X Ã— B

h

(cid:73)(X Ã— B) Ã— A

pXÃ—BÃ—A
(cid:9) by nat. of p

(cid:9)
(cid:73)Ï€(cid:96)Ã—A

f

pXÃ—A

/ (cid:73)X Ã— A

The result follows by postcomposing with Ï€r; by the deï¬nition of Tr we have

A,B(f ) = Ï€r Â· f Â· (pX Ã— A) Â· (cid:104)(Ï€(cid:96) Â· f )â€ , A(cid:105) = Ï€r Â· hâ€ .
TrX

35

/
/
/
/
/




/
/
v
v
O
O
)
)
/
o
o
We now verify the properties of a guarded trace for Tr.
(1) Vanishing (V1). For any f : (cid:73)1 Ã— A â†’ B the deï¬nition of Tr1

A,B(f ) yields f Â· (p1 Ã— A);
for if we consider B as the product 1 Ã— B we see that both Ï€(cid:96) Â· f : (cid:73)1 Ã— A â†’ 1 and its
dagger (Ï€(cid:96) Â· f )â€  : A â†’ 1 are unique morphisms, which implies that (cid:104)(Ï€(cid:96) Â· f )â€ , A(cid:105) : A â†’ 1 Ã— A
is the canonical isomorphism A âˆ¼= 1 Ã— A, and Ï€r : 1 Ã— B â†’ B is the canonical isomorphism
1 Ã— B âˆ¼= B.
(2) Vanishing (V2). Given f : (cid:73)X Ã— (cid:73)Y Ã— A â†’ X Ã— Y Ã— B we form F = Ï€(cid:96) Â· f :
(cid:73)X Ã— (cid:73)Y Ã— A â†’ X and G = Ï€m Â· f : (cid:73)X Ã— (cid:73)Y Ã— A â†’ Y , where Ï€m : X Ã— Y Ã— B â†’ B
denotes the middle product projection. Then by the BekiË‡c identity (see Proposition 3.10) we
â€ 
â€ 
have ((cid:104)F, G(cid:105)Â· (canÃ— A))â€  = (cid:104)e
R(cid:105) for appropriate eL : (cid:73)X Ã— A â†’ X and eR : (cid:73)Y Ã— A â†’ Y .
L, e
From the following diagram we see that Ï€(cid:96) Â· TrX(cid:73)Y Ã—A,Y Ã—B(f ) = eR:

(cid:73)Y Ã— A

(cid:104)F â€ ,(cid:73)Y Ã—A(cid:105)

/ X Ã— (cid:73)Y Ã— A

TrX (f )

(cid:9)
pXÃ—Y Ã—A /
/ (cid:73)X Ã— (cid:73)Y Ã— A
(cid:9)

eR

f

X Ã— Y Ã— B

(cid:9)

G

Ï€r

Ï€m

Y Ã— B
(cid:9)

Ï€(cid:96)

Y/

By the naturality of p we have

pX Ã— pY = (X Ã— Y

pXÃ—Y /

/(cid:73)(X Ã— Y )

can

/(cid:73)X Ã— (cid:73)Y ).

(B.3)

Now we obtain

A,B(TrX(cid:73)Y Ã—A,Y Ã—B(f )) = Ï€r Â· TrX (f ) Â· (pY Ã— A) Â· (cid:104)e
(cid:124)
TrY

â€ 
R, A(cid:105)

(cid:123)(cid:122)
(cid:125)
â€ 
R, A(cid:105)
= Ï€r Â· f Â· (pX Ã— (cid:73)Y Ã— A) Â· (cid:104)F â€ , (cid:73)Y Ã— A(cid:105) Â· (pY Ã— A) Â· (cid:104)e
â€ 
â€ 
R, A(cid:105)
R, A(cid:105), pY Â· e
= Ï€r Â· f Â· (pX Ã— (cid:73)Y Ã— A) Â· (cid:104)F â€  Â· (cid:104)pY Â· e
â€ 
â€ 
R, A(cid:105)
L, pY Â· e
= Ï€r Â· f Â· (pX Ã— (cid:73)Y Ã— A) Â· (cid:104)e
â€ 
â€ 
R, A(cid:105)
= Ï€r Â· f Â· (pX Ã— pY Ã— A) Â· (cid:104)e
L, e
â€ 
â€ 
R, A(cid:105)
= Ï€r Â· f Â· (can Ã— A) Â· (pXÃ—Y Ã— A) Â· (cid:104)e
L, e

(3.7)

(B.3)

A,B (f Â·(canÃ—A)) now follows from the deï¬nition of Tr, the fact that (cid:104)e

That this is TrXÃ—Y
((cid:104)F, G(cid:105)Â·(canÃ—A))â€  holds by the BekiË‡c identity and since (cid:104)F, G(cid:105) = Ï€(cid:48)
X Ã— Y .
(3) Superposing. Let f : (cid:73)X Ã— A â†’ X Ã— B and denote by Ï€(cid:48)
(cid:96) : X Ã— B Ã— C â†’ X the projections. Notice ï¬rst that we have
Ï€(cid:48)
/(cid:73)X Ã— A

(cid:96) Â· (f Ã— C))â€  = (cid:0)(cid:73)X Ã— A Ã— C

(Ï€(cid:48)

f

= (cid:0)A Ã— C

(P )

Ï€(cid:96)

/A

(cid:73)XÃ—Ï€(cid:96)
(Ï€(cid:96)Â·f )â€ 

/X(cid:1).

(cid:96)Â·f where Ï€(cid:48)

â€ 
â€ 
R(cid:105) =
L, e
(cid:96) : XÃ—Y Ã—A â†’
r : X Ã— B Ã— C â†’ B Ã— C and

/X(cid:1)â€ 

/X Ã— B

Ï€(cid:96)

Using this we obtain

AÃ—C,BÃ—C(f Ã— C)
TrX

def= Ï€(cid:48)

(cid:124)
r Â· (f Ã— C) Â· (pX Ã— A Ã— C) Â· (cid:104)(Ï€(cid:48)

= (cid:0)Ï€r Â· f Â· (pX Ã— A) Â· (cid:104)(Ï€(cid:96) Â· f )â€ , A(cid:105)(cid:1) Ã— C

(cid:125)
(cid:96) Â· (f Ã— C))â€ , A Ã— C(cid:105)
=(cid:104)(Ï€(cid:96)Â·f )â€ ,A(cid:105)Ã—C

(cid:123)(cid:122)

def= TrX

A,B(f ) Ã— C.

36

/
/
/
+
+
/
/
'
'




/
/
/
/
/
/
/
(4) Yanking. Consider c : (cid:73)X Ã— X â†’ X Ã— (cid:73)X. Then by deï¬nition we have

X,(cid:73)X (c) = Ï€r Â· c Â· (pX Ã— X) Â· (cid:104)(Ï€(cid:96) Â· c)â€ , X(cid:105).
TrX

Thus, we are done if we show that (Ï€(cid:96) Â· c)â€  is the identity on X, which easily follows from the
ï¬xpoint identity:

(Ï€(cid:96) Â· c)â€  (â€ )

= Ï€(cid:96) Â· c Â· (pX Ã— X) Â· (cid:104)(Ï€(cid:96) Â· c)â€ , X(cid:105) = Ï€r Â· (pX Ã— X) Â· (cid:104)(Ï€(cid:96) Â· c)â€ , X(cid:105) = X.

(5) Left tightening. Let f : (cid:73)X Ã— A â†’ X Ã— B and g : A(cid:48) â†’ A. By the parameter identity

we have

Then we have

A(cid:48),B(f Â· ((cid:73)X Ã— g))
TrX

(Ï€(cid:96) Â· f Â· ((cid:73)X Ã— g))â€  = (Ï€(cid:96) Â· f )â€  Â· g.

(B.4)

(B.4)

def= Ï€r Â· f Â· ((cid:73)X Ã— g) Â· (pX Ã— A(cid:48)) Â· (cid:104)(Ï€(cid:96) Â· f Â· ((cid:73)X Ã— g))â€ , A(cid:48)(cid:105)
= Ï€r Â· f Â· ((cid:73)X Ã— g) Â· (pX Ã— A(cid:48)) Â· (cid:104)(Ï€(cid:96) Â· f )â€  Â· g, A(cid:48)(cid:105)
= Ï€r Â· f Â· (pX Ã— A) Â· (cid:104)(Ï€(cid:96) Â· f )â€ , A(cid:105) Â· g
def= TrX

A,B(f ) Â· g.

(6) Right tightening. Let f : (cid:73)X Ã— A â†’ X Ã— B and g : B â†’ B(cid:48). We compute

A,B(cid:48)((X Ã— g) Â· f )
TrX

def= Ï€r Â· (X Ã— g)

Â·f Â· (pX Ã— A) Â· (cid:104)(Ï€(cid:96) Â· (X Ã— g)

Â·f )â€ , A(cid:105)

(cid:124)

(cid:123)(cid:122)

(cid:125)

=gÂ·Ï€r
def= g Â· TrX
A,B(f ).

(cid:124)

(cid:123)(cid:122)

=Ï€(cid:96)

(cid:125)

(7) Sliding. Let f : (cid:73)X Ã— A â†’ X(cid:48) Ã— B and g : X(cid:48) â†’ X. Notice ï¬rst that we have

(Ï€(cid:96) Â· (g Ã— B) Â· f )â€  = (g Â· (Ï€(cid:96) Â· f ))â€  (C)

= g Â· (Ï€(cid:96) Â· f Â· ((cid:73)g Ã— A))â€ .

(B.5)

Then we obtain

A,B((g Ã— B) Â· f )
TrX

(cid:124)

(cid:123)(cid:122)

=Ï€r

(cid:125)

def= Ï€r Â· (g Ã— B)

Â·f Â· (pX Ã— A) Â· (cid:104)(Ï€(cid:96) Â· (g Ã— B) Â· f )â€ , A(cid:105)

(B.5)

(cid:124)

= Ï€r Â· f Â· (pX Ã— A) Â· (cid:104)g Â· (Ï€(cid:96) Â· f Â· ((cid:73)g Ã— A))â€ , A(cid:105)
= Ï€r Â· f Â· (pX Ã— A) Â· (g Ã— A)
=((cid:73)gÃ—A)Â·(pX(cid:48)Ã—A)

(cid:123)(cid:122)
A,B(f Â· ((cid:73)g Ã— A)).

def= TrX(cid:48)

Â·(cid:104)(Ï€(cid:96) Â· f Â· ((cid:73)g Ã— A))â€ , A(cid:105)

(cid:125)

B.3. Mutual inverses
From dagger to trace and back. We show that â€ Trâ€  = â€ . For any f : (cid:73)X Ã— A â†’ X we
compute

â€ Trâ€ (f ) def= (Trâ€ )X

(cid:123)(cid:122)
(cid:125)
A,X ((cid:104)f, f(cid:105)) def= Ï€r Â· (cid:104)f, f(cid:105)

(cid:124)

=f

Â·(pX Ã— A) Â· (cid:104)(Ï€(cid:96) Â· (cid:104)f, f(cid:105))â€ , A(cid:105)

(â€ )
= fâ€ .

(cid:124)

(cid:123)(cid:122)

=(cid:104)fâ€ ,A(cid:105)

(cid:125)

37

From trace to dagger and back. We show that Trâ€ Tr = Tr. Let f : (cid:73)X Ã— A â†’ X Ã— B. Then
we have by the deï¬nition of â€ Tr
(Ï€(cid:96) Â· f )â€ Tr def= TrX

(B.6)

Using Lemma B.1, this allows us to conclude

A,X ((cid:104)Ï€(cid:96) Â· f, Ï€(cid:96) Â· f(cid:105)) = TrX
A,X (âˆ†X Â· Ï€(cid:96) Â· f ) =: h.
(cid:123)(cid:122)

(cid:125)
A,B(f ) def= Ï€r Â· f Â· (pX Ã— A) Â· (cid:104)(Ï€(cid:96) Â· f )â€ Tr, A(cid:105)

Lem. B.1= TrX

(cid:124)

A,B(f ).

=(cid:104)h,A(cid:105)

(Trâ€ Tr)X

C. Proof of Theorem 4.7
1. From trace to dagger. Let f , f(cid:48) and h form the commutative square on the left below:

(cid:73)X Ã— A
(cid:73)hÃ—A
(cid:73)X(cid:48) Ã— A

f

(cid:9)

f(cid:48)

X

h

/ X(cid:48)

(cid:73)X Ã— A
(cid:73)hÃ—A
(cid:73)X(cid:48) Ã— A

(cid:104)f,f(cid:105)

X Ã— X

(cid:9)

(cid:104)f(cid:48),f(cid:48)(cid:105)

XÃ—h /
/ X Ã— X(cid:48)
(cid:9)
hÃ—X(cid:48)
X(cid:48) Ã— X(cid:48)

hÃ—h

Then the diagram on the right above commutes, too, and thus, by uniformity of Tr we have

A,X(cid:48)((X Ã— h) Â· (cid:104)f, f(cid:105)) = TrX(cid:48)
TrX
A,X(cid:104)f, f(cid:105) (Rt)

A,X(cid:48)(cid:104)f(cid:48), f(cid:48)(cid:105).
A,X(cid:48)((XÃ—h)Â·(cid:104)f, f(cid:105))

= TrX

Thus, we obtain: hÂ·fâ€  def= hÂ·TrX

A,X(cid:48)(cid:104)f(cid:48), f(cid:48)(cid:105) def= (f(cid:48))â€ .
2. From dagger to trace. Let f , f(cid:48) and h form the commutative square on the left below:

= TrX(cid:48)

(C.1)

(C.1)

(cid:73)X Ã— A
(cid:73)hÃ—A
(cid:73)X(cid:48) Ã— A

X Ã— B
hÃ—B
/ X(cid:48) Ã— B

f

(cid:9)

f(cid:48)

(cid:73)(X Ã— B) Ã— A

(cid:73)Ï€(cid:96)Ã—A /

(cid:73)(hÃ—B)Ã—A
(cid:73)(X(cid:48) Ã— B) Ã— A (cid:73)Ï€(cid:96)Ã—A

(cid:9)

(cid:73)X Ã— A
(cid:73)hÃ—A
/ (cid:73)X(cid:48) Ã— A

X Ã— B
hÃ—B
/ X(cid:48) Ã— B

f

(cid:9)

f(cid:48)

Then the diagram on the right above commutes, too, and thus, by uniformity of â€  we have

(h Ã— B) Â· (f Â· ((cid:73)Ï€(cid:96) Ã— A))â€  = (f(cid:48) Â· ((cid:73)Ï€(cid:96) Ã— A))â€ 

(C.2)

Using Lemma B.2 we now compute:

TrX(cid:48)

A,B(f(cid:48)) Lem. B.2=

(C.2)
=

Ï€r Â· (f(cid:48) Â· ((cid:73)Ï€(cid:96) Ã— A))â€ 
Ï€r Â· (h Ã— B)

Â·(f Â· ((cid:73)Ï€(cid:96) Ã— A))â€ 

(cid:124)

(cid:123)(cid:122)

=Ï€r

(cid:125)

Lem. B.2=

TrX

A,B(f ).

38

/
/




/
/
/


%
%


/
/
/
/




/
/


/
/




/
/
D. Proof of Corollary 4.10
1. Let F : (C, (cid:73)C, TrC) â†’ (D, (cid:73)D, TrD) be a morphism of guarded traced categories. We show
that F preserves â€ Tr as deï¬ned in Construction 4.4.1. Let f : (cid:73)X Ã— A â†’ X in C. Then we
have (dropping subscripts of â€  and Tr)

F (fâ€ ) = F (TrX(cid:104)f, f(cid:105))
= TrF X (F(cid:104)f, f(cid:105))
= TrF X(cid:104)F f, F f(cid:105)
= (F f )â€ 

(by deï¬nition of â€ )
(F trace preserving)
(F ï¬nite product preserving)
(by deï¬nition of â€ ).

2. Let F : (C, (cid:73)C,â€ ) â†’ (D, (cid:73)D,â€¡) be a morphism of guarded Conway categories. We show
that F preserves Trâ€  as deï¬ned in Construction 4.4.2. Let f : (cid:73)CX Ã— A â†’ X Ã— B in C. Then
we have (again we drop all subscripts of Tr and â€ )

F (TrX (f )) = F(cid:0)Ï€r Â· (f Â· ((cid:73)CÏ€(cid:96) Ã— A))â€ (cid:1)
= F Ï€r Â·(cid:0)F f Â· F ((cid:73)CÏ€(cid:96) Ã— A)(cid:1)â€¡

= Ï€r Â· (F f Â· (F ((cid:73)CÏ€(cid:96)) Ã— F A))â€¡
= Ï€r Â· (F f Â· ((cid:73)D F Ï€(cid:96)
Ã—F A))â€¡

(cid:124)(cid:123)(cid:122)(cid:125)

=Ï€(cid:96)

(by Lemma B.2)
(F dagger preserving)
(F ï¬nite product preserving)
(by (4.1))

(by Lemma B.2).

= TrF X (F f )

This completes the proof.

39

